{"Node Id":"StreamAgg","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":4028992326,"Max Time":4028992326,"Access Object":"","Operation Info":"funcs:sum(Column#20)-\u003eColumn#18","Execution Info":"time:4.03s, loops:2","Disk":0,"Memory":1476,"Plans":[{"Node Id":"TableReader","Plan Rows":1,"Actual Rows":9,"Task":"root","Total Time":4028977496,"Max Time":4028977496,"Access Object":"","Operation Info":"data:StreamAgg_9","Execution Info":"time:4.03s, loops:2, cop_task: {num: 9, max: 4.02s, min: 662.5ms, avg: 2.65s, p95: 4.02s, max_proc_keys: 512775, p95_proc_keys: 512775, tot_proc: 23.7s, tot_wait: 90ms, rpc_num: 9, rpc_time: 23.9s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":413,"Plans":[{"Node Id":"StreamAgg","Plan Rows":1,"Actual Rows":9,"Task":"cop[tikv]","Total Time":4285000000,"Max Time":621000000,"Access Object":"","Operation Info":"funcs:sum(mul(new0107.lineitem.l_extendedprice, new0107.lineitem.l_discount))-\u003eColumn#20","Execution Info":"tikv_task:{proc max:621ms, min:352ms, p80:513ms, p95:621ms, iters:3923, tasks:9}, scan_detail: {total_process_keys: 4009984, total_process_keys_size: 787655655, total_keys: 4009993, rocksdb: {delete_skipped_count: 0, key_skipped_count: 4009984, block: {cache_hit_count: 12898, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"Selection","Plan Rows":832.9070933333335,"Actual Rows":76412,"Task":"cop[tikv]","Total Time":4185000000,"Max Time":603000000,"Access Object":"","Operation Info":"ge(new0107.lineitem.l_discount, 0.05), ge(new0107.lineitem.l_shipdate, 1994-01-01 00:00:00.000000), le(new0107.lineitem.l_discount, 0.07), lt(new0107.lineitem.l_quantity, 24), lt(new0107.lineitem.l_shipdate, 1995-01-01 00:00:00.000000)","Execution Info":"tikv_task:{proc max:603ms, min:346ms, p80:500ms, p95:603ms, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":3737000000,"Max Time":553000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:553ms, min:310ms, p80:450ms, p95:553ms, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}
/*PLACEHOLDER*/ select  sum(l_extendedprice * l_discount) as revenue from  lineitem where  l_shipdate >= '1994-01-01'  and l_shipdate < date_add('1994-01-01', interval '1' year)  and l_discount between 0.06 - 0.01 and 0.06 + 0.01  and l_quantity < 24;

{"Node Id":"Sort","Plan Rows":1,"Actual Rows":4,"Task":"root","Total Time":4092692505,"Max Time":4092692505,"Access Object":"","Operation Info":"new0107.lineitem.l_returnflag, new0107.lineitem.l_linestatus","Execution Info":"time:4.09s, loops:2","Disk":0,"Memory":34872,"Plans":[{"Node Id":"Projection","Plan Rows":1,"Actual Rows":4,"Task":"root","Total Time":4092599807,"Max Time":4092599807,"Access Object":"","Operation Info":"new0107.lineitem.l_returnflag, new0107.lineitem.l_linestatus, Column#18, Column#19, Column#20, Column#21, Column#22, Column#23, Column#24, Column#25","Execution Info":"time:4.09s, loops:4, Concurrency:OFF","Disk":0,"Memory":11624,"Plans":[{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":4,"Task":"root","Total Time":4092576759,"Max Time":4092576759,"Access Object":"","Operation Info":"group by:new0107.lineitem.l_linestatus, new0107.lineitem.l_returnflag, funcs:sum(Column#26)-\u003eColumn#18, funcs:sum(Column#27)-\u003eColumn#19, funcs:sum(Column#28)-\u003eColumn#20, funcs:sum(Column#29)-\u003eColumn#21, funcs:avg(Column#30, Column#31)-\u003eColumn#22, funcs:avg(Column#32, Column#33)-\u003eColumn#23, funcs:avg(Column#34, Column#35)-\u003eColumn#24, funcs:count(Column#36)-\u003eColumn#25, funcs:firstrow(new0107.lineitem.l_returnflag)-\u003enew0107.lineitem.l_returnflag, funcs:firstrow(new0107.lineitem.l_linestatus)-\u003enew0107.lineitem.l_linestatus","Execution Info":"time:4.09s, loops:4, partial_worker:{wall_time:4.092509477s, concurrency:5, task_num:1, tot_wait:20.459952068s, tot_exec:132.617µs, tot_time:20.460097424s, max:4.092462244s, p95:4.092462244s}, final_worker:{wall_time:4.092587258s, concurrency:5, task_num:3, tot_wait:20.458775599s, tot_exec:179.301µs, tot_time:20.458959407s, max:4.091827564s, p95:4.091827564s}","Disk":0,"Memory":136884,"Plans":[{"Node Id":"TableReader","Plan Rows":1,"Actual Rows":36,"Task":"root","Total Time":4092066598,"Max Time":4092066598,"Access Object":"","Operation Info":"data:HashAgg_9","Execution Info":"time:4.09s, loops:2, cop_task: {num: 9, max: 4.09s, min: 1.46s, avg: 2.55s, p95: 4.09s, max_proc_keys: 512775, p95_proc_keys: 512775, tot_proc: 22.8s, tot_wait: 91ms, rpc_num: 9, rpc_time: 23s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":3204,"Plans":[{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":36,"Task":"cop[tikv]","Total Time":10706000000,"Max Time":1409000000,"Access Object":"","Operation Info":"group by:new0107.lineitem.l_linestatus, new0107.lineitem.l_returnflag, funcs:sum(new0107.lineitem.l_quantity)-\u003eColumn#26, funcs:sum(new0107.lineitem.l_extendedprice)-\u003eColumn#27, funcs:sum(mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount)))-\u003eColumn#28, funcs:sum(mul(mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount)), plus(1, new0107.lineitem.l_tax)))-\u003eColumn#29, funcs:count(new0107.lineitem.l_quantity)-\u003eColumn#30, funcs:sum(new0107.lineitem.l_quantity)-\u003eColumn#31, funcs:count(new0107.lineitem.l_extendedprice)-\u003eColumn#32, funcs:sum(new0107.lineitem.l_extendedprice)-\u003eColumn#33, funcs:count(new0107.lineitem.l_discount)-\u003eColumn#34, funcs:sum(new0107.lineitem.l_discount)-\u003eColumn#35, funcs:count(1)-\u003eColumn#36","Execution Info":"tikv_task:{proc max:1.41s, min:649ms, p80:1.33s, p95:1.41s, iters:3923, tasks:9}, scan_detail: {total_process_keys: 4009984, total_process_keys_size: 787655655, total_keys: 4009993, rocksdb: {delete_skipped_count: 0, key_skipped_count: 4009984, block: {cache_hit_count: 12898, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"Selection","Plan Rows":1332651.3493333333,"Actual Rows":3928532,"Task":"cop[tikv]","Total Time":4744000000,"Max Time":663000000,"Access Object":"","Operation Info":"le(new0107.lineitem.l_shipdate, 1998-08-15 00:00:00.000000)","Execution Info":"tikv_task:{proc max:663ms, min:265ms, p80:603ms, p95:663ms, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4545000000,"Max Time":642000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:642ms, min:256ms, p80:578ms, p95:642ms, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  l_returnflag,  l_linestatus,  sum(l_quantity) as sum_qty,  sum(l_extendedprice) as sum_base_price,  sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,  sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,  avg(l_quantity) as avg_qty,  avg(l_extendedprice) as avg_price,  avg(l_discount) as avg_disc,  count(*) as count_order from  lineitem where  l_shipdate <= date_sub('1998-12-01', interval 108 day) group by  l_returnflag,  l_linestatus order by  l_returnflag,  l_linestatus;

{"Node Id":"Sort","Plan Rows":149568,"Actual Rows":33,"Task":"root","Total Time":9671244181,"Max Time":9671244181,"Access Object":"","Operation Info":"Column#19:desc, Column#18:desc","Execution Info":"time:9.67s, loops:2","Disk":0,"Memory":3720,"Plans":[{"Node Id":"Projection","Plan Rows":149568,"Actual Rows":33,"Task":"root","Total Time":9671115825,"Max Time":9671115825,"Access Object":"","Operation Info":"Column#18, Column#19","Execution Info":"time:9.67s, loops:6, Concurrency:5","Disk":0,"Memory":7440,"Plans":[{"Node Id":"HashAgg","Plan Rows":149568,"Actual Rows":33,"Task":"root","Total Time":9670149788,"Max Time":9670149788,"Access Object":"","Operation Info":"group by:Column#18, funcs:count(1)-\u003eColumn#19, funcs:firstrow(Column#18)-\u003eColumn#18","Execution Info":"time:9.67s, loops:6, partial_worker:{wall_time:9.557767808s, concurrency:5, task_num:150, tot_wait:47.370525047s, tot_exec:309.489124ms, tot_time:47.68020111s, max:9.554775561s, p95:9.554775561s}, final_worker:{wall_time:9.665320241s, concurrency:5, task_num:25, tot_wait:48.217308496s, tot_exec:362.122µs, tot_time:48.217679317s, max:9.665037484s, p95:9.665037484s}","Disk":0,"Memory":229368,"Plans":[{"Node Id":"HashAgg","Plan Rows":149568,"Actual Rows":150000,"Task":"root","Total Time":9523258893,"Max Time":9523258893,"Access Object":"","Operation Info":"group by:new0107.customer.c_custkey, funcs:count(new0107.orders.o_orderkey)-\u003eColumn#18","Execution Info":"time:9.52s, loops:151, partial_worker:{wall_time:8.348409138s, concurrency:5, task_num:1020, tot_wait:37.710194386s, tot_exec:2.788373696s, tot_time:40.992582893s, max:8.327582341s, p95:8.327582341s}, final_worker:{wall_time:9.523461057s, concurrency:5, task_num:25, tot_wait:40.819540284s, tot_exec:5.669933817s, tot_time:46.489498279s, max:9.523256627s, p95:9.523256627s}","Disk":0,"Memory":59662935,"Plans":[{"Node Id":"HashJoin","Plan Rows":878254.1720154043,"Actual Rows":1040728,"Task":"root","Total Time":7950618124,"Max Time":7950618124,"Access Object":"","Operation Info":"left outer join, equal:[eq(new0107.customer.c_custkey, new0107.orders.o_custkey)]","Execution Info":"time:7.95s, loops:1021, build_hash_table:{total:4.77s, fetch:4.69s, build:79.5ms}, probe:{concurrency:5, total:39.5s, max:7.9s, probe:10.3s, fetch:29.2s}","Disk":0,"Memory":1262960,"Plans":[{"Node Id":"TableReader","Plan Rows":150000,"Actual Rows":150000,"Task":"root","Total Time":4671406573,"Max Time":4671406573,"Access Object":"","Operation Info":"data:TableFullScan_17","Execution Info":"time:4.67s, loops:148, cop_task: {num: 1, max: 4.67s, proc_keys: 150000, tot_proc: 4.66s, tot_wait: 4ms, rpc_num: 1, rpc_time: 4.67s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":1202338,"Plans":[{"Node Id":"TableFullScan","Plan Rows":150000,"Actual Rows":150000,"Task":"cop[tikv]","Total Time":89000000,"Max Time":89000000,"Access Object":"","Operation Info":"table:customer, keep order:false","Execution Info":"tikv_task:{time:89ms, loops:151}, scan_detail: {total_process_keys: 150000, total_process_keys_size: 4050000, total_keys: 150001, rocksdb: {delete_skipped_count: 0, key_skipped_count: 150000, block: {cache_hit_count: 502, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]},{"Node Id":"TableReader","Plan Rows":875724.8,"Actual Rows":990658,"Task":"root","Total Time":5337188434,"Max Time":5337188434,"Access Object":"","Operation Info":"data:Selection_20","Execution Info":"time:5.34s, loops:980, cop_task: {num: 2, max: 6.32s, min: 4.35s, avg: 5.34s, p95: 6.32s, max_proc_keys: 583494, p95_proc_keys: 583494, tot_proc: 10.2s, tot_wait: 76ms, rpc_num: 2, rpc_time: 10.7s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":71780726,"Plans":[{"Node Id":"Selection","Plan Rows":875724.8,"Actual Rows":990658,"Task":"cop[tikv]","Total Time":1697000000,"Max Time":1066000000,"Access Object":"","Operation Info":"not(like(new0107.orders.o_comment, \"%pending%deposits%\", 92))","Execution Info":"tikv_task:{proc max:1.07s, min:631ms, p80:1.07s, p95:1.07s, iters:987, tasks:2}, scan_detail: {total_process_keys: 1001472, total_process_keys_size: 151717700, total_keys: 1001474, rocksdb: {delete_skipped_count: 0, key_skipped_count: 1001472, block: {cache_hit_count: 2529, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":1029000000,"Max Time":657000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:657ms, min:372ms, p80:657ms, p95:657ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  c_count,  count(*) as custdist from  (   select    c_custkey,    count(o_orderkey) as c_count   from    customer left outer join orders on     c_custkey = o_custkey     and o_comment not like '%pending%deposits%'   group by    c_custkey  ) c_orders group by  c_count order by  custdist desc,  c_count desc;

{"Node Id":"Projection","Plan Rows":640,"Actual Rows":838,"Task":"root","Total Time":10625050086,"Max Time":10625050086,"Access Object":"","Operation Info":"new0107.partsupp.ps_partkey, Column#35","Execution Info":"time:10.6s, loops:2, Concurrency:OFF","Disk":0,"Memory":48256,"Plans":[{"Node Id":"Sort","Plan Rows":640,"Actual Rows":838,"Task":"root","Total Time":10625038440,"Max Time":10625038440,"Access Object":"","Operation Info":"Column#35:desc","Execution Info":"time:10.6s, loops:2","Disk":0,"Memory":48256,"Plans":[{"Node Id":"Selection","Plan Rows":640,"Actual Rows":838,"Task":"root","Total Time":10621082806,"Max Time":10621082806,"Access Object":"","Operation Info":"gt(Column#35, 8147162.905283000000)","Execution Info":"time:10.6s, loops:2","Disk":0,"Memory":50944,"Plans":[{"Node Id":"HashAgg","Plan Rows":800,"Actual Rows":30670,"Task":"root","Total Time":10617975229,"Max Time":10617975229,"Access Object":"","Operation Info":"group by:Column#61, funcs:sum(Column#59)-\u003eColumn#35, funcs:firstrow(Column#60)-\u003enew0107.partsupp.ps_partkey","Execution Info":"time:10.6s, loops:34, partial_worker:{wall_time:10.15030036s, concurrency:5, task_num:35, tot_wait:50.517037084s, tot_exec:92.569427ms, tot_time:50.615765647s, max:10.125106651s, p95:10.125106651s}, final_worker:{wall_time:0s, concurrency:5, task_num:25, tot_wait:50.868795083s, tot_exec:1.106699963s, tot_time:51.975514797s, max:10.587695887s, p95:10.587695887s}","Disk":0,"Memory":9689353,"Plans":[{"Node Id":"Projection","Plan Rows":800,"Actual Rows":32480,"Task":"root","Total Time":10110371726,"Max Time":10110371726,"Access Object":"","Operation Info":"mul(new0107.partsupp.ps_supplycost, cast(new0107.partsupp.ps_availqty, decimal(20,0) BINARY))-\u003eColumn#59, new0107.partsupp.ps_partkey, new0107.partsupp.ps_partkey","Execution Info":"time:10.1s, loops:36, Concurrency:OFF","Disk":0,"Memory":297776,"Plans":[{"Node Id":"HashJoin","Plan Rows":800,"Actual Rows":32480,"Task":"root","Total Time":10100939458,"Max Time":10100939458,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.supplier.s_suppkey, new0107.partsupp.ps_suppkey)]","Execution Info":"time:10.1s, loops:36, build_hash_table:{total:8.45s, fetch:8.45s, build:291.5µs}, probe:{concurrency:5, total:50.4s, max:10.1s, probe:1.81s, fetch:48.6s}","Disk":0,"Memory":4976,"Plans":[{"Node Id":"HashJoin","Plan Rows":10,"Actual Rows":406,"Task":"root","Total Time":8454665568,"Max Time":8454665568,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.supplier.s_nationkey)]","Execution Info":"time:8.45s, loops:6, build_hash_table:{total:69.2ms, fetch:69.2ms, build:12.3µs}, probe:{concurrency:5, total:42.3s, max:8.45s, probe:1.73ms, fetch:42.3s}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":0.025,"Actual Rows":1,"Task":"root","Total Time":69133287,"Max Time":69133287,"Access Object":"","Operation Info":"data:Selection_88","Execution Info":"time:69.1ms, loops:2, cop_task: {num: 1, max: 69.8ms, proc_keys: 25, rpc_num: 1, rpc_time: 69.7ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":252,"Plans":[{"Node Id":"Selection","Plan Rows":0.025,"Actual Rows":1,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"eq(new0107.nation.n_name, \"MOZAMBIQUE\")","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:nation, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":10000,"Actual Rows":10000,"Task":"root","Total Time":8452189935,"Max Time":8452189935,"Access Object":"","Operation Info":"data:TableFullScan_85","Execution Info":"time:8.45s, loops:11, cop_task: {num: 1, max: 8.45s, proc_keys: 10000, tot_proc: 8.23s, tot_wait: 68ms, rpc_num: 1, rpc_time: 8.45s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":160537,"Plans":[{"Node Id":"TableFullScan","Plan Rows":10000,"Actual Rows":10000,"Task":"cop[tikv]","Total Time":7000000,"Max Time":7000000,"Access Object":"","Operation Info":"table:supplier, keep order:false","Execution Info":"tikv_task:{time:7ms, loops:14}, scan_detail: {total_process_keys: 10000, total_process_keys_size: 1815466, total_keys: 10001, rocksdb: {delete_skipped_count: 0, key_skipped_count: 10000, block: {cache_hit_count: 33, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":800000,"Actual Rows":800000,"Task":"root","Total Time":9660937563,"Max Time":9660937563,"Access Object":"","Operation Info":"data:TableFullScan_90","Execution Info":"time:9.66s, loops:783, cop_task: {num: 2, max: 9.76s, min: 9.12s, avg: 9.44s, p95: 9.76s, max_proc_keys: 529029, p95_proc_keys: 529029, tot_proc: 17.8s, tot_wait: 147ms, rpc_num: 2, rpc_time: 18.9s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":51231846,"Plans":[{"Node Id":"TableFullScan","Plan Rows":800000,"Actual Rows":800000,"Task":"cop[tikv]","Total Time":716000000,"Max Time":485000000,"Access Object":"","Operation Info":"table:partsupp, keep order:false","Execution Info":"tikv_task:{proc max:485ms, min:231ms, p80:485ms, p95:485ms, iters:790, tasks:2}, scan_detail: {total_process_keys: 800000, total_process_keys_size: 150608990, total_keys: 800002, rocksdb: {delete_skipped_count: 0, key_skipped_count: 800000, block: {cache_hit_count: 2473, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  ps_partkey,  sum(ps_supplycost * ps_availqty) as value from  partsupp,  supplier,  nation where  ps_suppkey = s_suppkey  and s_nationkey = n_nationkey  and n_name = 'MOZAMBIQUE' group by  ps_partkey having   sum(ps_supplycost * ps_availqty) > (    select     sum(ps_supplycost * ps_availqty) * 0.0001000000    from     partsupp,     supplier,     nation    where     ps_suppkey = s_suppkey     and s_nationkey = n_nationkey     and n_name = 'MOZAMBIQUE'   ) order by  value desc;

{"Node Id":"Projection","Plan Rows":20,"Actual Rows":20,"Task":"root","Total Time":12432901425,"Max Time":12432901425,"Access Object":"","Operation Info":"new0107.customer.c_custkey, new0107.customer.c_name, Column#39, new0107.customer.c_acctbal, new0107.nation.n_name, new0107.customer.c_address, new0107.customer.c_phone, new0107.customer.c_comment","Execution Info":"time:12.4s, loops:2, Concurrency:OFF","Disk":0,"Memory":9184,"Plans":[{"Node Id":"TopN","Plan Rows":20,"Actual Rows":20,"Task":"root","Total Time":12432821358,"Max Time":12432821358,"Access Object":"","Operation Info":"Column#39:desc, offset:0, count:20","Execution Info":"time:12.4s, loops:2","Disk":0,"Memory":332280,"Plans":[{"Node Id":"HashAgg","Plan Rows":4091.8732102300773,"Actual Rows":27560,"Task":"root","Total Time":12358853305,"Max Time":12358853305,"Access Object":"","Operation Info":"group by:Column#53, Column#54, Column#55, Column#56, Column#57, Column#58, Column#59, funcs:sum(Column#45)-\u003eColumn#39, funcs:firstrow(Column#46)-\u003enew0107.customer.c_custkey, funcs:firstrow(Column#47)-\u003enew0107.customer.c_name, funcs:firstrow(Column#48)-\u003enew0107.customer.c_address, funcs:firstrow(Column#49)-\u003enew0107.customer.c_phone, funcs:firstrow(Column#50)-\u003enew0107.customer.c_acctbal, funcs:firstrow(Column#51)-\u003enew0107.customer.c_comment, funcs:firstrow(Column#52)-\u003enew0107.nation.n_name","Execution Info":"time:12.4s, loops:31, partial_worker:{wall_time:11.944525133s, concurrency:5, task_num:78, tot_wait:57.951444954s, tot_exec:1.318075171s, tot_time:59.299784734s, max:11.903643747s, p95:11.903643747s}, final_worker:{wall_time:12.433055596s, concurrency:5, task_num:25, tot_wait:59.382433912s, tot_exec:2.130183647s, tot_time:1m1.512639058s, max:12.429463134s, p95:12.429463134s}","Disk":0,"Memory":39844271,"Plans":[{"Node Id":"Projection","Plan Rows":4091.8732102300773,"Actual Rows":76675,"Task":"root","Total Time":11817942115,"Max Time":11817942115,"Access Object":"","Operation Info":"mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount))-\u003eColumn#45, new0107.customer.c_custkey, new0107.customer.c_name, new0107.customer.c_address, new0107.customer.c_phone, new0107.customer.c_acctbal, new0107.customer.c_comment, new0107.nation.n_name, new0107.customer.c_custkey, new0107.customer.c_name, new0107.customer.c_acctbal, new0107.customer.c_phone, new0107.nation.n_name, new0107.customer.c_address, new0107.customer.c_comment","Execution Info":"time:11.8s, loops:79, Concurrency:5","Disk":0,"Memory":4707384,"Plans":[{"Node Id":"Projection","Plan Rows":4091.8732102300773,"Actual Rows":76675,"Task":"root","Total Time":11066596169,"Max Time":11066596169,"Access Object":"","Operation Info":"new0107.customer.c_custkey, new0107.customer.c_name, new0107.customer.c_address, new0107.customer.c_phone, new0107.customer.c_acctbal, new0107.customer.c_comment, new0107.lineitem.l_extendedprice, new0107.lineitem.l_discount, new0107.nation.n_name","Execution Info":"time:11.1s, loops:79, Concurrency:5","Disk":0,"Memory":3480336,"Plans":[{"Node Id":"HashJoin","Plan Rows":4091.8732102300773,"Actual Rows":76675,"Task":"root","Total Time":11020023121,"Max Time":11020023121,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.orders.o_orderkey, new0107.lineitem.l_orderkey)]","Execution Info":"time:11s, loops:79, build_hash_table:{total:10.6s, fetch:9.19s, build:1.42s}, probe:{concurrency:5, total:58.6s, max:11.8s, probe:5.37s, fetch:53.2s}","Disk":0,"Memory":135284944,"Plans":[{"Node Id":"HashJoin","Plan Rows":27445.442875481385,"Actual Rows":38190,"Task":"root","Total Time":7658392148,"Max Time":7658392148,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.customer.c_custkey, new0107.orders.o_custkey)]","Execution Info":"time:7.66s, loops:41, build_hash_table:{total:7.47s, fetch:7.43s, build:35.2ms}, probe:{concurrency:5, total:58.1s, max:11.7s, probe:19.2s, fetch:38.9s}","Disk":0,"Memory":1183200,"Plans":[{"Node Id":"HashJoin","Plan Rows":150000,"Actual Rows":150000,"Task":"root","Total Time":4136901244,"Max Time":4136901244,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.customer.c_nationkey)]","Execution Info":"time:4.14s, loops:148, build_hash_table:{total:461.3µs, fetch:442.8µs, build:18.5µs}, probe:{concurrency:5, total:58s, max:11.6s, probe:40.3s, fetch:17.8s}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":25,"Actual Rows":25,"Task":"root","Total Time":70716,"Max Time":70716,"Access Object":"","Operation Info":"data:TableFullScan_60","Execution Info":"time:70.7µs, loops:2, cop_task: {num: 1, max: 12.7ms, proc_keys: 25, rpc_num: 1, rpc_time: 5.41ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":794,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:nation, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]},{"Node Id":"TableReader","Plan Rows":150000,"Actual Rows":150000,"Task":"root","Total Time":3573045607,"Max Time":3573045607,"Access Object":"","Operation Info":"data:TableFullScan_58","Execution Info":"time:3.57s, loops:148, cop_task: {num: 1, max: 3.55s, proc_keys: 150000, tot_proc: 3.45s, tot_wait: 2ms, rpc_num: 1, rpc_time: 3.55s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":32798874,"Plans":[{"Node Id":"TableFullScan","Plan Rows":150000,"Actual Rows":150000,"Task":"cop[tikv]","Total Time":159000000,"Max Time":159000000,"Access Object":"","Operation Info":"table:customer, keep order:false","Execution Info":"tikv_task:{time:159ms, loops:151}, scan_detail: {total_process_keys: 150000, total_process_keys_size: 30533765, total_keys: 150001, rocksdb: {delete_skipped_count: 0, key_skipped_count: 150000, block: {cache_hit_count: 502, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":27366.4,"Actual Rows":38190,"Task":"root","Total Time":7432218482,"Max Time":7432218482,"Access Object":"","Operation Info":"data:Selection_63","Execution Info":"time:7.43s, loops:39, cop_task: {num: 2, max: 7.46s, min: 4.58s, avg: 6.02s, p95: 7.46s, max_proc_keys: 583494, p95_proc_keys: 583494, tot_proc: 11.8s, tot_wait: 20ms, rpc_num: 2, rpc_time: 12s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":946412,"Plans":[{"Node Id":"Selection","Plan Rows":27366.4,"Actual Rows":38190,"Task":"cop[tikv]","Total Time":1112000000,"Max Time":769000000,"Access Object":"","Operation Info":"ge(new0107.orders.o_orderdate, 1993-08-01 00:00:00.000000), lt(new0107.orders.o_orderdate, 1993-11-01 00:00:00.000000)","Execution Info":"tikv_task:{proc max:769ms, min:343ms, p80:769ms, p95:769ms, iters:987, tasks:2}, scan_detail: {total_process_keys: 1001472, total_process_keys_size: 151717700, total_keys: 1001474, rocksdb: {delete_skipped_count: 0, key_skipped_count: 1001472, block: {cache_hit_count: 2529, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":1060000000,"Max Time":740000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:740ms, min:320ms, p80:740ms, p95:740ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"TableReader","Plan Rows":4009.984,"Actual Rows":988138,"Task":"root","Total Time":8605701623,"Max Time":8605701623,"Access Object":"","Operation Info":"data:Selection_66","Execution Info":"time:8.61s, loops:963, cop_task: {num: 9, max: 9.46s, min: 4.74s, avg: 7.89s, p95: 9.46s, max_proc_keys: 512775, p95_proc_keys: 512775, tot_proc: 1m8.9s, tot_wait: 374ms, rpc_num: 9, rpc_time: 1m11s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":45586894,"Plans":[{"Node Id":"Selection","Plan Rows":4009.984,"Actual Rows":988138,"Task":"cop[tikv]","Total Time":4543000000,"Max Time":711000000,"Access Object":"","Operation Info":"eq(new0107.lineitem.l_returnflag, \"R\")","Execution Info":"tikv_task:{proc max:711ms, min:282ms, p80:594ms, p95:711ms, iters:3959, tasks:9}, scan_detail: {total_process_keys: 4009984, total_process_keys_size: 787655655, total_keys: 4009993, rocksdb: {delete_skipped_count: 0, key_skipped_count: 4009984, block: {cache_hit_count: 12898, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4133000000,"Max Time":665000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:665ms, min:239ms, p80:541ms, p95:665ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  c_custkey,  c_name,  sum(l_extendedprice * (1 - l_discount)) as revenue,  c_acctbal,  n_name,  c_address,  c_phone,  c_comment from  customer,  orders,  lineitem,  nation where  c_custkey = o_custkey  and l_orderkey = o_orderkey  and o_orderdate >= '1993-08-01'  and o_orderdate < date_add('1993-08-01', interval '3' month)  and l_returnflag = 'R'  and c_nationkey = n_nationkey group by  c_custkey,  c_name,  c_acctbal,  c_phone,  n_name,  c_address,  c_comment order by  revenue desc limit 20;

{"Node Id":"Sort","Plan Rows":1,"Actual Rows":2,"Task":"root","Total Time":12445102572,"Max Time":12445102572,"Access Object":"","Operation Info":"new0107.lineitem.l_shipmode","Execution Info":"time:12.4s, loops:2","Disk":0,"Memory":6968,"Plans":[{"Node Id":"Projection","Plan Rows":1,"Actual Rows":2,"Task":"root","Total Time":12445005686,"Max Time":12445005686,"Access Object":"","Operation Info":"new0107.lineitem.l_shipmode, Column#27, Column#28","Execution Info":"time:12.4s, loops:3, Concurrency:OFF","Disk":0,"Memory":3484,"Plans":[{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":2,"Task":"root","Total Time":12444996952,"Max Time":12444996952,"Access Object":"","Operation Info":"group by:Column#40, funcs:sum(Column#37)-\u003eColumn#27, funcs:sum(Column#38)-\u003eColumn#28, funcs:firstrow(Column#39)-\u003enew0107.lineitem.l_shipmode","Execution Info":"time:12.4s, loops:3, partial_worker:{wall_time:12.444964561s, concurrency:5, task_num:21, tot_wait:1m2.20909447s, tot_exec:8.877454ms, tot_time:1m2.218034098s, max:12.444021011s, p95:12.444021011s}, final_worker:{wall_time:0s, concurrency:5, task_num:10, tot_wait:1m2.220725266s, tot_exec:150.53µs, tot_time:1m2.220885871s, max:12.444237506s, p95:12.444237506s}","Disk":0,"Memory":1255418,"Plans":[{"Node Id":"Projection","Plan Rows":163.2035446153846,"Actual Rows":20757,"Task":"root","Total Time":12440431006,"Max Time":12440431006,"Access Object":"","Operation Info":"cast(case(or(eq(new0107.orders.o_orderpriority, 1-URGENT), eq(new0107.orders.o_orderpriority, 2-HIGH)), 1, 0), decimal(20,0) BINARY)-\u003eColumn#37, cast(case(and(ne(new0107.orders.o_orderpriority, 1-URGENT), ne(new0107.orders.o_orderpriority, 2-HIGH)), 1, 0), decimal(20,0) BINARY)-\u003eColumn#38, new0107.lineitem.l_shipmode, new0107.lineitem.l_shipmode","Execution Info":"time:12.4s, loops:22, Concurrency:OFF","Disk":0,"Memory":251984,"Plans":[{"Node Id":"Projection","Plan Rows":163.2035446153846,"Actual Rows":20757,"Task":"root","Total Time":12311130650,"Max Time":12311130650,"Access Object":"","Operation Info":"new0107.orders.o_orderpriority, new0107.lineitem.l_shipmode","Execution Info":"time:12.3s, loops:22, Concurrency:OFF","Disk":0,"Memory":307012,"Plans":[{"Node Id":"IndexJoin","Plan Rows":163.2035446153846,"Actual Rows":20757,"Task":"root","Total Time":12311022147,"Max Time":12311022147,"Access Object":"","Operation Info":"inner join, inner:TableReader_17, outer key:new0107.lineitem.l_orderkey, inner key:new0107.orders.o_orderkey, equal cond:eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)","Execution Info":"time:12.3s, loops:22, inner:{total:46.3s, concurrency:5, task:9, construct:121.7ms, fetch:45.9s, build:249.2ms}, probe:115.5ms","Disk":0,"Memory":3851373,"Plans":[{"Node Id":"TableReader","Plan Rows":160.39936,"Actual Rows":20773,"Task":"root","Total Time":5094450594,"Max Time":5094450594,"Access Object":"","Operation Info":"data:Selection_49","Execution Info":"time:5.09s, loops:26, cop_task: {num: 9, max: 5.09s, min: 1.21s, avg: 3.14s, p95: 5.09s, max_proc_keys: 512775, p95_proc_keys: 512775, tot_proc: 28.1s, tot_wait: 89ms, rpc_num: 9, rpc_time: 28.3s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":271153,"Plans":[{"Node Id":"Selection","Plan Rows":160.39936,"Actual Rows":20773,"Task":"cop[tikv]","Total Time":4954000000,"Max Time":647000000,"Access Object":"","Operation Info":"ge(new0107.lineitem.l_receiptdate, 1997-01-01 00:00:00.000000), in(new0107.lineitem.l_shipmode, \"RAIL\", \"FOB\"), lt(new0107.lineitem.l_commitdate, new0107.lineitem.l_receiptdate), lt(new0107.lineitem.l_receiptdate, 1998-01-01 00:00:00.000000), lt(new0107.lineitem.l_shipdate, new0107.lineitem.l_commitdate)","Execution Info":"tikv_task:{proc max:647ms, min:292ms, p80:636ms, p95:647ms, iters:3959, tasks:9}, scan_detail: {total_process_keys: 4009984, total_process_keys_size: 787655655, total_keys: 4009993, rocksdb: {delete_skipped_count: 0, key_skipped_count: 4009984, block: {cache_hit_count: 12898, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4041000000,"Max Time":548000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:548ms, min:233ms, p80:537ms, p95:548ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":1,"Actual Rows":19515,"Task":"root","Total Time":45616165717,"Max Time":9058616222,"Access Object":"","Operation Info":"data:TableRangeScan_16","Execution Info":"time:45.6s, loops:33, cop_task: {num: 13, max: 9.06s, min: 115.1ms, avg: 4.88s, p95: 9.06s, max_proc_keys: 4918, p95_proc_keys: 4918, tot_proc: 59.9s, tot_wait: 1.08s, rpc_num: 25, rpc_time: 2m6.6s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":19515,"Task":"cop[tikv]","Total Time":241000000,"Max Time":73000000,"Access Object":"","Operation Info":"table:orders, range: decided by [new0107.lineitem.l_orderkey], keep order:false","Execution Info":"tikv_task:{proc max:73ms, min:3ms, p80:28ms, p95:73ms, iters:71, tasks:13}, scan_detail: {total_process_keys: 19515, total_process_keys_size: 2958195, total_keys: 19858, rocksdb: {delete_skipped_count: 0, key_skipped_count: 665, block: {cache_hit_count: 25708, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  l_shipmode,  sum(case   when o_orderpriority = '1-URGENT'    or o_orderpriority = '2-HIGH'    then 1   else 0  end) as high_line_count,  sum(case   when o_orderpriority <> '1-URGENT'    and o_orderpriority <> '2-HIGH'    then 1   else 0  end) as low_line_count from  orders,  lineitem where  o_orderkey = l_orderkey  and l_shipmode in ('RAIL', 'FOB')  and l_commitdate < l_receiptdate  and l_shipdate < l_commitdate  and l_receiptdate >= '1997-01-01'  and l_receiptdate < date_add('1997-01-01', interval '1' year) group by  l_shipmode order by  l_shipmode;

{"Node Id":"Projection","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":13552618382,"Max Time":13552618382,"Access Object":"","Operation Info":"div(mul(100.00, Column#27), Column#28)-\u003eColumn#29","Execution Info":"time:13.6s, loops:2, Concurrency:OFF","Disk":0,"Memory":2856,"Plans":[{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":13552561549,"Max Time":13552561549,"Access Object":"","Operation Info":"funcs:sum(Column#31)-\u003eColumn#27, funcs:sum(Column#32)-\u003eColumn#28","Execution Info":"time:13.6s, loops:2, partial_worker:{wall_time:13.552531173s, concurrency:5, task_num:54, tot_wait:1m7.743385728s, tot_exec:9.687793ms, tot_time:1m7.75311861s, max:13.550719413s, p95:13.550719413s}, final_worker:{wall_time:13.55273502s, concurrency:5, task_num:5, tot_wait:1m7.752872605s, tot_exec:37.182µs, tot_time:1m7.752914443s, max:13.550613075s, p95:13.550613075s}","Disk":0,"Memory":972200,"Plans":[{"Node Id":"Projection","Plan Rows":101796.91307879772,"Actual Rows":51967,"Task":"root","Total Time":13550393945,"Max Time":13550393945,"Access Object":"","Operation Info":"case(like(new0107.part.p_type, PROMO%, 92), mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount)), 0)-\u003eColumn#31, mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount))-\u003eColumn#32","Execution Info":"time:13.6s, loops:55, Concurrency:5","Disk":0,"Memory":1076296,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":101796.91307879772,"Actual Rows":51967,"Task":"root","Total Time":13545929525,"Max Time":13545929525,"Access Object":"","Operation Info":"inner join, inner:TableReader_12, outer key:new0107.lineitem.l_partkey, inner key:new0107.part.p_partkey, equal cond:eq(new0107.lineitem.l_partkey, new0107.part.p_partkey)","Execution Info":"time:13.5s, loops:55, inner:{total:31s, concurrency:5, task:10, construct:721.6ms, fetch:29.1s, build:351.8ms, join:1.26s}","Disk":0,"Memory":13697618,"Plans":[{"Node Id":"TableReader","Plan Rows":100249.6,"Actual Rows":51967,"Task":"root","Total Time":9059749952,"Max Time":9059749952,"Access Object":"","Operation Info":"data:Selection_23","Execution Info":"time:9.06s, loops:56, cop_task: {num: 9, max: 9.02s, min: 6.27s, avg: 7.66s, p95: 9.02s, max_proc_keys: 512775, p95_proc_keys: 512775, tot_proc: 1m6.3s, tot_wait: 452ms, rpc_num: 9, rpc_time: 1m8.9s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":1258039,"Plans":[{"Node Id":"Selection","Plan Rows":100249.6,"Actual Rows":51967,"Task":"cop[tikv]","Total Time":4273000000,"Max Time":589000000,"Access Object":"","Operation Info":"ge(new0107.lineitem.l_shipdate, 1996-12-01 00:00:00.000000), lt(new0107.lineitem.l_shipdate, 1997-01-01 00:00:00.000000)","Execution Info":"tikv_task:{proc max:589ms, min:269ms, p80:517ms, p95:589ms, iters:3959, tasks:9}, scan_detail: {total_process_keys: 4009984, total_process_keys_size: 787655655, total_keys: 4009993, rocksdb: {delete_skipped_count: 0, key_skipped_count: 4009984, block: {cache_hit_count: 12898, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4063000000,"Max Time":562000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:562ms, min:255ms, p80:494ms, p95:562ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":1,"Actual Rows":50236,"Task":"root","Total Time":28614530618,"Max Time":5681153995,"Access Object":"","Operation Info":"data:TableRangeScan_11","Execution Info":"time:28.6s, loops:66, cop_task: {num: 10, max: 5.66s, min: 143.4ms, avg: 2.79s, p95: 5.66s, max_proc_keys: 18238, p95_proc_keys: 18238, tot_proc: 23.9s, tot_wait: 652ms, rpc_num: 19, rpc_time: 55.7s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":50236,"Task":"cop[tikv]","Total Time":483000000,"Max Time":163000000,"Access Object":"","Operation Info":"table:part, range: decided by [new0107.lineitem.l_partkey], keep order:false","Execution Info":"tikv_task:{proc max:163ms, min:2ms, p80:130ms, p95:163ms, iters:90, tasks:10}, scan_detail: {total_process_keys: 50236, total_process_keys_size: 8211521, total_keys: 53360, rocksdb: {delete_skipped_count: 0, key_skipped_count: 6506, block: {cache_hit_count: 61139, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}
/*PLACEHOLDER*/ select  100.00 * sum(case   when p_type like 'PROMO%'    then l_extendedprice * (1 - l_discount)   else 0  end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from  lineitem,  part where  l_partkey = p_partkey  and l_shipdate >= '1996-12-01'  and l_shipdate < date_add('1996-12-01', interval '1' month);

{"Node Id":"Sort","Plan Rows":307.48077797816654,"Actual Rows":1,"Task":"root","Total Time":2199088008,"Max Time":2199088008,"Access Object":"","Operation Info":"new0107.supplier.s_suppkey","Execution Info":"time:2.2s, loops:2","Disk":0,"Memory":3684,"Plans":[{"Node Id":"IndexJoin","Plan Rows":307.48077797816654,"Actual Rows":1,"Task":"root","Total Time":2199059474,"Max Time":2199059474,"Access Object":"","Operation Info":"inner join, inner:TableReader_62, outer key:new0107.lineitem.l_suppkey, inner key:new0107.supplier.s_suppkey, equal cond:eq(new0107.lineitem.l_suppkey, new0107.supplier.s_suppkey)","Execution Info":"time:2.2s, loops:2, inner:{total:233.1ms, concurrency:5, task:1, construct:13.2µs, fetch:233.1ms, build:4.67µs}, probe:4.57µs","Disk":0,"Memory":108177,"Plans":[{"Node Id":"TableReader","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":232985950,"Max Time":232985950,"Access Object":"","Operation Info":"data:TableRangeScan_61","Execution Info":"time:233ms, loops:2, cop_task: {num: 1, max: 210.2ms, proc_keys: 1, rpc_num: 1, rpc_time: 210.2ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":1,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:supplier, range: decided by [new0107.lineitem.l_suppkey], keep order:false","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 1, total_process_keys_size: 129, total_keys: 1, rocksdb: {delete_skipped_count: 0, key_skipped_count: 0, block: {cache_hit_count: 3, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]},{"Node Id":"Selection","Plan Rows":307.48077797816654,"Actual Rows":1,"Task":"root","Total Time":1954938213,"Max Time":1954938213,"Access Object":"","Operation Info":"eq(Column#25, 1479126.6609)","Execution Info":"time:1.95s, loops:3","Disk":0,"Memory":50944,"Plans":[{"Node Id":"HashAgg","Plan Rows":384.3509724727081,"Actual Rows":10000,"Task":"root","Total Time":1953905143,"Max Time":1953905143,"Access Object":"","Operation Info":"group by:new0107.lineitem.l_suppkey, funcs:sum(Column#46)-\u003eColumn#25, funcs:firstrow(new0107.lineitem.l_suppkey)-\u003enew0107.lineitem.l_suppkey","Execution Info":"time:1.95s, loops:13, partial_worker:{wall_time:1.787525035s, concurrency:5, task_num:9, tot_wait:8.247771403s, tot_exec:350.297387ms, tot_time:8.625836356s, max:1.735717185s, p95:1.735717185s}, final_worker:{wall_time:1.954999623s, concurrency:5, task_num:25, tot_wait:8.819069106s, tot_exec:494.09925ms, tot_time:9.313190796s, max:1.949240083s, p95:1.949240083s}","Disk":0,"Memory":11140214,"Plans":[{"Node Id":"TableReader","Plan Rows":384.3509724727081,"Actual Rows":72907,"Task":"root","Total Time":1177132183,"Max Time":1177132183,"Access Object":"","Operation Info":"data:HashAgg_73","Execution Info":"time:1.18s, loops:10, cop_task: {num: 9, max: 1.12s, min: 91.2ms, avg: 450.5ms, p95: 1.12s, rpc_num: 9, rpc_time: 4.05s, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":808641,"Plans":[{"Node Id":"HashAgg","Plan Rows":384.3509724727081,"Actual Rows":72907,"Task":"cop[tikv]","Total Time":4716000000,"Max Time":640000000,"Access Object":"","Operation Info":"group by:new0107.lineitem.l_suppkey, funcs:sum(mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount)))-\u003eColumn#46","Execution Info":"tikv_task:{proc max:640ms, min:266ms, p80:587ms, p95:640ms, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"Selection","Plan Rows":154124.125,"Actual Rows":154277,"Task":"cop[tikv]","Total Time":4328000000,"Max Time":595000000,"Access Object":"","Operation Info":"ge(new0107.lineitem.l_shipdate, 1997-07-01 00:00:00.000000), lt(new0107.lineitem.l_shipdate, 1997-10-01 00:00:00.000000)","Execution Info":"tikv_task:{proc max:595ms, min:238ms, p80:528ms, p95:595ms, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4093000000,"Max Time":572000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:572ms, min:216ms, p80:504ms, p95:572ms, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
 /*PLACEHOLDER*/ select  s_suppkey,  s_name,  s_address,  s_phone,  total_revenue from  supplier,  revenue0 where  s_suppkey = supplier_no  and total_revenue = (   select    max(total_revenue)   from    revenue0  ) order by  s_suppkey;

{"Node Id":"Projection","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":3779380858,"Max Time":3779380858,"Access Object":"","Operation Info":"div(mul(100.00, Column#27), Column#28)-\u003eColumn#29","Execution Info":"time:3.78s, loops:2, Concurrency:OFF","Disk":0,"Memory":2856,"Plans":[{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":3779352349,"Max Time":3779352349,"Access Object":"","Operation Info":"funcs:sum(Column#31)-\u003eColumn#27, funcs:sum(Column#32)-\u003eColumn#28","Execution Info":"time:3.78s, loops:2, partial_worker:{wall_time:3.779315737s, concurrency:5, task_num:54, tot_wait:18.658705809s, tot_exec:198.982052ms, tot_time:18.857740977s, max:3.771561339s, p95:3.771561339s}, final_worker:{wall_time:3.779435596s, concurrency:5, task_num:5, tot_wait:18.857959256s, tot_exec:42.329µs, tot_time:18.858005838s, max:3.77162722s, p95:3.77162722s}","Disk":0,"Memory":972200,"Plans":[{"Node Id":"Projection","Plan Rows":51569.74907482635,"Actual Rows":51967,"Task":"root","Total Time":3770843066,"Max Time":3770843066,"Access Object":"","Operation Info":"case(like(new0107.part.p_type, PROMO%, 92), mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount)), 0)-\u003eColumn#31, mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount))-\u003eColumn#32","Execution Info":"time:3.77s, loops:55, Concurrency:5","Disk":0,"Memory":1059912,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":51569.74907482635,"Actual Rows":51967,"Task":"root","Total Time":3324349986,"Max Time":3324349986,"Access Object":"","Operation Info":"inner join, inner:TableReader_12, outer key:new0107.lineitem.l_partkey, inner key:new0107.part.p_partkey, equal cond:eq(new0107.lineitem.l_partkey, new0107.part.p_partkey)","Execution Info":"time:3.32s, loops:55, inner:{total:16s, concurrency:5, task:10, construct:747.4ms, fetch:11.1s, build:79.8ms, join:4.2s}","Disk":0,"Memory":13626832,"Plans":[{"Node Id":"TableReader","Plan Rows":50785.88888888899,"Actual Rows":51967,"Task":"root","Total Time":218181917,"Max Time":218181917,"Access Object":"","Operation Info":"data:Selection_23","Execution Info":"time:218.2ms, loops:56, cop_task: {num: 9, max: 211ms, min: 100.3ms, avg: 167.4ms, p95: 211ms, rpc_num: 9, rpc_time: 1.51s, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":3953090,"Plans":[{"Node Id":"Selection","Plan Rows":50785.88888888899,"Actual Rows":51967,"Task":"cop[tikv]","Total Time":4273000000,"Max Time":589000000,"Access Object":"","Operation Info":"ge(new0107.lineitem.l_shipdate, 1996-12-01 00:00:00.000000), lt(new0107.lineitem.l_shipdate, 1997-01-01 00:00:00.000000)","Execution Info":"tikv_task:{proc max:589ms, min:269ms, p80:517ms, p95:589ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4063000000,"Max Time":562000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:562ms, min:255ms, p80:494ms, p95:562ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":1,"Actual Rows":50208,"Task":"root","Total Time":10661995693,"Max Time":2277620120,"Access Object":"","Operation Info":"data:TableRangeScan_11","Execution Info":"time:10.7s, loops:66, cop_task: {num: 10, max: 2.25s, min: 68.9ms, avg: 1s, p95: 2.25s, max_proc_keys: 18246, p95_proc_keys: 18246, tot_proc: 5.42s, tot_wait: 624ms, rpc_num: 19, rpc_time: 20s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":50208,"Task":"cop[tikv]","Total Time":446000000,"Max Time":151000000,"Access Object":"","Operation Info":"table:part, range: decided by [new0107.lineitem.l_partkey], keep order:false","Execution Info":"tikv_task:{proc max:151ms, min:1ms, p80:147ms, p95:151ms, iters:90, tasks:10}, scan_detail: {total_process_keys: 50208, total_process_keys_size: 8207456, total_keys: 53256, rocksdb: {delete_skipped_count: 0, key_skipped_count: 6355, block: {cache_hit_count: 60973, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}
/*PLACEHOLDER*/ select  100.00 * sum(case   when p_type like 'PROMO%'    then l_extendedprice * (1 - l_discount)   else 0  end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from  lineitem,  part where  l_partkey = p_partkey  and l_shipdate >= '1996-12-01'  and l_shipdate < date_add('1996-12-01', interval '1' month);

{"Node Id":"Projection","Plan Rows":100,"Actual Rows":100,"Task":"root","Total Time":14486168066,"Max Time":14486168066,"Access Object":"","Operation Info":"new0107.supplier.s_acctbal, new0107.supplier.s_name, new0107.nation.n_name, new0107.part.p_partkey, new0107.part.p_mfgr, new0107.supplier.s_address, new0107.supplier.s_phone, new0107.supplier.s_comment","Execution Info":"time:14.5s, loops:2, Concurrency:OFF","Disk":0,"Memory":29808,"Plans":[{"Node Id":"TopN","Plan Rows":100,"Actual Rows":100,"Task":"root","Total Time":14486150969,"Max Time":14486150969,"Access Object":"","Operation Info":"new0107.supplier.s_acctbal:desc, new0107.nation.n_name, new0107.supplier.s_name, new0107.part.p_partkey, offset:0, count:100","Execution Info":"time:14.5s, loops:2","Disk":0,"Memory":143768,"Plans":[{"Node Id":"Projection","Plan Rows":160,"Actual Rows":485,"Task":"root","Total Time":14485653877,"Max Time":14485653877,"Access Object":"","Operation Info":"new0107.part.p_partkey, new0107.part.p_mfgr, new0107.supplier.s_name, new0107.supplier.s_address, new0107.supplier.s_phone, new0107.supplier.s_acctbal, new0107.supplier.s_comment, new0107.nation.n_name","Execution Info":"time:14.5s, loops:2, Concurrency:OFF","Disk":0,"Memory":139888,"Plans":[{"Node Id":"HashJoin","Plan Rows":160,"Actual Rows":485,"Task":"root","Total Time":14485644110,"Max Time":14485644110,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.part.p_partkey, new0107.partsupp.ps_partkey) eq(new0107.partsupp.ps_supplycost, Column#50)]","Execution Info":"time:14.5s, loops:2, build_hash_table:{total:10.6s, fetch:10.3s, build:259.1ms}, probe:{concurrency:5, total:1m12.4s, max:14.5s, probe:1.55ms, fetch:1m12.4s}","Disk":0,"Memory":5761024,"Plans":[{"Node Id":"IndexJoin","Plan Rows":160,"Actual Rows":649,"Task":"root","Total Time":14478466165,"Max Time":14478466165,"Access Object":"","Operation Info":"inner join, inner:TableReader_53, outer key:new0107.partsupp.ps_partkey, inner key:new0107.part.p_partkey, equal cond:eq(new0107.partsupp.ps_partkey, new0107.part.p_partkey)","Execution Info":"time:14.5s, loops:2, inner:{total:25.4s, concurrency:5, task:14, construct:2.77s, fetch:22.6s, build:495.7µs}, probe:409.9ms","Disk":0,"Memory":59679096,"Plans":[{"Node Id":"HashJoin","Plan Rows":200,"Actual Rows":160240,"Task":"root","Total Time":9739256698,"Max Time":9739256698,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.supplier.s_suppkey, new0107.partsupp.ps_suppkey)]","Execution Info":"time:9.74s, loops:161, build_hash_table:{total:198.6ms, fetch:189.5ms, build:9.15ms}, probe:{concurrency:5, total:1m5.7s, max:13.2s, probe:23.6s, fetch:42.1s}","Disk":0,"Memory":539720,"Plans":[{"Node Id":"HashJoin","Plan Rows":2.5,"Actual Rows":2003,"Task":"root","Total Time":190803050,"Max Time":190803050,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.supplier.s_nationkey)]","Execution Info":"time:190.8ms, loops:6, build_hash_table:{total:389.9µs, fetch:383.9µs, build:5.99µs}, probe:{concurrency:5, total:952.1ms, max:191.5ms, probe:40.1ms, fetch:911.9ms}","Disk":0,"Memory":1000,"Plans":[{"Node Id":"HashJoin","Plan Rows":0.00625,"Actual Rows":5,"Task":"root","Total Time":354983,"Max Time":354983,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.region.r_regionkey, new0107.nation.n_regionkey)]","Execution Info":"time:355µs, loops:2, build_hash_table:{total:113.3µs, fetch:109.6µs, build:3.72µs}, probe:{concurrency:5, total:41.5µs, max:26.4µs, probe:18.1µs, fetch:23.5µs}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":0.005,"Actual Rows":1,"Task":"root","Total Time":37195,"Max Time":37195,"Access Object":"","Operation Info":"data:Selection_84","Execution Info":"time:37.2µs, loops:2, cop_task: {num: 1, max: 13.3ms, proc_keys: 5, rpc_num: 1, rpc_time: 10.4ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":242,"Plans":[{"Node Id":"Selection","Plan Rows":0.005,"Actual Rows":1,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"eq(new0107.region.r_name, \"ASIA\")","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 5, total_process_keys_size: 559, total_keys: 6, rocksdb: {delete_skipped_count: 0, key_skipped_count: 5, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":5,"Actual Rows":5,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:region, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":25,"Actual Rows":25,"Task":"root","Total Time":24440,"Max Time":24440,"Access Object":"","Operation Info":"data:TableFullScan_81","Execution Info":"time:24.4µs, loops:2, cop_task: {num: 1, max: 857.2µs, proc_keys: 25, rpc_num: 1, rpc_time: 829.5µs, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":1006,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:nation, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":10000,"Actual Rows":10000,"Task":"root","Total Time":175984828,"Max Time":175984828,"Access Object":"","Operation Info":"data:TableFullScan_86","Execution Info":"time:176ms, loops:11, cop_task: {num: 1, max: 185.6ms, proc_keys: 10000, tot_proc: 163ms, tot_wait: 1ms, rpc_num: 1, rpc_time: 178.3ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":2087019,"Plans":[{"Node Id":"TableFullScan","Plan Rows":10000,"Actual Rows":10000,"Task":"cop[tikv]","Total Time":20000000,"Max Time":20000000,"Access Object":"","Operation Info":"table:supplier, keep order:false","Execution Info":"tikv_task:{time:20ms, loops:14}, scan_detail: {total_process_keys: 10000, total_process_keys_size: 1815466, total_keys: 10001, rocksdb: {delete_skipped_count: 0, key_skipped_count: 10000, block: {cache_hit_count: 33, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":800000,"Actual Rows":800000,"Task":"root","Total Time":8332101395,"Max Time":8332101395,"Access Object":"","Operation Info":"data:TableFullScan_88","Execution Info":"time:8.33s, loops:783, cop_task: {num: 2, max: 9.56s, min: 8.33s, avg: 8.94s, p95: 9.56s, max_proc_keys: 529029, p95_proc_keys: 529029, tot_proc: 16.4s, tot_wait: 58ms, rpc_num: 2, rpc_time: 17.9s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":44825514,"Plans":[{"Node Id":"TableFullScan","Plan Rows":800000,"Actual Rows":800000,"Task":"cop[tikv]","Total Time":818000000,"Max Time":593000000,"Access Object":"","Operation Info":"table:partsupp, keep order:false","Execution Info":"tikv_task:{proc max:593ms, min:225ms, p80:593ms, p95:593ms, iters:790, tasks:2}, scan_detail: {total_process_keys: 800000, total_process_keys_size: 150608990, total_keys: 800002, rocksdb: {delete_skipped_count: 0, key_skipped_count: 800000, block: {cache_hit_count: 2473, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":0.0008,"Actual Rows":485,"Task":"root","Total Time":21857422862,"Max Time":3642380904,"Access Object":"","Operation Info":"data:Selection_52","Execution Info":"time:21.9s, loops:28, cop_task: {num: 14, max: 3.61s, min: 307.5ms, avg: 1.46s, p95: 3.61s, max_proc_keys: 18934, p95_proc_keys: 18934, tot_proc: 14s, tot_wait: 1.02s, rpc_num: 27, rpc_time: 40.5s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":0,"Plans":[{"Node Id":"Selection","Plan Rows":0.0008,"Actual Rows":485,"Task":"cop[tikv]","Total Time":1118000000,"Max Time":232000000,"Access Object":"","Operation Info":"eq(new0107.part.p_size, 30), like(new0107.part.p_type, \"%STEEL\", 92)","Execution Info":"tikv_task:{proc max:232ms, min:5ms, p80:164ms, p95:232ms, iters:177, tasks:14}, scan_detail: {total_process_keys: 118077, total_process_keys_size: 19298203, total_keys: 146962, rocksdb: {delete_skipped_count: 0, key_skipped_count: 98373, block: {cache_hit_count: 136580, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":118077,"Task":"cop[tikv]","Total Time":1111000000,"Max Time":232000000,"Access Object":"","Operation Info":"table:part, range: decided by [new0107.partsupp.ps_partkey], keep order:false","Execution Info":"tikv_task:{proc max:232ms, min:5ms, p80:164ms, p95:232ms, iters:177, tasks:14}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"Selection","Plan Rows":160,"Actual Rows":118067,"Task":"root","Total Time":10237281258,"Max Time":10237281258,"Access Object":"","Operation Info":"not(isnull(Column#50))","Execution Info":"time:10.2s, loops:117","Disk":0,"Memory":50944,"Plans":[{"Node Id":"HashAgg","Plan Rows":200,"Actual Rows":118067,"Task":"root","Total Time":10227531684,"Max Time":10227531684,"Access Object":"","Operation Info":"group by:new0107.partsupp.ps_partkey, funcs:min(new0107.partsupp.ps_supplycost)-\u003eColumn#50, funcs:firstrow(new0107.partsupp.ps_partkey)-\u003enew0107.partsupp.ps_partkey","Execution Info":"time:10.2s, loops:120, partial_worker:{wall_time:9.444457681s, concurrency:5, task_num:160, tot_wait:45.745480377s, tot_exec:743.019789ms, tot_time:46.706548044s, max:9.443472098s, p95:9.443472098s}, final_worker:{wall_time:10.565787848s, concurrency:5, task_num:25, tot_wait:46.897806806s, tot_exec:5.734028128s, tot_time:52.631859727s, max:10.564664027s, p95:10.564664027s}","Disk":0,"Memory":38203549,"Plans":[{"Node Id":"HashJoin","Plan Rows":200,"Actual Rows":160240,"Task":"root","Total Time":9229912693,"Max Time":9229912693,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.supplier.s_suppkey, new0107.partsupp.ps_suppkey)]","Execution Info":"time:9.23s, loops:161, build_hash_table:{total:6.5s, fetch:6.49s, build:442.2µs}, probe:{concurrency:5, total:46s, max:9.23s, probe:3.72s, fetch:42.3s}","Disk":0,"Memory":26400,"Plans":[{"Node Id":"HashJoin","Plan Rows":2.5,"Actual Rows":2003,"Task":"root","Total Time":6494950177,"Max Time":6494950177,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.supplier.s_nationkey)]","Execution Info":"time:6.49s, loops:7, build_hash_table:{total:62.1ms, fetch:62.1ms, build:6.93µs}, probe:{concurrency:5, total:32.5s, max:6.49s, probe:3.08ms, fetch:32.5s}","Disk":0,"Memory":372,"Plans":[{"Node Id":"HashJoin","Plan Rows":0.00625,"Actual Rows":5,"Task":"root","Total Time":62071160,"Max Time":62071160,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.region.r_regionkey, new0107.nation.n_regionkey)]","Execution Info":"time:62.1ms, loops:2, build_hash_table:{total:61.7ms, fetch:61.7ms, build:4.75µs}, probe:{concurrency:5, total:308.2ms, max:61.7ms, probe:14.1µs, fetch:308.1ms}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":0.005,"Actual Rows":1,"Task":"root","Total Time":61628964,"Max Time":61628964,"Access Object":"","Operation Info":"data:Selection_117","Execution Info":"time:61.6ms, loops:2, cop_task: {num: 1, max: 63.8ms, proc_keys: 5, rpc_num: 1, rpc_time: 63.8ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":246,"Plans":[{"Node Id":"Selection","Plan Rows":0.005,"Actual Rows":1,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"eq(new0107.region.r_name, \"ASIA\")","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 5, total_process_keys_size: 559, total_keys: 6, rocksdb: {delete_skipped_count: 0, key_skipped_count: 5, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":5,"Actual Rows":5,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:region, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":25,"Actual Rows":25,"Task":"root","Total Time":58281055,"Max Time":58281055,"Access Object":"","Operation Info":"data:TableFullScan_114","Execution Info":"time:58.3ms, loops:2, cop_task: {num: 1, max: 60.3ms, proc_keys: 25, rpc_num: 1, rpc_time: 60.3ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":613,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:nation, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":10000,"Actual Rows":10000,"Task":"root","Total Time":6492062528,"Max Time":6492062528,"Access Object":"","Operation Info":"data:TableFullScan_119","Execution Info":"time:6.49s, loops:11, cop_task: {num: 1, max: 6.49s, proc_keys: 10000, tot_proc: 6.44s, tot_wait: 41ms, rpc_num: 1, rpc_time: 6.49s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":160537,"Plans":[{"Node Id":"TableFullScan","Plan Rows":10000,"Actual Rows":10000,"Task":"cop[tikv]","Total Time":8000000,"Max Time":8000000,"Access Object":"","Operation Info":"table:supplier, keep order:false","Execution Info":"tikv_task:{time:8ms, loops:14}, scan_detail: {total_process_keys: 10000, total_process_keys_size: 1815466, total_keys: 10001, rocksdb: {delete_skipped_count: 0, key_skipped_count: 10000, block: {cache_hit_count: 33, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":800000,"Actual Rows":800000,"Task":"root","Total Time":6314436599,"Max Time":6314436599,"Access Object":"","Operation Info":"data:TableFullScan_121","Execution Info":"time:6.31s, loops:783, cop_task: {num: 2, max: 8.59s, min: 4.41s, avg: 6.5s, p95: 8.59s, max_proc_keys: 529029, p95_proc_keys: 529029, tot_proc: 12.2s, tot_wait: 90ms, rpc_num: 2, rpc_time: 13s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":44825522,"Plans":[{"Node Id":"TableFullScan","Plan Rows":800000,"Actual Rows":800000,"Task":"cop[tikv]","Total Time":797000000,"Max Time":567000000,"Access Object":"","Operation Info":"table:partsupp, keep order:false","Execution Info":"tikv_task:{proc max:567ms, min:230ms, p80:567ms, p95:567ms, iters:790, tasks:2}, scan_detail: {total_process_keys: 800000, total_process_keys_size: 150608990, total_keys: 800002, rocksdb: {delete_skipped_count: 0, key_skipped_count: 800000, block: {cache_hit_count: 2473, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  s_acctbal,  s_name,  n_name,  p_partkey,  p_mfgr,  s_address,  s_phone,  s_comment from  part,  supplier,  partsupp,  nation,  region where  p_partkey = ps_partkey  and s_suppkey = ps_suppkey  and p_size = 30  and p_type like '%STEEL'  and s_nationkey = n_nationkey  and n_regionkey = r_regionkey  and r_name = 'ASIA'  and ps_supplycost = (   select    min(ps_supplycost)   from    partsupp,    supplier,    nation,    region   where    p_partkey = ps_partkey    and s_suppkey = ps_suppkey    and s_nationkey = n_nationkey    and n_regionkey = r_regionkey    and r_name = 'ASIA'  ) order by  s_acctbal desc,  n_name,  s_name,  p_partkey limit 100;

{"Node Id":"Sort","Plan Rows":1,"Actual Rows":2,"Task":"root","Total Time":2177226326,"Max Time":2177226326,"Access Object":"","Operation Info":"new0107.lineitem.l_shipmode","Execution Info":"time:2.18s, loops:2","Disk":0,"Memory":6968,"Plans":[{"Node Id":"Projection","Plan Rows":1,"Actual Rows":2,"Task":"root","Total Time":2177164169,"Max Time":2177164169,"Access Object":"","Operation Info":"new0107.lineitem.l_shipmode, Column#27, Column#28","Execution Info":"time:2.18s, loops:3, Concurrency:OFF","Disk":0,"Memory":3484,"Plans":[{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":2,"Task":"root","Total Time":2177139268,"Max Time":2177139268,"Access Object":"","Operation Info":"group by:Column#40, funcs:sum(Column#37)-\u003eColumn#27, funcs:sum(Column#38)-\u003eColumn#28, funcs:firstrow(Column#39)-\u003enew0107.lineitem.l_shipmode","Execution Info":"time:2.18s, loops:3, partial_worker:{wall_time:2.148197348s, concurrency:5, task_num:24, tot_wait:10.549575777s, tot_exec:8.265693ms, tot_time:10.557875872s, max:2.123658017s, p95:2.123658017s}, final_worker:{wall_time:2.177300125s, concurrency:5, task_num:10, tot_wait:10.632489097s, tot_exec:86.813µs, tot_time:10.632582776s, max:2.131559365s, p95:2.131559365s}","Disk":0,"Memory":1195329,"Plans":[{"Node Id":"Projection","Plan Rows":137139.56931393046,"Actual Rows":20757,"Task":"root","Total Time":2110291317,"Max Time":2110291317,"Access Object":"","Operation Info":"cast(case(or(eq(new0107.orders.o_orderpriority, 1-URGENT), eq(new0107.orders.o_orderpriority, 2-HIGH)), 1, 0), decimal(20,0) BINARY)-\u003eColumn#37, cast(case(and(ne(new0107.orders.o_orderpriority, 1-URGENT), ne(new0107.orders.o_orderpriority, 2-HIGH)), 1, 0), decimal(20,0) BINARY)-\u003eColumn#38, new0107.lineitem.l_shipmode, new0107.lineitem.l_shipmode","Execution Info":"time:2.11s, loops:25, Concurrency:5","Disk":0,"Memory":297284,"Plans":[{"Node Id":"Projection","Plan Rows":137139.56931393046,"Actual Rows":20757,"Task":"root","Total Time":2089154998,"Max Time":2089154998,"Access Object":"","Operation Info":"new0107.orders.o_orderpriority, new0107.lineitem.l_shipmode","Execution Info":"time:2.09s, loops:25, Concurrency:5","Disk":0,"Memory":111872,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":137139.56931393046,"Actual Rows":20757,"Task":"root","Total Time":2088966171,"Max Time":2088966171,"Access Object":"","Operation Info":"inner join, inner:TableReader_17, outer key:new0107.lineitem.l_orderkey, inner key:new0107.orders.o_orderkey, equal cond:eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)","Execution Info":"time:2.09s, loops:25, inner:{total:6.47s, concurrency:5, task:9, construct:579ms, fetch:5.45s, build:197.7ms, join:443.6ms}","Disk":0,"Memory":3857607,"Plans":[{"Node Id":"TableReader","Plan Rows":134783.21932571862,"Actual Rows":20773,"Task":"root","Total Time":895811403,"Max Time":895811403,"Access Object":"","Operation Info":"data:Selection_49","Execution Info":"time:895.8ms, loops:26, cop_task: {num: 9, max: 743ms, min: 64ms, avg: 227.2ms, p95: 743ms, rpc_num: 9, rpc_time: 2.04s, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":270736,"Plans":[{"Node Id":"Selection","Plan Rows":134783.21932571862,"Actual Rows":20773,"Task":"cop[tikv]","Total Time":4954000000,"Max Time":647000000,"Access Object":"","Operation Info":"ge(new0107.lineitem.l_receiptdate, 1997-01-01 00:00:00.000000), in(new0107.lineitem.l_shipmode, \"RAIL\", \"FOB\"), lt(new0107.lineitem.l_commitdate, new0107.lineitem.l_receiptdate), lt(new0107.lineitem.l_receiptdate, 1998-01-01 00:00:00.000000), lt(new0107.lineitem.l_shipdate, new0107.lineitem.l_commitdate)","Execution Info":"tikv_task:{proc max:647ms, min:292ms, p80:636ms, p95:647ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4041000000,"Max Time":548000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:548ms, min:233ms, p80:537ms, p95:548ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":1,"Actual Rows":19515,"Task":"root","Total Time":4993606273,"Max Time":1030660919,"Access Object":"","Operation Info":"data:TableRangeScan_16","Execution Info":"time:4.99s, loops:34, cop_task: {num: 13, max: 1.02s, min: 90.7ms, avg: 417.8ms, p95: 1.02s, max_proc_keys: 5445, p95_proc_keys: 5445, tot_proc: 1.08s, tot_wait: 313ms, rpc_num: 25, rpc_time: 10.8s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":19515,"Task":"cop[tikv]","Total Time":218000000,"Max Time":78000000,"Access Object":"","Operation Info":"table:orders, range: decided by [new0107.lineitem.l_orderkey], keep order:false","Execution Info":"tikv_task:{proc max:78ms, min:1ms, p80:19ms, p95:78ms, iters:72, tasks:13}, scan_detail: {total_process_keys: 19515, total_process_keys_size: 2958195, total_keys: 19858, rocksdb: {delete_skipped_count: 0, key_skipped_count: 665, block: {cache_hit_count: 25707, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  l_shipmode,  sum(case   when o_orderpriority = '1-URGENT'    or o_orderpriority = '2-HIGH'    then 1   else 0  end) as high_line_count,  sum(case   when o_orderpriority <> '1-URGENT'    and o_orderpriority <> '2-HIGH'    then 1   else 0  end) as low_line_count from  orders,  lineitem where  o_orderkey = l_orderkey  and l_shipmode in ('RAIL', 'FOB')  and l_commitdate < l_receiptdate  and l_shipdate < l_commitdate  and l_receiptdate >= '1997-01-01'  and l_receiptdate < date_add('1997-01-01', interval '1' year) group by  l_shipmode order by  l_shipmode;

{"Node Id":"Sort","Plan Rows":1,"Actual Rows":18333,"Task":"root","Total Time":15069325563,"Max Time":15069325563,"Access Object":"","Operation Info":"Column#23:desc, new0107.part.p_brand, new0107.part.p_type, new0107.part.p_size","Execution Info":"time:15.1s, loops:19","Disk":0,"Memory":1362656,"Plans":[{"Node Id":"Projection","Plan Rows":1,"Actual Rows":18333,"Task":"root","Total Time":14840141116,"Max Time":14840141116,"Access Object":"","Operation Info":"new0107.part.p_brand, new0107.part.p_type, new0107.part.p_size, Column#23","Execution Info":"time:14.8s, loops:19, Concurrency:OFF","Disk":0,"Memory":1328656,"Plans":[{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":18333,"Task":"root","Total Time":14840059141,"Max Time":14840059141,"Access Object":"","Operation Info":"group by:new0107.part.p_brand, new0107.part.p_size, new0107.part.p_type, funcs:count(distinct new0107.partsupp.ps_suppkey)-\u003eColumn#23, funcs:firstrow(new0107.part.p_brand)-\u003enew0107.part.p_brand, funcs:firstrow(new0107.part.p_type)-\u003enew0107.part.p_type, funcs:firstrow(new0107.part.p_size)-\u003enew0107.part.p_size","Execution Info":"time:14.8s, loops:19","Disk":0,"Memory":8761243,"Plans":[{"Node Id":"IndexJoin","Plan Rows":2768.654210668834,"Actual Rows":119078,"Task":"root","Total Time":13430237861,"Max Time":13430237861,"Access Object":"","Operation Info":"anti semi join, inner:TableReader_20, outer key:new0107.partsupp.ps_suppkey, inner key:new0107.supplier.s_suppkey, equal cond:eq(new0107.partsupp.ps_suppkey, new0107.supplier.s_suppkey)","Execution Info":"time:13.4s, loops:118, inner:{total:14.8s, concurrency:5, task:13, construct:2.33s, fetch:12.5s, build:96.3µs}, probe:606.9ms","Disk":0,"Memory":18872725,"Plans":[{"Node Id":"Projection","Plan Rows":3460.8177633360424,"Actual Rows":119136,"Task":"root","Total Time":11386471558,"Max Time":11386471558,"Access Object":"","Operation Info":"new0107.partsupp.ps_suppkey, new0107.part.p_brand, new0107.part.p_type, new0107.part.p_size","Execution Info":"time:11.4s, loops:122, Concurrency:5","Disk":0,"Memory":583040,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":3460.8177633360424,"Actual Rows":119136,"Task":"root","Total Time":11566680134,"Max Time":11566680134,"Access Object":"","Operation Info":"inner join, inner:IndexReader_33, outer key:new0107.part.p_partkey, inner key:new0107.partsupp.ps_partkey, equal cond:eq(new0107.part.p_partkey, new0107.partsupp.ps_partkey)","Execution Info":"time:11.6s, loops:121, inner:{total:57.1s, concurrency:5, task:9, construct:463.3ms, fetch:51.6s, build:98.6ms, join:5.06s}","Disk":0,"Memory":9848987,"Plans":[{"Node Id":"TableReader","Plan Rows":852.0533333333335,"Actual Rows":29784,"Task":"root","Total Time":483698326,"Max Time":483698326,"Access Object":"","Operation Info":"data:Selection_60","Execution Info":"time:483.7ms, loops:35, cop_task: {num: 1, max: 467.3ms, proc_keys: 200000, tot_proc: 455ms, tot_wait: 1ms, rpc_num: 1, rpc_time: 467.3ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":1817830,"Plans":[{"Node Id":"Selection","Plan Rows":852.0533333333335,"Actual Rows":29784,"Task":"cop[tikv]","Total Time":324000000,"Max Time":324000000,"Access Object":"","Operation Info":"in(new0107.part.p_size, 48, 19, 12, 4, 41, 7, 21, 39), ne(new0107.part.p_brand, \"Brand#34\"), not(like(new0107.part.p_type, \"LARGE BRUSHED%\", 92))","Execution Info":"tikv_task:{time:324ms, loops:200}, scan_detail: {total_process_keys: 200000, total_process_keys_size: 32687576, total_keys: 200001, rocksdb: {delete_skipped_count: 0, key_skipped_count: 200000, block: {cache_hit_count: 546, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":200000,"Actual Rows":200000,"Task":"cop[tikv]","Total Time":261000000,"Max Time":261000000,"Access Object":"","Operation Info":"table:part, keep order:false","Execution Info":"tikv_task:{time:261ms, loops:200}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"IndexReader","Plan Rows":4.061738424045492,"Actual Rows":119136,"Task":"root","Total Time":51476441169,"Max Time":9704201897,"Access Object":"","Operation Info":"index:IndexRangeScan_32","Execution Info":"time:51.5s, loops:133, cop_task: {num: 9, max: 9.6s, min: 27.3ms, avg: 5.66s, p95: 9.6s, max_proc_keys: 53228, p95_proc_keys: 53228, tot_proc: 49.2s, tot_wait: 274ms, rpc_num: 17, rpc_time: 1m41.8s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":15311,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":4.061738424045492,"Actual Rows":119136,"Task":"cop[tikv]","Total Time":801000000,"Max Time":327000000,"Access Object":"","Operation Info":"table:partsupp, index:PRIMARY(PS_PARTKEY, PS_SUPPKEY), range: decided by [eq(new0107.partsupp.ps_partkey, new0107.part.p_partkey)], keep order:false","Execution Info":"tikv_task:{proc max:327ms, min:1ms, p80:225ms, p95:327ms, iters:159, tasks:9}, scan_detail: {total_process_keys: 119136, total_process_keys_size: 6314208, total_keys: 148920, rocksdb: {delete_skipped_count: 0, key_skipped_count: 119136, block: {cache_hit_count: 119224, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"TableReader","Plan Rows":0.8,"Actual Rows":24,"Task":"root","Total Time":11318759157,"Max Time":1770902776,"Access Object":"","Operation Info":"data:Selection_19","Execution Info":"time:11.3s, loops:23, cop_task: {num: 13, max: 1.65s, min: 101.6ms, avg: 779.9ms, p95: 1.65s, max_proc_keys: 9384, p95_proc_keys: 9384, tot_proc: 6.51s, tot_wait: 535ms, rpc_num: 25, rpc_time: 18.6s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":0,"Plans":[{"Node Id":"Selection","Plan Rows":0.8,"Actual Rows":24,"Task":"cop[tikv]","Total Time":349000000,"Max Time":66000000,"Access Object":"","Operation Info":"like(new0107.supplier.s_comment, \"%Customer%Complaints%\", 92)","Execution Info":"tikv_task:{proc max:66ms, min:9ms, p80:40ms, p95:66ms, iters:118, tasks:13}, scan_detail: {total_process_keys: 57883, total_process_keys_size: 10510753, total_keys: 65234, rocksdb: {delete_skipped_count: 0, key_skipped_count: 49169, block: {cache_hit_count: 38817, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":57883,"Task":"cop[tikv]","Total Time":302000000,"Max Time":63000000,"Access Object":"","Operation Info":"table:supplier, range: decided by [new0107.partsupp.ps_suppkey], keep order:false","Execution Info":"tikv_task:{proc max:63ms, min:9ms, p80:33ms, p95:63ms, iters:118, tasks:13}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  p_brand,  p_type,  p_size,  count(distinct ps_suppkey) as supplier_cnt from  partsupp,  part where  p_partkey = ps_partkey  and p_brand <> 'Brand#34'  and p_type not like 'LARGE BRUSHED%'  and p_size in (48, 19, 12, 4, 41, 7, 21, 39)  and ps_suppkey not in (   select    s_suppkey   from    supplier   where    s_comment like '%Customer%Complaints%'  ) group by  p_brand,  p_type,  p_size order by  supplier_cnt desc,  p_brand,  p_type,  p_size;

{"Node Id":"Projection","Plan Rows":100,"Actual Rows":100,"Task":"root","Total Time":12157866490,"Max Time":12157866490,"Access Object":"","Operation Info":"new0107.supplier.s_acctbal, new0107.supplier.s_name, new0107.nation.n_name, new0107.part.p_partkey, new0107.part.p_mfgr, new0107.supplier.s_address, new0107.supplier.s_phone, new0107.supplier.s_comment","Execution Info":"time:12.2s, loops:2, Concurrency:OFF","Disk":0,"Memory":29808,"Plans":[{"Node Id":"TopN","Plan Rows":100,"Actual Rows":100,"Task":"root","Total Time":12157849072,"Max Time":12157849072,"Access Object":"","Operation Info":"new0107.supplier.s_acctbal:desc, new0107.nation.n_name, new0107.supplier.s_name, new0107.part.p_partkey, offset:0, count:100","Execution Info":"time:12.2s, loops:2","Disk":0,"Memory":143768,"Plans":[{"Node Id":"Projection","Plan Rows":160,"Actual Rows":485,"Task":"root","Total Time":12157342229,"Max Time":12157342229,"Access Object":"","Operation Info":"new0107.part.p_partkey, new0107.part.p_mfgr, new0107.supplier.s_name, new0107.supplier.s_address, new0107.supplier.s_phone, new0107.supplier.s_acctbal, new0107.supplier.s_comment, new0107.nation.n_name","Execution Info":"time:12.2s, loops:2, Concurrency:OFF","Disk":0,"Memory":139888,"Plans":[{"Node Id":"HashJoin","Plan Rows":160,"Actual Rows":485,"Task":"root","Total Time":12157327715,"Max Time":12157327715,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.part.p_partkey, new0107.partsupp.ps_partkey) eq(new0107.partsupp.ps_supplycost, Column#50)]","Execution Info":"time:12.2s, loops:2, build_hash_table:{total:10.6s, fetch:10.4s, build:202.5ms}, probe:{concurrency:5, total:1m0.7s, max:12.1s, probe:1.87ms, fetch:1m0.7s}","Disk":0,"Memory":5761024,"Plans":[{"Node Id":"IndexJoin","Plan Rows":203.08692120227457,"Actual Rows":649,"Task":"root","Total Time":12116576058,"Max Time":12116576058,"Access Object":"","Operation Info":"inner join, inner:TableReader_53, outer key:new0107.partsupp.ps_partkey, inner key:new0107.part.p_partkey, equal cond:eq(new0107.partsupp.ps_partkey, new0107.part.p_partkey)","Execution Info":"time:12.1s, loops:2, inner:{total:13.9s, concurrency:5, task:14, construct:1.99s, fetch:11.9s, build:300.7µs}, probe:377.9ms","Disk":0,"Memory":59864040,"Plans":[{"Node Id":"HashJoin","Plan Rows":200,"Actual Rows":160240,"Task":"root","Total Time":8858008135,"Max Time":8858008135,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.supplier.s_suppkey, new0107.partsupp.ps_suppkey)]","Execution Info":"time:8.86s, loops:162, build_hash_table:{total:310.5ms, fetch:288.1ms, build:22.3ms}, probe:{concurrency:5, total:50.6s, max:10.2s, probe:12.1s, fetch:38.5s}","Disk":0,"Memory":598488,"Plans":[{"Node Id":"HashJoin","Plan Rows":2.5,"Actual Rows":2003,"Task":"root","Total Time":288226371,"Max Time":288226371,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.supplier.s_nationkey)]","Execution Info":"time:288.2ms, loops:7, build_hash_table:{total:106.1ms, fetch:106.1ms, build:4.88µs}, probe:{concurrency:5, total:1.44s, max:287.4ms, probe:3.69ms, fetch:1.43s}","Disk":0,"Memory":1000,"Plans":[{"Node Id":"HashJoin","Plan Rows":0.00625,"Actual Rows":5,"Task":"root","Total Time":105970722,"Max Time":105970722,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.region.r_regionkey, new0107.nation.n_regionkey)]","Execution Info":"time:106ms, loops:2, build_hash_table:{total:105.1ms, fetch:105.1ms, build:3.42µs}, probe:{concurrency:5, total:523.9ms, max:104.9ms, probe:10.1µs, fetch:523.9ms}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":0.005,"Actual Rows":1,"Task":"root","Total Time":104913102,"Max Time":104913102,"Access Object":"","Operation Info":"data:Selection_84","Execution Info":"time:104.9ms, loops:2, cop_task: {num: 1, max: 125.4ms, proc_keys: 5, rpc_num: 1, rpc_time: 125.3ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":246,"Plans":[{"Node Id":"Selection","Plan Rows":0.005,"Actual Rows":1,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"eq(new0107.region.r_name, \"ASIA\")","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 5, total_process_keys_size: 559, total_keys: 6, rocksdb: {delete_skipped_count: 0, key_skipped_count: 5, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":5,"Actual Rows":5,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:region, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":25,"Actual Rows":25,"Task":"root","Total Time":101190488,"Max Time":101190488,"Access Object":"","Operation Info":"data:TableFullScan_81","Execution Info":"time:101.2ms, loops:2, cop_task: {num: 1, max: 120.1ms, proc_keys: 25, rpc_num: 1, rpc_time: 120.1ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":1006,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:nation, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":10000,"Actual Rows":10000,"Task":"root","Total Time":285336226,"Max Time":285336226,"Access Object":"","Operation Info":"data:TableFullScan_86","Execution Info":"time:285.3ms, loops:11, cop_task: {num: 1, max: 303.7ms, proc_keys: 0, rpc_num: 1, rpc_time: 303.6ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":2086986,"Plans":[{"Node Id":"TableFullScan","Plan Rows":10000,"Actual Rows":10000,"Task":"cop[tikv]","Total Time":20000000,"Max Time":20000000,"Access Object":"","Operation Info":"table:supplier, keep order:false","Execution Info":"tikv_task:{time:20ms, loops:14}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":800000,"Actual Rows":800000,"Task":"root","Total Time":7590170039,"Max Time":7590170039,"Access Object":"","Operation Info":"data:TableFullScan_88","Execution Info":"time:7.59s, loops:783, cop_task: {num: 2, max: 7.74s, min: 7.61s, avg: 7.67s, p95: 7.74s, max_proc_keys: 529029, p95_proc_keys: 529029, tot_proc: 13.9s, tot_wait: 170ms, rpc_num: 2, rpc_time: 15.3s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":44825514,"Plans":[{"Node Id":"TableFullScan","Plan Rows":800000,"Actual Rows":800000,"Task":"cop[tikv]","Total Time":694000000,"Max Time":432000000,"Access Object":"","Operation Info":"table:partsupp, keep order:false","Execution Info":"tikv_task:{proc max:432ms, min:262ms, p80:432ms, p95:432ms, iters:790, tasks:2}, scan_detail: {total_process_keys: 800000, total_process_keys_size: 150608990, total_keys: 800002, rocksdb: {delete_skipped_count: 0, key_skipped_count: 800000, block: {cache_hit_count: 2473, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":0.008704000000000002,"Actual Rows":485,"Task":"root","Total Time":11400802504,"Max Time":1507289474,"Access Object":"","Operation Info":"data:Selection_52","Execution Info":"time:11.4s, loops:28, cop_task: {num: 14, max: 1.5s, min: 164.6ms, avg: 689.2ms, p95: 1.5s, max_proc_keys: 18936, p95_proc_keys: 18936, tot_proc: 3.44s, tot_wait: 1.12s, rpc_num: 27, rpc_time: 18.5s, copr_cache_hit_ratio: 0.14}","Disk":0,"Memory":0,"Plans":[{"Node Id":"Selection","Plan Rows":0.008704000000000002,"Actual Rows":485,"Task":"cop[tikv]","Total Time":989000000,"Max Time":145000000,"Access Object":"","Operation Info":"eq(new0107.part.p_size, 30), like(new0107.part.p_type, \"%STEEL\", 92)","Execution Info":"tikv_task:{proc max:145ms, min:5ms, p80:134ms, p95:145ms, iters:176, tasks:14}, scan_detail: {total_process_keys: 115825, total_process_keys_size: 18930147, total_keys: 144156, rocksdb: {delete_skipped_count: 0, key_skipped_count: 96507, block: {cache_hit_count: 133926, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":118077,"Task":"cop[tikv]","Total Time":982000000,"Max Time":145000000,"Access Object":"","Operation Info":"table:part, range: decided by [new0107.partsupp.ps_partkey], keep order:false","Execution Info":"tikv_task:{proc max:145ms, min:5ms, p80:133ms, p95:145ms, iters:176, tasks:14}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"Selection","Plan Rows":160,"Actual Rows":118067,"Task":"root","Total Time":10107606236,"Max Time":10107606236,"Access Object":"","Operation Info":"not(isnull(Column#50))","Execution Info":"time:10.1s, loops:117","Disk":0,"Memory":50944,"Plans":[{"Node Id":"HashAgg","Plan Rows":200,"Actual Rows":118067,"Task":"root","Total Time":10098335961,"Max Time":10098335961,"Access Object":"","Operation Info":"group by:new0107.partsupp.ps_partkey, funcs:min(new0107.partsupp.ps_supplycost)-\u003eColumn#50, funcs:firstrow(new0107.partsupp.ps_partkey)-\u003enew0107.partsupp.ps_partkey","Execution Info":"time:10.1s, loops:120, partial_worker:{wall_time:9.981734335s, concurrency:5, task_num:160, tot_wait:48.500274297s, tot_exec:999.09929ms, tot_time:49.513903522s, max:9.911580071s, p95:9.911580071s}, final_worker:{wall_time:10.629677003s, concurrency:5, task_num:25, tot_wait:49.621577314s, tot_exec:3.136472652s, tot_time:52.758080468s, max:10.629030091s, p95:10.629030091s}","Disk":0,"Memory":38202028,"Plans":[{"Node Id":"HashJoin","Plan Rows":200,"Actual Rows":160240,"Task":"root","Total Time":9881107001,"Max Time":9881107001,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.supplier.s_suppkey, new0107.partsupp.ps_suppkey)]","Execution Info":"time:9.88s, loops:161, build_hash_table:{total:288.1ms, fetch:287.6ms, build:477µs}, probe:{concurrency:5, total:49.3s, max:9.88s, probe:5.84s, fetch:43.5s}","Disk":0,"Memory":26400,"Plans":[{"Node Id":"HashJoin","Plan Rows":2.5,"Actual Rows":2003,"Task":"root","Total Time":287955809,"Max Time":287955809,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.supplier.s_nationkey)]","Execution Info":"time:288ms, loops:7, build_hash_table:{total:106.9ms, fetch:106.9ms, build:7.18µs}, probe:{concurrency:5, total:1.44s, max:287.6ms, probe:3.17ms, fetch:1.43s}","Disk":0,"Memory":372,"Plans":[{"Node Id":"HashJoin","Plan Rows":0.00625,"Actual Rows":5,"Task":"root","Total Time":106832981,"Max Time":106832981,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.region.r_regionkey, new0107.nation.n_regionkey)]","Execution Info":"time:106.8ms, loops:2, build_hash_table:{total:106.6ms, fetch:106.6ms, build:6.78µs}, probe:{concurrency:5, total:533.2ms, max:106.7ms, probe:20.5µs, fetch:533.2ms}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":0.005,"Actual Rows":1,"Task":"root","Total Time":106566594,"Max Time":106566594,"Access Object":"","Operation Info":"data:Selection_117","Execution Info":"time:106.6ms, loops:2, cop_task: {num: 1, max: 107.3ms, proc_keys: 5, rpc_num: 1, rpc_time: 107.3ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":246,"Plans":[{"Node Id":"Selection","Plan Rows":0.005,"Actual Rows":1,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"eq(new0107.region.r_name, \"ASIA\")","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 5, total_process_keys_size: 559, total_keys: 6, rocksdb: {delete_skipped_count: 0, key_skipped_count: 5, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":5,"Actual Rows":5,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:region, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":25,"Actual Rows":25,"Task":"root","Total Time":101412129,"Max Time":101412129,"Access Object":"","Operation Info":"data:TableFullScan_114","Execution Info":"time:101.4ms, loops:2, cop_task: {num: 1, max: 101.3ms, proc_keys: 25, rpc_num: 1, rpc_time: 101.3ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":613,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:nation, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":10000,"Actual Rows":10000,"Task":"root","Total Time":285266030,"Max Time":285266030,"Access Object":"","Operation Info":"data:TableFullScan_119","Execution Info":"time:285.3ms, loops:11, cop_task: {num: 1, max: 285.7ms, proc_keys: 0, rpc_num: 1, rpc_time: 285.7ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":160504,"Plans":[{"Node Id":"TableFullScan","Plan Rows":10000,"Actual Rows":10000,"Task":"cop[tikv]","Total Time":11000000,"Max Time":11000000,"Access Object":"","Operation Info":"table:supplier, keep order:false","Execution Info":"tikv_task:{time:11ms, loops:14}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":800000,"Actual Rows":800000,"Task":"root","Total Time":8201857870,"Max Time":8201857870,"Access Object":"","Operation Info":"data:TableFullScan_121","Execution Info":"time:8.2s, loops:783, cop_task: {num: 2, max: 8.48s, min: 6.94s, avg: 7.71s, p95: 8.48s, max_proc_keys: 529029, p95_proc_keys: 529029, tot_proc: 13.8s, tot_wait: 177ms, rpc_num: 2, rpc_time: 15.4s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":44825523,"Plans":[{"Node Id":"TableFullScan","Plan Rows":800000,"Actual Rows":800000,"Task":"cop[tikv]","Total Time":761000000,"Max Time":435000000,"Access Object":"","Operation Info":"table:partsupp, keep order:false","Execution Info":"tikv_task:{proc max:435ms, min:326ms, p80:435ms, p95:435ms, iters:790, tasks:2}, scan_detail: {total_process_keys: 800000, total_process_keys_size: 150608990, total_keys: 800002, rocksdb: {delete_skipped_count: 0, key_skipped_count: 800000, block: {cache_hit_count: 2473, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  s_acctbal,  s_name,  n_name,  p_partkey,  p_mfgr,  s_address,  s_phone,  s_comment from  part,  supplier,  partsupp,  nation,  region where  p_partkey = ps_partkey  and s_suppkey = ps_suppkey  and p_size = 30  and p_type like '%STEEL'  and s_nationkey = n_nationkey  and n_regionkey = r_regionkey  and r_name = 'ASIA'  and ps_supplycost = (   select    min(ps_supplycost)   from    partsupp,    supplier,    nation,    region   where    p_partkey = ps_partkey    and s_suppkey = ps_suppkey    and s_nationkey = n_nationkey    and n_regionkey = r_regionkey    and r_name = 'ASIA'  ) order by  s_acctbal desc,  n_name,  s_name,  p_partkey limit 100;

{"Node Id":"Sort","Plan Rows":16.36749284092031,"Actual Rows":4,"Task":"root","Total Time":16814983197,"Max Time":16814983197,"Access Object":"","Operation Info":"new0107.nation.n_name, new0107.nation.n_name, Column#50","Execution Info":"time:16.8s, loops:2","Disk":0,"Memory":6112,"Plans":[{"Node Id":"Projection","Plan Rows":16.36749284092031,"Actual Rows":4,"Task":"root","Total Time":16814923588,"Max Time":16814923588,"Access Object":"","Operation Info":"new0107.nation.n_name, new0107.nation.n_name, Column#50, Column#52","Execution Info":"time:16.8s, loops:3, Concurrency:OFF","Disk":0,"Memory":3056,"Plans":[{"Node Id":"HashAgg","Plan Rows":16.36749284092031,"Actual Rows":4,"Task":"root","Total Time":16814905840,"Max Time":16814905840,"Access Object":"","Operation Info":"group by:Column#59, Column#60, Column#61, funcs:sum(Column#55)-\u003eColumn#52, funcs:firstrow(Column#56)-\u003enew0107.nation.n_name, funcs:firstrow(Column#57)-\u003enew0107.nation.n_name, funcs:firstrow(Column#58)-\u003eColumn#50","Execution Info":"time:16.8s, loops:3, partial_worker:{wall_time:16.814847299s, concurrency:5, task_num:6, tot_wait:1m23.616455111s, tot_exec:142.017831ms, tot_time:1m23.758512668s, max:16.813077712s, p95:16.813077712s}, final_worker:{wall_time:0s, concurrency:5, task_num:10, tot_wait:1m24.065550026s, tot_exec:98.667µs, tot_time:1m24.065654597s, max:16.813157585s, p95:16.813157585s}","Disk":0,"Memory":681370,"Plans":[{"Node Id":"Projection","Plan Rows":16.36749284092031,"Actual Rows":3908,"Task":"root","Total Time":16736533051,"Max Time":16736533051,"Access Object":"","Operation Info":"mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount))-\u003eColumn#55, new0107.nation.n_name, new0107.nation.n_name, extract(YEAR, new0107.lineitem.l_shipdate)-\u003eColumn#58, new0107.nation.n_name, new0107.nation.n_name, extract(YEAR, new0107.lineitem.l_shipdate)-\u003eColumn#61","Execution Info":"time:16.7s, loops:7, Concurrency:OFF","Disk":0,"Memory":206592,"Plans":[{"Node Id":"Projection","Plan Rows":16.36749284092031,"Actual Rows":3908,"Task":"root","Total Time":16735499950,"Max Time":16735499950,"Access Object":"","Operation Info":"new0107.lineitem.l_extendedprice, new0107.lineitem.l_discount, new0107.lineitem.l_shipdate, new0107.nation.n_name, new0107.nation.n_name","Execution Info":"time:16.7s, loops:7, Concurrency:OFF","Disk":0,"Memory":456948,"Plans":[{"Node Id":"HashJoin","Plan Rows":16.36749284092031,"Actual Rows":3908,"Task":"root","Total Time":16735273842,"Max Time":16735273842,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.customer.c_nationkey, new0107.nation.n_nationkey)], other cond:or(and(eq(new0107.nation.n_name, \"JAPAN\"), eq(new0107.nation.n_name, \"INDIA\")), and(eq(new0107.nation.n_name, \"INDIA\"), eq(new0107.nation.n_name, \"JAPAN\")))","Execution Info":"time:16.7s, loops:7, build_hash_table:{total:58ms, fetch:57.9ms, build:23.9µs}, probe:{concurrency:5, total:1m23.5s, max:16.7s, probe:381.9ms, fetch:1m23.1s}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"IndexJoin","Plan Rows":8183.746420460154,"Actual Rows":96460,"Task":"root","Total Time":16551428089,"Max Time":16551428089,"Access Object":"","Operation Info":"inner join, inner:TableReader_42, outer key:new0107.orders.o_custkey, inner key:new0107.customer.c_custkey, equal cond:eq(new0107.orders.o_custkey, new0107.customer.c_custkey)","Execution Info":"time:16.6s, loops:96, inner:{total:8.79s, concurrency:5, task:12, construct:842.5ms, fetch:7.79s, build:162.1ms}, probe:632.8ms","Disk":0,"Memory":21389274,"Plans":[{"Node Id":"IndexJoin","Plan Rows":8160.177230769229,"Actual Rows":96460,"Task":"root","Total Time":14414758851,"Max Time":14414758851,"Access Object":"","Operation Info":"inner join, inner:TableReader_54, outer key:new0107.lineitem.l_orderkey, inner key:new0107.orders.o_orderkey, equal cond:eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)","Execution Info":"time:14.4s, loops:100, inner:{total:19.1s, concurrency:5, task:12, construct:1.85s, fetch:17.1s, build:169.5ms}, probe:527.7ms","Disk":0,"Memory":21484640,"Plans":[{"Node Id":"HashJoin","Plan Rows":8019.968,"Actual Rows":96560,"Task":"root","Total Time":10275715424,"Max Time":10275715424,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.supplier.s_suppkey, new0107.lineitem.l_suppkey)]","Execution Info":"time:10.3s, loops:100, build_hash_table:{total:9.65s, fetch:9.65s, build:487.2µs}, probe:{concurrency:5, total:1m2.8s, max:12.6s, probe:13.3s, fetch:49.5s}","Disk":0,"Memory":24120,"Plans":[{"Node Id":"HashJoin","Plan Rows":20,"Actual Rows":792,"Task":"root","Total Time":9652807213,"Max Time":9652807213,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.supplier.s_nationkey)]","Execution Info":"time:9.65s, loops:6, build_hash_table:{total:222.8µs, fetch:215.9µs, build:6.9µs}, probe:{concurrency:5, total:48.1s, max:9.65s, probe:2.24ms, fetch:48.1s}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":0.05,"Actual Rows":2,"Task":"root","Total Time":79053,"Max Time":79053,"Access Object":"","Operation Info":"data:Selection_82","Execution Info":"time:79.1µs, loops:2, cop_task: {num: 1, max: 7.53ms, proc_keys: 25, rpc_num: 1, rpc_time: 4.43ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":264,"Plans":[{"Node Id":"Selection","Plan Rows":0.05,"Actual Rows":2,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"or(eq(new0107.nation.n_name, \"JAPAN\"), eq(new0107.nation.n_name, \"INDIA\"))","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:n1, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":10000,"Actual Rows":10000,"Task":"root","Total Time":9544122538,"Max Time":9544122538,"Access Object":"","Operation Info":"data:TableFullScan_79","Execution Info":"time:9.54s, loops:11, cop_task: {num: 1, max: 9.42s, proc_keys: 10000, tot_proc: 8.97s, tot_wait: 16ms, rpc_num: 1, rpc_time: 9.41s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":160537,"Plans":[{"Node Id":"TableFullScan","Plan Rows":10000,"Actual Rows":10000,"Task":"cop[tikv]","Total Time":7000000,"Max Time":7000000,"Access Object":"","Operation Info":"table:supplier, keep order:false","Execution Info":"tikv_task:{time:7ms, loops:14}, scan_detail: {total_process_keys: 10000, total_process_keys_size: 1815466, total_keys: 10001, rocksdb: {delete_skipped_count: 0, key_skipped_count: 10000, block: {cache_hit_count: 33, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":100249.6,"Actual Rows":1222829,"Task":"root","Total Time":4741468233,"Max Time":4741468233,"Access Object":"","Operation Info":"data:Selection_85","Execution Info":"time:4.74s, loops:1192, cop_task: {num: 9, max: 10.3s, min: 4.58s, avg: 7.83s, p95: 10.3s, max_proc_keys: 512775, p95_proc_keys: 512775, tot_proc: 1m7s, tot_wait: 421ms, rpc_num: 9, rpc_time: 1m10.5s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":119287678,"Plans":[{"Node Id":"Selection","Plan Rows":100249.6,"Actual Rows":1222829,"Task":"cop[tikv]","Total Time":4382000000,"Max Time":636000000,"Access Object":"","Operation Info":"ge(new0107.lineitem.l_shipdate, 1995-01-01 00:00:00.000000), le(new0107.lineitem.l_shipdate, 1996-12-31 00:00:00.000000)","Execution Info":"tikv_task:{proc max:636ms, min:245ms, p80:516ms, p95:636ms, iters:3959, tasks:9}, scan_detail: {total_process_keys: 4009984, total_process_keys_size: 787655655, total_keys: 4009993, rocksdb: {delete_skipped_count: 0, key_skipped_count: 4009984, block: {cache_hit_count: 12898, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4113000000,"Max Time":602000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:602ms, min:226ms, p80:488ms, p95:602ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"TableReader","Plan Rows":1,"Actual Rows":83418,"Task":"root","Total Time":16542159201,"Max Time":2349316216,"Access Object":"","Operation Info":"data:TableRangeScan_53","Execution Info":"time:16.5s, loops:99, cop_task: {num: 16, max: 2.29s, min: 235.4ms, avg: 1.06s, p95: 2.29s, max_proc_keys: 20732, p95_proc_keys: 20732, tot_proc: 8.23s, tot_wait: 1.35s, rpc_num: 31, rpc_time: 32.1s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":83418,"Task":"cop[tikv]","Total Time":987000000,"Max Time":246000000,"Access Object":"","Operation Info":"table:orders, range: decided by [new0107.lineitem.l_orderkey], keep order:false","Execution Info":"tikv_task:{proc max:246ms, min:9ms, p80:101ms, p95:246ms, iters:152, tasks:16}, scan_detail: {total_process_keys: 83418, total_process_keys_size: 12639547, total_keys: 89072, rocksdb: {delete_skipped_count: 0, key_skipped_count: 11561, block: {cache_hit_count: 108473, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":1,"Actual Rows":76351,"Task":"root","Total Time":7543855284,"Max Time":1764197762,"Access Object":"","Operation Info":"data:TableRangeScan_41","Execution Info":"time:7.54s, loops:94, cop_task: {num: 12, max: 1.68s, min: 73ms, avg: 552.8ms, p95: 1.68s, max_proc_keys: 19665, p95_proc_keys: 19665, tot_proc: 4.11s, tot_wait: 1.16s, rpc_num: 23, rpc_time: 13.2s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":76351,"Task":"cop[tikv]","Total Time":1032000000,"Max Time":278000000,"Access Object":"","Operation Info":"table:customer, range: decided by [new0107.orders.o_custkey], keep order:false","Execution Info":"tikv_task:{proc max:278ms, min:1ms, p80:195ms, p95:278ms, iters:122, tasks:12}, scan_detail: {total_process_keys: 76351, total_process_keys_size: 15533771, total_keys: 81454, rocksdb: {delete_skipped_count: 0, key_skipped_count: 10206, block: {cache_hit_count: 92713, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":0.05,"Actual Rows":2,"Task":"root","Total Time":57824307,"Max Time":57824307,"Access Object":"","Operation Info":"data:Selection_92","Execution Info":"time:57.8ms, loops:2, cop_task: {num: 1, max: 61.6ms, proc_keys: 25, rpc_num: 1, rpc_time: 61.6ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":268,"Plans":[{"Node Id":"Selection","Plan Rows":0.05,"Actual Rows":2,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"or(eq(new0107.nation.n_name, \"INDIA\"), eq(new0107.nation.n_name, \"JAPAN\"))","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:n2, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  supp_nation,  cust_nation,  l_year,  sum(volume) as revenue from  (   select    n1.n_name as supp_nation,    n2.n_name as cust_nation,    extract(year from l_shipdate) as l_year,    l_extendedprice * (1 - l_discount) as volume   from    supplier,    lineitem,    orders,    customer,    nation n1,    nation n2   where    s_suppkey = l_suppkey    and o_orderkey = l_orderkey    and c_custkey = o_custkey    and s_nationkey = n1.n_nationkey    and c_nationkey = n2.n_nationkey    and (     (n1.n_name = 'JAPAN' and n2.n_name = 'INDIA')     or (n1.n_name = 'INDIA' and n2.n_name = 'JAPAN')    )    and l_shipdate between '1995-01-01' and '1996-12-31'  ) as shipping group by  supp_nation,  cust_nation,  l_year order by  supp_nation,  cust_nation,  l_year;

{"Node Id":"Sort","Plan Rows":149568,"Actual Rows":33,"Task":"root","Total Time":4863961117,"Max Time":4863961117,"Access Object":"","Operation Info":"Column#19:desc, Column#18:desc","Execution Info":"time:4.86s, loops:2","Disk":0,"Memory":3720,"Plans":[{"Node Id":"Projection","Plan Rows":149568,"Actual Rows":33,"Task":"root","Total Time":4863899318,"Max Time":4863899318,"Access Object":"","Operation Info":"Column#18, Column#19","Execution Info":"time:4.86s, loops:6, Concurrency:5","Disk":0,"Memory":7440,"Plans":[{"Node Id":"HashAgg","Plan Rows":149568,"Actual Rows":33,"Task":"root","Total Time":4847343462,"Max Time":4847343462,"Access Object":"","Operation Info":"group by:Column#18, funcs:count(1)-\u003eColumn#19, funcs:firstrow(Column#18)-\u003eColumn#18","Execution Info":"time:4.85s, loops:6, partial_worker:{wall_time:4.847277522s, concurrency:5, task_num:150, tot_wait:24.183361647s, tot_exec:39.165227ms, tot_time:24.222638025s, max:4.844564734s, p95:4.844564734s}, final_worker:{wall_time:4.847489125s, concurrency:5, task_num:25, tot_wait:24.223397459s, tot_exec:181.755µs, tot_time:24.223586955s, max:4.84473687s, p95:4.84473687s}","Disk":0,"Memory":229472,"Plans":[{"Node Id":"HashAgg","Plan Rows":149568,"Actual Rows":150000,"Task":"root","Total Time":4844212951,"Max Time":4844212951,"Access Object":"","Operation Info":"group by:new0107.customer.c_custkey, funcs:count(new0107.orders.o_orderkey)-\u003eColumn#18","Execution Info":"time:4.84s, loops:151, partial_worker:{wall_time:4.187369583s, concurrency:5, task_num:1022, tot_wait:16.702908338s, tot_exec:2.197084576s, tot_time:19.971261732s, max:4.10432483s, p95:4.10432483s}, final_worker:{wall_time:4.844406545s, concurrency:5, task_num:25, tot_wait:19.295107931s, tot_exec:4.141918266s, tot_time:23.437051922s, max:4.807571754s, p95:4.807571754s}","Disk":0,"Memory":59678350,"Plans":[{"Node Id":"HashJoin","Plan Rows":878254.1720154043,"Actual Rows":1040728,"Task":"root","Total Time":3679090733,"Max Time":3679090733,"Access Object":"","Operation Info":"left outer join, equal:[eq(new0107.customer.c_custkey, new0107.orders.o_custkey)]","Execution Info":"time:3.68s, loops:1023, build_hash_table:{total:1.35s, fetch:240.3ms, build:1.1s}, probe:{concurrency:5, total:17.3s, max:3.53s, probe:8.06s, fetch:9.28s}","Disk":0,"Memory":1262960,"Plans":[{"Node Id":"TableReader","Plan Rows":150000,"Actual Rows":150000,"Task":"root","Total Time":112394321,"Max Time":112394321,"Access Object":"","Operation Info":"data:TableFullScan_17","Execution Info":"time:112.4ms, loops:148, cop_task: {num: 1, max: 75.9ms, proc_keys: 0, rpc_num: 1, rpc_time: 75.8ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":1202298,"Plans":[{"Node Id":"TableFullScan","Plan Rows":150000,"Actual Rows":150000,"Task":"cop[tikv]","Total Time":89000000,"Max Time":89000000,"Access Object":"","Operation Info":"table:customer, keep order:false","Execution Info":"tikv_task:{time:89ms, loops:151}","Disk":0,"Memory":0,"Plans":[]}]},{"Node Id":"TableReader","Plan Rows":875724.8,"Actual Rows":990658,"Task":"root","Total Time":1813358254,"Max Time":1813358254,"Access Object":"","Operation Info":"data:Selection_20","Execution Info":"time:1.81s, loops:980, cop_task: {num: 2, max: 2.13s, min: 1.85s, avg: 1.99s, p95: 2.13s, max_proc_keys: 583494, p95_proc_keys: 583494, tot_proc: 2.09s, tot_wait: 36ms, rpc_num: 2, rpc_time: 3.98s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":71780726,"Plans":[{"Node Id":"Selection","Plan Rows":875724.8,"Actual Rows":990658,"Task":"cop[tikv]","Total Time":1721000000,"Max Time":1066000000,"Access Object":"","Operation Info":"not(like(new0107.orders.o_comment, \"%pending%deposits%\", 92))","Execution Info":"tikv_task:{proc max:1.07s, min:655ms, p80:1.07s, p95:1.07s, iters:987, tasks:2}, scan_detail: {total_process_keys: 1001472, total_process_keys_size: 151717700, total_keys: 1001474, rocksdb: {delete_skipped_count: 0, key_skipped_count: 1001472, block: {cache_hit_count: 2529, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":1062000000,"Max Time":660000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:660ms, min:402ms, p80:660ms, p95:660ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  c_count,  count(*) as custdist from  (   select    c_custkey,    count(o_orderkey) as c_count   from    customer left outer join orders on     c_custkey = o_custkey     and o_comment not like '%pending%deposits%'   group by    c_custkey  ) c_orders group by  c_count order by  custdist desc,  c_count desc;

{"Node Id":"Projection","Plan Rows":640,"Actual Rows":838,"Task":"root","Total Time":3225280574,"Max Time":3225280574,"Access Object":"","Operation Info":"new0107.partsupp.ps_partkey, Column#35","Execution Info":"time:3.23s, loops:2, Concurrency:OFF","Disk":0,"Memory":48256,"Plans":[{"Node Id":"Sort","Plan Rows":640,"Actual Rows":838,"Task":"root","Total Time":3225266935,"Max Time":3225266935,"Access Object":"","Operation Info":"Column#35:desc","Execution Info":"time:3.23s, loops:2","Disk":0,"Memory":48256,"Plans":[{"Node Id":"Selection","Plan Rows":640,"Actual Rows":838,"Task":"root","Total Time":3224505049,"Max Time":3224505049,"Access Object":"","Operation Info":"gt(Column#35, 8147162.905283000000)","Execution Info":"time:3.22s, loops:2","Disk":0,"Memory":50944,"Plans":[{"Node Id":"HashAgg","Plan Rows":800,"Actual Rows":30670,"Task":"root","Total Time":3222278358,"Max Time":3222278358,"Access Object":"","Operation Info":"group by:Column#61, funcs:sum(Column#59)-\u003eColumn#35, funcs:firstrow(Column#60)-\u003enew0107.partsupp.ps_partkey","Execution Info":"time:3.22s, loops:34, partial_worker:{wall_time:3.176126133s, concurrency:5, task_num:35, tot_wait:15.244167251s, tot_exec:36.316426ms, tot_time:15.283939518s, max:3.05901267s, p95:3.05901267s}, final_worker:{wall_time:0s, concurrency:5, task_num:25, tot_wait:15.639130092s, tot_exec:315.343722ms, tot_time:15.954493558s, max:3.222265309s, p95:3.222265309s}","Disk":0,"Memory":9689421,"Plans":[{"Node Id":"Projection","Plan Rows":800,"Actual Rows":32480,"Task":"root","Total Time":3052650136,"Max Time":3052650136,"Access Object":"","Operation Info":"mul(new0107.partsupp.ps_supplycost, cast(new0107.partsupp.ps_availqty, decimal(20,0) BINARY))-\u003eColumn#59, new0107.partsupp.ps_partkey, new0107.partsupp.ps_partkey","Execution Info":"time:3.05s, loops:36, Concurrency:OFF","Disk":0,"Memory":297776,"Plans":[{"Node Id":"HashJoin","Plan Rows":800,"Actual Rows":32480,"Task":"root","Total Time":3047515044,"Max Time":3047515044,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.supplier.s_suppkey, new0107.partsupp.ps_suppkey)]","Execution Info":"time:3.05s, loops:36, build_hash_table:{total:407.9ms, fetch:407.7ms, build:175.6µs}, probe:{concurrency:5, total:15.2s, max:3.05s, probe:531.3ms, fetch:14.7s}","Disk":0,"Memory":4976,"Plans":[{"Node Id":"HashJoin","Plan Rows":10,"Actual Rows":406,"Task":"root","Total Time":407769635,"Max Time":407769635,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.supplier.s_nationkey)]","Execution Info":"time:407.8ms, loops:6, build_hash_table:{total:380.9ms, fetch:380.9ms, build:8.4µs}, probe:{concurrency:5, total:2.02s, max:406.2ms, probe:2.76ms, fetch:2.02s}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":0.025,"Actual Rows":1,"Task":"root","Total Time":380743307,"Max Time":380743307,"Access Object":"","Operation Info":"data:Selection_88","Execution Info":"time:380.7ms, loops:2, cop_task: {num: 1, max: 383.6ms, proc_keys: 25, rpc_num: 1, rpc_time: 383.6ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":254,"Plans":[{"Node Id":"Selection","Plan Rows":0.025,"Actual Rows":1,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"eq(new0107.nation.n_name, \"MOZAMBIQUE\")","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:nation, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":10000,"Actual Rows":10000,"Task":"root","Total Time":403136838,"Max Time":403136838,"Access Object":"","Operation Info":"data:TableFullScan_85","Execution Info":"time:403.1ms, loops:11, cop_task: {num: 1, max: 405.9ms, proc_keys: 0, rpc_num: 1, rpc_time: 405.8ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":160506,"Plans":[{"Node Id":"TableFullScan","Plan Rows":10000,"Actual Rows":10000,"Task":"cop[tikv]","Total Time":7000000,"Max Time":7000000,"Access Object":"","Operation Info":"table:supplier, keep order:false","Execution Info":"tikv_task:{time:7ms, loops:14}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":800000,"Actual Rows":800000,"Task":"root","Total Time":2804238468,"Max Time":2804238468,"Access Object":"","Operation Info":"data:TableFullScan_90","Execution Info":"time:2.8s, loops:783, cop_task: {num: 2, max: 2.89s, min: 2.44s, avg: 2.67s, p95: 2.89s, max_proc_keys: 529029, p95_proc_keys: 529029, tot_proc: 3.7s, tot_wait: 658ms, rpc_num: 2, rpc_time: 5.33s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":51231848,"Plans":[{"Node Id":"TableFullScan","Plan Rows":800000,"Actual Rows":800000,"Task":"cop[tikv]","Total Time":823000000,"Max Time":570000000,"Access Object":"","Operation Info":"table:partsupp, keep order:false","Execution Info":"tikv_task:{proc max:570ms, min:253ms, p80:570ms, p95:570ms, iters:790, tasks:2}, scan_detail: {total_process_keys: 800000, total_process_keys_size: 150608990, total_keys: 800002, rocksdb: {delete_skipped_count: 0, key_skipped_count: 800000, block: {cache_hit_count: 2473, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  ps_partkey,  sum(ps_supplycost * ps_availqty) as value from  partsupp,  supplier,  nation where  ps_suppkey = s_suppkey  and s_nationkey = n_nationkey  and n_name = 'MOZAMBIQUE' group by  ps_partkey having   sum(ps_supplycost * ps_availqty) > (    select     sum(ps_supplycost * ps_availqty) * 0.0001000000    from     partsupp,     supplier,     nation    where     ps_suppkey = s_suppkey     and s_nationkey = n_nationkey     and n_name = 'MOZAMBIQUE'   ) order by  value desc;

{"Node Id":"Sort","Plan Rows":1,"Actual Rows":5,"Task":"root","Total Time":20061802773,"Max Time":20061802773,"Access Object":"","Operation Info":"new0107.orders.o_orderpriority","Execution Info":"time:20.1s, loops:2","Disk":0,"Memory":4000,"Plans":[{"Node Id":"Projection","Plan Rows":1,"Actual Rows":5,"Task":"root","Total Time":20061752360,"Max Time":20061752360,"Access Object":"","Operation Info":"new0107.orders.o_orderpriority, Column#27","Execution Info":"time:20.1s, loops:5, Concurrency:OFF","Disk":0,"Memory":1000,"Plans":[{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":5,"Task":"root","Total Time":20061735297,"Max Time":20061735297,"Access Object":"","Operation Info":"group by:new0107.orders.o_orderpriority, funcs:count(1)-\u003eColumn#27, funcs:firstrow(new0107.orders.o_orderpriority)-\u003enew0107.orders.o_orderpriority","Execution Info":"time:20.1s, loops:5, partial_worker:{wall_time:20.033335305s, concurrency:5, task_num:34, tot_wait:1m40.04449639s, tot_exec:9.794082ms, tot_time:1m40.054332246s, max:20.011155318s, p95:20.011155318s}, final_worker:{wall_time:0s, concurrency:5, task_num:20, tot_wait:1m40.273935997s, tot_exec:99.14µs, tot_time:1m40.274043448s, max:20.060242692s, p95:20.060242692s}","Disk":0,"Memory":383027,"Plans":[{"Node Id":"IndexJoin","Plan Rows":21893.120000000003,"Actual Rows":34630,"Task":"root","Total Time":20005856815,"Max Time":20005856815,"Access Object":"","Operation Info":"semi join, inner:IndexLookUp_18, outer key:new0107.orders.o_orderkey, inner key:new0107.lineitem.l_orderkey, equal cond:eq(new0107.orders.o_orderkey, new0107.lineitem.l_orderkey)","Execution Info":"time:20s, loops:35, inner:{total:55.2s, concurrency:5, task:10, construct:962.9ms, fetch:54.2s, build:84.9ms}, probe:342ms","Disk":0,"Memory":10233966,"Plans":[{"Node Id":"TableReader","Plan Rows":27366.4,"Actual Rows":37775,"Task":"root","Total Time":9404635085,"Max Time":9404635085,"Access Object":"","Operation Info":"data:Selection_39","Execution Info":"time:9.4s, loops:42, cop_task: {num: 2, max: 9.49s, min: 4.5s, avg: 7s, p95: 9.49s, max_proc_keys: 583494, p95_proc_keys: 583494, tot_proc: 13.9s, tot_wait: 48ms, rpc_num: 2, rpc_time: 14s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":1261407,"Plans":[{"Node Id":"Selection","Plan Rows":27366.4,"Actual Rows":37775,"Task":"cop[tikv]","Total Time":934000000,"Max Time":559000000,"Access Object":"","Operation Info":"ge(new0107.orders.o_orderdate, 1995-01-01 00:00:00.000000), lt(new0107.orders.o_orderdate, 1995-04-01 00:00:00.000000)","Execution Info":"tikv_task:{proc max:559ms, min:375ms, p80:559ms, p95:559ms, iters:987, tasks:2}, scan_detail: {total_process_keys: 1001472, total_process_keys_size: 151717700, total_keys: 1001474, rocksdb: {delete_skipped_count: 0, key_skipped_count: 1001472, block: {cache_hit_count: 2529, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":871000000,"Max Time":519000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:519ms, min:352ms, p80:519ms, p95:519ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"IndexLookUp","Plan Rows":4.05435485958328,"Actual Rows":95181,"Task":"root","Total Time":53447203342,"Max Time":8537878475,"Access Object":"","Operation Info":"","Execution Info":"time:53.4s, loops:109, index_task: {total_time: 32.6s, fetch_handle: 32.4s, build: 79.1µs, wait: 142ms}, table_task: {total_time: 45.2s, num: 31, concurrency: 50}","Disk":0,"Memory":208480,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":5.0679435744790995,"Actual Rows":150845,"Task":"cop[tikv]","Total Time":1695000000,"Max Time":498000000,"Access Object":"","Operation Info":"table:lineitem, index:PRIMARY(L_ORDERKEY, L_LINENUMBER), range: decided by [eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)], keep order:false","Execution Info":"time:32.3s, loops:173, cop_task: {num: 14, max: 7.14s, min: 46.9ms, avg: 2.44s, p95: 7.14s, max_proc_keys: 33223, p95_proc_keys: 33223, tot_proc: 29.7s, tot_wait: 955ms, rpc_num: 27, rpc_time: 1m8.1s, copr_cache_hit_ratio: 0.00}, tikv_task:{proc max:498ms, min:2ms, p80:212ms, p95:498ms, iters:209, tasks:14}, scan_detail: {total_process_keys: 150845, total_process_keys_size: 7994785, total_keys: 188620, rocksdb: {delete_skipped_count: 0, key_skipped_count: 150845, block: {cache_hit_count: 151233, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]},{"Node Id":"Selection","Plan Rows":4.05435485958328,"Actual Rows":95181,"Task":"cop[tikv]","Total Time":1189000000,"Max Time":111000000,"Access Object":"","Operation Info":"lt(new0107.lineitem.l_commitdate, new0107.lineitem.l_receiptdate)","Execution Info":"time:45s, loops:142, cop_task: {num: 42, max: 6.91s, min: 36.6ms, avg: 1.29s, p95: 4.11s, max_proc_keys: 16008, p95_proc_keys: 9525, tot_proc: 37.6s, tot_wait: 4.53s, rpc_num: 83, rpc_time: 1m48.3s, copr_cache_hit_ratio: 0.00}, tikv_task:{proc max:111ms, min:0s, p80:41ms, p95:82ms, iters:334, tasks:42}, scan_detail: {total_process_keys: 150845, total_process_keys_size: 29631549, total_keys: 182241, rocksdb: {delete_skipped_count: 0, key_skipped_count: 145874, block: {cache_hit_count: 124030, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRowIDScan","Plan Rows":5.0679435744790995,"Actual Rows":150845,"Task":"cop[tikv]","Total Time":1157000000,"Max Time":111000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:111ms, min:0s, p80:41ms, p95:82ms, iters:334, tasks:42}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  o_orderpriority,  count(*) as order_count from  orders where  o_orderdate >= '1995-01-01'  and o_orderdate < date_add('1995-01-01', interval '3' month)  and exists (   select    *   from    lineitem   where    l_orderkey = o_orderkey    and l_commitdate < l_receiptdate  ) group by  o_orderpriority order by  o_orderpriority;

{"Node Id":"Sort","Plan Rows":1,"Actual Rows":2,"Task":"root","Total Time":2527080115,"Max Time":2527080115,"Access Object":"","Operation Info":"new0107.lineitem.l_shipmode","Execution Info":"time:2.53s, loops:2","Disk":0,"Memory":6968,"Plans":[{"Node Id":"Projection","Plan Rows":1,"Actual Rows":2,"Task":"root","Total Time":2527033007,"Max Time":2527033007,"Access Object":"","Operation Info":"new0107.lineitem.l_shipmode, Column#27, Column#28","Execution Info":"time:2.53s, loops:3, Concurrency:OFF","Disk":0,"Memory":3484,"Plans":[{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":2,"Task":"root","Total Time":2527026846,"Max Time":2527026846,"Access Object":"","Operation Info":"group by:Column#40, funcs:sum(Column#37)-\u003eColumn#27, funcs:sum(Column#38)-\u003eColumn#28, funcs:firstrow(Column#39)-\u003enew0107.lineitem.l_shipmode","Execution Info":"time:2.53s, loops:3, partial_worker:{wall_time:2.526982789s, concurrency:5, task_num:24, tot_wait:12.611870386s, tot_exec:15.389078ms, tot_time:12.627287858s, max:2.525474936s, p95:2.525474936s}, final_worker:{wall_time:2.527468694s, concurrency:5, task_num:10, tot_wait:12.627675734s, tot_exec:72.552µs, tot_time:12.627752515s, max:2.525565453s, p95:2.525565453s}","Disk":0,"Memory":1181040,"Plans":[{"Node Id":"Projection","Plan Rows":137139.56931393046,"Actual Rows":20757,"Task":"root","Total Time":2525191921,"Max Time":2525191921,"Access Object":"","Operation Info":"cast(case(or(eq(new0107.orders.o_orderpriority, 1-URGENT), eq(new0107.orders.o_orderpriority, 2-HIGH)), 1, 0), decimal(20,0) BINARY)-\u003eColumn#37, cast(case(and(ne(new0107.orders.o_orderpriority, 1-URGENT), ne(new0107.orders.o_orderpriority, 2-HIGH)), 1, 0), decimal(20,0) BINARY)-\u003eColumn#38, new0107.lineitem.l_shipmode, new0107.lineitem.l_shipmode","Execution Info":"time:2.53s, loops:25, Concurrency:5","Disk":0,"Memory":283396,"Plans":[{"Node Id":"Projection","Plan Rows":137139.56931393046,"Actual Rows":20757,"Task":"root","Total Time":2524608926,"Max Time":2524608926,"Access Object":"","Operation Info":"new0107.orders.o_orderpriority, new0107.lineitem.l_shipmode","Execution Info":"time:2.52s, loops:25, Concurrency:5","Disk":0,"Memory":111872,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":137139.56931393046,"Actual Rows":20757,"Task":"root","Total Time":2524375510,"Max Time":2524375510,"Access Object":"","Operation Info":"inner join, inner:TableReader_17, outer key:new0107.lineitem.l_orderkey, inner key:new0107.orders.o_orderkey, equal cond:eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)","Execution Info":"time:2.52s, loops:25, inner:{total:10.9s, concurrency:5, task:9, construct:78.2ms, fetch:10.3s, build:3.66ms, join:560.2ms}","Disk":0,"Memory":3872758,"Plans":[{"Node Id":"TableReader","Plan Rows":134783.21932571862,"Actual Rows":20773,"Task":"root","Total Time":484262502,"Max Time":484262502,"Access Object":"","Operation Info":"data:Selection_49","Execution Info":"time:484.3ms, loops:26, cop_task: {num: 9, max: 468.9ms, min: 15.7ms, avg: 164.3ms, p95: 468.9ms, rpc_num: 9, rpc_time: 1.48s, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":387611,"Plans":[{"Node Id":"Selection","Plan Rows":134783.21932571862,"Actual Rows":20773,"Task":"cop[tikv]","Total Time":4954000000,"Max Time":647000000,"Access Object":"","Operation Info":"ge(new0107.lineitem.l_receiptdate, 1997-01-01 00:00:00.000000), in(new0107.lineitem.l_shipmode, \"RAIL\", \"FOB\"), lt(new0107.lineitem.l_commitdate, new0107.lineitem.l_receiptdate), lt(new0107.lineitem.l_receiptdate, 1998-01-01 00:00:00.000000), lt(new0107.lineitem.l_shipdate, new0107.lineitem.l_commitdate)","Execution Info":"tikv_task:{proc max:647ms, min:292ms, p80:636ms, p95:647ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4041000000,"Max Time":548000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:548ms, min:233ms, p80:537ms, p95:548ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":1,"Actual Rows":19515,"Task":"root","Total Time":10157189085,"Max Time":2013014420,"Access Object":"","Operation Info":"data:TableRangeScan_16","Execution Info":"time:10.2s, loops:33, cop_task: {num: 13, max: 1.95s, min: 53ms, avg: 966.9ms, p95: 1.95s, max_proc_keys: 4735, p95_proc_keys: 4735, tot_proc: 10.3s, tot_wait: 547ms, rpc_num: 25, rpc_time: 25.1s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":19515,"Task":"cop[tikv]","Total Time":205000000,"Max Time":49000000,"Access Object":"","Operation Info":"table:orders, range: decided by [new0107.lineitem.l_orderkey], keep order:false","Execution Info":"tikv_task:{proc max:49ms, min:0s, p80:23ms, p95:49ms, iters:70, tasks:13}, scan_detail: {total_process_keys: 19515, total_process_keys_size: 2958195, total_keys: 19858, rocksdb: {delete_skipped_count: 0, key_skipped_count: 665, block: {cache_hit_count: 25714, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  l_shipmode,  sum(case   when o_orderpriority = '1-URGENT'    or o_orderpriority = '2-HIGH'    then 1   else 0  end) as high_line_count,  sum(case   when o_orderpriority <> '1-URGENT'    and o_orderpriority <> '2-HIGH'    then 1   else 0  end) as low_line_count from  orders,  lineitem where  o_orderkey = l_orderkey  and l_shipmode in ('RAIL', 'FOB')  and l_commitdate < l_receiptdate  and l_shipdate < l_commitdate  and l_receiptdate >= '1997-01-01'  and l_receiptdate < date_add('1997-01-01', interval '1' year) group by  l_shipmode order by  l_shipmode;

{"Node Id":"Sort","Plan Rows":16.367492840920313,"Actual Rows":4,"Task":"root","Total Time":16319235373,"Max Time":16319235373,"Access Object":"","Operation Info":"new0107.nation.n_name, new0107.nation.n_name, Column#50","Execution Info":"time:16.3s, loops:2","Disk":0,"Memory":6112,"Plans":[{"Node Id":"Projection","Plan Rows":16.367492840920313,"Actual Rows":4,"Task":"root","Total Time":16319197501,"Max Time":16319197501,"Access Object":"","Operation Info":"new0107.nation.n_name, new0107.nation.n_name, Column#50, Column#52","Execution Info":"time:16.3s, loops:3, Concurrency:OFF","Disk":0,"Memory":3056,"Plans":[{"Node Id":"HashAgg","Plan Rows":16.367492840920313,"Actual Rows":4,"Task":"root","Total Time":16319193145,"Max Time":16319193145,"Access Object":"","Operation Info":"group by:Column#59, Column#60, Column#61, funcs:sum(Column#55)-\u003eColumn#52, funcs:firstrow(Column#56)-\u003enew0107.nation.n_name, funcs:firstrow(Column#57)-\u003enew0107.nation.n_name, funcs:firstrow(Column#58)-\u003eColumn#50","Execution Info":"time:16.3s, loops:3, partial_worker:{wall_time:16.319157793s, concurrency:5, task_num:6, tot_wait:1m21.59237011s, tot_exec:1.61113ms, tot_time:1m21.59399958s, max:16.318810397s, p95:16.318810397s}, final_worker:{wall_time:0s, concurrency:5, task_num:10, tot_wait:1m21.594328697s, tot_exec:71.276µs, tot_time:1m21.594404176s, max:16.318895257s, p95:16.318895257s}","Disk":0,"Memory":679296,"Plans":[{"Node Id":"Projection","Plan Rows":16.367492840920313,"Actual Rows":3908,"Task":"root","Total Time":16318611866,"Max Time":16318611866,"Access Object":"","Operation Info":"mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount))-\u003eColumn#55, new0107.nation.n_name, new0107.nation.n_name, extract(YEAR, new0107.lineitem.l_shipdate)-\u003eColumn#58, new0107.nation.n_name, new0107.nation.n_name, extract(YEAR, new0107.lineitem.l_shipdate)-\u003eColumn#61","Execution Info":"time:16.3s, loops:7, Concurrency:OFF","Disk":0,"Memory":255776,"Plans":[{"Node Id":"Projection","Plan Rows":16.367492840920313,"Actual Rows":3908,"Task":"root","Total Time":16317432455,"Max Time":16317432455,"Access Object":"","Operation Info":"new0107.lineitem.l_extendedprice, new0107.lineitem.l_discount, new0107.lineitem.l_shipdate, new0107.nation.n_name, new0107.nation.n_name","Execution Info":"time:16.3s, loops:7, Concurrency:OFF","Disk":0,"Memory":477276,"Plans":[{"Node Id":"HashJoin","Plan Rows":16.367492840920313,"Actual Rows":3908,"Task":"root","Total Time":16317308697,"Max Time":16317308697,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.customer.c_nationkey, new0107.nation.n_nationkey)], other cond:or(and(eq(new0107.nation.n_name, \"JAPAN\"), eq(new0107.nation.n_name, \"INDIA\")), and(eq(new0107.nation.n_name, \"INDIA\"), eq(new0107.nation.n_name, \"JAPAN\")))","Execution Info":"time:16.3s, loops:7, build_hash_table:{total:39.7ms, fetch:39.7ms, build:8.3µs}, probe:{concurrency:5, total:1m21.6s, max:16.3s, probe:900.1ms, fetch:1m20.7s}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"IndexJoin","Plan Rows":8183.746420460156,"Actual Rows":96460,"Task":"root","Total Time":16114302429,"Max Time":16114302429,"Access Object":"","Operation Info":"inner join, inner:TableReader_42, outer key:new0107.orders.o_custkey, inner key:new0107.customer.c_custkey, equal cond:eq(new0107.orders.o_custkey, new0107.customer.c_custkey)","Execution Info":"time:16.1s, loops:96, inner:{total:17.2s, concurrency:5, task:12, construct:1.36s, fetch:15.3s, build:600.5ms}, probe:1.21s","Disk":0,"Memory":21389466,"Plans":[{"Node Id":"IndexJoin","Plan Rows":8160.177230769231,"Actual Rows":96460,"Task":"root","Total Time":11054800082,"Max Time":11054800082,"Access Object":"","Operation Info":"inner join, inner:TableReader_54, outer key:new0107.lineitem.l_orderkey, inner key:new0107.orders.o_orderkey, equal cond:eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)","Execution Info":"time:11.1s, loops:100, inner:{total:13.2s, concurrency:5, task:12, construct:1.91s, fetch:10.9s, build:388ms}, probe:376.3ms","Disk":0,"Memory":21489904,"Plans":[{"Node Id":"HashJoin","Plan Rows":8019.968000000001,"Actual Rows":96560,"Task":"root","Total Time":8311751037,"Max Time":8311751037,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.supplier.s_suppkey, new0107.lineitem.l_suppkey)]","Execution Info":"time:8.31s, loops:100, build_hash_table:{total:38.4ms, fetch:38.2ms, build:210.1µs}, probe:{concurrency:5, total:47.1s, max:9.54s, probe:9.14s, fetch:37.9s}","Disk":0,"Memory":25624,"Plans":[{"Node Id":"HashJoin","Plan Rows":20,"Actual Rows":792,"Task":"root","Total Time":38265835,"Max Time":38265835,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.supplier.s_nationkey)]","Execution Info":"time:38.3ms, loops:6, build_hash_table:{total:37.2ms, fetch:37.1ms, build:19.8µs}, probe:{concurrency:5, total:189ms, max:38ms, probe:1.34ms, fetch:187.6ms}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":0.05,"Actual Rows":2,"Task":"root","Total Time":37100133,"Max Time":37100133,"Access Object":"","Operation Info":"data:Selection_82","Execution Info":"time:37.1ms, loops:2, cop_task: {num: 1, max: 38ms, proc_keys: 25, tot_proc: 1ms, tot_wait: 36ms, rpc_num: 1, rpc_time: 37.9ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":280,"Plans":[{"Node Id":"Selection","Plan Rows":0.05,"Actual Rows":2,"Task":"cop[tikv]","Total Time":1000000,"Max Time":1000000,"Access Object":"","Operation Info":"or(eq(new0107.nation.n_name, \"JAPAN\"), eq(new0107.nation.n_name, \"INDIA\"))","Execution Info":"tikv_task:{time:1ms, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":1000000,"Max Time":1000000,"Access Object":"","Operation Info":"table:n1, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:1ms, loops:1}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":10000,"Actual Rows":10000,"Task":"root","Total Time":37141775,"Max Time":37141775,"Access Object":"","Operation Info":"data:TableFullScan_79","Execution Info":"time:37.1ms, loops:11, cop_task: {num: 1, max: 37.5ms, proc_keys: 0, rpc_num: 1, rpc_time: 37.4ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":160504,"Plans":[{"Node Id":"TableFullScan","Plan Rows":10000,"Actual Rows":10000,"Task":"cop[tikv]","Total Time":11000000,"Max Time":11000000,"Access Object":"","Operation Info":"table:supplier, keep order:false","Execution Info":"tikv_task:{time:11ms, loops:14}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":1232756.2658436215,"Actual Rows":1222829,"Task":"root","Total Time":7445119249,"Max Time":7445119249,"Access Object":"","Operation Info":"data:Selection_85","Execution Info":"time:7.45s, loops:1192, cop_task: {num: 9, max: 9.18s, min: 6.5s, avg: 7.69s, p95: 9.18s, max_proc_keys: 512775, p95_proc_keys: 512775, tot_proc: 1m3.7s, tot_wait: 378ms, rpc_num: 9, rpc_time: 1m9.2s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":68564180,"Plans":[{"Node Id":"Selection","Plan Rows":1232756.2658436215,"Actual Rows":1222829,"Task":"cop[tikv]","Total Time":4425000000,"Max Time":627000000,"Access Object":"","Operation Info":"ge(new0107.lineitem.l_shipdate, 1995-01-01 00:00:00.000000), le(new0107.lineitem.l_shipdate, 1996-12-31 00:00:00.000000)","Execution Info":"tikv_task:{proc max:627ms, min:366ms, p80:526ms, p95:627ms, iters:3959, tasks:9}, scan_detail: {total_process_keys: 4009984, total_process_keys_size: 787655655, total_keys: 4009993, rocksdb: {delete_skipped_count: 0, key_skipped_count: 4009984, block: {cache_hit_count: 12898, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4207000000,"Max Time":584000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:584ms, min:363ms, p80:490ms, p95:584ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"TableReader","Plan Rows":1,"Actual Rows":83421,"Task":"root","Total Time":10480405146,"Max Time":1723805491,"Access Object":"","Operation Info":"data:TableRangeScan_53","Execution Info":"time:10.5s, loops:99, cop_task: {num: 17, max: 1.71s, min: 111.8ms, avg: 781.5ms, p95: 1.71s, max_proc_keys: 14185, p95_proc_keys: 14185, tot_proc: 5.55s, tot_wait: 3.66s, rpc_num: 33, rpc_time: 26.2s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":83421,"Task":"cop[tikv]","Total Time":975000000,"Max Time":191000000,"Access Object":"","Operation Info":"table:orders, range: decided by [new0107.lineitem.l_orderkey], keep order:false","Execution Info":"tikv_task:{proc max:191ms, min:7ms, p80:121ms, p95:191ms, iters:156, tasks:17}, scan_detail: {total_process_keys: 83421, total_process_keys_size: 12639951, total_keys: 89075, rocksdb: {delete_skipped_count: 0, key_skipped_count: 11561, block: {cache_hit_count: 108509, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":1,"Actual Rows":76397,"Task":"root","Total Time":14279404009,"Max Time":3541784338,"Access Object":"","Operation Info":"data:TableRangeScan_41","Execution Info":"time:14.3s, loops:94, cop_task: {num: 12, max: 3.53s, min: 107.3ms, avg: 1.05s, p95: 3.53s, max_proc_keys: 19634, p95_proc_keys: 19634, tot_proc: 9.62s, tot_wait: 236ms, rpc_num: 23, rpc_time: 25s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":76397,"Task":"cop[tikv]","Total Time":796000000,"Max Time":181000000,"Access Object":"","Operation Info":"table:customer, range: decided by [new0107.orders.o_custkey], keep order:false","Execution Info":"tikv_task:{proc max:181ms, min:1ms, p80:157ms, p95:181ms, iters:122, tasks:12}, scan_detail: {total_process_keys: 76397, total_process_keys_size: 15547335, total_keys: 81501, rocksdb: {delete_skipped_count: 0, key_skipped_count: 10208, block: {cache_hit_count: 92739, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":0.05,"Actual Rows":2,"Task":"root","Total Time":39677269,"Max Time":39677269,"Access Object":"","Operation Info":"data:Selection_92","Execution Info":"time:39.7ms, loops:2, cop_task: {num: 1, max: 39.8ms, proc_keys: 25, rpc_num: 1, rpc_time: 39.8ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":268,"Plans":[{"Node Id":"Selection","Plan Rows":0.05,"Actual Rows":2,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"or(eq(new0107.nation.n_name, \"INDIA\"), eq(new0107.nation.n_name, \"JAPAN\"))","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:n2, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  supp_nation,  cust_nation,  l_year,  sum(volume) as revenue from  (   select    n1.n_name as supp_nation,    n2.n_name as cust_nation,    extract(year from l_shipdate) as l_year,    l_extendedprice * (1 - l_discount) as volume   from    supplier,    lineitem,    orders,    customer,    nation n1,    nation n2   where    s_suppkey = l_suppkey    and o_orderkey = l_orderkey    and c_custkey = o_custkey    and s_nationkey = n1.n_nationkey    and c_nationkey = n2.n_nationkey    and (     (n1.n_name = 'JAPAN' and n2.n_name = 'INDIA')     or (n1.n_name = 'INDIA' and n2.n_name = 'JAPAN')    )    and l_shipdate between '1995-01-01' and '1996-12-31'  ) as shipping group by  supp_nation,  cust_nation,  l_year order by  supp_nation,  cust_nation,  l_year;

{"Node Id":"Projection","Plan Rows":10,"Actual Rows":10,"Task":"root","Total Time":20403224946,"Max Time":20403224946,"Access Object":"","Operation Info":"new0107.lineitem.l_orderkey, Column#35, new0107.orders.o_orderdate, new0107.orders.o_shippriority","Execution Info":"time:20.4s, loops:2, Concurrency:OFF","Disk":0,"Memory":2544,"Plans":[{"Node Id":"TopN","Plan Rows":10,"Actual Rows":10,"Task":"root","Total Time":20403216351,"Max Time":20403216351,"Access Object":"","Operation Info":"Column#35:desc, new0107.orders.o_orderdate, offset:0, count:10","Execution Info":"time:20.4s, loops:2","Disk":0,"Memory":78560,"Plans":[{"Node Id":"HashAgg","Plan Rows":5483.094595319597,"Actual Rows":7662,"Task":"root","Total Time":20395026069,"Max Time":20395026069,"Access Object":"","Operation Info":"group by:Column#48, Column#49, Column#50, funcs:sum(Column#44)-\u003eColumn#35, funcs:firstrow(Column#45)-\u003enew0107.orders.o_orderdate, funcs:firstrow(Column#46)-\u003enew0107.orders.o_shippriority, funcs:firstrow(Column#47)-\u003enew0107.lineitem.l_orderkey","Execution Info":"time:20.4s, loops:11, partial_worker:{wall_time:20.290886625s, concurrency:5, task_num:22, tot_wait:1m41.208806478s, tot_exec:11.945814ms, tot_time:1m41.222001023s, max:20.24570454s, p95:20.24570454s}, final_worker:{wall_time:20.396334364s, concurrency:5, task_num:25, tot_wait:1m41.419342457s, tot_exec:97.264203ms, tot_time:1m41.516620042s, max:20.339820654s, p95:20.339820654s}","Disk":0,"Memory":3404507,"Plans":[{"Node Id":"Projection","Plan Rows":5483.094595319597,"Actual Rows":20167,"Task":"root","Total Time":20241176551,"Max Time":20241176551,"Access Object":"","Operation Info":"mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount))-\u003eColumn#44, new0107.orders.o_orderdate, new0107.orders.o_shippriority, new0107.lineitem.l_orderkey, new0107.lineitem.l_orderkey, new0107.orders.o_orderdate, new0107.orders.o_shippriority","Execution Info":"time:20.2s, loops:23, Concurrency:5","Disk":0,"Memory":570072,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":5483.094595319597,"Actual Rows":20167,"Task":"root","Total Time":20235757252,"Max Time":20235757252,"Access Object":"","Operation Info":"inner join, inner:IndexLookUp_27, outer key:new0107.orders.o_orderkey, inner key:new0107.lineitem.l_orderkey, equal cond:eq(new0107.orders.o_orderkey, new0107.lineitem.l_orderkey)","Execution Info":"time:20.2s, loops:23, inner:{total:1m10.4s, concurrency:5, task:12, construct:2.01s, fetch:1m7.3s, build:328.4ms, join:1.02s}","Disk":0,"Memory":23447038,"Plans":[{"Node Id":"HashJoin","Plan Rows":1352.396320800387,"Actual Rows":96277,"Task":"root","Total Time":7087123437,"Max Time":7087123437,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.customer.c_custkey, new0107.orders.o_custkey)]","Execution Info":"time:7.09s, loops:99, build_hash_table:{total:510ms, fetch:465.3ms, build:44.6ms}, probe:{concurrency:5, total:1m1.5s, max:12.3s, probe:27.4s, fetch:34.1s}","Disk":0,"Memory":977192,"Plans":[{"Node Id":"TableReader","Plan Rows":150,"Actual Rows":29752,"Task":"root","Total Time":460351872,"Max Time":460351872,"Access Object":"","Operation Info":"data:Selection_75","Execution Info":"time:460.4ms, loops:30, cop_task: {num: 1, max: 465.5ms, proc_keys: 150000, tot_proc: 450ms, rpc_num: 1, rpc_time: 465.5ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":778318,"Plans":[{"Node Id":"Selection","Plan Rows":150,"Actual Rows":29752,"Task":"cop[tikv]","Total Time":164000000,"Max Time":164000000,"Access Object":"","Operation Info":"eq(new0107.customer.c_mktsegment, \"AUTOMOBILE\")","Execution Info":"tikv_task:{time:164ms, loops:151}, scan_detail: {total_process_keys: 150000, total_process_keys_size: 30533765, total_keys: 150001, rocksdb: {delete_skipped_count: 0, key_skipped_count: 150000, block: {cache_hit_count: 502, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":150000,"Actual Rows":150000,"Task":"cop[tikv]","Total Time":138000000,"Max Time":138000000,"Access Object":"","Operation Info":"table:customer, keep order:false","Execution Info":"tikv_task:{time:138ms, loops:151}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":363790.6773333333,"Actual Rows":484673,"Task":"root","Total Time":6723409916,"Max Time":6723409916,"Access Object":"","Operation Info":"data:Selection_72","Execution Info":"time:6.72s, loops:473, cop_task: {num: 2, max: 6.63s, min: 5.2s, avg: 5.91s, p95: 6.63s, max_proc_keys: 583494, p95_proc_keys: 583494, tot_proc: 11.7s, tot_wait: 25ms, rpc_num: 2, rpc_time: 11.8s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":15547640,"Plans":[{"Node Id":"Selection","Plan Rows":363790.6773333333,"Actual Rows":484673,"Task":"cop[tikv]","Total Time":937000000,"Max Time":541000000,"Access Object":"","Operation Info":"lt(new0107.orders.o_orderdate, 1995-03-13 00:00:00.000000)","Execution Info":"tikv_task:{proc max:541ms, min:396ms, p80:541ms, p95:541ms, iters:987, tasks:2}, scan_detail: {total_process_keys: 1001472, total_process_keys_size: 151717700, total_keys: 1001474, rocksdb: {delete_skipped_count: 0, key_skipped_count: 1001472, block: {cache_hit_count: 2529, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":885000000,"Max Time":510000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:510ms, min:375ms, p80:510ms, p95:510ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"IndexLookUp","Plan Rows":4.054354859583279,"Actual Rows":20167,"Task":"root","Total Time":66574155985,"Max Time":7814177902,"Access Object":"","Operation Info":"","Execution Info":"time:1m6.6s, loops:39, index_task: {total_time: 44.2s, fetch_handle: 40.2s, build: 104.1µs, wait: 4s}, table_task: {total_time: 1m42.1s, num: 58, concurrency: 60}","Disk":0,"Memory":162352,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":12.163064578749838,"Actual Rows":384652,"Task":"cop[tikv]","Total Time":3500000000,"Max Time":885000000,"Access Object":"","Operation Info":"table:lineitem, index:PRIMARY(L_ORDERKEY, L_LINENUMBER), range: decided by [eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)], keep order:false","Execution Info":"time:40.1s, loops:412, cop_task: {num: 21, max: 6.62s, min: 57.7ms, avg: 2.22s, p95: 6.34s, max_proc_keys: 85007, p95_proc_keys: 84296, tot_proc: 40.1s, tot_wait: 1.73s, rpc_num: 41, rpc_time: 1m27s, copr_cache_hit_ratio: 0.00}, tikv_task:{proc max:885ms, min:1ms, p80:184ms, p95:685ms, iters:467, tasks:21}, scan_detail: {total_process_keys: 384652, total_process_keys_size: 20386556, total_keys: 480929, rocksdb: {delete_skipped_count: 0, key_skipped_count: 384652, block: {cache_hit_count: 385413, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]},{"Node Id":"Selection","Plan Rows":4.054354859583279,"Actual Rows":20167,"Task":"cop[tikv]","Total Time":2981000000,"Max Time":219000000,"Access Object":"","Operation Info":"gt(new0107.lineitem.l_shipdate, 1995-03-13 00:00:00.000000)","Execution Info":"time:1m41.6s, loops:119, cop_task: {num: 76, max: 4.24s, min: 51.1ms, avg: 1.59s, p95: 3.91s, max_proc_keys: 20480, p95_proc_keys: 18900, tot_proc: 1m31.3s, tot_wait: 6.45s, rpc_num: 151, rpc_time: 4m1.2s, copr_cache_hit_ratio: 0.00}, tikv_task:{proc max:219ms, min:0s, p80:71ms, p95:151ms, iters:712, tasks:76}, scan_detail: {total_process_keys: 384652, total_process_keys_size: 75568360, total_keys: 460381, rocksdb: {delete_skipped_count: 0, key_skipped_count: 373351, block: {cache_hit_count: 296066, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRowIDScan","Plan Rows":12.163064578749838,"Actual Rows":384652,"Task":"cop[tikv]","Total Time":2937000000,"Max Time":202000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:202ms, min:0s, p80:70ms, p95:149ms, iters:712, tasks:76}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  l_orderkey,  sum(l_extendedprice * (1 - l_discount)) as revenue,  o_orderdate,  o_shippriority from  customer,  orders,  lineitem where  c_mktsegment = 'AUTOMOBILE'  and c_custkey = o_custkey  and l_orderkey = o_orderkey  and o_orderdate < '1995-03-13'  and l_shipdate > '1995-03-13' group by  l_orderkey,  o_orderdate,  o_shippriority order by  revenue desc,  o_orderdate limit 10;

{"Node Id":"Projection","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":3007263770,"Max Time":3007263770,"Access Object":"","Operation Info":"div(mul(100.00, Column#27), Column#28)-\u003eColumn#29","Execution Info":"time:3.01s, loops:2, Concurrency:OFF","Disk":0,"Memory":2856,"Plans":[{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":3007232833,"Max Time":3007232833,"Access Object":"","Operation Info":"funcs:sum(Column#31)-\u003eColumn#27, funcs:sum(Column#32)-\u003eColumn#28","Execution Info":"time:3.01s, loops:2, partial_worker:{wall_time:3.007190648s, concurrency:5, task_num:54, tot_wait:14.944112666s, tot_exec:7.896637ms, tot_time:14.952047842s, max:2.990422812s, p95:2.990422812s}, final_worker:{wall_time:3.007354987s, concurrency:5, task_num:5, tot_wait:14.952372615s, tot_exec:34.97µs, tot_time:14.952411305s, max:2.990514267s, p95:2.990514267s}","Disk":0,"Memory":972200,"Plans":[{"Node Id":"Projection","Plan Rows":51569.74907482635,"Actual Rows":51967,"Task":"root","Total Time":2990012032,"Max Time":2990012032,"Access Object":"","Operation Info":"case(like(new0107.part.p_type, PROMO%, 92), mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount)), 0)-\u003eColumn#31, mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount))-\u003eColumn#32","Execution Info":"time:2.99s, loops:55, Concurrency:5","Disk":0,"Memory":1059912,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":51569.74907482635,"Actual Rows":51967,"Task":"root","Total Time":2801846953,"Max Time":2801846953,"Access Object":"","Operation Info":"inner join, inner:TableReader_12, outer key:new0107.lineitem.l_partkey, inner key:new0107.part.p_partkey, equal cond:eq(new0107.lineitem.l_partkey, new0107.part.p_partkey)","Execution Info":"time:2.8s, loops:55, inner:{total:12.8s, concurrency:5, task:10, construct:343.8ms, fetch:11.4s, build:9.73ms, join:1.08s}","Disk":0,"Memory":13547364,"Plans":[{"Node Id":"TableReader","Plan Rows":50785.88888888899,"Actual Rows":51967,"Task":"root","Total Time":320633005,"Max Time":320633005,"Access Object":"","Operation Info":"data:Selection_23","Execution Info":"time:320.6ms, loops:56, cop_task: {num: 9, max: 270.7ms, min: 67.4ms, avg: 151.4ms, p95: 270.7ms, rpc_num: 9, rpc_time: 1.36s, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":2099502,"Plans":[{"Node Id":"Selection","Plan Rows":50785.88888888899,"Actual Rows":51967,"Task":"cop[tikv]","Total Time":4273000000,"Max Time":589000000,"Access Object":"","Operation Info":"ge(new0107.lineitem.l_shipdate, 1996-12-01 00:00:00.000000), lt(new0107.lineitem.l_shipdate, 1997-01-01 00:00:00.000000)","Execution Info":"tikv_task:{proc max:589ms, min:269ms, p80:517ms, p95:589ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4063000000,"Max Time":562000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:562ms, min:255ms, p80:494ms, p95:562ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":1,"Actual Rows":50161,"Task":"root","Total Time":11222904639,"Max Time":2276080362,"Access Object":"","Operation Info":"data:TableRangeScan_11","Execution Info":"time:11.2s, loops:64, cop_task: {num: 10, max: 2.08s, min: 35.2ms, avg: 1.04s, p95: 2.08s, max_proc_keys: 18242, p95_proc_keys: 18242, tot_proc: 8.81s, tot_wait: 291ms, rpc_num: 19, rpc_time: 20.8s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":50161,"Task":"cop[tikv]","Total Time":430000000,"Max Time":155000000,"Access Object":"","Operation Info":"table:part, range: decided by [new0107.lineitem.l_partkey], keep order:false","Execution Info":"tikv_task:{proc max:155ms, min:1ms, p80:132ms, p95:155ms, iters:89, tasks:10}, scan_detail: {total_process_keys: 50161, total_process_keys_size: 8199627, total_keys: 53251, rocksdb: {delete_skipped_count: 0, key_skipped_count: 6449, block: {cache_hit_count: 60960, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}
/*PLACEHOLDER*/ select  100.00 * sum(case   when p_type like 'PROMO%'    then l_extendedprice * (1 - l_discount)   else 0  end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from  lineitem,  part where  l_partkey = p_partkey  and l_shipdate >= '1996-12-01'  and l_shipdate < date_add('1996-12-01', interval '1' month);

{"Node Id":"Sort","Plan Rows":149568,"Actual Rows":33,"Task":"root","Total Time":6462329188,"Max Time":6462329188,"Access Object":"","Operation Info":"Column#19:desc, Column#18:desc","Execution Info":"time:6.46s, loops:2","Disk":0,"Memory":3720,"Plans":[{"Node Id":"Projection","Plan Rows":149568,"Actual Rows":33,"Task":"root","Total Time":6462280623,"Max Time":6462280623,"Access Object":"","Operation Info":"Column#18, Column#19","Execution Info":"time:6.46s, loops:6, Concurrency:5","Disk":0,"Memory":7440,"Plans":[{"Node Id":"HashAgg","Plan Rows":149568,"Actual Rows":33,"Task":"root","Total Time":6461624026,"Max Time":6461624026,"Access Object":"","Operation Info":"group by:Column#18, funcs:count(1)-\u003eColumn#19, funcs:firstrow(Column#18)-\u003eColumn#18","Execution Info":"time:6.46s, loops:6, partial_worker:{wall_time:6.461549234s, concurrency:5, task_num:150, tot_wait:32.234076018s, tot_exec:19.46259ms, tot_time:32.255615627s, max:6.461223551s, p95:6.461223551s}, final_worker:{wall_time:6.461725714s, concurrency:5, task_num:25, tot_wait:32.306751871s, tot_exec:195.469µs, tot_time:32.306954488s, max:6.46140739s, p95:6.46140739s}","Disk":0,"Memory":229446,"Plans":[{"Node Id":"HashAgg","Plan Rows":149568,"Actual Rows":150000,"Task":"root","Total Time":6435689568,"Max Time":6435689568,"Access Object":"","Operation Info":"group by:new0107.customer.c_custkey, funcs:count(new0107.orders.o_orderkey)-\u003eColumn#18","Execution Info":"time:6.44s, loops:151, partial_worker:{wall_time:5.814184404s, concurrency:5, task_num:1021, tot_wait:24.424511769s, tot_exec:3.941194577s, tot_time:28.701614247s, max:5.813280983s, p95:5.813280983s}, final_worker:{wall_time:6.435899858s, concurrency:5, task_num:25, tot_wait:28.751628472s, tot_exec:3.020948963s, tot_time:31.772598377s, max:6.435463471s, p95:6.435463471s}","Disk":0,"Memory":59651471,"Plans":[{"Node Id":"HashJoin","Plan Rows":878254.1720154043,"Actual Rows":1040728,"Task":"root","Total Time":5588822214,"Max Time":5588822214,"Access Object":"","Operation Info":"left outer join, equal:[eq(new0107.customer.c_custkey, new0107.orders.o_custkey)]","Execution Info":"time:5.59s, loops:1022, build_hash_table:{total:284.9ms, fetch:75.3ms, build:209.6ms}, probe:{concurrency:5, total:27.5s, max:5.51s, probe:14s, fetch:13.6s}","Disk":0,"Memory":1262960,"Plans":[{"Node Id":"TableReader","Plan Rows":150000,"Actual Rows":150000,"Task":"root","Total Time":74059573,"Max Time":74059573,"Access Object":"","Operation Info":"data:TableFullScan_17","Execution Info":"time:74.1ms, loops:148, cop_task: {num: 1, max: 74ms, proc_keys: 0, rpc_num: 1, rpc_time: 74ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":1202298,"Plans":[{"Node Id":"TableFullScan","Plan Rows":150000,"Actual Rows":150000,"Task":"cop[tikv]","Total Time":89000000,"Max Time":89000000,"Access Object":"","Operation Info":"table:customer, keep order:false","Execution Info":"tikv_task:{time:89ms, loops:151}","Disk":0,"Memory":0,"Plans":[]}]},{"Node Id":"TableReader","Plan Rows":875724.8,"Actual Rows":990658,"Task":"root","Total Time":2637276775,"Max Time":2637276775,"Access Object":"","Operation Info":"data:Selection_20","Execution Info":"time:2.64s, loops:980, cop_task: {num: 2, max: 2.99s, min: 2.61s, avg: 2.8s, p95: 2.99s, max_proc_keys: 583494, p95_proc_keys: 583494, tot_proc: 4.63s, tot_wait: 138ms, rpc_num: 2, rpc_time: 5.6s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":71780726,"Plans":[{"Node Id":"Selection","Plan Rows":875724.8,"Actual Rows":990658,"Task":"cop[tikv]","Total Time":1820000000,"Max Time":1066000000,"Access Object":"","Operation Info":"not(like(new0107.orders.o_comment, \"%pending%deposits%\", 92))","Execution Info":"tikv_task:{proc max:1.07s, min:754ms, p80:1.07s, p95:1.07s, iters:987, tasks:2}, scan_detail: {total_process_keys: 1001472, total_process_keys_size: 151717700, total_keys: 1001474, rocksdb: {delete_skipped_count: 0, key_skipped_count: 1001472, block: {cache_hit_count: 2529, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":1013000000,"Max Time":605000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:605ms, min:408ms, p80:605ms, p95:605ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  c_count,  count(*) as custdist from  (   select    c_custkey,    count(o_orderkey) as c_count   from    customer left outer join orders on     c_custkey = o_custkey     and o_comment not like '%pending%deposits%'   group by    c_custkey  ) c_orders group by  c_count order by  custdist desc,  c_count desc;

{"Node Id":"Sort","Plan Rows":2946.178694158076,"Actual Rows":175,"Task":"root","Total Time":22409314763,"Max Time":22409314763,"Access Object":"","Operation Info":"new0107.nation.n_name, Column#53:desc","Execution Info":"time:22.4s, loops:2","Disk":0,"Memory":17276,"Plans":[{"Node Id":"Projection","Plan Rows":2946.178694158076,"Actual Rows":175,"Task":"root","Total Time":22409080642,"Max Time":22409080642,"Access Object":"","Operation Info":"new0107.nation.n_name, Column#53, Column#55","Execution Info":"time:22.4s, loops:6, Concurrency:5","Disk":0,"Memory":25628,"Plans":[{"Node Id":"HashAgg","Plan Rows":2946.178694158076,"Actual Rows":175,"Task":"root","Total Time":22408863762,"Max Time":22408863762,"Access Object":"","Operation Info":"group by:Column#67, Column#68, funcs:sum(Column#64)-\u003eColumn#55, funcs:firstrow(Column#65)-\u003enew0107.nation.n_name, funcs:firstrow(Column#66)-\u003eColumn#53","Execution Info":"time:22.4s, loops:6, partial_worker:{wall_time:22.408734558s, concurrency:5, task_num:215, tot_wait:1m51.255829803s, tot_exec:781.938771ms, tot_time:1m52.038025347s, max:22.407986697s, p95:22.407986697s}, final_worker:{wall_time:22.409186614s, concurrency:5, task_num:25, tot_wait:1m52.036167712s, tot_exec:622.25µs, tot_time:1m52.0367977s, max:22.407957471s, p95:22.407957471s}","Disk":0,"Memory":1375207,"Plans":[{"Node Id":"Projection","Plan Rows":3331507.8607707974,"Actual Rows":217738,"Task":"root","Total Time":22324554847,"Max Time":22324554847,"Access Object":"","Operation Info":"minus(mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount)), mul(new0107.partsupp.ps_supplycost, new0107.lineitem.l_quantity))-\u003eColumn#64, new0107.nation.n_name, extract(YEAR, new0107.orders.o_orderdate)-\u003eColumn#66, new0107.nation.n_name, extract(YEAR, new0107.orders.o_orderdate)-\u003eColumn#68","Execution Info":"time:22.3s, loops:216, Concurrency:5","Disk":0,"Memory":1522240,"Plans":[{"Node Id":"Projection","Plan Rows":3331507.8607707974,"Actual Rows":217738,"Task":"root","Total Time":22278037109,"Max Time":22278037109,"Access Object":"","Operation Info":"new0107.lineitem.l_quantity, new0107.lineitem.l_extendedprice, new0107.lineitem.l_discount, new0107.partsupp.ps_supplycost, new0107.orders.o_orderdate, new0107.nation.n_name","Execution Info":"time:22.3s, loops:216, Concurrency:5","Disk":0,"Memory":1930224,"Plans":[{"Node Id":"HashJoin","Plan Rows":3331507.8607707974,"Actual Rows":217738,"Task":"root","Total Time":22401156966,"Max Time":22401156966,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)]","Execution Info":"time:22.4s, loops:216, build_hash_table:{total:10.4s, fetch:7.11s, build:3.31s}, probe:{concurrency:5, total:1m52s, max:22.4s, probe:5.5s, fetch:1m46.5s}","Disk":0,"Memory":16507392,"Plans":[{"Node Id":"HashJoin","Plan Rows":3274265.4576647705,"Actual Rows":217928,"Task":"root","Total Time":22381992540,"Max Time":22381992540,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.lineitem.l_suppkey, new0107.partsupp.ps_suppkey) eq(new0107.lineitem.l_partkey, new0107.partsupp.ps_partkey)]","Execution Info":"time:22.4s, loops:216, build_hash_table:{total:11.6s, fetch:8.68s, build:2.92s}, probe:{concurrency:5, total:1m52s, max:22.4s, probe:6.99s, fetch:1m45s}","Disk":0,"Memory":45451936,"Plans":[{"Node Id":"HashJoin","Plan Rows":3257501.218521527,"Actual Rows":217928,"Task":"root","Total Time":20552551989,"Max Time":20552551989,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.lineitem.l_partkey, new0107.part.p_partkey)]","Execution Info":"time:20.6s, loops:217, build_hash_table:{total:9.38s, fetch:9.38s, build:5.53ms}, probe:{concurrency:5, total:1m51.9s, max:22.4s, probe:18.7s, fetch:1m33.2s}","Disk":0,"Memory":587600,"Plans":[{"Node Id":"HashJoin","Plan Rows":4009984,"Actual Rows":4009984,"Task":"root","Total Time":16439634298,"Max Time":16439634298,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.supplier.s_suppkey, new0107.lineitem.l_suppkey)]","Execution Info":"time:16.4s, loops:3920, build_hash_table:{total:118ms, fetch:112.2ms, build:5.78ms}, probe:{concurrency:5, total:1m51.8s, max:22.4s, probe:1m22.6s, fetch:29.2s}","Disk":0,"Memory":271000,"Plans":[{"Node Id":"HashJoin","Plan Rows":10000,"Actual Rows":10000,"Task":"root","Total Time":116107284,"Max Time":116107284,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.supplier.s_nationkey)]","Execution Info":"time:116.1ms, loops:11, build_hash_table:{total:169.7µs, fetch:146µs, build:23.7µs}, probe:{concurrency:5, total:580.1ms, max:116.2ms, probe:29.9ms, fetch:550.2ms}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":25,"Actual Rows":25,"Task":"root","Total Time":41905,"Max Time":41905,"Access Object":"","Operation Info":"data:TableFullScan_106","Execution Info":"time:41.9µs, loops:2, cop_task: {num: 1, max: 12.4ms, proc_keys: 25, rpc_num: 1, rpc_time: 12.4ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":798,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:nation, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]},{"Node Id":"TableReader","Plan Rows":10000,"Actual Rows":10000,"Task":"root","Total Time":108054821,"Max Time":108054821,"Access Object":"","Operation Info":"data:TableFullScan_104","Execution Info":"time:108.1ms, loops:11, cop_task: {num: 1, max: 123.5ms, proc_keys: 10000, tot_proc: 121ms, rpc_num: 1, rpc_time: 123.5ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":160531,"Plans":[{"Node Id":"TableFullScan","Plan Rows":10000,"Actual Rows":10000,"Task":"cop[tikv]","Total Time":11000000,"Max Time":11000000,"Access Object":"","Operation Info":"table:supplier, keep order:false","Execution Info":"tikv_task:{time:11ms, loops:14}, scan_detail: {total_process_keys: 10000, total_process_keys_size: 1815466, total_keys: 10001, rocksdb: {delete_skipped_count: 0, key_skipped_count: 10000, block: {cache_hit_count: 33, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":4009984,"Actual Rows":4009984,"Task":"root","Total Time":5195382681,"Max Time":5195382681,"Access Object":"","Operation Info":"data:TableFullScan_108","Execution Info":"time:5.2s, loops:3924, cop_task: {num: 9, max: 8.08s, min: 5.15s, avg: 6.92s, p95: 8.08s, max_proc_keys: 512775, p95_proc_keys: 512775, tot_proc: 55.4s, tot_wait: 348ms, rpc_num: 9, rpc_time: 1m2.3s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":577661260,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4236000000,"Max Time":591000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:591ms, min:249ms, p80:585ms, p95:591ms, iters:3959, tasks:9}, scan_detail: {total_process_keys: 4009984, total_process_keys_size: 787655655, total_keys: 4009993, rocksdb: {delete_skipped_count: 0, key_skipped_count: 4009984, block: {cache_hit_count: 12898, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":160000,"Actual Rows":10899,"Task":"root","Total Time":9371940398,"Max Time":9371940398,"Access Object":"","Operation Info":"data:Selection_111","Execution Info":"time:9.37s, loops:12, cop_task: {num: 1, max: 9.27s, proc_keys: 200000, tot_proc: 9.19s, tot_wait: 24ms, rpc_num: 1, rpc_time: 9.27s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":508503,"Plans":[{"Node Id":"Selection","Plan Rows":160000,"Actual Rows":10899,"Task":"cop[tikv]","Total Time":357000000,"Max Time":357000000,"Access Object":"","Operation Info":"like(new0107.part.p_name, \"%dim%\", 92)","Execution Info":"tikv_task:{time:357ms, loops:200}, scan_detail: {total_process_keys: 200000, total_process_keys_size: 32687576, total_keys: 200001, rocksdb: {delete_skipped_count: 0, key_skipped_count: 200000, block: {cache_hit_count: 546, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":200000,"Actual Rows":200000,"Task":"cop[tikv]","Total Time":222000000,"Max Time":222000000,"Access Object":"","Operation Info":"table:part, keep order:false","Execution Info":"tikv_task:{time:222ms, loops:200}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"TableReader","Plan Rows":800000,"Actual Rows":800000,"Task":"root","Total Time":8123487200,"Max Time":8123487200,"Access Object":"","Operation Info":"data:TableFullScan_113","Execution Info":"time:8.12s, loops:783, cop_task: {num: 2, max: 9.17s, min: 8.08s, avg: 8.63s, p95: 9.17s, max_proc_keys: 529029, p95_proc_keys: 529029, tot_proc: 15.9s, tot_wait: 63ms, rpc_num: 2, rpc_time: 17.3s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":44825522,"Plans":[{"Node Id":"TableFullScan","Plan Rows":800000,"Actual Rows":800000,"Task":"cop[tikv]","Total Time":748000000,"Max Time":517000000,"Access Object":"","Operation Info":"table:partsupp, keep order:false","Execution Info":"tikv_task:{proc max:517ms, min:231ms, p80:517ms, p95:517ms, iters:790, tasks:2}, scan_detail: {total_process_keys: 800000, total_process_keys_size: 150608990, total_keys: 800002, rocksdb: {delete_skipped_count: 0, key_skipped_count: 800000, block: {cache_hit_count: 2473, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":1094656,"Actual Rows":1001472,"Task":"root","Total Time":6638838787,"Max Time":6638838787,"Access Object":"","Operation Info":"data:TableFullScan_115","Execution Info":"time:6.64s, loops:980, cop_task: {num: 2, max: 9.19s, min: 6.33s, avg: 7.76s, p95: 9.19s, max_proc_keys: 583494, p95_proc_keys: 583494, tot_proc: 15.2s, tot_wait: 76ms, rpc_num: 2, rpc_time: 15.5s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":16047475,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":757000000,"Max Time":437000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:437ms, min:320ms, p80:437ms, p95:437ms, iters:987, tasks:2}, scan_detail: {total_process_keys: 1001472, total_process_keys_size: 151717700, total_keys: 1001474, rocksdb: {delete_skipped_count: 0, key_skipped_count: 1001472, block: {cache_hit_count: 2529, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  nation,  o_year,  sum(amount) as sum_profit from  (   select    n_name as nation,    extract(year from o_orderdate) as o_year,    l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount   from    part,    supplier,    lineitem,    partsupp,    orders,    nation   where    s_suppkey = l_suppkey    and ps_suppkey = l_suppkey    and ps_partkey = l_partkey    and p_partkey = l_partkey    and o_orderkey = l_orderkey    and s_nationkey = n_nationkey    and p_name like '%dim%'  ) as profit group by  nation,  o_year order by  nation,  o_year desc;

{"Node Id":"Projection","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":7312438889,"Max Time":7312438889,"Access Object":"","Operation Info":"div(Column#46, 7.0)-\u003eColumn#47","Execution Info":"time:7.31s, loops:2, Concurrency:OFF","Disk":0,"Memory":1428,"Plans":[{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":7312418853,"Max Time":7312418853,"Access Object":"","Operation Info":"funcs:sum(new0107.lineitem.l_extendedprice)-\u003eColumn#46","Execution Info":"time:7.31s, loops:2, partial_worker:{wall_time:7.312396644s, concurrency:5, task_num:5, tot_wait:36.560140128s, tot_exec:92.573µs, tot_time:36.560242345s, max:7.312061561s, p95:7.312061561s}, final_worker:{wall_time:7.312817339s, concurrency:5, task_num:5, tot_wait:36.560337664s, tot_exec:19.368µs, tot_time:36.560360435s, max:7.312091441s, p95:7.312091441s}","Disk":0,"Memory":37608,"Plans":[{"Node Id":"HashJoin","Plan Rows":89.76451795288384,"Actual Rows":421,"Task":"root","Total Time":7312107757,"Max Time":7312107757,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.part.p_partkey, new0107.lineitem.l_partkey)], other cond:lt(new0107.lineitem.l_quantity, mul(0.2, Column#44))","Execution Info":"time:7.31s, loops:6, build_hash_table:{total:4.98s, fetch:4.98s, build:797.3µs}, probe:{concurrency:5, total:36.6s, max:7.31s, probe:61.7ms, fetch:36.5s}","Disk":0,"Memory":458192,"Plans":[{"Node Id":"HashJoin","Plan Rows":89.76451795288384,"Actual Rows":4588,"Task":"root","Total Time":4982398091,"Max Time":4982398091,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.part.p_partkey, new0107.lineitem.l_partkey)]","Execution Info":"time:4.98s, loops:6, build_hash_table:{total:3.02s, fetch:3.02s, build:130.8µs}, probe:{concurrency:5, total:24.8s, max:4.98s, probe:4.53s, fetch:20.3s}","Disk":0,"Memory":41680,"Plans":[{"Node Id":"TableReader","Plan Rows":4.409,"Actual Rows":233,"Task":"root","Total Time":3018038464,"Max Time":3018038464,"Access Object":"","Operation Info":"data:Selection_39","Execution Info":"time:3.02s, loops:2, cop_task: {num: 1, max: 3s, proc_keys: 200000, tot_proc: 2.83s, tot_wait: 58ms, rpc_num: 1, rpc_time: 3s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":16110,"Plans":[{"Node Id":"Selection","Plan Rows":4.409,"Actual Rows":233,"Task":"cop[tikv]","Total Time":230000000,"Max Time":230000000,"Access Object":"","Operation Info":"eq(new0107.part.p_brand, \"Brand#44\"), eq(new0107.part.p_container, \"WRAP PKG\")","Execution Info":"tikv_task:{time:230ms, loops:200}, scan_detail: {total_process_keys: 200000, total_process_keys_size: 32687576, total_keys: 200001, rocksdb: {delete_skipped_count: 0, key_skipped_count: 200000, block: {cache_hit_count: 546, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":200000,"Actual Rows":200000,"Task":"cop[tikv]","Total Time":194000000,"Max Time":194000000,"Access Object":"","Operation Info":"table:part, keep order:false","Execution Info":"tikv_task:{time:194ms, loops:200}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":4009984,"Actual Rows":4009984,"Task":"root","Total Time":2743437211,"Max Time":2743437211,"Access Object":"","Operation Info":"data:TableFullScan_36","Execution Info":"time:2.74s, loops:3924, cop_task: {num: 9, max: 4.61s, min: 1.98s, avg: 3.47s, p95: 4.61s, max_proc_keys: 512775, p95_proc_keys: 512775, tot_proc: 24.3s, tot_wait: 572ms, rpc_num: 9, rpc_time: 31.2s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":144848721,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4254000000,"Max Time":613000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:613ms, min:240ms, p80:522ms, p95:613ms, iters:3959, tasks:9}, scan_detail: {total_process_keys: 4009984, total_process_keys_size: 787655655, total_keys: 4009993, rocksdb: {delete_skipped_count: 0, key_skipped_count: 4009984, block: {cache_hit_count: 12898, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"HashAgg","Plan Rows":196960,"Actual Rows":200000,"Task":"root","Total Time":7310340738,"Max Time":7310340738,"Access Object":"","Operation Info":"group by:new0107.lineitem.l_partkey, funcs:avg(Column#50, Column#51)-\u003eColumn#44, funcs:firstrow(new0107.lineitem.l_partkey)-\u003enew0107.lineitem.l_partkey","Execution Info":"time:7.31s, loops:200, partial_worker:{wall_time:6.115040339s, concurrency:5, task_num:9, tot_wait:16.490260764s, tot_exec:11.527155578s, tot_time:29.012519824s, max:6.114914865s, p95:6.114914865s}, final_worker:{wall_time:7.310735529s, concurrency:5, task_num:25, tot_wait:28.272959532s, tot_exec:7.629190873s, tot_time:35.902173436s, max:7.310550153s, p95:7.310550153s}","Disk":0,"Memory":228074105,"Plans":[{"Node Id":"TableReader","Plan Rows":196960,"Actual Rows":1590811,"Task":"root","Total Time":5287056000,"Max Time":5287056000,"Access Object":"","Operation Info":"data:HashAgg_41","Execution Info":"time:5.29s, loops:10, cop_task: {num: 9, max: 5.27s, min: 2.09s, avg: 3.59s, p95: 5.27s, max_proc_keys: 512775, p95_proc_keys: 512775, tot_proc: 29.5s, tot_wait: 586ms, rpc_num: 9, rpc_time: 32.3s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":20445508,"Plans":[{"Node Id":"HashAgg","Plan Rows":196960,"Actual Rows":1590811,"Task":"cop[tikv]","Total Time":8618000000,"Max Time":1120000000,"Access Object":"","Operation Info":"group by:new0107.lineitem.l_partkey, funcs:count(new0107.lineitem.l_quantity)-\u003eColumn#50, funcs:sum(new0107.lineitem.l_quantity)-\u003eColumn#51","Execution Info":"tikv_task:{proc max:1.12s, min:574ms, p80:1.09s, p95:1.12s, iters:3923, tasks:9}, scan_detail: {total_process_keys: 4009984, total_process_keys_size: 787655655, total_keys: 4009993, rocksdb: {delete_skipped_count: 0, key_skipped_count: 4009984, block: {cache_hit_count: 12898, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4380000000,"Max Time":570000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:570ms, min:362ms, p80:563ms, p95:570ms, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  sum(l_extendedprice) / 7.0 as avg_yearly from  lineitem,  part where  p_partkey = l_partkey  and p_brand = 'Brand#44'  and p_container = 'WRAP PKG'  and l_quantity < (   select    0.2 * avg(l_quantity)   from    lineitem   where    l_partkey = p_partkey  );
 drop view revenue0;
create view revenue0 (supplier_no, total_revenue) as  select   l_suppkey,   sum(l_extendedprice * (1 - l_discount))  from   lineitem  where   l_shipdate >= '1997-07-01'   and l_shipdate < date_add('1997-07-01', interval '3' month)  group by   l_suppkey;

{"Node Id":"Sort","Plan Rows":73.6544673539519,"Actual Rows":2,"Task":"root","Total Time":26182882283,"Max Time":26182882283,"Access Object":"","Operation Info":"Column#62","Execution Info":"time:26.2s, loops:2","Disk":0,"Memory":3600,"Plans":[{"Node Id":"Projection","Plan Rows":73.6544673539519,"Actual Rows":2,"Task":"root","Total Time":26182855381,"Max Time":26182855381,"Access Object":"","Operation Info":"Column#62, div(Column#64, Column#65)-\u003eColumn#66","Execution Info":"time:26.2s, loops:3, Concurrency:OFF","Disk":0,"Memory":3228,"Plans":[{"Node Id":"HashAgg","Plan Rows":73.6544673539519,"Actual Rows":2,"Task":"root","Total Time":26182828925,"Max Time":26182828925,"Access Object":"","Operation Info":"group by:Column#78, funcs:sum(Column#75)-\u003eColumn#64, funcs:sum(Column#76)-\u003eColumn#65, funcs:firstrow(Column#77)-\u003eColumn#62","Execution Info":"time:26.2s, loops:3, partial_worker:{wall_time:26.182801035s, concurrency:5, task_num:2, tot_wait:2m10.91028926s, tot_exec:441.75µs, tot_time:2m10.910744277s, max:26.18215509s, p95:26.18215509s}, final_worker:{wall_time:0s, concurrency:5, task_num:4, tot_wait:2m10.912548383s, tot_exec:40.663µs, tot_time:2m10.912592163s, max:26.182529661s, p95:26.182529661s}","Disk":0,"Memory":240419,"Plans":[{"Node Id":"Projection","Plan Rows":200,"Actual Rows":1704,"Task":"root","Total Time":26180984326,"Max Time":26180984326,"Access Object":"","Operation Info":"case(eq(new0107.nation.n_name, INDIA), mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount)), 0)-\u003eColumn#75, mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount))-\u003eColumn#76, extract(YEAR, new0107.orders.o_orderdate)-\u003eColumn#77, extract(YEAR, new0107.orders.o_orderdate)-\u003eColumn#78","Execution Info":"time:26.2s, loops:3, Concurrency:OFF","Disk":0,"Memory":111608,"Plans":[{"Node Id":"Projection","Plan Rows":200,"Actual Rows":1704,"Task":"root","Total Time":26180133951,"Max Time":26180133951,"Access Object":"","Operation Info":"new0107.lineitem.l_extendedprice, new0107.lineitem.l_discount, new0107.orders.o_orderdate, new0107.nation.n_name","Execution Info":"time:26.2s, loops:3, Concurrency:OFF","Disk":0,"Memory":185184,"Plans":[{"Node Id":"HashJoin","Plan Rows":200,"Actual Rows":1704,"Task":"root","Total Time":26180084394,"Max Time":26180084394,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.supplier.s_nationkey, new0107.nation.n_nationkey)]","Execution Info":"time:26.2s, loops:3, build_hash_table:{total:73.3ms, fetch:73.3ms, build:23.1µs}, probe:{concurrency:5, total:2m10.7s, max:26.2s, probe:50.5ms, fetch:2m10.6s}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"IndexJoin","Plan Rows":200,"Actual Rows":1704,"Task":"root","Total Time":26102670713,"Max Time":26102670713,"Access Object":"","Operation Info":"inner join, inner:TableReader_47, outer key:new0107.lineitem.l_suppkey, inner key:new0107.supplier.s_suppkey, equal cond:eq(new0107.lineitem.l_suppkey, new0107.supplier.s_suppkey)","Execution Info":"time:26.1s, loops:3, inner:{total:5.87s, concurrency:5, task:5, construct:1.52ms, fetch:5.87s, build:632µs}, probe:1.25ms","Disk":0,"Memory":736613,"Plans":[{"Node Id":"IndexJoin","Plan Rows":200,"Actual Rows":1704,"Task":"root","Total Time":23518153532,"Max Time":23518153532,"Access Object":"","Operation Info":"inner join, inner:TableReader_59, outer key:new0107.lineitem.l_partkey, inner key:new0107.part.p_partkey, equal cond:eq(new0107.lineitem.l_partkey, new0107.part.p_partkey)","Execution Info":"time:23.5s, loops:7, inner:{total:21.9s, concurrency:5, task:18, construct:2.61s, fetch:19.3s, build:794.4µs}, probe:280.6ms","Disk":0,"Memory":48381686,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":1370.7736488298992,"Actual Rows":244708,"Task":"root","Total Time":20342161116,"Max Time":20342161116,"Access Object":"","Operation Info":"inner join, inner:IndexLookUp_73, outer key:new0107.orders.o_orderkey, inner key:new0107.lineitem.l_orderkey, equal cond:eq(new0107.orders.o_orderkey, new0107.lineitem.l_orderkey)","Execution Info":"time:20.3s, loops:244, inner:{total:1m6.9s, concurrency:5, task:11, construct:353.7ms, fetch:1m1.5s, build:164.2ms, join:5.07s}","Disk":0,"Memory":38756879,"Plans":[{"Node Id":"HashJoin","Plan Rows":338.09908020009675,"Actual Rows":61273,"Task":"root","Total Time":4399400083,"Max Time":4399400083,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.customer.c_custkey, new0107.orders.o_custkey)]","Execution Info":"time:4.4s, loops:65, build_hash_table:{total:4.29s, fetch:4.25s, build:31.4ms}, probe:{concurrency:5, total:22s, max:4.4s, probe:259.7ms, fetch:21.7s}","Disk":0,"Memory":293088,"Plans":[{"Node Id":"HashJoin","Plan Rows":37.5,"Actual Rows":30183,"Task":"root","Total Time":4239477439,"Max Time":4239477439,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.customer.c_nationkey)]","Execution Info":"time:4.24s, loops:35, build_hash_table:{total:28.7ms, fetch:28.6ms, build:11.8µs}, probe:{concurrency:5, total:21.4s, max:4.28s, probe:236ms, fetch:21.2s}","Disk":0,"Memory":372,"Plans":[{"Node Id":"HashJoin","Plan Rows":0.00625,"Actual Rows":5,"Task":"root","Total Time":28560910,"Max Time":28560910,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.region.r_regionkey, new0107.nation.n_regionkey)]","Execution Info":"time:28.6ms, loops:2, build_hash_table:{total:81.8µs, fetch:78.8µs, build:2.94µs}, probe:{concurrency:5, total:140.5ms, max:28.2ms, probe:32.1µs, fetch:140.5ms}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":0.005,"Actual Rows":1,"Task":"root","Total Time":26570,"Max Time":26570,"Access Object":"","Operation Info":"data:Selection_105","Execution Info":"time:26.6µs, loops:2, cop_task: {num: 1, max: 1.3ms, proc_keys: 5, rpc_num: 1, rpc_time: 1.28ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":246,"Plans":[{"Node Id":"Selection","Plan Rows":0.005,"Actual Rows":1,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"eq(new0107.region.r_name, \"ASIA\")","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 5, total_process_keys_size: 559, total_keys: 6, rocksdb: {delete_skipped_count: 0, key_skipped_count: 5, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":5,"Actual Rows":5,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:region, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":25,"Actual Rows":25,"Task":"root","Total Time":28029534,"Max Time":28029534,"Access Object":"","Operation Info":"data:TableFullScan_102","Execution Info":"time:28ms, loops:2, cop_task: {num: 1, max: 29.4ms, proc_keys: 25, rpc_num: 1, rpc_time: 29.3ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":613,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:n1, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":150000,"Actual Rows":150000,"Task":"root","Total Time":4232292734,"Max Time":4232292734,"Access Object":"","Operation Info":"data:TableFullScan_107","Execution Info":"time:4.23s, loops:148, cop_task: {num: 1, max: 4.23s, proc_keys: 150000, tot_proc: 4.21s, tot_wait: 5ms, rpc_num: 1, rpc_time: 4.23s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":2403837,"Plans":[{"Node Id":"TableFullScan","Plan Rows":150000,"Actual Rows":150000,"Task":"cop[tikv]","Total Time":109000000,"Max Time":109000000,"Access Object":"","Operation Info":"table:customer, keep order:false","Execution Info":"tikv_task:{time:109ms, loops:151}, scan_detail: {total_process_keys: 150000, total_process_keys_size: 30533765, total_keys: 150001, rocksdb: {delete_skipped_count: 0, key_skipped_count: 150000, block: {cache_hit_count: 502, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":27366.4,"Actual Rows":305307,"Task":"root","Total Time":902390387,"Max Time":902390387,"Access Object":"","Operation Info":"data:Selection_110","Execution Info":"time:902.4ms, loops:299, cop_task: {num: 2, max: 4.35s, min: 853.3ms, avg: 2.6s, p95: 4.35s, max_proc_keys: 583494, p95_proc_keys: 583494, tot_proc: 5.13s, tot_wait: 34ms, rpc_num: 2, rpc_time: 5.21s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":7357258,"Plans":[{"Node Id":"Selection","Plan Rows":27366.4,"Actual Rows":305307,"Task":"cop[tikv]","Total Time":981000000,"Max Time":541000000,"Access Object":"","Operation Info":"ge(new0107.orders.o_orderdate, 1995-01-01 00:00:00.000000), le(new0107.orders.o_orderdate, 1996-12-31 00:00:00.000000)","Execution Info":"tikv_task:{proc max:541ms, min:440ms, p80:541ms, p95:541ms, iters:987, tasks:2}, scan_detail: {total_process_keys: 1001472, total_process_keys_size: 151717700, total_keys: 1001474, rocksdb: {delete_skipped_count: 0, key_skipped_count: 1001472, block: {cache_hit_count: 2529, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":925000000,"Max Time":507000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:507ms, min:418ms, p80:507ms, p95:507ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"IndexLookUp","Plan Rows":4.054354859583279,"Actual Rows":244708,"Task":"root","Total Time":60875864889,"Max Time":9117286752,"Access Object":"","Operation Info":"","Execution Info":"time:1m0.9s, loops:254, index_task: {total_time: 42.4s, fetch_handle: 41.6s, build: 116.7µs, wait: 815.6ms}, table_task: {total_time: 1m1s, num: 42, concurrency: 55}","Disk":0,"Memory":576668,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":4.054354859583279,"Actual Rows":244708,"Task":"cop[tikv]","Total Time":2268000000,"Max Time":501000000,"Access Object":"","Operation Info":"table:lineitem, index:PRIMARY(L_ORDERKEY, L_LINENUMBER), range: decided by [eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)], keep order:false","Execution Info":"time:41.5s, loops:270, cop_task: {num: 18, max: 7.56s, min: 154.3ms, avg: 2.51s, p95: 7.56s, max_proc_keys: 58476, p95_proc_keys: 58476, tot_proc: 40.1s, tot_wait: 993ms, rpc_num: 35, rpc_time: 1m23.4s, copr_cache_hit_ratio: 0.00}, tikv_task:{proc max:501ms, min:1ms, p80:302ms, p95:501ms, iters:318, tasks:18}, scan_detail: {total_process_keys: 244708, total_process_keys_size: 12969524, total_keys: 305981, rocksdb: {delete_skipped_count: 0, key_skipped_count: 244708, block: {cache_hit_count: 245262, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]},{"Node Id":"TableRowIDScan","Plan Rows":4.054354859583279,"Actual Rows":244708,"Task":"cop[tikv]","Total Time":2146000000,"Max Time":235000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"time:1m0.7s, loops:307, cop_task: {num: 60, max: 4.38s, min: 45.5ms, avg: 1.36s, p95: 4.04s, max_proc_keys: 20480, p95_proc_keys: 17170, tot_proc: 57.8s, tot_wait: 5.67s, rpc_num: 118, rpc_time: 2m41.1s, copr_cache_hit_ratio: 0.00}, tikv_task:{proc max:235ms, min:0s, p80:61ms, p95:164ms, iters:503, tasks:60}, scan_detail: {total_process_keys: 244708, total_process_keys_size: 48054481, total_keys: 294300, rocksdb: {delete_skipped_count: 0, key_skipped_count: 236786, block: {cache_hit_count: 195381, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":0.001,"Actual Rows":1603,"Task":"root","Total Time":17744526763,"Max Time":3103777902,"Access Object":"","Operation Info":"data:Selection_58","Execution Info":"time:17.7s, loops:36, cop_task: {num: 18, max: 3.1s, min: 127.2ms, avg: 916.9ms, p95: 3.1s, max_proc_keys: 24237, p95_proc_keys: 24237, tot_proc: 12.5s, tot_wait: 624ms, rpc_num: 35, rpc_time: 32.8s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":0,"Plans":[{"Node Id":"Selection","Plan Rows":0.001,"Actual Rows":1603,"Task":"cop[tikv]","Total Time":2925000000,"Max Time":370000000,"Access Object":"","Operation Info":"eq(new0107.part.p_type, \"SMALL PLATED COPPER\")","Execution Info":"tikv_task:{proc max:370ms, min:10ms, p80:312ms, p95:370ms, iters:309, tasks:18}, scan_detail: {total_process_keys: 231267, total_process_keys_size: 37800170, total_keys: 253236, rocksdb: {delete_skipped_count: 0, key_skipped_count: 46883, block: {cache_hit_count: 286029, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":231267,"Task":"cop[tikv]","Total Time":2845000000,"Max Time":361000000,"Access Object":"","Operation Info":"table:part, range: decided by [new0107.lineitem.l_partkey], keep order:false","Execution Info":"tikv_task:{proc max:361ms, min:10ms, p80:308ms, p95:361ms, iters:309, tasks:18}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"TableReader","Plan Rows":1,"Actual Rows":1584,"Task":"root","Total Time":5866272122,"Max Time":2984533257,"Access Object":"","Operation Info":"data:TableRangeScan_46","Execution Info":"time:5.87s, loops:10, cop_task: {num: 5, max: 2.97s, min: 73ms, avg: 1.17s, p95: 2.97s, max_proc_keys: 678, p95_proc_keys: 678, tot_proc: 5.47s, tot_wait: 220ms, rpc_num: 9, rpc_time: 11.6s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":1584,"Task":"cop[tikv]","Total Time":26000000,"Max Time":10000000,"Access Object":"","Operation Info":"table:supplier, range: decided by [new0107.lineitem.l_suppkey], keep order:false","Execution Info":"tikv_task:{proc max:10ms, min:0s, p80:10ms, p95:10ms, iters:18, tasks:5}, scan_detail: {total_process_keys: 1584, total_process_keys_size: 286618, total_keys: 1657, rocksdb: {delete_skipped_count: 0, key_skipped_count: 150, block: {cache_hit_count: 1914, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":25,"Actual Rows":25,"Task":"root","Total Time":73163831,"Max Time":73163831,"Access Object":"","Operation Info":"data:TableFullScan_119","Execution Info":"time:73.2ms, loops:2, cop_task: {num: 1, max: 73.4ms, proc_keys: 25, rpc_num: 1, rpc_time: 73.4ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":798,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:n2, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  o_year,  sum(case   when nation = 'INDIA' then volume   else 0  end) / sum(volume) as mkt_share from  (   select    extract(year from o_orderdate) as o_year,    l_extendedprice * (1 - l_discount) as volume,    n2.n_name as nation   from    part,    supplier,    lineitem,    orders,    customer,    nation n1,    nation n2,    region   where    p_partkey = l_partkey    and s_suppkey = l_suppkey    and l_orderkey = o_orderkey    and o_custkey = c_custkey    and c_nationkey = n1.n_nationkey    and n1.n_regionkey = r_regionkey    and r_name = 'ASIA'    and s_nationkey = n2.n_nationkey    and o_orderdate between '1995-01-01' and '1996-12-31'    and p_type = 'SMALL PLATED COPPER'  ) as all_nations group by  o_year order by  o_year;

{"Node Id":"Projection","Plan Rows":10,"Actual Rows":10,"Task":"root","Total Time":12001526950,"Max Time":12001526950,"Access Object":"","Operation Info":"new0107.lineitem.l_orderkey, Column#35, new0107.orders.o_orderdate, new0107.orders.o_shippriority","Execution Info":"time:12s, loops:2, Concurrency:OFF","Disk":0,"Memory":2544,"Plans":[{"Node Id":"TopN","Plan Rows":10,"Actual Rows":10,"Task":"root","Total Time":12001500975,"Max Time":12001500975,"Access Object":"","Operation Info":"Column#35:desc, new0107.orders.o_orderdate, offset:0, count:10","Execution Info":"time:12s, loops:2","Disk":0,"Memory":78560,"Plans":[{"Node Id":"HashAgg","Plan Rows":535774.7154925766,"Actual Rows":7662,"Task":"root","Total Time":12000276550,"Max Time":12000276550,"Access Object":"","Operation Info":"group by:Column#48, Column#49, Column#50, funcs:sum(Column#44)-\u003eColumn#35, funcs:firstrow(Column#45)-\u003enew0107.orders.o_orderdate, funcs:firstrow(Column#46)-\u003enew0107.orders.o_shippriority, funcs:firstrow(Column#47)-\u003enew0107.lineitem.l_orderkey","Execution Info":"time:12s, loops:11, partial_worker:{wall_time:11.773618688s, concurrency:5, task_num:22, tot_wait:58.652869799s, tot_exec:11.485745ms, tot_time:58.67024776s, max:11.738152677s, p95:11.738152677s}, final_worker:{wall_time:12.001837167s, concurrency:5, task_num:25, tot_wait:58.834048211s, tot_exec:251.144191ms, tot_time:59.08520588s, max:11.979925319s, p95:11.979925319s}","Disk":0,"Memory":3435648,"Plans":[{"Node Id":"Projection","Plan Rows":795926.0114565928,"Actual Rows":20167,"Task":"root","Total Time":11716224001,"Max Time":11716224001,"Access Object":"","Operation Info":"mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount))-\u003eColumn#44, new0107.orders.o_orderdate, new0107.orders.o_shippriority, new0107.lineitem.l_orderkey, new0107.lineitem.l_orderkey, new0107.orders.o_orderdate, new0107.orders.o_shippriority","Execution Info":"time:11.7s, loops:23, Concurrency:5","Disk":0,"Memory":571632,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":795926.0114565928,"Actual Rows":20167,"Task":"root","Total Time":11714522794,"Max Time":11714522794,"Access Object":"","Operation Info":"inner join, inner:IndexLookUp_27, outer key:new0107.orders.o_orderkey, inner key:new0107.lineitem.l_orderkey, equal cond:eq(new0107.orders.o_orderkey, new0107.lineitem.l_orderkey)","Execution Info":"time:11.7s, loops:23, inner:{total:47.2s, concurrency:5, task:12, construct:429ms, fetch:46.4s, build:17.5ms, join:421.2ms}","Disk":0,"Memory":23022208,"Plans":[{"Node Id":"HashJoin","Plan Rows":196313.84992738423,"Actual Rows":96277,"Task":"root","Total Time":455019734,"Max Time":455019734,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.customer.c_custkey, new0107.orders.o_custkey)]","Execution Info":"time:455ms, loops:99, build_hash_table:{total:216.9ms, fetch:195.9ms, build:21ms}, probe:{concurrency:5, total:8.58s, max:1.72s, probe:7.33s, fetch:1.25s}","Disk":0,"Memory":977192,"Plans":[{"Node Id":"TableReader","Plan Rows":21774,"Actual Rows":29752,"Task":"root","Total Time":195482802,"Max Time":195482802,"Access Object":"","Operation Info":"data:Selection_75","Execution Info":"time:195.5ms, loops:30, cop_task: {num: 1, max: 187.2ms, proc_keys: 0, rpc_num: 1, rpc_time: 187.2ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":778282,"Plans":[{"Node Id":"Selection","Plan Rows":21774,"Actual Rows":29752,"Task":"cop[tikv]","Total Time":164000000,"Max Time":164000000,"Access Object":"","Operation Info":"eq(new0107.customer.c_mktsegment, \"AUTOMOBILE\")","Execution Info":"tikv_task:{time:164ms, loops:151}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":150000,"Actual Rows":150000,"Task":"cop[tikv]","Total Time":138000000,"Max Time":138000000,"Access Object":"","Operation Info":"table:customer, keep order:false","Execution Info":"tikv_task:{time:138ms, loops:151}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":730104.3924398626,"Actual Rows":484673,"Task":"root","Total Time":179374843,"Max Time":179374843,"Access Object":"","Operation Info":"data:Selection_72","Execution Info":"time:179.4ms, loops:473, cop_task: {num: 2, max: 183.4ms, min: 171.5ms, avg: 177.5ms, p95: 183.4ms, rpc_num: 2, rpc_time: 354.9ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":15547598,"Plans":[{"Node Id":"Selection","Plan Rows":730104.3924398626,"Actual Rows":484673,"Task":"cop[tikv]","Total Time":937000000,"Max Time":541000000,"Access Object":"","Operation Info":"lt(new0107.orders.o_orderdate, 1995-03-13 00:00:00.000000)","Execution Info":"tikv_task:{proc max:541ms, min:396ms, p80:541ms, p95:541ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":885000000,"Max Time":510000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:510ms, min:375ms, p80:510ms, p95:510ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"IndexLookUp","Plan Rows":4.054354859583279,"Actual Rows":20167,"Task":"root","Total Time":45766577627,"Max Time":5723051795,"Access Object":"","Operation Info":"","Execution Info":"time:45.8s, loops:39, index_task: {total_time: 15.8s, fetch_handle: 15.4s, build: 123.3µs, wait: 389.2ms}, table_task: {total_time: 1m20.1s, num: 57, concurrency: 60}","Disk":0,"Memory":162352,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":7.484459202807528,"Actual Rows":384652,"Task":"cop[tikv]","Total Time":3664000000,"Max Time":942000000,"Access Object":"","Operation Info":"table:lineitem, index:PRIMARY(L_ORDERKEY, L_LINENUMBER), range: decided by [eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)], keep order:false","Execution Info":"time:15.3s, loops:410, cop_task: {num: 21, max: 3.12s, min: 80.3ms, avg: 903.6ms, p95: 2.02s, max_proc_keys: 88766, p95_proc_keys: 81046, tot_proc: 15.3s, tot_wait: 1.77s, rpc_num: 41, rpc_time: 37s, copr_cache_hit_ratio: 0.00}, tikv_task:{proc max:942ms, min:1ms, p80:192ms, p95:742ms, iters:470, tasks:21}, scan_detail: {total_process_keys: 384652, total_process_keys_size: 20386556, total_keys: 480929, rocksdb: {delete_skipped_count: 0, key_skipped_count: 384652, block: {cache_hit_count: 385413, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]},{"Node Id":"Selection","Plan Rows":4.054354859583279,"Actual Rows":20167,"Task":"cop[tikv]","Total Time":2877000000,"Max Time":263000000,"Access Object":"","Operation Info":"gt(new0107.lineitem.l_shipdate, 1995-03-13 00:00:00.000000)","Execution Info":"time:1m18.8s, loops:117, cop_task: {num: 75, max: 3.61s, min: 46.6ms, avg: 1.28s, p95: 3.35s, max_proc_keys: 20480, p95_proc_keys: 17625, tot_proc: 1m27.2s, tot_wait: 3.3s, rpc_num: 149, rpc_time: 3m12s, copr_cache_hit_ratio: 0.03}, tikv_task:{proc max:263ms, min:0s, p80:73ms, p95:131ms, iters:715, tasks:75}, scan_detail: {total_process_keys: 380588, total_process_keys_size: 74770183, total_keys: 455511, rocksdb: {delete_skipped_count: 0, key_skipped_count: 369399, block: {cache_hit_count: 292617, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRowIDScan","Plan Rows":7.484459202807528,"Actual Rows":384652,"Task":"cop[tikv]","Total Time":2851000000,"Max Time":261000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:261ms, min:0s, p80:73ms, p95:131ms, iters:715, tasks:75}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  l_orderkey,  sum(l_extendedprice * (1 - l_discount)) as revenue,  o_orderdate,  o_shippriority from  customer,  orders,  lineitem where  c_mktsegment = 'AUTOMOBILE'  and c_custkey = o_custkey  and l_orderkey = o_orderkey  and o_orderdate < '1995-03-13'  and l_shipdate > '1995-03-13' group by  l_orderkey,  o_orderdate,  o_shippriority order by  revenue desc,  o_orderdate limit 10;

{"Node Id":"Projection","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":5285629957,"Max Time":5285629957,"Access Object":"","Operation Info":"div(mul(100.00, Column#27), Column#28)-\u003eColumn#29","Execution Info":"time:5.29s, loops:2, Concurrency:OFF","Disk":0,"Memory":2856,"Plans":[{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":5285588957,"Max Time":5285588957,"Access Object":"","Operation Info":"funcs:sum(Column#31)-\u003eColumn#27, funcs:sum(Column#32)-\u003eColumn#28","Execution Info":"time:5.29s, loops:2, partial_worker:{wall_time:4.940670873s, concurrency:5, task_num:54, tot_wait:24.673216966s, tot_exec:8.317467ms, tot_time:24.681588122s, max:4.938561562s, p95:4.938561562s}, final_worker:{wall_time:5.240961269s, concurrency:5, task_num:5, tot_wait:24.681696831s, tot_exec:107.344111ms, tot_time:24.789044924s, max:5.034695082s, p95:5.034695082s}","Disk":0,"Memory":972200,"Plans":[{"Node Id":"Projection","Plan Rows":51569.74907482635,"Actual Rows":51967,"Task":"root","Total Time":4927058356,"Max Time":4927058356,"Access Object":"","Operation Info":"case(like(new0107.part.p_type, PROMO%, 92), mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount)), 0)-\u003eColumn#31, mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount))-\u003eColumn#32","Execution Info":"time:4.93s, loops:55, Concurrency:5","Disk":0,"Memory":1059912,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":51569.74907482635,"Actual Rows":51967,"Task":"root","Total Time":4882383501,"Max Time":4882383501,"Access Object":"","Operation Info":"inner join, inner:TableReader_12, outer key:new0107.lineitem.l_partkey, inner key:new0107.part.p_partkey, equal cond:eq(new0107.lineitem.l_partkey, new0107.part.p_partkey)","Execution Info":"time:4.88s, loops:55, inner:{total:14.3s, concurrency:5, task:10, construct:260.8ms, fetch:13.6s, build:12.2ms, join:446ms}","Disk":0,"Memory":13465438,"Plans":[{"Node Id":"TableReader","Plan Rows":50785.88888888899,"Actual Rows":51967,"Task":"root","Total Time":481727236,"Max Time":481727236,"Access Object":"","Operation Info":"data:Selection_23","Execution Info":"time:481.7ms, loops:56, cop_task: {num: 9, max: 241.3ms, min: 193.5ms, avg: 218.6ms, p95: 241.3ms, rpc_num: 9, rpc_time: 1.97s, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":3555009,"Plans":[{"Node Id":"Selection","Plan Rows":50785.88888888899,"Actual Rows":51967,"Task":"cop[tikv]","Total Time":4273000000,"Max Time":589000000,"Access Object":"","Operation Info":"ge(new0107.lineitem.l_shipdate, 1996-12-01 00:00:00.000000), lt(new0107.lineitem.l_shipdate, 1997-01-01 00:00:00.000000)","Execution Info":"tikv_task:{proc max:589ms, min:269ms, p80:517ms, p95:589ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4063000000,"Max Time":562000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:562ms, min:255ms, p80:494ms, p95:562ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":1,"Actual Rows":50280,"Task":"root","Total Time":13491909510,"Max Time":3077403281,"Access Object":"","Operation Info":"data:TableRangeScan_11","Execution Info":"time:13.5s, loops:65, cop_task: {num: 10, max: 2.98s, min: 196.7ms, avg: 1.32s, p95: 2.98s, max_proc_keys: 18315, p95_proc_keys: 18315, tot_proc: 11.3s, tot_wait: 1.01s, rpc_num: 19, rpc_time: 26.1s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":50280,"Task":"cop[tikv]","Total Time":550000000,"Max Time":166000000,"Access Object":"","Operation Info":"table:part, range: decided by [new0107.lineitem.l_partkey], keep order:false","Execution Info":"tikv_task:{proc max:166ms, min:2ms, p80:153ms, p95:166ms, iters:89, tasks:10}, scan_detail: {total_process_keys: 50280, total_process_keys_size: 8219074, total_keys: 53310, rocksdb: {delete_skipped_count: 0, key_skipped_count: 6317, block: {cache_hit_count: 61020, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}
/*PLACEHOLDER*/ select  100.00 * sum(case   when p_type like 'PROMO%'    then l_extendedprice * (1 - l_discount)   else 0  end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from  lineitem,  part where  l_partkey = p_partkey  and l_shipdate >= '1996-12-01'  and l_shipdate < date_add('1996-12-01', interval '1' month);

{"Node Id":"Projection","Plan Rows":10,"Actual Rows":10,"Task":"root","Total Time":11113954543,"Max Time":11113954543,"Access Object":"","Operation Info":"new0107.lineitem.l_orderkey, Column#35, new0107.orders.o_orderdate, new0107.orders.o_shippriority","Execution Info":"time:11.1s, loops:2, Concurrency:OFF","Disk":0,"Memory":2544,"Plans":[{"Node Id":"TopN","Plan Rows":10,"Actual Rows":10,"Task":"root","Total Time":11113945827,"Max Time":11113945827,"Access Object":"","Operation Info":"Column#35:desc, new0107.orders.o_orderdate, offset:0, count:10","Execution Info":"time:11.1s, loops:2","Disk":0,"Memory":78560,"Plans":[{"Node Id":"HashAgg","Plan Rows":535774.7154925766,"Actual Rows":7662,"Task":"root","Total Time":11112738910,"Max Time":11112738910,"Access Object":"","Operation Info":"group by:Column#48, Column#49, Column#50, funcs:sum(Column#44)-\u003eColumn#35, funcs:firstrow(Column#45)-\u003enew0107.orders.o_orderdate, funcs:firstrow(Column#46)-\u003enew0107.orders.o_shippriority, funcs:firstrow(Column#47)-\u003enew0107.lineitem.l_orderkey","Execution Info":"time:11.1s, loops:11, partial_worker:{wall_time:11.051443726s, concurrency:5, task_num:21, tot_wait:54.9763211s, tot_exec:181.675842ms, tot_time:55.159160283s, max:11.051331059s, p95:11.051331059s}, final_worker:{wall_time:11.11408585s, concurrency:5, task_num:25, tot_wait:55.30211999s, tot_exec:67.990951ms, tot_time:55.370126737s, max:11.113771109s, p95:11.113771109s}","Disk":0,"Memory":3435872,"Plans":[{"Node Id":"Projection","Plan Rows":795926.0114565928,"Actual Rows":20167,"Task":"root","Total Time":11001370083,"Max Time":11001370083,"Access Object":"","Operation Info":"mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount))-\u003eColumn#44, new0107.orders.o_orderdate, new0107.orders.o_shippriority, new0107.lineitem.l_orderkey, new0107.lineitem.l_orderkey, new0107.orders.o_orderdate, new0107.orders.o_shippriority","Execution Info":"time:11s, loops:22, Concurrency:5","Disk":0,"Memory":682724,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":795926.0114565928,"Actual Rows":20167,"Task":"root","Total Time":11000863300,"Max Time":11000863300,"Access Object":"","Operation Info":"inner join, inner:IndexLookUp_27, outer key:new0107.orders.o_orderkey, inner key:new0107.lineitem.l_orderkey, equal cond:eq(new0107.orders.o_orderkey, new0107.lineitem.l_orderkey)","Execution Info":"time:11s, loops:22, inner:{total:43.5s, concurrency:5, task:12, construct:474.8ms, fetch:42.6s, build:91.3ms, join:438.8ms}","Disk":0,"Memory":23285182,"Plans":[{"Node Id":"HashJoin","Plan Rows":196313.84992738423,"Actual Rows":96277,"Task":"root","Total Time":667109634,"Max Time":667109634,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.customer.c_custkey, new0107.orders.o_custkey)]","Execution Info":"time:667.1ms, loops:100, build_hash_table:{total:124.7ms, fetch:103.8ms, build:21ms}, probe:{concurrency:5, total:17.6s, max:3.53s, probe:15.7s, fetch:1.97s}","Disk":0,"Memory":977192,"Plans":[{"Node Id":"TableReader","Plan Rows":21774,"Actual Rows":29752,"Task":"root","Total Time":102760060,"Max Time":102760060,"Access Object":"","Operation Info":"data:Selection_75","Execution Info":"time:102.8ms, loops:30, cop_task: {num: 1, max: 103.2ms, proc_keys: 0, rpc_num: 1, rpc_time: 103.1ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":778280,"Plans":[{"Node Id":"Selection","Plan Rows":21774,"Actual Rows":29752,"Task":"cop[tikv]","Total Time":164000000,"Max Time":164000000,"Access Object":"","Operation Info":"eq(new0107.customer.c_mktsegment, \"AUTOMOBILE\")","Execution Info":"tikv_task:{time:164ms, loops:151}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":150000,"Actual Rows":150000,"Task":"cop[tikv]","Total Time":138000000,"Max Time":138000000,"Access Object":"","Operation Info":"table:customer, keep order:false","Execution Info":"tikv_task:{time:138ms, loops:151}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":730104.3924398626,"Actual Rows":484673,"Task":"root","Total Time":264407298,"Max Time":264407298,"Access Object":"","Operation Info":"data:Selection_72","Execution Info":"time:264.4ms, loops:473, cop_task: {num: 2, max: 35.2ms, min: 32.4ms, avg: 33.8ms, p95: 35.2ms, rpc_num: 2, rpc_time: 67.5ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":15547598,"Plans":[{"Node Id":"Selection","Plan Rows":730104.3924398626,"Actual Rows":484673,"Task":"cop[tikv]","Total Time":937000000,"Max Time":541000000,"Access Object":"","Operation Info":"lt(new0107.orders.o_orderdate, 1995-03-13 00:00:00.000000)","Execution Info":"tikv_task:{proc max:541ms, min:396ms, p80:541ms, p95:541ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":885000000,"Max Time":510000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:510ms, min:375ms, p80:510ms, p95:510ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"IndexLookUp","Plan Rows":4.054354859583279,"Actual Rows":20167,"Task":"root","Total Time":42024876553,"Max Time":6312458197,"Access Object":"","Operation Info":"","Execution Info":"time:42s, loops:39, index_task: {total_time: 28.9s, fetch_handle: 23.2s, build: 86.8µs, wait: 5.65s}, table_task: {total_time: 1m8.1s, num: 57, concurrency: 60}","Disk":0,"Memory":163344,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":7.484459202807528,"Actual Rows":384652,"Task":"cop[tikv]","Total Time":3996000000,"Max Time":1086000000,"Access Object":"","Operation Info":"table:lineitem, index:PRIMARY(L_ORDERKEY, L_LINENUMBER), range: decided by [eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)], keep order:false","Execution Info":"time:23.1s, loops:412, cop_task: {num: 20, max: 3.2s, min: 51ms, avg: 1.41s, p95: 3.2s, max_proc_keys: 91176, p95_proc_keys: 91176, tot_proc: 24.3s, tot_wait: 1.03s, rpc_num: 39, rpc_time: 53.7s, copr_cache_hit_ratio: 0.00}, tikv_task:{proc max:1.09s, min:1ms, p80:365ms, p95:1.09s, iters:463, tasks:20}, scan_detail: {total_process_keys: 384652, total_process_keys_size: 20386556, total_keys: 480929, rocksdb: {delete_skipped_count: 0, key_skipped_count: 384652, block: {cache_hit_count: 385413, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]},{"Node Id":"Selection","Plan Rows":4.054354859583279,"Actual Rows":20167,"Task":"cop[tikv]","Total Time":2904000000,"Max Time":220000000,"Access Object":"","Operation Info":"gt(new0107.lineitem.l_shipdate, 1995-03-13 00:00:00.000000)","Execution Info":"time:1m7.6s, loops:119, cop_task: {num: 78, max: 3.64s, min: 8.83ms, avg: 1.12s, p95: 2.94s, max_proc_keys: 20480, p95_proc_keys: 20007, tot_proc: 1m17.2s, tot_wait: 4.34s, rpc_num: 155, rpc_time: 2m54.8s, copr_cache_hit_ratio: 0.00}, tikv_task:{proc max:220ms, min:0s, p80:57ms, p95:156ms, iters:718, tasks:78}, scan_detail: {total_process_keys: 384652, total_process_keys_size: 75568360, total_keys: 460371, rocksdb: {delete_skipped_count: 0, key_skipped_count: 373345, block: {cache_hit_count: 296041, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRowIDScan","Plan Rows":7.484459202807528,"Actual Rows":384652,"Task":"cop[tikv]","Total Time":2874000000,"Max Time":220000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:220ms, min:0s, p80:57ms, p95:153ms, iters:718, tasks:78}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  l_orderkey,  sum(l_extendedprice * (1 - l_discount)) as revenue,  o_orderdate,  o_shippriority from  customer,  orders,  lineitem where  c_mktsegment = 'AUTOMOBILE'  and c_custkey = o_custkey  and l_orderkey = o_orderkey  and o_orderdate < '1995-03-13'  and l_shipdate > '1995-03-13' group by  l_orderkey,  o_orderdate,  o_shippriority order by  revenue desc,  o_orderdate limit 10;

{"Node Id":"Sort","Plan Rows":149568,"Actual Rows":33,"Task":"root","Total Time":7659064769,"Max Time":7659064769,"Access Object":"","Operation Info":"Column#19:desc, Column#18:desc","Execution Info":"time:7.66s, loops:2","Disk":0,"Memory":3720,"Plans":[{"Node Id":"Projection","Plan Rows":149568,"Actual Rows":33,"Task":"root","Total Time":7658505594,"Max Time":7658505594,"Access Object":"","Operation Info":"Column#18, Column#19","Execution Info":"time:7.66s, loops:6, Concurrency:5","Disk":0,"Memory":7440,"Plans":[{"Node Id":"HashAgg","Plan Rows":149568,"Actual Rows":33,"Task":"root","Total Time":7658304863,"Max Time":7658304863,"Access Object":"","Operation Info":"group by:Column#18, funcs:count(1)-\u003eColumn#19, funcs:firstrow(Column#18)-\u003eColumn#18","Execution Info":"time:7.66s, loops:6, partial_worker:{wall_time:7.658221503s, concurrency:5, task_num:150, tot_wait:38.217773855s, tot_exec:72.038219ms, tot_time:38.289956446s, max:7.658027017s, p95:7.658027017s}, final_worker:{wall_time:7.659291797s, concurrency:5, task_num:25, tot_wait:38.290754622s, tot_exec:207.319µs, tot_time:38.29096876s, max:7.658215394s, p95:7.658215394s}","Disk":0,"Memory":229446,"Plans":[{"Node Id":"HashAgg","Plan Rows":149568,"Actual Rows":150000,"Task":"root","Total Time":7657574171,"Max Time":7657574171,"Access Object":"","Operation Info":"group by:new0107.customer.c_custkey, funcs:count(new0107.orders.o_orderkey)-\u003eColumn#18","Execution Info":"time:7.66s, loops:151, partial_worker:{wall_time:6.685300361s, concurrency:5, task_num:1021, tot_wait:27.526200191s, tot_exec:2.826460599s, tot_time:32.79848919s, max:6.614491368s, p95:6.614491368s}, final_worker:{wall_time:7.657794856s, concurrency:5, task_num:25, tot_wait:32.761428588s, tot_exec:4.629352945s, tot_time:37.390808402s, max:7.657664645s, p95:7.657664645s}","Disk":0,"Memory":59674807,"Plans":[{"Node Id":"HashJoin","Plan Rows":878254.1720154043,"Actual Rows":1040728,"Task":"root","Total Time":5888907139,"Max Time":5888907139,"Access Object":"","Operation Info":"left outer join, equal:[eq(new0107.customer.c_custkey, new0107.orders.o_custkey)]","Execution Info":"time:5.89s, loops:1022, build_hash_table:{total:843.9ms, fetch:294.6ms, build:549.3ms}, probe:{concurrency:5, total:29.4s, max:5.89s, probe:12.7s, fetch:16.7s}","Disk":0,"Memory":1262960,"Plans":[{"Node Id":"TableReader","Plan Rows":150000,"Actual Rows":150000,"Task":"root","Total Time":264468418,"Max Time":264468418,"Access Object":"","Operation Info":"data:TableFullScan_17","Execution Info":"time:264.5ms, loops:148, cop_task: {num: 1, max: 263.3ms, proc_keys: 0, rpc_num: 1, rpc_time: 263.3ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":1202298,"Plans":[{"Node Id":"TableFullScan","Plan Rows":150000,"Actual Rows":150000,"Task":"cop[tikv]","Total Time":89000000,"Max Time":89000000,"Access Object":"","Operation Info":"table:customer, keep order:false","Execution Info":"tikv_task:{time:89ms, loops:151}","Disk":0,"Memory":0,"Plans":[]}]},{"Node Id":"TableReader","Plan Rows":875724.8,"Actual Rows":990658,"Task":"root","Total Time":3230526840,"Max Time":3230526840,"Access Object":"","Operation Info":"data:Selection_20","Execution Info":"time:3.23s, loops:980, cop_task: {num: 2, max: 3.59s, min: 3.22s, avg: 3.41s, p95: 3.59s, max_proc_keys: 583494, p95_proc_keys: 583494, tot_proc: 6.07s, tot_wait: 90ms, rpc_num: 2, rpc_time: 6.82s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":71780726,"Plans":[{"Node Id":"Selection","Plan Rows":875724.8,"Actual Rows":990658,"Task":"cop[tikv]","Total Time":2276000000,"Max Time":1351000000,"Access Object":"","Operation Info":"not(like(new0107.orders.o_comment, \"%pending%deposits%\", 92))","Execution Info":"tikv_task:{proc max:1.35s, min:925ms, p80:1.35s, p95:1.35s, iters:987, tasks:2}, scan_detail: {total_process_keys: 1001472, total_process_keys_size: 151717700, total_keys: 1001474, rocksdb: {delete_skipped_count: 0, key_skipped_count: 1001472, block: {cache_hit_count: 2529, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":1463000000,"Max Time":910000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:910ms, min:553ms, p80:910ms, p95:910ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  c_count,  count(*) as custdist from  (   select    c_custkey,    count(o_orderkey) as c_count   from    customer left outer join orders on     c_custkey = o_custkey     and o_comment not like '%pending%deposits%'   group by    c_custkey  ) c_orders group by  c_count order by  custdist desc,  c_count desc;

{"Node Id":"Sort","Plan Rows":8.43216,"Actual Rows":18333,"Task":"root","Total Time":5497696471,"Max Time":5497696471,"Access Object":"","Operation Info":"Column#23:desc, new0107.part.p_brand, new0107.part.p_type, new0107.part.p_size","Execution Info":"time:5.5s, loops:19","Disk":0,"Memory":1362656,"Plans":[{"Node Id":"Projection","Plan Rows":8.43216,"Actual Rows":18333,"Task":"root","Total Time":5312589344,"Max Time":5312589344,"Access Object":"","Operation Info":"new0107.part.p_brand, new0107.part.p_type, new0107.part.p_size, Column#23","Execution Info":"time:5.31s, loops:19, Concurrency:OFF","Disk":0,"Memory":1328656,"Plans":[{"Node Id":"HashAgg","Plan Rows":8.43216,"Actual Rows":18333,"Task":"root","Total Time":5311363323,"Max Time":5311363323,"Access Object":"","Operation Info":"group by:new0107.part.p_brand, new0107.part.p_size, new0107.part.p_type, funcs:count(distinct new0107.partsupp.ps_suppkey)-\u003eColumn#23, funcs:firstrow(new0107.part.p_brand)-\u003enew0107.part.p_brand, funcs:firstrow(new0107.part.p_type)-\u003enew0107.part.p_type, funcs:firstrow(new0107.part.p_size)-\u003enew0107.part.p_size","Execution Info":"time:5.31s, loops:19","Disk":0,"Memory":8761243,"Plans":[{"Node Id":"HashJoin","Plan Rows":45665.63769293257,"Actual Rows":119078,"Task":"root","Total Time":3825865550,"Max Time":3825865550,"Access Object":"","Operation Info":"anti semi join, equal:[eq(new0107.partsupp.ps_suppkey, new0107.supplier.s_suppkey)]","Execution Info":"time:3.83s, loops:119, build_hash_table:{total:2.74s, fetch:2.74s, build:9.32µs}, probe:{concurrency:5, total:26.2s, max:5.23s, probe:5.55s, fetch:20.6s}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"Projection","Plan Rows":57082.04711616571,"Actual Rows":119136,"Task":"root","Total Time":1829690690,"Max Time":1829690690,"Access Object":"","Operation Info":"new0107.partsupp.ps_suppkey, new0107.part.p_brand, new0107.part.p_type, new0107.part.p_size","Execution Info":"time:1.83s, loops:121, Concurrency:5","Disk":0,"Memory":760800,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":57082.04711616571,"Actual Rows":119136,"Task":"root","Total Time":5000071949,"Max Time":5000071949,"Access Object":"","Operation Info":"inner join, inner:IndexReader_33, outer key:new0107.part.p_partkey, inner key:new0107.partsupp.ps_partkey, equal cond:eq(new0107.part.p_partkey, new0107.partsupp.ps_partkey)","Execution Info":"time:5s, loops:121, inner:{total:17.6s, concurrency:5, task:9, construct:49.5ms, fetch:15.4s, build:17.9ms, join:2.14s}","Disk":0,"Memory":9038005,"Plans":[{"Node Id":"TableReader","Plan Rows":14053.599999999999,"Actual Rows":29784,"Task":"root","Total Time":54826883,"Max Time":54826883,"Access Object":"","Operation Info":"data:Selection_60","Execution Info":"time:54.8ms, loops:35, cop_task: {num: 1, max: 52.4ms, proc_keys: 0, rpc_num: 1, rpc_time: 52.4ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":1817788,"Plans":[{"Node Id":"Selection","Plan Rows":14053.599999999999,"Actual Rows":29784,"Task":"cop[tikv]","Total Time":324000000,"Max Time":324000000,"Access Object":"","Operation Info":"in(new0107.part.p_size, 48, 19, 12, 4, 41, 7, 21, 39), ne(new0107.part.p_brand, \"Brand#34\"), not(like(new0107.part.p_type, \"LARGE BRUSHED%\", 92))","Execution Info":"tikv_task:{time:324ms, loops:200}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":200000,"Actual Rows":200000,"Task":"cop[tikv]","Total Time":261000000,"Max Time":261000000,"Access Object":"","Operation Info":"table:part, keep order:false","Execution Info":"tikv_task:{time:261ms, loops:200}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"IndexReader","Plan Rows":4.061738424045491,"Actual Rows":119136,"Task":"root","Total Time":15385092571,"Max Time":2973412274,"Access Object":"","Operation Info":"index:IndexRangeScan_32","Execution Info":"time:15.4s, loops:133, cop_task: {num: 9, max: 2.94s, min: 71ms, avg: 1.69s, p95: 2.94s, max_proc_keys: 53228, p95_proc_keys: 53228, tot_proc: 14.4s, tot_wait: 404ms, rpc_num: 17, rpc_time: 30.4s, copr_cache_hit_ratio: 0.11}","Disk":0,"Memory":15278,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":4.061738424045491,"Actual Rows":119136,"Task":"cop[tikv]","Total Time":874000000,"Max Time":293000000,"Access Object":"","Operation Info":"table:partsupp, index:PRIMARY(PS_PARTKEY, PS_SUPPKEY), range: decided by [eq(new0107.partsupp.ps_partkey, new0107.part.p_partkey)], keep order:false","Execution Info":"tikv_task:{proc max:293ms, min:2ms, p80:282ms, p95:293ms, iters:159, tasks:9}, scan_detail: {total_process_keys: 117188, total_process_keys_size: 6210964, total_keys: 146485, rocksdb: {delete_skipped_count: 0, key_skipped_count: 117188, block: {cache_hit_count: 117275, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"TableReader","Plan Rows":8000,"Actual Rows":4,"Task":"root","Total Time":2734980404,"Max Time":2734980404,"Access Object":"","Operation Info":"data:Selection_67","Execution Info":"time:2.73s, loops:2, cop_task: {num: 1, max: 2.72s, proc_keys: 10000, tot_proc: 2.65s, tot_wait: 28ms, rpc_num: 1, rpc_time: 2.72s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":605,"Plans":[{"Node Id":"Selection","Plan Rows":8000,"Actual Rows":4,"Task":"cop[tikv]","Total Time":16000000,"Max Time":16000000,"Access Object":"","Operation Info":"like(new0107.supplier.s_comment, \"%Customer%Complaints%\", 92)","Execution Info":"tikv_task:{time:16ms, loops:14}, scan_detail: {total_process_keys: 10000, total_process_keys_size: 1815466, total_keys: 10001, rocksdb: {delete_skipped_count: 0, key_skipped_count: 10000, block: {cache_hit_count: 33, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":10000,"Actual Rows":10000,"Task":"cop[tikv]","Total Time":9000000,"Max Time":9000000,"Access Object":"","Operation Info":"table:supplier, keep order:false","Execution Info":"tikv_task:{time:9ms, loops:14}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  p_brand,  p_type,  p_size,  count(distinct ps_suppkey) as supplier_cnt from  partsupp,  part where  p_partkey = ps_partkey  and p_brand <> 'Brand#34'  and p_type not like 'LARGE BRUSHED%'  and p_size in (48, 19, 12, 4, 41, 7, 21, 39)  and ps_suppkey not in (   select    s_suppkey   from    supplier   where    s_comment like '%Customer%Complaints%'  ) group by  p_brand,  p_type,  p_size order by  supplier_cnt desc,  p_brand,  p_type,  p_size;

{"Node Id":"Sort","Plan Rows":1,"Actual Rows":5,"Task":"root","Total Time":11034953027,"Max Time":11034953027,"Access Object":"","Operation Info":"new0107.orders.o_orderpriority","Execution Info":"time:11s, loops:2","Disk":0,"Memory":4000,"Plans":[{"Node Id":"Projection","Plan Rows":1,"Actual Rows":5,"Task":"root","Total Time":11034912961,"Max Time":11034912961,"Access Object":"","Operation Info":"new0107.orders.o_orderpriority, Column#27","Execution Info":"time:11s, loops:5, Concurrency:OFF","Disk":0,"Memory":1000,"Plans":[{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":5,"Task":"root","Total Time":11034903978,"Max Time":11034903978,"Access Object":"","Operation Info":"group by:new0107.orders.o_orderpriority, funcs:count(1)-\u003eColumn#27, funcs:firstrow(new0107.orders.o_orderpriority)-\u003enew0107.orders.o_orderpriority","Execution Info":"time:11s, loops:5, partial_worker:{wall_time:11.034874671s, concurrency:5, task_num:34, tot_wait:55.079795827s, tot_exec:31.878462ms, tot_time:55.111726389s, max:11.033959337s, p95:11.033959337s}, final_worker:{wall_time:0s, concurrency:5, task_num:20, tot_wait:55.170257083s, tot_exec:118.074µs, tot_time:55.170381947s, max:11.034089153s, p95:11.034089153s}","Disk":0,"Memory":382731,"Plans":[{"Node Id":"IndexJoin","Plan Rows":33363.37979381443,"Actual Rows":34630,"Task":"root","Total Time":11005947931,"Max Time":11005947931,"Access Object":"","Operation Info":"semi join, inner:IndexLookUp_18, outer key:new0107.orders.o_orderkey, inner key:new0107.lineitem.l_orderkey, equal cond:eq(new0107.orders.o_orderkey, new0107.lineitem.l_orderkey)","Execution Info":"time:11s, loops:35, inner:{total:40.3s, concurrency:5, task:10, construct:272.1ms, fetch:39.4s, build:652.6ms}, probe:265.9ms","Disk":0,"Memory":10434729,"Plans":[{"Node Id":"TableReader","Plan Rows":41704.22474226803,"Actual Rows":37775,"Task":"root","Total Time":303138360,"Max Time":303138360,"Access Object":"","Operation Info":"data:Selection_39","Execution Info":"time:303.1ms, loops:42, cop_task: {num: 2, max: 324.7ms, min: 299.2ms, avg: 311.9ms, p95: 324.7ms, rpc_num: 2, rpc_time: 623.8ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":1261374,"Plans":[{"Node Id":"Selection","Plan Rows":41704.22474226803,"Actual Rows":37775,"Task":"cop[tikv]","Total Time":934000000,"Max Time":559000000,"Access Object":"","Operation Info":"ge(new0107.orders.o_orderdate, 1995-01-01 00:00:00.000000), lt(new0107.orders.o_orderdate, 1995-04-01 00:00:00.000000)","Execution Info":"tikv_task:{proc max:559ms, min:375ms, p80:559ms, p95:559ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":871000000,"Max Time":519000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:519ms, min:352ms, p80:519ms, p95:519ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"IndexLookUp","Plan Rows":4.054354859583279,"Actual Rows":95181,"Task":"root","Total Time":39288539645,"Max Time":5746379100,"Access Object":"","Operation Info":"","Execution Info":"time:39.3s, loops:110, index_task: {total_time: 11.7s, fetch_handle: 11.7s, build: 79µs, wait: 83.1µs}, table_task: {total_time: 1m15.7s, num: 33, concurrency: 50}","Disk":0,"Memory":211848,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":5.067943574479099,"Actual Rows":150845,"Task":"cop[tikv]","Total Time":1197000000,"Max Time":294000000,"Access Object":"","Operation Info":"table:lineitem, index:PRIMARY(L_ORDERKEY, L_LINENUMBER), range: decided by [eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)], keep order:false","Execution Info":"time:11.5s, loops:174, cop_task: {num: 13, max: 1.52s, min: 102.7ms, avg: 1.11s, p95: 1.52s, max_proc_keys: 36503, p95_proc_keys: 36503, tot_proc: 12.9s, tot_wait: 390ms, rpc_num: 25, rpc_time: 28.7s, copr_cache_hit_ratio: 0.00}, tikv_task:{proc max:294ms, min:3ms, p80:195ms, p95:294ms, iters:206, tasks:13}, scan_detail: {total_process_keys: 150845, total_process_keys_size: 7994785, total_keys: 188620, rocksdb: {delete_skipped_count: 0, key_skipped_count: 150845, block: {cache_hit_count: 151233, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]},{"Node Id":"Selection","Plan Rows":4.054354859583279,"Actual Rows":95181,"Task":"cop[tikv]","Total Time":1692000000,"Max Time":183000000,"Access Object":"","Operation Info":"lt(new0107.lineitem.l_commitdate, new0107.lineitem.l_receiptdate)","Execution Info":"time:1m14.7s, loops:148, cop_task: {num: 43, max: 4.05s, min: 34.4ms, avg: 2.23s, p95: 3.95s, max_proc_keys: 17842, p95_proc_keys: 12133, tot_proc: 1m2.7s, tot_wait: 2.34s, rpc_num: 85, rpc_time: 3m11.7s, copr_cache_hit_ratio: 0.00}, tikv_task:{proc max:183ms, min:0s, p80:55ms, p95:146ms, iters:341, tasks:43}, scan_detail: {total_process_keys: 150845, total_process_keys_size: 29631549, total_keys: 182243, rocksdb: {delete_skipped_count: 0, key_skipped_count: 145875, block: {cache_hit_count: 124027, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRowIDScan","Plan Rows":5.067943574479099,"Actual Rows":150845,"Task":"cop[tikv]","Total Time":1677000000,"Max Time":183000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:183ms, min:0s, p80:55ms, p95:144ms, iters:341, tasks:43}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  o_orderpriority,  count(*) as order_count from  orders where  o_orderdate >= '1995-01-01'  and o_orderdate < date_add('1995-01-01', interval '3' month)  and exists (   select    *   from    lineitem   where    l_orderkey = o_orderkey    and l_commitdate < l_receiptdate  ) group by  o_orderpriority order by  o_orderpriority;

{"Node Id":"Projection","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":3995637188,"Max Time":3995637188,"Access Object":"","Operation Info":"div(mul(100.00, Column#27), Column#28)-\u003eColumn#29","Execution Info":"time:4s, loops:2, Concurrency:OFF","Disk":0,"Memory":2856,"Plans":[{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":3995618451,"Max Time":3995618451,"Access Object":"","Operation Info":"funcs:sum(Column#31)-\u003eColumn#27, funcs:sum(Column#32)-\u003eColumn#28","Execution Info":"time:4s, loops:2, partial_worker:{wall_time:3.995583975s, concurrency:5, task_num:54, tot_wait:19.967206152s, tot_exec:8.478561ms, tot_time:19.975734522s, max:3.995155326s, p95:3.995155326s}, final_worker:{wall_time:3.995755363s, concurrency:5, task_num:5, tot_wait:19.975972919s, tot_exec:34.647µs, tot_time:19.976011199s, max:3.995226643s, p95:3.995226643s}","Disk":0,"Memory":955816,"Plans":[{"Node Id":"Projection","Plan Rows":51569.74907482635,"Actual Rows":51967,"Task":"root","Total Time":3994652468,"Max Time":3994652468,"Access Object":"","Operation Info":"case(like(new0107.part.p_type, PROMO%, 92), mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount)), 0)-\u003eColumn#31, mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount))-\u003eColumn#32","Execution Info":"time:3.99s, loops:55, Concurrency:5","Disk":0,"Memory":1059912,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":51569.74907482635,"Actual Rows":51967,"Task":"root","Total Time":3930029656,"Max Time":3930029656,"Access Object":"","Operation Info":"inner join, inner:TableReader_12, outer key:new0107.lineitem.l_partkey, inner key:new0107.part.p_partkey, equal cond:eq(new0107.lineitem.l_partkey, new0107.part.p_partkey)","Execution Info":"time:3.93s, loops:55, inner:{total:15.1s, concurrency:5, task:10, construct:334.6ms, fetch:14.1s, build:9.14ms, join:619.4ms}","Disk":0,"Memory":13626445,"Plans":[{"Node Id":"TableReader","Plan Rows":50785.88888888899,"Actual Rows":51967,"Task":"root","Total Time":1317326094,"Max Time":1317326094,"Access Object":"","Operation Info":"data:Selection_23","Execution Info":"time:1.32s, loops:56, cop_task: {num: 9, max: 1.32s, min: 88.7ms, avg: 518.1ms, p95: 1.32s, rpc_num: 9, rpc_time: 4.66s, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":1759545,"Plans":[{"Node Id":"Selection","Plan Rows":50785.88888888899,"Actual Rows":51967,"Task":"cop[tikv]","Total Time":4273000000,"Max Time":589000000,"Access Object":"","Operation Info":"ge(new0107.lineitem.l_shipdate, 1996-12-01 00:00:00.000000), lt(new0107.lineitem.l_shipdate, 1997-01-01 00:00:00.000000)","Execution Info":"tikv_task:{proc max:589ms, min:269ms, p80:517ms, p95:589ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4063000000,"Max Time":562000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:562ms, min:255ms, p80:494ms, p95:562ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":1,"Actual Rows":50182,"Task":"root","Total Time":13880634809,"Max Time":2707190426,"Access Object":"","Operation Info":"data:TableRangeScan_11","Execution Info":"time:13.9s, loops:66, cop_task: {num: 10, max: 2.65s, min: 110.9ms, avg: 1.33s, p95: 2.65s, max_proc_keys: 18248, p95_proc_keys: 18248, tot_proc: 5.08s, tot_wait: 737ms, rpc_num: 19, rpc_time: 26.6s, copr_cache_hit_ratio: 0.10}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":50182,"Task":"cop[tikv]","Total Time":650000000,"Max Time":272000000,"Access Object":"","Operation Info":"table:part, range: decided by [new0107.lineitem.l_partkey], keep order:false","Execution Info":"tikv_task:{proc max:272ms, min:1ms, p80:181ms, p95:272ms, iters:90, tasks:10}, scan_detail: {total_process_keys: 49926, total_process_keys_size: 8161072, total_keys: 53028, rocksdb: {delete_skipped_count: 0, key_skipped_count: 6452, block: {cache_hit_count: 60587, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}
/*PLACEHOLDER*/ select  100.00 * sum(case   when p_type like 'PROMO%'    then l_extendedprice * (1 - l_discount)   else 0  end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from  lineitem,  part where  l_partkey = p_partkey  and l_shipdate >= '1996-12-01'  and l_shipdate < date_add('1996-12-01', interval '1' month);

{"Node Id":"Sort","Plan Rows":338.09908020009675,"Actual Rows":2,"Task":"root","Total Time":15408696589,"Max Time":15408696589,"Access Object":"","Operation Info":"Column#62","Execution Info":"time:15.4s, loops:2","Disk":0,"Memory":3600,"Plans":[{"Node Id":"Projection","Plan Rows":338.09908020009675,"Actual Rows":2,"Task":"root","Total Time":15408666026,"Max Time":15408666026,"Access Object":"","Operation Info":"Column#62, div(Column#64, Column#65)-\u003eColumn#66","Execution Info":"time:15.4s, loops:3, Concurrency:OFF","Disk":0,"Memory":3228,"Plans":[{"Node Id":"HashAgg","Plan Rows":338.09908020009675,"Actual Rows":2,"Task":"root","Total Time":15408650085,"Max Time":15408650085,"Access Object":"","Operation Info":"group by:Column#78, funcs:sum(Column#75)-\u003eColumn#64, funcs:sum(Column#76)-\u003eColumn#65, funcs:firstrow(Column#77)-\u003eColumn#62","Execution Info":"time:15.4s, loops:3, partial_worker:{wall_time:15.40860965s, concurrency:5, task_num:2, tot_wait:1m16.399061708s, tot_exec:481.861µs, tot_time:1m16.399553284s, max:15.279919933s, p95:15.279919933s}, final_worker:{wall_time:0s, concurrency:5, task_num:4, tot_wait:1m16.398888071s, tot_exec:46.121µs, tot_time:1m16.398937639s, max:15.279805475s, p95:15.279805475s}","Disk":0,"Memory":240419,"Plans":[{"Node Id":"Projection","Plan Rows":723,"Actual Rows":1704,"Task":"root","Total Time":15280025004,"Max Time":15280025004,"Access Object":"","Operation Info":"case(eq(new0107.nation.n_name, INDIA), mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount)), 0)-\u003eColumn#75, mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount))-\u003eColumn#76, extract(YEAR, new0107.orders.o_orderdate)-\u003eColumn#77, extract(YEAR, new0107.orders.o_orderdate)-\u003eColumn#78","Execution Info":"time:15.3s, loops:3, Concurrency:OFF","Disk":0,"Memory":111608,"Plans":[{"Node Id":"Projection","Plan Rows":723,"Actual Rows":1704,"Task":"root","Total Time":15278864434,"Max Time":15278864434,"Access Object":"","Operation Info":"new0107.lineitem.l_extendedprice, new0107.lineitem.l_discount, new0107.orders.o_orderdate, new0107.nation.n_name","Execution Info":"time:15.3s, loops:3, Concurrency:OFF","Disk":0,"Memory":185184,"Plans":[{"Node Id":"HashJoin","Plan Rows":723,"Actual Rows":1704,"Task":"root","Total Time":15278808170,"Max Time":15278808170,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.supplier.s_nationkey, new0107.nation.n_nationkey)]","Execution Info":"time:15.3s, loops:3, build_hash_table:{total:429.6ms, fetch:429.6ms, build:20.3µs}, probe:{concurrency:5, total:1m16.4s, max:15.3s, probe:2.48ms, fetch:1m16.4s}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"IndexJoin","Plan Rows":723,"Actual Rows":1704,"Task":"root","Total Time":15277685214,"Max Time":15277685214,"Access Object":"","Operation Info":"inner join, inner:TableReader_47, outer key:new0107.lineitem.l_suppkey, inner key:new0107.supplier.s_suppkey, equal cond:eq(new0107.lineitem.l_suppkey, new0107.supplier.s_suppkey)","Execution Info":"time:15.3s, loops:3, inner:{total:5.72s, concurrency:5, task:5, construct:2.02ms, fetch:5.72s, build:786.5µs}, probe:47.5ms","Disk":0,"Memory":736613,"Plans":[{"Node Id":"IndexJoin","Plan Rows":723,"Actual Rows":1704,"Task":"root","Total Time":15034369439,"Max Time":15034369439,"Access Object":"","Operation Info":"inner join, inner:TableReader_59, outer key:new0107.lineitem.l_partkey, inner key:new0107.part.p_partkey, equal cond:eq(new0107.lineitem.l_partkey, new0107.part.p_partkey)","Execution Info":"time:15s, loops:7, inner:{total:31.1s, concurrency:5, task:18, construct:3.43s, fetch:27.7s, build:1.55ms}, probe:700.6ms","Disk":0,"Memory":48272855,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":1370.7736488298992,"Actual Rows":244708,"Task":"root","Total Time":10580929367,"Max Time":10580929367,"Access Object":"","Operation Info":"inner join, inner:IndexLookUp_73, outer key:new0107.orders.o_orderkey, inner key:new0107.lineitem.l_orderkey, equal cond:eq(new0107.orders.o_orderkey, new0107.lineitem.l_orderkey)","Execution Info":"time:10.6s, loops:243, inner:{total:34.7s, concurrency:5, task:11, construct:374.8ms, fetch:32s, build:12ms, join:2.26s}","Disk":0,"Memory":38051981,"Plans":[{"Node Id":"HashJoin","Plan Rows":338.09908020009675,"Actual Rows":61273,"Task":"root","Total Time":1244446285,"Max Time":1244446285,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.customer.c_custkey, new0107.orders.o_custkey)]","Execution Info":"time:1.24s, loops:64, build_hash_table:{total:759.7ms, fetch:716.5ms, build:43.2ms}, probe:{concurrency:5, total:5.74s, max:1.18s, probe:971.7ms, fetch:4.76s}","Disk":0,"Memory":293088,"Plans":[{"Node Id":"HashJoin","Plan Rows":37.5,"Actual Rows":30183,"Task":"root","Total Time":749740836,"Max Time":749740836,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.customer.c_nationkey)]","Execution Info":"time:749.7ms, loops:35, build_hash_table:{total:436.2ms, fetch:436.2ms, build:7.61µs}, probe:{concurrency:5, total:3.69s, max:755.9ms, probe:1.47s, fetch:2.22s}","Disk":0,"Memory":372,"Plans":[{"Node Id":"HashJoin","Plan Rows":0.00625,"Actual Rows":5,"Task":"root","Total Time":436188831,"Max Time":436188831,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.region.r_regionkey, new0107.nation.n_regionkey)]","Execution Info":"time:436.2ms, loops:2, build_hash_table:{total:429.5ms, fetch:429.5ms, build:4.16µs}, probe:{concurrency:5, total:2.17s, max:436.1ms, probe:20.5µs, fetch:2.17s}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":0.005,"Actual Rows":1,"Task":"root","Total Time":429450539,"Max Time":429450539,"Access Object":"","Operation Info":"data:Selection_105","Execution Info":"time:429.5ms, loops:2, cop_task: {num: 1, max: 403.1ms, proc_keys: 5, rpc_num: 1, rpc_time: 403ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":248,"Plans":[{"Node Id":"Selection","Plan Rows":0.005,"Actual Rows":1,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"eq(new0107.region.r_name, \"ASIA\")","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 5, total_process_keys_size: 559, total_keys: 6, rocksdb: {delete_skipped_count: 0, key_skipped_count: 5, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":5,"Actual Rows":5,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:region, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":25,"Actual Rows":25,"Task":"root","Total Time":429237945,"Max Time":429237945,"Access Object":"","Operation Info":"data:TableFullScan_102","Execution Info":"time:429.2ms, loops:2, cop_task: {num: 1, max: 400.6ms, proc_keys: 25, rpc_num: 1, rpc_time: 400.6ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":615,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:n1, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":150000,"Actual Rows":150000,"Task":"root","Total Time":429807130,"Max Time":429807130,"Access Object":"","Operation Info":"data:TableFullScan_107","Execution Info":"time:429.8ms, loops:148, cop_task: {num: 1, max: 400.7ms, proc_keys: 0, rpc_num: 1, rpc_time: 400.7ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":2403799,"Plans":[{"Node Id":"TableFullScan","Plan Rows":150000,"Actual Rows":150000,"Task":"cop[tikv]","Total Time":110000000,"Max Time":110000000,"Access Object":"","Operation Info":"table:customer, keep order:false","Execution Info":"tikv_task:{time:110ms, loops:151}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":335928.1222794716,"Actual Rows":305307,"Task":"root","Total Time":483466821,"Max Time":483466821,"Access Object":"","Operation Info":"data:Selection_110","Execution Info":"time:483.5ms, loops:299, cop_task: {num: 2, max: 455.4ms, min: 401.5ms, avg: 428.5ms, p95: 455.4ms, rpc_num: 2, rpc_time: 856.9ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":7357216,"Plans":[{"Node Id":"Selection","Plan Rows":335928.1222794716,"Actual Rows":305307,"Task":"cop[tikv]","Total Time":981000000,"Max Time":541000000,"Access Object":"","Operation Info":"ge(new0107.orders.o_orderdate, 1995-01-01 00:00:00.000000), le(new0107.orders.o_orderdate, 1996-12-31 00:00:00.000000)","Execution Info":"tikv_task:{proc max:541ms, min:440ms, p80:541ms, p95:541ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":925000000,"Max Time":507000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:507ms, min:418ms, p80:507ms, p95:507ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"IndexLookUp","Plan Rows":4.054354859583279,"Actual Rows":244708,"Task":"root","Total Time":31680237085,"Max Time":5716974497,"Access Object":"","Operation Info":"","Execution Info":"time:31.7s, loops:257, index_task: {total_time: 15.4s, fetch_handle: 14.4s, build: 82.3µs, wait: 1.04s}, table_task: {total_time: 45.6s, num: 46, concurrency: 55}","Disk":0,"Memory":573864,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":4.054354859583279,"Actual Rows":244708,"Task":"cop[tikv]","Total Time":2129000000,"Max Time":447000000,"Access Object":"","Operation Info":"table:lineitem, index:PRIMARY(L_ORDERKEY, L_LINENUMBER), range: decided by [eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)], keep order:false","Execution Info":"time:14.4s, loops:271, cop_task: {num: 18, max: 1.85s, min: 125.2ms, avg: 1.15s, p95: 1.85s, max_proc_keys: 57319, p95_proc_keys: 57319, tot_proc: 16.4s, tot_wait: 1.32s, rpc_num: 35, rpc_time: 39.8s, copr_cache_hit_ratio: 0.00}, tikv_task:{proc max:447ms, min:3ms, p80:235ms, p95:447ms, iters:322, tasks:18}, scan_detail: {total_process_keys: 244708, total_process_keys_size: 12969524, total_keys: 305981, rocksdb: {delete_skipped_count: 0, key_skipped_count: 244708, block: {cache_hit_count: 245262, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]},{"Node Id":"TableRowIDScan","Plan Rows":4.054354859583279,"Actual Rows":244708,"Task":"cop[tikv]","Total Time":2017000000,"Max Time":153000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"time:45.3s, loops:313, cop_task: {num: 66, max: 2.91s, min: 55.6ms, avg: 1.05s, p95: 2.84s, max_proc_keys: 19613, p95_proc_keys: 11232, tot_proc: 1m0.8s, tot_wait: 3.01s, rpc_num: 131, rpc_time: 2m18.9s, copr_cache_hit_ratio: 0.02}, tikv_task:{proc max:153ms, min:0s, p80:48ms, p95:100ms, iters:527, tasks:66}, scan_detail: {total_process_keys: 242692, total_process_keys_size: 47659159, total_keys: 291872, rocksdb: {delete_skipped_count: 0, key_skipped_count: 234831, block: {cache_hit_count: 193620, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":0.003615,"Actual Rows":1616,"Task":"root","Total Time":25931918591,"Max Time":3845335764,"Access Object":"","Operation Info":"data:Selection_58","Execution Info":"time:25.9s, loops:36, cop_task: {num: 18, max: 3.55s, min: 40.5ms, avg: 1.35s, p95: 3.55s, max_proc_keys: 24090, p95_proc_keys: 24090, tot_proc: 15.7s, tot_wait: 1.05s, rpc_num: 35, rpc_time: 48.7s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":0,"Plans":[{"Node Id":"Selection","Plan Rows":0.003615,"Actual Rows":1616,"Task":"cop[tikv]","Total Time":2718000000,"Max Time":362000000,"Access Object":"","Operation Info":"eq(new0107.part.p_type, \"SMALL PLATED COPPER\")","Execution Info":"tikv_task:{proc max:362ms, min:10ms, p80:300ms, p95:362ms, iters:310, tasks:18}, scan_detail: {total_process_keys: 231333, total_process_keys_size: 37810388, total_keys: 253174, rocksdb: {delete_skipped_count: 0, key_skipped_count: 46573, block: {cache_hit_count: 285928, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":231333,"Task":"cop[tikv]","Total Time":2678000000,"Max Time":360000000,"Access Object":"","Operation Info":"table:part, range: decided by [new0107.lineitem.l_partkey], keep order:false","Execution Info":"tikv_task:{proc max:360ms, min:9ms, p80:295ms, p95:360ms, iters:310, tasks:18}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"TableReader","Plan Rows":1,"Actual Rows":1584,"Task":"root","Total Time":5719348864,"Max Time":2621600080,"Access Object":"","Operation Info":"data:TableRangeScan_46","Execution Info":"time:5.72s, loops:10, cop_task: {num: 5, max: 2.61s, min: 145.2ms, avg: 1.09s, p95: 2.61s, max_proc_keys: 676, p95_proc_keys: 676, tot_proc: 3.86s, tot_wait: 221ms, rpc_num: 9, rpc_time: 10.6s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":1584,"Task":"cop[tikv]","Total Time":43000000,"Max Time":16000000,"Access Object":"","Operation Info":"table:supplier, range: decided by [new0107.lineitem.l_suppkey], keep order:false","Execution Info":"tikv_task:{proc max:16ms, min:1ms, p80:16ms, p95:16ms, iters:18, tasks:5}, scan_detail: {total_process_keys: 1584, total_process_keys_size: 286783, total_keys: 1654, rocksdb: {delete_skipped_count: 0, key_skipped_count: 144, block: {cache_hit_count: 1914, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":25,"Actual Rows":25,"Task":"root","Total Time":429562117,"Max Time":429562117,"Access Object":"","Operation Info":"data:TableFullScan_119","Execution Info":"time:429.6ms, loops:2, cop_task: {num: 1, max: 402.1ms, proc_keys: 25, rpc_num: 1, rpc_time: 402.1ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":800,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:n2, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  o_year,  sum(case   when nation = 'INDIA' then volume   else 0  end) / sum(volume) as mkt_share from  (   select    extract(year from o_orderdate) as o_year,    l_extendedprice * (1 - l_discount) as volume,    n2.n_name as nation   from    part,    supplier,    lineitem,    orders,    customer,    nation n1,    nation n2,    region   where    p_partkey = l_partkey    and s_suppkey = l_suppkey    and l_orderkey = o_orderkey    and o_custkey = c_custkey    and c_nationkey = n1.n_nationkey    and n1.n_regionkey = r_regionkey    and r_name = 'ASIA'    and s_nationkey = n2.n_nationkey    and o_orderdate between '1995-01-01' and '1996-12-31'    and p_type = 'SMALL PLATED COPPER'  ) as all_nations group by  o_year order by  o_year;

{"Node Id":"Sort","Plan Rows":1,"Actual Rows":5,"Task":"root","Total Time":7822437308,"Max Time":7822437308,"Access Object":"","Operation Info":"new0107.orders.o_orderpriority","Execution Info":"time:7.82s, loops:2","Disk":0,"Memory":4000,"Plans":[{"Node Id":"Projection","Plan Rows":1,"Actual Rows":5,"Task":"root","Total Time":7821905104,"Max Time":7821905104,"Access Object":"","Operation Info":"new0107.orders.o_orderpriority, Column#27","Execution Info":"time:7.82s, loops:5, Concurrency:OFF","Disk":0,"Memory":1000,"Plans":[{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":5,"Task":"root","Total Time":7821886875,"Max Time":7821886875,"Access Object":"","Operation Info":"group by:new0107.orders.o_orderpriority, funcs:count(1)-\u003eColumn#27, funcs:firstrow(new0107.orders.o_orderpriority)-\u003enew0107.orders.o_orderpriority","Execution Info":"time:7.82s, loops:5, partial_worker:{wall_time:7.821756379s, concurrency:5, task_num:34, tot_wait:39.004548918s, tot_exec:35.576538ms, tot_time:39.040205055s, max:7.821059655s, p95:7.821059655s}, final_worker:{wall_time:0s, concurrency:5, task_num:20, tot_wait:39.083849046s, tot_exec:458.377µs, tot_time:39.084317822s, max:7.821755939s, p95:7.821755939s}","Disk":0,"Memory":379901,"Plans":[{"Node Id":"IndexJoin","Plan Rows":33363.37979381443,"Actual Rows":34630,"Task":"root","Total Time":7795641542,"Max Time":7795641542,"Access Object":"","Operation Info":"semi join, inner:IndexLookUp_18, outer key:new0107.orders.o_orderkey, inner key:new0107.lineitem.l_orderkey, equal cond:eq(new0107.orders.o_orderkey, new0107.lineitem.l_orderkey)","Execution Info":"time:7.8s, loops:35, inner:{total:27s, concurrency:5, task:10, construct:435.1ms, fetch:26.5s, build:113.4ms}, probe:199.5ms","Disk":0,"Memory":10435251,"Plans":[{"Node Id":"TableReader","Plan Rows":41704.22474226803,"Actual Rows":37775,"Task":"root","Total Time":236713348,"Max Time":236713348,"Access Object":"","Operation Info":"data:Selection_39","Execution Info":"time:236.7ms, loops:42, cop_task: {num: 2, max: 107ms, min: 81.1ms, avg: 94ms, p95: 107ms, rpc_num: 2, rpc_time: 188ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":1261374,"Plans":[{"Node Id":"Selection","Plan Rows":41704.22474226803,"Actual Rows":37775,"Task":"cop[tikv]","Total Time":934000000,"Max Time":559000000,"Access Object":"","Operation Info":"ge(new0107.orders.o_orderdate, 1995-01-01 00:00:00.000000), lt(new0107.orders.o_orderdate, 1995-04-01 00:00:00.000000)","Execution Info":"tikv_task:{proc max:559ms, min:375ms, p80:559ms, p95:559ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":871000000,"Max Time":519000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:519ms, min:352ms, p80:519ms, p95:519ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"IndexLookUp","Plan Rows":4.054354859583279,"Actual Rows":95181,"Task":"root","Total Time":25758468351,"Max Time":4705900193,"Access Object":"","Operation Info":"","Execution Info":"time:25.8s, loops:110, index_task: {total_time: 12.7s, fetch_handle: 12.7s, build: 51.9µs, wait: 76.9µs}, table_task: {total_time: 23.6s, num: 33, concurrency: 50}","Disk":0,"Memory":39376,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":5.067943574479099,"Actual Rows":150845,"Task":"cop[tikv]","Total Time":1397000000,"Max Time":358000000,"Access Object":"","Operation Info":"table:lineitem, index:PRIMARY(L_ORDERKEY, L_LINENUMBER), range: decided by [eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)], keep order:false","Execution Info":"time:12.7s, loops:174, cop_task: {num: 13, max: 3.5s, min: 104.7ms, avg: 999.8ms, p95: 3.5s, max_proc_keys: 36503, p95_proc_keys: 36503, tot_proc: 6.4s, tot_wait: 789ms, rpc_num: 25, rpc_time: 25.9s, copr_cache_hit_ratio: 0.15}, tikv_task:{proc max:358ms, min:3ms, p80:223ms, p95:358ms, iters:206, tasks:13}, scan_detail: {total_process_keys: 149042, total_process_keys_size: 7899226, total_keys: 186361, rocksdb: {delete_skipped_count: 0, key_skipped_count: 149042, block: {cache_hit_count: 149407, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]},{"Node Id":"Selection","Plan Rows":4.054354859583279,"Actual Rows":95181,"Task":"cop[tikv]","Total Time":1546000000,"Max Time":174000000,"Access Object":"","Operation Info":"lt(new0107.lineitem.l_commitdate, new0107.lineitem.l_receiptdate)","Execution Info":"time:23.4s, loops:148, cop_task: {num: 43, max: 2.36s, min: 44.2ms, avg: 550.8ms, p95: 1.98s, max_proc_keys: 13800, p95_proc_keys: 8192, tot_proc: 5.02s, tot_wait: 2.12s, rpc_num: 85, rpc_time: 47.2s, copr_cache_hit_ratio: 0.35}, tikv_task:{proc max:174ms, min:0s, p80:61ms, p95:103ms, iters:340, tasks:43}, scan_detail: {total_process_keys: 125087, total_process_keys_size: 24575822, total_keys: 151176, rocksdb: {delete_skipped_count: 0, key_skipped_count: 120978, block: {cache_hit_count: 102876, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRowIDScan","Plan Rows":5.067943574479099,"Actual Rows":150845,"Task":"cop[tikv]","Total Time":1530000000,"Max Time":173000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:173ms, min:0s, p80:61ms, p95:102ms, iters:340, tasks:43}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  o_orderpriority,  count(*) as order_count from  orders where  o_orderdate >= '1995-01-01'  and o_orderdate < date_add('1995-01-01', interval '3' month)  and exists (   select    *   from    lineitem   where    l_orderkey = o_orderkey    and l_commitdate < l_receiptdate  ) group by  o_orderpriority order by  o_orderpriority;

{"Node Id":"Projection","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":6336839143,"Max Time":6336839143,"Access Object":"","Operation Info":"div(Column#46, 7.0)-\u003eColumn#47","Execution Info":"time:6.34s, loops:2, Concurrency:OFF","Disk":0,"Memory":1428,"Plans":[{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":6336780715,"Max Time":6336780715,"Access Object":"","Operation Info":"funcs:sum(new0107.lineitem.l_extendedprice)-\u003eColumn#46","Execution Info":"time:6.34s, loops:2, partial_worker:{wall_time:6.336740878s, concurrency:5, task_num:5, tot_wait:31.436143102s, tot_exec:510.16µs, tot_time:31.436700593s, max:6.287361984s, p95:6.287361984s}, final_worker:{wall_time:0s, concurrency:5, task_num:5, tot_wait:31.437115358s, tot_exec:33.587µs, tot_time:31.437158684s, max:6.287478475s, p95:6.287478475s}","Disk":0,"Memory":35344,"Plans":[{"Node Id":"HashJoin","Plan Rows":1210.4745245946383,"Actual Rows":421,"Task":"root","Total Time":6287368614,"Max Time":6287368614,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.part.p_partkey, new0107.lineitem.l_partkey)], other cond:lt(new0107.lineitem.l_quantity, mul(0.2, Column#44))","Execution Info":"time:6.29s, loops:6, build_hash_table:{total:4.72s, fetch:4.59s, build:132ms}, probe:{concurrency:5, total:31.4s, max:6.29s, probe:102.4ms, fetch:31.3s}","Disk":0,"Memory":637296,"Plans":[{"Node Id":"HashJoin","Plan Rows":1210.4745245946383,"Actual Rows":4588,"Task":"root","Total Time":4721479524,"Max Time":4721479524,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.part.p_partkey, new0107.lineitem.l_partkey)]","Execution Info":"time:4.72s, loops:8, build_hash_table:{total:2.34s, fetch:2.34s, build:134.5µs}, probe:{concurrency:5, total:23.3s, max:4.66s, probe:2.98s, fetch:20.3s}","Disk":0,"Memory":41680,"Plans":[{"Node Id":"TableReader","Plan Rows":59.45536499999999,"Actual Rows":233,"Task":"root","Total Time":2343758563,"Max Time":2343758563,"Access Object":"","Operation Info":"data:Selection_39","Execution Info":"time:2.34s, loops:2, cop_task: {num: 1, max: 2.2s, proc_keys: 0, rpc_num: 1, rpc_time: 2.2s, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":16070,"Plans":[{"Node Id":"Selection","Plan Rows":59.45536499999999,"Actual Rows":233,"Task":"cop[tikv]","Total Time":230000000,"Max Time":230000000,"Access Object":"","Operation Info":"eq(new0107.part.p_brand, \"Brand#44\"), eq(new0107.part.p_container, \"WRAP PKG\")","Execution Info":"tikv_task:{time:230ms, loops:200}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":200000,"Actual Rows":200000,"Task":"cop[tikv]","Total Time":194000000,"Max Time":194000000,"Access Object":"","Operation Info":"table:part, keep order:false","Execution Info":"tikv_task:{time:194ms, loops:200}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":4009984,"Actual Rows":4009984,"Task":"root","Total Time":1974454213,"Max Time":1974454213,"Access Object":"","Operation Info":"data:TableFullScan_36","Execution Info":"time:1.97s, loops:3924, cop_task: {num: 9, max: 3.69s, min: 1.48s, avg: 3.02s, p95: 3.69s, max_proc_keys: 512775, p95_proc_keys: 512775, tot_proc: 13.6s, tot_wait: 1.6s, rpc_num: 9, rpc_time: 27.2s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":122258129,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4139000000,"Max Time":555000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:555ms, min:290ms, p80:508ms, p95:555ms, iters:3959, tasks:9}, scan_detail: {total_process_keys: 4009984, total_process_keys_size: 787655655, total_keys: 4009993, rocksdb: {delete_skipped_count: 0, key_skipped_count: 4009984, block: {cache_hit_count: 12898, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"HashAgg","Plan Rows":196960,"Actual Rows":200000,"Task":"root","Total Time":6278520459,"Max Time":6278520459,"Access Object":"","Operation Info":"group by:new0107.lineitem.l_partkey, funcs:avg(Column#50, Column#51)-\u003eColumn#44, funcs:firstrow(new0107.lineitem.l_partkey)-\u003enew0107.lineitem.l_partkey","Execution Info":"time:6.28s, loops:200, partial_worker:{wall_time:4.087323466s, concurrency:5, task_num:9, tot_wait:4.878602903s, tot_exec:13.298649686s, tot_time:19.174828138s, max:4.064140462s, p95:4.064140462s}, final_worker:{wall_time:6.279118747s, concurrency:5, task_num:25, tot_wait:18.068476972s, tot_exec:10.947542231s, tot_time:29.016045275s, max:6.256050504s, p95:6.256050504s}","Disk":0,"Memory":241549243,"Plans":[{"Node Id":"TableReader","Plan Rows":196960,"Actual Rows":1590811,"Task":"root","Total Time":2735081295,"Max Time":2735081295,"Access Object":"","Operation Info":"data:HashAgg_41","Execution Info":"time:2.74s, loops:10, cop_task: {num: 9, max: 2.18s, min: 451.9ms, avg: 1.46s, p95: 2.18s, rpc_num: 9, rpc_time: 13.2s, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":20440764,"Plans":[{"Node Id":"HashAgg","Plan Rows":196960,"Actual Rows":1590811,"Task":"cop[tikv]","Total Time":8618000000,"Max Time":1120000000,"Access Object":"","Operation Info":"group by:new0107.lineitem.l_partkey, funcs:count(new0107.lineitem.l_quantity)-\u003eColumn#50, funcs:sum(new0107.lineitem.l_quantity)-\u003eColumn#51","Execution Info":"tikv_task:{proc max:1.12s, min:574ms, p80:1.09s, p95:1.12s, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4380000000,"Max Time":570000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:570ms, min:362ms, p80:563ms, p95:570ms, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  sum(l_extendedprice) / 7.0 as avg_yearly from  lineitem,  part where  p_partkey = l_partkey  and p_brand = 'Brand#44'  and p_container = 'WRAP PKG'  and l_quantity < (   select    0.2 * avg(l_quantity)   from    lineitem   where    l_partkey = p_partkey  );

{"Node Id":"Projection","Plan Rows":20,"Actual Rows":20,"Task":"root","Total Time":12618513965,"Max Time":12618513965,"Access Object":"","Operation Info":"new0107.customer.c_custkey, new0107.customer.c_name, Column#39, new0107.customer.c_acctbal, new0107.nation.n_name, new0107.customer.c_address, new0107.customer.c_phone, new0107.customer.c_comment","Execution Info":"time:12.6s, loops:2, Concurrency:OFF","Disk":0,"Memory":9184,"Plans":[{"Node Id":"TopN","Plan Rows":20,"Actual Rows":20,"Task":"root","Total Time":12618447822,"Max Time":12618447822,"Access Object":"","Operation Info":"Column#39:desc, offset:0, count:20","Execution Info":"time:12.6s, loops:2","Disk":0,"Memory":332280,"Plans":[{"Node Id":"HashAgg","Plan Rows":41373.958195989835,"Actual Rows":27560,"Task":"root","Total Time":12615206911,"Max Time":12615206911,"Access Object":"","Operation Info":"group by:Column#53, Column#54, Column#55, Column#56, Column#57, Column#58, Column#59, funcs:sum(Column#45)-\u003eColumn#39, funcs:firstrow(Column#46)-\u003enew0107.customer.c_custkey, funcs:firstrow(Column#47)-\u003enew0107.customer.c_name, funcs:firstrow(Column#48)-\u003enew0107.customer.c_address, funcs:firstrow(Column#49)-\u003enew0107.customer.c_phone, funcs:firstrow(Column#50)-\u003enew0107.customer.c_acctbal, funcs:firstrow(Column#51)-\u003enew0107.customer.c_comment, funcs:firstrow(Column#52)-\u003enew0107.nation.n_name","Execution Info":"time:12.6s, loops:31, partial_worker:{wall_time:12.454084824s, concurrency:5, task_num:78, tot_wait:59.261070571s, tot_exec:2.325149458s, tot_time:1m1.734579725s, max:12.438221578s, p95:12.438221578s}, final_worker:{wall_time:12.61880907s, concurrency:5, task_num:25, tot_wait:1m1.817063496s, tot_exec:1.126684683s, tot_time:1m2.94377473s, max:12.615089287s, p95:12.615089287s}","Disk":0,"Memory":42103531,"Plans":[{"Node Id":"Projection","Plan Rows":167744.70847210684,"Actual Rows":76675,"Task":"root","Total Time":12264181168,"Max Time":12264181168,"Access Object":"","Operation Info":"mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount))-\u003eColumn#45, new0107.customer.c_custkey, new0107.customer.c_name, new0107.customer.c_address, new0107.customer.c_phone, new0107.customer.c_acctbal, new0107.customer.c_comment, new0107.nation.n_name, new0107.customer.c_custkey, new0107.customer.c_name, new0107.customer.c_acctbal, new0107.customer.c_phone, new0107.nation.n_name, new0107.customer.c_address, new0107.customer.c_comment","Execution Info":"time:12.3s, loops:79, Concurrency:5","Disk":0,"Memory":4719624,"Plans":[{"Node Id":"Projection","Plan Rows":167744.70847210684,"Actual Rows":76675,"Task":"root","Total Time":11018105288,"Max Time":11018105288,"Access Object":"","Operation Info":"new0107.customer.c_custkey, new0107.customer.c_name, new0107.customer.c_address, new0107.customer.c_phone, new0107.customer.c_acctbal, new0107.customer.c_comment, new0107.lineitem.l_extendedprice, new0107.lineitem.l_discount, new0107.nation.n_name","Execution Info":"time:11s, loops:79, Concurrency:5","Disk":0,"Memory":3533192,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":167744.70847210684,"Actual Rows":76675,"Task":"root","Total Time":11736467913,"Max Time":11736467913,"Access Object":"","Operation Info":"inner join, inner:IndexLookUp_32, outer key:new0107.orders.o_orderkey, inner key:new0107.lineitem.l_orderkey, equal cond:eq(new0107.orders.o_orderkey, new0107.lineitem.l_orderkey)","Execution Info":"time:11.7s, loops:79, inner:{total:47.3s, concurrency:5, task:10, construct:339.7ms, fetch:39.6s, build:99.7ms, join:7.41s}","Disk":0,"Memory":25655829,"Plans":[{"Node Id":"HashJoin","Plan Rows":41373.958195989835,"Actual Rows":38190,"Task":"root","Total Time":2628888706,"Max Time":2628888706,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.customer.c_custkey, new0107.orders.o_custkey)]","Execution Info":"time:2.63s, loops:42, build_hash_table:{total:47.2ms, fetch:32.7ms, build:14.6ms}, probe:{concurrency:5, total:13.1s, max:2.63s, probe:1.72s, fetch:11.4s}","Disk":0,"Memory":1157088,"Plans":[{"Node Id":"HashJoin","Plan Rows":150000,"Actual Rows":150000,"Task":"root","Total Time":2567278556,"Max Time":2567278556,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.customer.c_nationkey)]","Execution Info":"time:2.57s, loops:148, build_hash_table:{total:59.6ms, fetch:59.6ms, build:24.3µs}, probe:{concurrency:5, total:12.2s, max:2.62s, probe:3.35s, fetch:8.81s}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":25,"Actual Rows":25,"Task":"root","Total Time":59517929,"Max Time":59517929,"Access Object":"","Operation Info":"data:TableFullScan_60","Execution Info":"time:59.5ms, loops:2, cop_task: {num: 1, max: 60.5ms, proc_keys: 25, rpc_num: 1, rpc_time: 60.4ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":798,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:nation, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]},{"Node Id":"TableReader","Plan Rows":150000,"Actual Rows":150000,"Task":"root","Total Time":1720939048,"Max Time":1720939048,"Access Object":"","Operation Info":"data:TableFullScan_58","Execution Info":"time:1.72s, loops:148, cop_task: {num: 1, max: 1.66s, proc_keys: 150000, tot_proc: 1.46s, tot_wait: 22ms, rpc_num: 1, rpc_time: 1.66s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":32798874,"Plans":[{"Node Id":"TableFullScan","Plan Rows":150000,"Actual Rows":150000,"Task":"cop[tikv]","Total Time":198000000,"Max Time":198000000,"Access Object":"","Operation Info":"table:customer, keep order:false","Execution Info":"tikv_task:{time:198ms, loops:151}, scan_detail: {total_process_keys: 150000, total_process_keys_size: 30533765, total_keys: 150001, rocksdb: {delete_skipped_count: 0, key_skipped_count: 150000, block: {cache_hit_count: 502, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":41254.801196385386,"Actual Rows":38190,"Task":"root","Total Time":32047924,"Max Time":32047924,"Access Object":"","Operation Info":"data:Selection_63","Execution Info":"time:32ms, loops:39, cop_task: {num: 2, max: 35.5ms, min: 30.7ms, avg: 33.1ms, p95: 35.5ms, rpc_num: 2, rpc_time: 66.1ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":946379,"Plans":[{"Node Id":"Selection","Plan Rows":41254.801196385386,"Actual Rows":38190,"Task":"cop[tikv]","Total Time":1112000000,"Max Time":769000000,"Access Object":"","Operation Info":"ge(new0107.orders.o_orderdate, 1993-08-01 00:00:00.000000), lt(new0107.orders.o_orderdate, 1993-11-01 00:00:00.000000)","Execution Info":"tikv_task:{proc max:769ms, min:343ms, p80:769ms, p95:769ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":1060000000,"Max Time":740000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:740ms, min:320ms, p80:740ms, p95:740ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"IndexLookUp","Plan Rows":4.054354859583279,"Actual Rows":76675,"Task":"root","Total Time":39452248288,"Max Time":5473345251,"Access Object":"","Operation Info":"","Execution Info":"time:39.5s, loops:91, index_task: {total_time: 27.1s, fetch_handle: 27.1s, build: 70.7µs, wait: 96.2µs}, table_task: {total_time: 49.5s, num: 38, concurrency: 50}","Disk":0,"Memory":349624,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":16.31766974151436,"Actual Rows":153298,"Task":"cop[tikv]","Total Time":1741000000,"Max Time":238000000,"Access Object":"","Operation Info":"table:lineitem, index:PRIMARY(L_ORDERKEY, L_LINENUMBER), range: decided by [eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)], keep order:false","Execution Info":"time:27.1s, loops:183, cop_task: {num: 40, max: 3.65s, min: 364.4ms, avg: 1.94s, p95: 3.54s, max_proc_keys: 18741, p95_proc_keys: 15900, tot_proc: 51.7s, tot_wait: 5.44s, rpc_num: 76, rpc_time: 2m31s, copr_cache_hit_ratio: 0.00}, tikv_task:{proc max:238ms, min:5ms, p80:93ms, p95:185ms, iters:333, tasks:40}, scan_detail: {total_process_keys: 153298, total_process_keys_size: 8124794, total_keys: 191488, rocksdb: {delete_skipped_count: 0, key_skipped_count: 153298, block: {cache_hit_count: 152871, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]},{"Node Id":"Selection","Plan Rows":4.054354859583279,"Actual Rows":76675,"Task":"cop[tikv]","Total Time":1543000000,"Max Time":122000000,"Access Object":"","Operation Info":"eq(new0107.lineitem.l_returnflag, \"R\")","Execution Info":"time:48.6s, loops:133, cop_task: {num: 133, max: 2.7s, min: 27.2ms, avg: 734.1ms, p95: 2.2s, max_proc_keys: 8453, p95_proc_keys: 4146, tot_proc: 19.9s, tot_wait: 8.34s, rpc_num: 263, rpc_time: 3m14.6s, copr_cache_hit_ratio: 0.00}, tikv_task:{proc max:122ms, min:0s, p80:15ms, p95:49ms, iters:672, tasks:133}, scan_detail: {total_process_keys: 153298, total_process_keys_size: 30112421, total_keys: 185883, rocksdb: {delete_skipped_count: 0, key_skipped_count: 148044, block: {cache_hit_count: 129290, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRowIDScan","Plan Rows":16.31766974151436,"Actual Rows":153298,"Task":"cop[tikv]","Total Time":1520000000,"Max Time":122000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:122ms, min:0s, p80:14ms, p95:49ms, iters:672, tasks:133}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  c_custkey,  c_name,  sum(l_extendedprice * (1 - l_discount)) as revenue,  c_acctbal,  n_name,  c_address,  c_phone,  c_comment from  customer,  orders,  lineitem,  nation where  c_custkey = o_custkey  and l_orderkey = o_orderkey  and o_orderdate >= '1993-08-01'  and o_orderdate < date_add('1993-08-01', interval '3' month)  and l_returnflag = 'R'  and c_nationkey = n_nationkey group by  c_custkey,  c_name,  c_acctbal,  c_phone,  n_name,  c_address,  c_comment order by  revenue desc limit 20;

{"Node Id":"Sort","Plan Rows":1,"Actual Rows":5,"Task":"root","Total Time":7654155324,"Max Time":7654155324,"Access Object":"","Operation Info":"new0107.orders.o_orderpriority","Execution Info":"time:7.65s, loops:2","Disk":0,"Memory":4000,"Plans":[{"Node Id":"Projection","Plan Rows":1,"Actual Rows":5,"Task":"root","Total Time":7654107202,"Max Time":7654107202,"Access Object":"","Operation Info":"new0107.orders.o_orderpriority, Column#27","Execution Info":"time:7.65s, loops:5, Concurrency:OFF","Disk":0,"Memory":1000,"Plans":[{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":5,"Task":"root","Total Time":7654084834,"Max Time":7654084834,"Access Object":"","Operation Info":"group by:new0107.orders.o_orderpriority, funcs:count(1)-\u003eColumn#27, funcs:firstrow(new0107.orders.o_orderpriority)-\u003enew0107.orders.o_orderpriority","Execution Info":"time:7.65s, loops:5, partial_worker:{wall_time:7.654000122s, concurrency:5, task_num:34, tot_wait:38.129643699s, tot_exec:135.35896ms, tot_time:38.265114073s, max:7.653593743s, p95:7.653593743s}, final_worker:{wall_time:0s, concurrency:5, task_num:20, tot_wait:38.269085438s, tot_exec:283.194µs, tot_time:38.269377101s, max:7.65391236s, p95:7.65391236s}","Disk":0,"Memory":379746,"Plans":[{"Node Id":"IndexJoin","Plan Rows":33363.37979381443,"Actual Rows":34630,"Task":"root","Total Time":7624284641,"Max Time":7624284641,"Access Object":"","Operation Info":"semi join, inner:IndexLookUp_18, outer key:new0107.orders.o_orderkey, inner key:new0107.lineitem.l_orderkey, equal cond:eq(new0107.orders.o_orderkey, new0107.lineitem.l_orderkey)","Execution Info":"time:7.62s, loops:35, inner:{total:26.4s, concurrency:5, task:10, construct:862.9ms, fetch:25.4s, build:124.6ms}, probe:82.9ms","Disk":0,"Memory":11333070,"Plans":[{"Node Id":"TableReader","Plan Rows":41704.22474226803,"Actual Rows":37775,"Task":"root","Total Time":119276536,"Max Time":119276536,"Access Object":"","Operation Info":"data:Selection_39","Execution Info":"time:119.3ms, loops:42, cop_task: {num: 2, max: 885.7ms, min: 115.2ms, avg: 500.4ms, p95: 885.7ms, rpc_num: 2, rpc_time: 1s, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":1261365,"Plans":[{"Node Id":"Selection","Plan Rows":41704.22474226803,"Actual Rows":37775,"Task":"cop[tikv]","Total Time":934000000,"Max Time":559000000,"Access Object":"","Operation Info":"ge(new0107.orders.o_orderdate, 1995-01-01 00:00:00.000000), lt(new0107.orders.o_orderdate, 1995-04-01 00:00:00.000000)","Execution Info":"tikv_task:{proc max:559ms, min:375ms, p80:559ms, p95:559ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":871000000,"Max Time":519000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:519ms, min:352ms, p80:519ms, p95:519ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"IndexLookUp","Plan Rows":4.054354859583279,"Actual Rows":95181,"Task":"root","Total Time":25129810469,"Max Time":3984775070,"Access Object":"","Operation Info":"","Execution Info":"time:25.1s, loops:109, index_task: {total_time: 10.6s, fetch_handle: 10.4s, build: 41.6µs, wait: 166.7ms}, table_task: {total_time: 32.9s, num: 31, concurrency: 50}","Disk":0,"Memory":208496,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":5.067943574479099,"Actual Rows":150845,"Task":"cop[tikv]","Total Time":1418000000,"Max Time":361000000,"Access Object":"","Operation Info":"table:lineitem, index:PRIMARY(L_ORDERKEY, L_LINENUMBER), range: decided by [eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)], keep order:false","Execution Info":"time:10.4s, loops:172, cop_task: {num: 14, max: 2.34s, min: 78.1ms, avg: 824.6ms, p95: 2.34s, max_proc_keys: 33223, p95_proc_keys: 33223, tot_proc: 6.61s, tot_wait: 436ms, rpc_num: 27, rpc_time: 23s, copr_cache_hit_ratio: 0.14}, tikv_task:{proc max:361ms, min:2ms, p80:235ms, p95:361ms, iters:209, tasks:14}, scan_detail: {total_process_keys: 148981, total_process_keys_size: 7895993, total_keys: 186294, rocksdb: {delete_skipped_count: 0, key_skipped_count: 148981, block: {cache_hit_count: 149385, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]},{"Node Id":"Selection","Plan Rows":4.054354859583279,"Actual Rows":95181,"Task":"cop[tikv]","Total Time":1425000000,"Max Time":175000000,"Access Object":"","Operation Info":"lt(new0107.lineitem.l_commitdate, new0107.lineitem.l_receiptdate)","Execution Info":"time:32.2s, loops:141, cop_task: {num: 40, max: 2.39s, min: 9.5ms, avg: 807.3ms, p95: 2.36s, max_proc_keys: 16008, p95_proc_keys: 11822, tot_proc: 7.71s, tot_wait: 2.55s, rpc_num: 79, rpc_time: 1m4.4s, copr_cache_hit_ratio: 0.25}, tikv_task:{proc max:175ms, min:0s, p80:68ms, p95:162ms, iters:328, tasks:40}, scan_detail: {total_process_keys: 134672, total_process_keys_size: 26454363, total_keys: 162687, rocksdb: {delete_skipped_count: 0, key_skipped_count: 130244, block: {cache_hit_count: 109424, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRowIDScan","Plan Rows":5.067943574479099,"Actual Rows":150845,"Task":"cop[tikv]","Total Time":1405000000,"Max Time":172000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:172ms, min:0s, p80:68ms, p95:160ms, iters:328, tasks:40}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  o_orderpriority,  count(*) as order_count from  orders where  o_orderdate >= '1995-01-01'  and o_orderdate < date_add('1995-01-01', interval '3' month)  and exists (   select    *   from    lineitem   where    l_orderkey = o_orderkey    and l_commitdate < l_receiptdate  ) group by  o_orderpriority order by  o_orderpriority;

{"Node Id":"Sort","Plan Rows":338.09908020009675,"Actual Rows":2,"Task":"root","Total Time":16782169087,"Max Time":16782169087,"Access Object":"","Operation Info":"Column#62","Execution Info":"time:16.8s, loops:2","Disk":0,"Memory":3600,"Plans":[{"Node Id":"Projection","Plan Rows":338.09908020009675,"Actual Rows":2,"Task":"root","Total Time":16782119962,"Max Time":16782119962,"Access Object":"","Operation Info":"Column#62, div(Column#64, Column#65)-\u003eColumn#66","Execution Info":"time:16.8s, loops:3, Concurrency:OFF","Disk":0,"Memory":3228,"Plans":[{"Node Id":"HashAgg","Plan Rows":338.09908020009675,"Actual Rows":2,"Task":"root","Total Time":16782082999,"Max Time":16782082999,"Access Object":"","Operation Info":"group by:Column#78, funcs:sum(Column#75)-\u003eColumn#64, funcs:sum(Column#76)-\u003eColumn#65, funcs:firstrow(Column#77)-\u003eColumn#62","Execution Info":"time:16.8s, loops:3, partial_worker:{wall_time:16.756088267s, concurrency:5, task_num:2, tot_wait:1m23.720912167s, tot_exec:1.194117ms, tot_time:1m23.722170776s, max:16.744467362s, p95:16.744467362s}, final_worker:{wall_time:0s, concurrency:5, task_num:4, tot_wait:1m23.808160053s, tot_exec:161.547µs, tot_time:1m23.808327018s, max:16.763288059s, p95:16.763288059s}","Disk":0,"Memory":240419,"Plans":[{"Node Id":"Projection","Plan Rows":723,"Actual Rows":1704,"Task":"root","Total Time":16732388131,"Max Time":16732388131,"Access Object":"","Operation Info":"case(eq(new0107.nation.n_name, INDIA), mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount)), 0)-\u003eColumn#75, mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount))-\u003eColumn#76, extract(YEAR, new0107.orders.o_orderdate)-\u003eColumn#77, extract(YEAR, new0107.orders.o_orderdate)-\u003eColumn#78","Execution Info":"time:16.7s, loops:3, Concurrency:OFF","Disk":0,"Memory":111608,"Plans":[{"Node Id":"Projection","Plan Rows":723,"Actual Rows":1704,"Task":"root","Total Time":16730175038,"Max Time":16730175038,"Access Object":"","Operation Info":"new0107.lineitem.l_extendedprice, new0107.lineitem.l_discount, new0107.orders.o_orderdate, new0107.nation.n_name","Execution Info":"time:16.7s, loops:3, Concurrency:OFF","Disk":0,"Memory":185184,"Plans":[{"Node Id":"HashJoin","Plan Rows":723,"Actual Rows":1704,"Task":"root","Total Time":16730114207,"Max Time":16730114207,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.supplier.s_nationkey, new0107.nation.n_nationkey)]","Execution Info":"time:16.7s, loops:3, build_hash_table:{total:275.2ms, fetch:275.2ms, build:20.6µs}, probe:{concurrency:5, total:1m23.1s, max:16.7s, probe:88.2ms, fetch:1m23s}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"IndexJoin","Plan Rows":723,"Actual Rows":1704,"Task":"root","Total Time":16505726638,"Max Time":16505726638,"Access Object":"","Operation Info":"inner join, inner:TableReader_47, outer key:new0107.lineitem.l_suppkey, inner key:new0107.supplier.s_suppkey, equal cond:eq(new0107.lineitem.l_suppkey, new0107.supplier.s_suppkey)","Execution Info":"time:16.5s, loops:3, inner:{total:2.5s, concurrency:5, task:5, construct:2.05ms, fetch:2.5s, build:2.12ms}, probe:4.17ms","Disk":0,"Memory":736613,"Plans":[{"Node Id":"IndexJoin","Plan Rows":723,"Actual Rows":1704,"Task":"root","Total Time":15581536320,"Max Time":15581536320,"Access Object":"","Operation Info":"inner join, inner:TableReader_59, outer key:new0107.lineitem.l_partkey, inner key:new0107.part.p_partkey, equal cond:eq(new0107.lineitem.l_partkey, new0107.part.p_partkey)","Execution Info":"time:15.6s, loops:7, inner:{total:32.8s, concurrency:5, task:18, construct:1.96s, fetch:30.9s, build:1.26ms}, probe:746.7ms","Disk":0,"Memory":48380727,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":1370.7736488298992,"Actual Rows":244708,"Task":"root","Total Time":11807337896,"Max Time":11807337896,"Access Object":"","Operation Info":"inner join, inner:IndexLookUp_73, outer key:new0107.orders.o_orderkey, inner key:new0107.lineitem.l_orderkey, equal cond:eq(new0107.orders.o_orderkey, new0107.lineitem.l_orderkey)","Execution Info":"time:11.8s, loops:244, inner:{total:55.1s, concurrency:5, task:11, construct:287.1ms, fetch:52.1s, build:562ms, join:2.67s}","Disk":0,"Memory":38013171,"Plans":[{"Node Id":"HashJoin","Plan Rows":338.09908020009675,"Actual Rows":61273,"Task":"root","Total Time":1036230025,"Max Time":1036230025,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.customer.c_custkey, new0107.orders.o_custkey)]","Execution Info":"time:1.04s, loops:64, build_hash_table:{total:658.8ms, fetch:532.1ms, build:126.7ms}, probe:{concurrency:5, total:4.74s, max:1.01s, probe:1.24s, fetch:3.5s}","Disk":0,"Memory":293088,"Plans":[{"Node Id":"HashJoin","Plan Rows":37.5,"Actual Rows":30183,"Task":"root","Total Time":558640554,"Max Time":558640554,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.customer.c_nationkey)]","Execution Info":"time:558.6ms, loops:35, build_hash_table:{total:161.3ms, fetch:161.3ms, build:7.72µs}, probe:{concurrency:5, total:3.11s, max:658.3ms, probe:783.9ms, fetch:2.32s}","Disk":0,"Memory":372,"Plans":[{"Node Id":"HashJoin","Plan Rows":0.00625,"Actual Rows":5,"Task":"root","Total Time":161265475,"Max Time":161265475,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.region.r_regionkey, new0107.nation.n_regionkey)]","Execution Info":"time:161.3ms, loops:2, build_hash_table:{total:132.7ms, fetch:132.7ms, build:7.44µs}, probe:{concurrency:5, total:796.1ms, max:161.1ms, probe:24.6µs, fetch:796.1ms}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":0.005,"Actual Rows":1,"Task":"root","Total Time":132677616,"Max Time":132677616,"Access Object":"","Operation Info":"data:Selection_105","Execution Info":"time:132.7ms, loops:2, cop_task: {num: 1, max: 149.7ms, proc_keys: 5, rpc_num: 1, rpc_time: 149.6ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":246,"Plans":[{"Node Id":"Selection","Plan Rows":0.005,"Actual Rows":1,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"eq(new0107.region.r_name, \"ASIA\")","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 5, total_process_keys_size: 559, total_keys: 6, rocksdb: {delete_skipped_count: 0, key_skipped_count: 5, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":5,"Actual Rows":5,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:region, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":25,"Actual Rows":25,"Task":"root","Total Time":151662715,"Max Time":151662715,"Access Object":"","Operation Info":"data:TableFullScan_102","Execution Info":"time:151.7ms, loops:2, cop_task: {num: 1, max: 117.6ms, proc_keys: 25, rpc_num: 1, rpc_time: 117.6ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":613,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:n1, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":150000,"Actual Rows":150000,"Task":"root","Total Time":453286337,"Max Time":453286337,"Access Object":"","Operation Info":"data:TableFullScan_107","Execution Info":"time:453.3ms, loops:148, cop_task: {num: 1, max: 396.2ms, proc_keys: 0, rpc_num: 1, rpc_time: 396.2ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":2403799,"Plans":[{"Node Id":"TableFullScan","Plan Rows":150000,"Actual Rows":150000,"Task":"cop[tikv]","Total Time":110000000,"Max Time":110000000,"Access Object":"","Operation Info":"table:customer, keep order:false","Execution Info":"tikv_task:{time:110ms, loops:151}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":335928.1222794716,"Actual Rows":305307,"Task":"root","Total Time":237230395,"Max Time":237230395,"Access Object":"","Operation Info":"data:Selection_110","Execution Info":"time:237.2ms, loops:299, cop_task: {num: 2, max: 249.5ms, min: 248.8ms, avg: 249.2ms, p95: 249.5ms, rpc_num: 2, rpc_time: 498.3ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":7357216,"Plans":[{"Node Id":"Selection","Plan Rows":335928.1222794716,"Actual Rows":305307,"Task":"cop[tikv]","Total Time":981000000,"Max Time":541000000,"Access Object":"","Operation Info":"ge(new0107.orders.o_orderdate, 1995-01-01 00:00:00.000000), le(new0107.orders.o_orderdate, 1996-12-31 00:00:00.000000)","Execution Info":"tikv_task:{proc max:541ms, min:440ms, p80:541ms, p95:541ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":925000000,"Max Time":507000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:507ms, min:418ms, p80:507ms, p95:507ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"IndexLookUp","Plan Rows":4.054354859583279,"Actual Rows":244708,"Task":"root","Total Time":51627661974,"Max Time":6165263525,"Access Object":"","Operation Info":"","Execution Info":"time:51.6s, loops:256, index_task: {total_time: 24.4s, fetch_handle: 22s, build: 78.9µs, wait: 2.45s}, table_task: {total_time: 1m26.3s, num: 42, concurrency: 55}","Disk":0,"Memory":576668,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":4.054354859583279,"Actual Rows":244708,"Task":"cop[tikv]","Total Time":2330000000,"Max Time":565000000,"Access Object":"","Operation Info":"table:lineitem, index:PRIMARY(L_ORDERKEY, L_LINENUMBER), range: decided by [eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)], keep order:false","Execution Info":"time:21.9s, loops:269, cop_task: {num: 18, max: 3.95s, min: 625.3ms, avg: 1.87s, p95: 3.95s, max_proc_keys: 58775, p95_proc_keys: 58775, tot_proc: 25.3s, tot_wait: 1.13s, rpc_num: 35, rpc_time: 1m5.9s, copr_cache_hit_ratio: 0.00}, tikv_task:{proc max:565ms, min:4ms, p80:191ms, p95:565ms, iters:323, tasks:18}, scan_detail: {total_process_keys: 244708, total_process_keys_size: 12969524, total_keys: 305981, rocksdb: {delete_skipped_count: 0, key_skipped_count: 244708, block: {cache_hit_count: 245262, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]},{"Node Id":"TableRowIDScan","Plan Rows":4.054354859583279,"Actual Rows":244708,"Task":"cop[tikv]","Total Time":1947000000,"Max Time":194000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"time:1m25.3s, loops:311, cop_task: {num: 62, max: 3.99s, min: 27.3ms, avg: 1.58s, p95: 3.23s, max_proc_keys: 20480, p95_proc_keys: 13837, tot_proc: 52.4s, tot_wait: 5.55s, rpc_num: 123, rpc_time: 3m16.4s, copr_cache_hit_ratio: 0.05}, tikv_task:{proc max:194ms, min:0s, p80:45ms, p95:104ms, iters:512, tasks:62}, scan_detail: {total_process_keys: 237769, total_process_keys_size: 46692326, total_keys: 285974, rocksdb: {delete_skipped_count: 0, key_skipped_count: 230068, block: {cache_hit_count: 189421, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":0.003615,"Actual Rows":1624,"Task":"root","Total Time":30121335014,"Max Time":3644837313,"Access Object":"","Operation Info":"data:Selection_58","Execution Info":"time:30.1s, loops:36, cop_task: {num: 18, max: 3.52s, min: 305ms, avg: 1.61s, p95: 3.52s, max_proc_keys: 24142, p95_proc_keys: 24142, tot_proc: 19.7s, tot_wait: 1.46s, rpc_num: 35, rpc_time: 55s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":0,"Plans":[{"Node Id":"Selection","Plan Rows":0.003615,"Actual Rows":1624,"Task":"cop[tikv]","Total Time":3115000000,"Max Time":421000000,"Access Object":"","Operation Info":"eq(new0107.part.p_type, \"SMALL PLATED COPPER\")","Execution Info":"tikv_task:{proc max:421ms, min:10ms, p80:321ms, p95:421ms, iters:310, tasks:18}, scan_detail: {total_process_keys: 231228, total_process_keys_size: 37793737, total_keys: 253179, rocksdb: {delete_skipped_count: 0, key_skipped_count: 46871, block: {cache_hit_count: 285930, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":231228,"Task":"cop[tikv]","Total Time":3047000000,"Max Time":408000000,"Access Object":"","Operation Info":"table:part, range: decided by [new0107.lineitem.l_partkey], keep order:false","Execution Info":"tikv_task:{proc max:408ms, min:9ms, p80:319ms, p95:408ms, iters:310, tasks:18}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"TableReader","Plan Rows":1,"Actual Rows":1595,"Task":"root","Total Time":2496687584,"Max Time":933269498,"Access Object":"","Operation Info":"data:TableRangeScan_46","Execution Info":"time:2.5s, loops:10, cop_task: {num: 5, max: 825.1ms, min: 149.4ms, avg: 411.3ms, p95: 825.1ms, max_proc_keys: 672, p95_proc_keys: 672, tot_proc: 28ms, tot_wait: 145ms, rpc_num: 9, rpc_time: 3.84s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":1595,"Task":"cop[tikv]","Total Time":17000000,"Max Time":7000000,"Access Object":"","Operation Info":"table:supplier, range: decided by [new0107.lineitem.l_suppkey], keep order:false","Execution Info":"tikv_task:{proc max:7ms, min:1ms, p80:7ms, p95:7ms, iters:19, tasks:5}, scan_detail: {total_process_keys: 1595, total_process_keys_size: 288830, total_keys: 1678, rocksdb: {delete_skipped_count: 0, key_skipped_count: 170, block: {cache_hit_count: 1946, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":25,"Actual Rows":25,"Task":"root","Total Time":275147250,"Max Time":275147250,"Access Object":"","Operation Info":"data:TableFullScan_119","Execution Info":"time:275.1ms, loops:2, cop_task: {num: 1, max: 249.7ms, proc_keys: 25, rpc_num: 1, rpc_time: 249.7ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":798,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:n2, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  o_year,  sum(case   when nation = 'INDIA' then volume   else 0  end) / sum(volume) as mkt_share from  (   select    extract(year from o_orderdate) as o_year,    l_extendedprice * (1 - l_discount) as volume,    n2.n_name as nation   from    part,    supplier,    lineitem,    orders,    customer,    nation n1,    nation n2,    region   where    p_partkey = l_partkey    and s_suppkey = l_suppkey    and l_orderkey = o_orderkey    and o_custkey = c_custkey    and c_nationkey = n1.n_nationkey    and n1.n_regionkey = r_regionkey    and r_name = 'ASIA'    and s_nationkey = n2.n_nationkey    and o_orderdate between '1995-01-01' and '1996-12-31'    and p_type = 'SMALL PLATED COPPER'  ) as all_nations group by  o_year order by  o_year;

{"Node Id":"Projection","Plan Rows":100,"Actual Rows":6,"Task":"root","Total Time":16506239443,"Max Time":16506239443,"Access Object":"","Operation Info":"new0107.customer.c_name, new0107.customer.c_custkey, new0107.orders.o_orderkey, new0107.orders.o_orderdate, new0107.orders.o_totalprice, Column#54","Execution Info":"time:16.5s, loops:2, Concurrency:OFF","Disk":0,"Memory":4600,"Plans":[{"Node Id":"TopN","Plan Rows":100,"Actual Rows":6,"Task":"root","Total Time":16506230100,"Max Time":16506230100,"Access Object":"","Operation Info":"new0107.orders.o_totalprice:desc, new0107.orders.o_orderdate, offset:0, count:100","Execution Info":"time:16.5s, loops:2","Disk":0,"Memory":9248,"Plans":[{"Node Id":"HashAgg","Plan Rows":807403.0718960115,"Actual Rows":6,"Task":"root","Total Time":16506175065,"Max Time":16506175065,"Access Object":"","Operation Info":"group by:new0107.customer.c_custkey, new0107.customer.c_name, new0107.orders.o_orderdate, new0107.orders.o_orderkey, new0107.orders.o_totalprice, funcs:sum(new0107.lineitem.l_quantity)-\u003eColumn#54, funcs:firstrow(new0107.customer.c_custkey)-\u003enew0107.customer.c_custkey, funcs:firstrow(new0107.customer.c_name)-\u003enew0107.customer.c_name, funcs:firstrow(new0107.orders.o_orderkey)-\u003enew0107.orders.o_orderkey, funcs:firstrow(new0107.orders.o_totalprice)-\u003enew0107.orders.o_totalprice, funcs:firstrow(new0107.orders.o_orderdate)-\u003enew0107.orders.o_orderdate","Execution Info":"time:16.5s, loops:4, partial_worker:{wall_time:16.506130603s, concurrency:5, task_num:3, tot_wait:1m22.52877194s, tot_exec:252.656µs, tot_time:1m22.529053004s, max:16.505821868s, p95:16.505821868s}, final_worker:{wall_time:16.561063197s, concurrency:5, task_num:5, tot_wait:1m22.529351206s, tot_exec:67.876µs, tot_time:1m22.529422653s, max:16.505903594s, p95:16.505903594s}","Disk":0,"Memory":52283,"Plans":[{"Node Id":"HashJoin","Plan Rows":3273498.568184062,"Actual Rows":42,"Task":"root","Total Time":16505697336,"Max Time":16505697336,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.orders.o_orderkey, new0107.lineitem.l_orderkey)]","Execution Info":"time:16.5s, loops:4, build_hash_table:{total:14.7s, fetch:14.7s, build:31.5µs}, probe:{concurrency:5, total:1m22.2s, max:16.5s, probe:3.87s, fetch:1m18.3s}","Disk":0,"Memory":12688,"Plans":[{"Node Id":"HashJoin","Plan Rows":807403.0718960115,"Actual Rows":6,"Task":"root","Total Time":14733277009,"Max Time":14733277009,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.orders.o_orderkey, new0107.lineitem.l_orderkey)]","Execution Info":"time:14.7s, loops:5, build_hash_table:{total:9.91s, fetch:9.91s, build:13.8µs}, probe:{concurrency:5, total:1m13.6s, max:14.7s, probe:678ms, fetch:1m12.9s}","Disk":0,"Memory":49664,"Plans":[{"Node Id":"HashJoin","Plan Rows":1097817.7150192554,"Actual Rows":1001472,"Task":"root","Total Time":7220498256,"Max Time":7220498256,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.customer.c_custkey, new0107.orders.o_custkey)]","Execution Info":"time:7.22s, loops:980, build_hash_table:{total:2.58s, fetch:2.29s, build:284.7ms}, probe:{concurrency:5, total:1m12.9s, max:14.6s, probe:59s, fetch:14s}","Disk":0,"Memory":5182368,"Plans":[{"Node Id":"TableReader","Plan Rows":150000,"Actual Rows":150000,"Task":"root","Total Time":2232504469,"Max Time":2232504469,"Access Object":"","Operation Info":"data:TableFullScan_88","Execution Info":"time:2.23s, loops:148, cop_task: {num: 1, max: 2.23s, proc_keys: 150000, tot_proc: 2.01s, tot_wait: 18ms, rpc_num: 1, rpc_time: 2.23s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":5105051,"Plans":[{"Node Id":"TableFullScan","Plan Rows":150000,"Actual Rows":150000,"Task":"cop[tikv]","Total Time":169000000,"Max Time":169000000,"Access Object":"","Operation Info":"table:customer, keep order:false","Execution Info":"tikv_task:{time:169ms, loops:151}, scan_detail: {total_process_keys: 150000, total_process_keys_size: 30533765, total_keys: 150001, rocksdb: {delete_skipped_count: 0, key_skipped_count: 150000, block: {cache_hit_count: 502, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]},{"Node Id":"TableReader","Plan Rows":1094656,"Actual Rows":1001472,"Task":"root","Total Time":2118736374,"Max Time":2118736374,"Access Object":"","Operation Info":"data:TableFullScan_86","Execution Info":"time:2.12s, loops:980, cop_task: {num: 2, max: 3.7s, min: 2s, avg: 2.85s, p95: 3.7s, max_proc_keys: 583494, p95_proc_keys: 583494, tot_proc: 4.86s, tot_wait: 41ms, rpc_num: 2, rpc_time: 5.7s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":64133924,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":1127000000,"Max Time":707000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:707ms, min:420ms, p80:707ms, p95:707ms, iters:987, tasks:2}, scan_detail: {total_process_keys: 1001472, total_process_keys_size: 151717700, total_keys: 1001474, rocksdb: {delete_skipped_count: 0, key_skipped_count: 1001472, block: {cache_hit_count: 2529, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"Selection","Plan Rows":791244.8,"Actual Rows":6,"Task":"root","Total Time":9908576464,"Max Time":9908576464,"Access Object":"","Operation Info":"gt(Column#52, 314)","Execution Info":"time:9.91s, loops:2","Disk":0,"Memory":50944,"Plans":[{"Node Id":"HashAgg","Plan Rows":989056,"Actual Rows":1002367,"Task":"root","Total Time":9086233016,"Max Time":9086233016,"Access Object":"","Operation Info":"group by:new0107.lineitem.l_orderkey, funcs:sum(Column#66)-\u003eColumn#52, funcs:firstrow(new0107.lineitem.l_orderkey)-\u003enew0107.lineitem.l_orderkey","Execution Info":"time:9.09s, loops:983, partial_worker:{wall_time:5.766148038s, concurrency:5, task_num:9, tot_wait:13.94235336s, tot_exec:5.992326493s, tot_time:21.913880366s, max:5.765855882s, p95:5.765855882s}, final_worker:{wall_time:9.908866541s, concurrency:5, task_num:25, tot_wait:18.11349593s, tot_exec:28.696496087s, tot_time:46.81004357s, max:9.902874054s, p95:9.902874054s}","Disk":0,"Memory":350266804,"Plans":[{"Node Id":"TableReader","Plan Rows":989056,"Actual Rows":1002374,"Task":"root","Total Time":3437412215,"Max Time":3437412215,"Access Object":"","Operation Info":"data:HashAgg_91","Execution Info":"time:3.44s, loops:10, cop_task: {num: 9, max: 3.4s, min: 1.82s, avg: 2.73s, p95: 3.4s, max_proc_keys: 512775, p95_proc_keys: 512775, tot_proc: 23.1s, tot_wait: 251ms, rpc_num: 9, rpc_time: 24.5s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":11716516,"Plans":[{"Node Id":"HashAgg","Plan Rows":989056,"Actual Rows":1002374,"Task":"cop[tikv]","Total Time":5051000000,"Max Time":713000000,"Access Object":"","Operation Info":"group by:new0107.lineitem.l_orderkey, funcs:sum(new0107.lineitem.l_quantity)-\u003eColumn#66","Execution Info":"tikv_task:{proc max:713ms, min:301ms, p80:675ms, p95:713ms, iters:3923, tasks:9}, scan_detail: {total_process_keys: 4009984, total_process_keys_size: 787655655, total_keys: 4009993, rocksdb: {delete_skipped_count: 0, key_skipped_count: 4009984, block: {cache_hit_count: 12898, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":3708000000,"Max Time":535000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:535ms, min:241ms, p80:502ms, p95:535ms, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]},{"Node Id":"TableReader","Plan Rows":4009984,"Actual Rows":4009984,"Task":"root","Total Time":2573549771,"Max Time":2573549771,"Access Object":"","Operation Info":"data:TableFullScan_101","Execution Info":"time:2.57s, loops:3924, cop_task: {num: 9, max: 4.54s, min: 2.27s, avg: 2.89s, p95: 4.54s, max_proc_keys: 512775, p95_proc_keys: 512775, tot_proc: 22s, tot_wait: 279ms, rpc_num: 9, rpc_time: 26s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":192576059,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4033000000,"Max Time":792000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:792ms, min:327ms, p80:462ms, p95:792ms, iters:3959, tasks:9}, scan_detail: {total_process_keys: 4009984, total_process_keys_size: 787655655, total_keys: 4009993, rocksdb: {delete_skipped_count: 0, key_skipped_count: 4009984, block: {cache_hit_count: 12898, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}
/*PLACEHOLDER*/ select  c_name,  c_custkey,  o_orderkey,  o_orderdate,  o_totalprice,  sum(l_quantity) from  customer,  orders,  lineitem where  o_orderkey in (   select    l_orderkey   from    lineitem   group by    l_orderkey having     sum(l_quantity) > 314  )  and c_custkey = o_custkey  and o_orderkey = l_orderkey group by  c_name,  c_custkey,  o_orderkey,  o_orderdate,  o_totalprice order by  o_totalprice desc,  o_orderdate limit 100;

{"Node Id":"Projection","Plan Rows":640,"Actual Rows":838,"Task":"root","Total Time":2529583058,"Max Time":2529583058,"Access Object":"","Operation Info":"new0107.partsupp.ps_partkey, Column#35","Execution Info":"time:2.53s, loops:2, Concurrency:OFF","Disk":0,"Memory":48256,"Plans":[{"Node Id":"Sort","Plan Rows":640,"Actual Rows":838,"Task":"root","Total Time":2529556910,"Max Time":2529556910,"Access Object":"","Operation Info":"Column#35:desc","Execution Info":"time:2.53s, loops:2","Disk":0,"Memory":48256,"Plans":[{"Node Id":"Selection","Plan Rows":640,"Actual Rows":838,"Task":"root","Total Time":2528564664,"Max Time":2528564664,"Access Object":"","Operation Info":"gt(Column#35, 8147162.905283000000)","Execution Info":"time:2.53s, loops:2","Disk":0,"Memory":50944,"Plans":[{"Node Id":"HashAgg","Plan Rows":800,"Actual Rows":30670,"Task":"root","Total Time":2525667283,"Max Time":2525667283,"Access Object":"","Operation Info":"group by:Column#61, funcs:sum(Column#59)-\u003eColumn#35, funcs:firstrow(Column#60)-\u003enew0107.partsupp.ps_partkey","Execution Info":"time:2.53s, loops:34, partial_worker:{wall_time:2.312985786s, concurrency:5, task_num:35, tot_wait:10.251663747s, tot_exec:360.056279ms, tot_time:10.615351866s, max:2.134898971s, p95:2.134898971s}, final_worker:{wall_time:0s, concurrency:5, task_num:25, tot_wait:11.210876147s, tot_exec:745.260613ms, tot_time:11.956159779s, max:2.502031944s, p95:2.502031944s}","Disk":0,"Memory":10041677,"Plans":[{"Node Id":"Projection","Plan Rows":800,"Actual Rows":32480,"Task":"root","Total Time":2088435837,"Max Time":2088435837,"Access Object":"","Operation Info":"mul(new0107.partsupp.ps_supplycost, cast(new0107.partsupp.ps_availqty, decimal(20,0) BINARY))-\u003eColumn#59, new0107.partsupp.ps_partkey, new0107.partsupp.ps_partkey","Execution Info":"time:2.09s, loops:36, Concurrency:OFF","Disk":0,"Memory":297776,"Plans":[{"Node Id":"HashJoin","Plan Rows":800,"Actual Rows":32480,"Task":"root","Total Time":2006699311,"Max Time":2006699311,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.supplier.s_suppkey, new0107.partsupp.ps_suppkey)]","Execution Info":"time:2.01s, loops:36, build_hash_table:{total:165.7ms, fetch:165.4ms, build:287.1µs}, probe:{concurrency:5, total:10.2s, max:2.06s, probe:1.87s, fetch:8.36s}","Disk":0,"Memory":4976,"Plans":[{"Node Id":"HashJoin","Plan Rows":10,"Actual Rows":406,"Task":"root","Total Time":165491702,"Max Time":165491702,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.supplier.s_nationkey)]","Execution Info":"time:165.5ms, loops:6, build_hash_table:{total:133.3ms, fetch:133.3ms, build:6.32µs}, probe:{concurrency:5, total:683ms, max:137.6ms, probe:1.88ms, fetch:681.1ms}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":0.025,"Actual Rows":1,"Task":"root","Total Time":133123903,"Max Time":133123903,"Access Object":"","Operation Info":"data:Selection_88","Execution Info":"time:133.1ms, loops:2, cop_task: {num: 1, max: 157.4ms, proc_keys: 25, rpc_num: 1, rpc_time: 157.3ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":248,"Plans":[{"Node Id":"Selection","Plan Rows":0.025,"Actual Rows":1,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"eq(new0107.nation.n_name, \"MOZAMBIQUE\")","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:nation, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":10000,"Actual Rows":10000,"Task":"root","Total Time":123533610,"Max Time":123533610,"Access Object":"","Operation Info":"data:TableFullScan_85","Execution Info":"time:123.5ms, loops:11, cop_task: {num: 1, max: 149.8ms, proc_keys: 0, rpc_num: 1, rpc_time: 149.7ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":160504,"Plans":[{"Node Id":"TableFullScan","Plan Rows":10000,"Actual Rows":10000,"Task":"cop[tikv]","Total Time":7000000,"Max Time":7000000,"Access Object":"","Operation Info":"table:supplier, keep order:false","Execution Info":"tikv_task:{time:7ms, loops:14}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":800000,"Actual Rows":800000,"Task":"root","Total Time":1635178825,"Max Time":1635178825,"Access Object":"","Operation Info":"data:TableFullScan_90","Execution Info":"time:1.64s, loops:783, cop_task: {num: 2, max: 1.76s, min: 1.27s, avg: 1.51s, p95: 1.76s, max_proc_keys: 529029, p95_proc_keys: 529029, tot_proc: 1.22s, tot_wait: 1ms, rpc_num: 2, rpc_time: 3.02s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":51231847,"Plans":[{"Node Id":"TableFullScan","Plan Rows":800000,"Actual Rows":800000,"Task":"cop[tikv]","Total Time":838000000,"Max Time":496000000,"Access Object":"","Operation Info":"table:partsupp, keep order:false","Execution Info":"tikv_task:{proc max:496ms, min:342ms, p80:496ms, p95:496ms, iters:790, tasks:2}, scan_detail: {total_process_keys: 800000, total_process_keys_size: 150608990, total_keys: 800002, rocksdb: {delete_skipped_count: 0, key_skipped_count: 800000, block: {cache_hit_count: 2473, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  ps_partkey,  sum(ps_supplycost * ps_availqty) as value from  partsupp,  supplier,  nation where  ps_suppkey = s_suppkey  and s_nationkey = n_nationkey  and n_name = 'MOZAMBIQUE' group by  ps_partkey having   sum(ps_supplycost * ps_availqty) > (    select     sum(ps_supplycost * ps_availqty) * 0.0001000000    from     partsupp,     supplier,     nation    where     ps_suppkey = s_suppkey     and s_nationkey = n_nationkey     and n_name = 'MOZAMBIQUE'   ) order by  value desc;

{"Node Id":"Sort","Plan Rows":1,"Actual Rows":2,"Task":"root","Total Time":1373172112,"Max Time":1373172112,"Access Object":"","Operation Info":"new0107.lineitem.l_shipmode","Execution Info":"time:1.37s, loops:2","Disk":0,"Memory":6968,"Plans":[{"Node Id":"Projection","Plan Rows":1,"Actual Rows":2,"Task":"root","Total Time":1373098933,"Max Time":1373098933,"Access Object":"","Operation Info":"new0107.lineitem.l_shipmode, Column#27, Column#28","Execution Info":"time:1.37s, loops:3, Concurrency:OFF","Disk":0,"Memory":3484,"Plans":[{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":2,"Task":"root","Total Time":1373093000,"Max Time":1373093000,"Access Object":"","Operation Info":"group by:Column#40, funcs:sum(Column#37)-\u003eColumn#27, funcs:sum(Column#38)-\u003eColumn#28, funcs:firstrow(Column#39)-\u003enew0107.lineitem.l_shipmode","Execution Info":"time:1.37s, loops:3, partial_worker:{wall_time:1.373036546s, concurrency:5, task_num:24, tot_wait:6.849444568s, tot_exec:6.428163ms, tot_time:6.855901021s, max:1.371195423s, p95:1.371195423s}, final_worker:{wall_time:1.373218193s, concurrency:5, task_num:10, tot_wait:6.856281938s, tot_exec:63.589µs, tot_time:6.856350589s, max:1.371282375s, p95:1.371282375s}","Disk":0,"Memory":1230110,"Plans":[{"Node Id":"Projection","Plan Rows":137139.56931393046,"Actual Rows":20757,"Task":"root","Total Time":1371007336,"Max Time":1371007336,"Access Object":"","Operation Info":"cast(case(or(eq(new0107.orders.o_orderpriority, 1-URGENT), eq(new0107.orders.o_orderpriority, 2-HIGH)), 1, 0), decimal(20,0) BINARY)-\u003eColumn#37, cast(case(and(ne(new0107.orders.o_orderpriority, 1-URGENT), ne(new0107.orders.o_orderpriority, 2-HIGH)), 1, 0), decimal(20,0) BINARY)-\u003eColumn#38, new0107.lineitem.l_shipmode, new0107.lineitem.l_shipmode","Execution Info":"time:1.37s, loops:25, Concurrency:5","Disk":0,"Memory":294200,"Plans":[{"Node Id":"Projection","Plan Rows":137139.56931393046,"Actual Rows":20757,"Task":"root","Total Time":1369243381,"Max Time":1369243381,"Access Object":"","Operation Info":"new0107.orders.o_orderpriority, new0107.lineitem.l_shipmode","Execution Info":"time:1.37s, loops:25, Concurrency:5","Disk":0,"Memory":110840,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":137139.56931393046,"Actual Rows":20757,"Task":"root","Total Time":1368001178,"Max Time":1368001178,"Access Object":"","Operation Info":"inner join, inner:TableReader_17, outer key:new0107.lineitem.l_orderkey, inner key:new0107.orders.o_orderkey, equal cond:eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)","Execution Info":"time:1.37s, loops:25, inner:{total:2.57s, concurrency:5, task:9, construct:17ms, fetch:2.29s, build:3.7ms, join:254.7ms}","Disk":0,"Memory":3859580,"Plans":[{"Node Id":"TableReader","Plan Rows":134783.21932571862,"Actual Rows":20773,"Task":"root","Total Time":1078244538,"Max Time":1078244538,"Access Object":"","Operation Info":"data:Selection_49","Execution Info":"time:1.08s, loops:26, cop_task: {num: 9, max: 1.03s, min: 606.1ms, avg: 875.5ms, p95: 1.03s, rpc_num: 9, rpc_time: 7.88s, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":273849,"Plans":[{"Node Id":"Selection","Plan Rows":134783.21932571862,"Actual Rows":20773,"Task":"cop[tikv]","Total Time":4954000000,"Max Time":647000000,"Access Object":"","Operation Info":"ge(new0107.lineitem.l_receiptdate, 1997-01-01 00:00:00.000000), in(new0107.lineitem.l_shipmode, \"RAIL\", \"FOB\"), lt(new0107.lineitem.l_commitdate, new0107.lineitem.l_receiptdate), lt(new0107.lineitem.l_receiptdate, 1998-01-01 00:00:00.000000), lt(new0107.lineitem.l_shipdate, new0107.lineitem.l_commitdate)","Execution Info":"tikv_task:{proc max:647ms, min:292ms, p80:636ms, p95:647ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4041000000,"Max Time":548000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:548ms, min:233ms, p80:537ms, p95:548ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":1,"Actual Rows":19515,"Task":"root","Total Time":2282411017,"Max Time":457756861,"Access Object":"","Operation Info":"data:TableRangeScan_16","Execution Info":"time:2.28s, loops:33, cop_task: {num: 13, max: 361.8ms, min: 18ms, avg: 157.4ms, p95: 361.8ms, max_proc_keys: 4026, p95_proc_keys: 4026, tot_proc: 211ms, tot_wait: 27ms, rpc_num: 25, rpc_time: 4.07s, copr_cache_hit_ratio: 0.31}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":19515,"Task":"cop[tikv]","Total Time":241000000,"Max Time":59000000,"Access Object":"","Operation Info":"table:orders, range: decided by [new0107.lineitem.l_orderkey], keep order:false","Execution Info":"tikv_task:{proc max:59ms, min:3ms, p80:33ms, p95:59ms, iters:71, tasks:13}, scan_detail: {total_process_keys: 18238, total_process_keys_size: 2764404, total_keys: 18561, rocksdb: {delete_skipped_count: 0, key_skipped_count: 625, block: {cache_hit_count: 24194, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  l_shipmode,  sum(case   when o_orderpriority = '1-URGENT'    or o_orderpriority = '2-HIGH'    then 1   else 0  end) as high_line_count,  sum(case   when o_orderpriority <> '1-URGENT'    and o_orderpriority <> '2-HIGH'    then 1   else 0  end) as low_line_count from  orders,  lineitem where  o_orderkey = l_orderkey  and l_shipmode in ('RAIL', 'FOB')  and l_commitdate < l_receiptdate  and l_shipdate < l_commitdate  and l_receiptdate >= '1997-01-01'  and l_receiptdate < date_add('1997-01-01', interval '1' year) group by  l_shipmode order by  l_shipmode;

{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":3145860415,"Max Time":3145860415,"Access Object":"","Operation Info":"funcs:sum(Column#28)-\u003eColumn#27","Execution Info":"time:3.15s, loops:2, partial_worker:{wall_time:3.135472283s, concurrency:5, task_num:1, tot_wait:15.606153531s, tot_exec:42.352µs, tot_time:15.606205087s, max:3.121248551s, p95:3.121248551s}, final_worker:{wall_time:0s, concurrency:5, task_num:1, tot_wait:15.690177115s, tot_exec:39.611µs, tot_time:15.690221325s, max:3.139140183s, p95:3.139140183s}","Disk":0,"Memory":20344,"Plans":[{"Node Id":"Projection","Plan Rows":752.2410234143051,"Actual Rows":72,"Task":"root","Total Time":3115504550,"Max Time":3115504550,"Access Object":"","Operation Info":"mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount))-\u003eColumn#28","Execution Info":"time:3.12s, loops:2, Concurrency:OFF","Disk":0,"Memory":6464,"Plans":[{"Node Id":"IndexJoin","Plan Rows":752.2410234143051,"Actual Rows":72,"Task":"root","Total Time":3115455208,"Max Time":3115455208,"Access Object":"","Operation Info":"inner join, inner:TableReader_15, outer key:new0107.lineitem.l_partkey, inner key:new0107.part.p_partkey, equal cond:eq(new0107.lineitem.l_partkey, new0107.part.p_partkey), other cond:or(and(and(eq(new0107.part.p_brand, \"Brand#52\"), in(new0107.part.p_container, \"SM CASE\", \"SM BOX\", \"SM PACK\", \"SM PKG\")), and(ge(new0107.lineitem.l_quantity, 4), and(le(new0107.lineitem.l_quantity, 14), le(new0107.part.p_size, 5)))), or(and(and(eq(new0107.part.p_brand, \"Brand#11\"), in(new0107.part.p_container, \"MED BAG\", \"MED BOX\", \"MED PKG\", \"MED PACK\")), and(ge(new0107.lineitem.l_quantity, 18), and(le(new0107.lineitem.l_quantity, 28), le(new0107.part.p_size, 10)))), and(and(eq(new0107.part.p_brand, \"Brand#51\"), in(new0107.part.p_container, \"LG CASE\", \"LG BOX\", \"LG PACK\", \"LG PKG\")), and(ge(new0107.lineitem.l_quantity, 29), and(le(new0107.lineitem.l_quantity, 39), le(new0107.part.p_size, 15))))))","Execution Info":"time:3.12s, loops:2, inner:{total:4.95s, concurrency:5, task:12, construct:589.1ms, fetch:4.36s, build:149µs}, probe:23ms","Disk":0,"Memory":29642320,"Plans":[{"Node Id":"TableReader","Plan Rows":0.0006902727524847001,"Actual Rows":200,"Task":"root","Total Time":4055566636,"Max Time":694547812,"Access Object":"","Operation Info":"data:Selection_14","Execution Info":"time:4.06s, loops:21, cop_task: {num: 12, max: 583.6ms, min: 34.4ms, avg: 289.9ms, p95: 583.6ms, max_proc_keys: 24081, p95_proc_keys: 24081, tot_proc: 827ms, tot_wait: 7ms, rpc_num: 23, rpc_time: 6.85s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":0,"Plans":[{"Node Id":"Selection","Plan Rows":0.0006902727524847001,"Actual Rows":200,"Task":"cop[tikv]","Total Time":823000000,"Max Time":245000000,"Access Object":"","Operation Info":"ge(new0107.part.p_size, 1), or(and(eq(new0107.part.p_brand, \"Brand#52\"), and(in(new0107.part.p_container, \"SM CASE\", \"SM BOX\", \"SM PACK\", \"SM PKG\"), le(new0107.part.p_size, 5))), or(and(eq(new0107.part.p_brand, \"Brand#11\"), and(in(new0107.part.p_container, \"MED BAG\", \"MED BOX\", \"MED PKG\", \"MED PACK\"), le(new0107.part.p_size, 10))), and(eq(new0107.part.p_brand, \"Brand#51\"), and(in(new0107.part.p_container, \"LG CASE\", \"LG BOX\", \"LG PACK\", \"LG PKG\"), le(new0107.part.p_size, 15)))))","Execution Info":"tikv_task:{proc max:245ms, min:1ms, p80:132ms, p95:245ms, iters:137, tasks:12}, scan_detail: {total_process_keys: 89917, total_process_keys_size: 14692312, total_keys: 97061, rocksdb: {delete_skipped_count: 0, key_skipped_count: 15118, block: {cache_hit_count: 110181, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":89917,"Task":"cop[tikv]","Total Time":757000000,"Max Time":229000000,"Access Object":"","Operation Info":"table:part, range: decided by [new0107.lineitem.l_partkey], keep order:false","Execution Info":"tikv_task:{proc max:229ms, min:0s, p80:122ms, p95:229ms, iters:137, tasks:12}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":740.8069598584078,"Actual Rows":94250,"Task":"root","Total Time":1681009736,"Max Time":1681009736,"Access Object":"","Operation Info":"data:Selection_27","Execution Info":"time:1.68s, loops:97, cop_task: {num: 9, max: 2.29s, min: 1.66s, avg: 2.06s, p95: 2.29s, max_proc_keys: 512775, p95_proc_keys: 512775, tot_proc: 12.7s, tot_wait: 104ms, rpc_num: 9, rpc_time: 18.6s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":12101345,"Plans":[{"Node Id":"Selection","Plan Rows":740.8069598584078,"Actual Rows":94250,"Task":"cop[tikv]","Total Time":7506000000,"Max Time":1015000000,"Access Object":"","Operation Info":"eq(new0107.lineitem.l_shipinstruct, \"DELIVER IN PERSON\"), in(new0107.lineitem.l_shipmode, \"AIR\", \"AIR REG\"), or(and(ge(new0107.lineitem.l_quantity, 4), le(new0107.lineitem.l_quantity, 14)), or(and(ge(new0107.lineitem.l_quantity, 18), le(new0107.lineitem.l_quantity, 28)), and(ge(new0107.lineitem.l_quantity, 29), le(new0107.lineitem.l_quantity, 39))))","Execution Info":"tikv_task:{proc max:1.02s, min:507ms, p80:962ms, p95:1.02s, iters:3959, tasks:9}, scan_detail: {total_process_keys: 4009984, total_process_keys_size: 787655655, total_keys: 4009993, rocksdb: {delete_skipped_count: 0, key_skipped_count: 4009984, block: {cache_hit_count: 12898, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4827000000,"Max Time":676000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:676ms, min:347ms, p80:624ms, p95:676ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}
/*PLACEHOLDER*/ select  sum(l_extendedprice* (1 - l_discount)) as revenue from  lineitem,  part where  (   p_partkey = l_partkey   and p_brand = 'Brand#52'   and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')   and l_quantity >= 4 and l_quantity <= 4 + 10   and p_size between 1 and 5   and l_shipmode in ('AIR', 'AIR REG')   and l_shipinstruct = 'DELIVER IN PERSON'  )  or  (   p_partkey = l_partkey   and p_brand = 'Brand#11'   and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')   and l_quantity >= 18 and l_quantity <= 18 + 10   and p_size between 1 and 10   and l_shipmode in ('AIR', 'AIR REG')   and l_shipinstruct = 'DELIVER IN PERSON'  )  or  (   p_partkey = l_partkey   and p_brand = 'Brand#51'   and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')   and l_quantity >= 29 and l_quantity <= 29 + 10   and p_size between 1 and 15   and l_shipmode in ('AIR', 'AIR REG')   and l_shipinstruct = 'DELIVER IN PERSON'  );
 drop view revenue0;

{"Node Id":"Sort","Plan Rows":10,"Actual Rows":152,"Task":"root","Total Time":3043681484,"Max Time":3043681484,"Access Object":"","Operation Info":"new0107.supplier.s_name","Execution Info":"time:3.04s, loops:2","Disk":0,"Memory":13568,"Plans":[{"Node Id":"HashJoin","Plan Rows":10,"Actual Rows":152,"Task":"root","Total Time":3043483181,"Max Time":3043483181,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.supplier.s_suppkey, new0107.partsupp.ps_suppkey)]","Execution Info":"time:3.04s, loops:6, build_hash_table:{total:432.6ms, fetch:432.3ms, build:268.8µs}, probe:{concurrency:5, total:14.7s, max:2.93s, probe:834.5µs, fetch:14.7s}","Disk":0,"Memory":35428,"Plans":[{"Node Id":"HashJoin","Plan Rows":10,"Actual Rows":420,"Task":"root","Total Time":432243858,"Max Time":432243858,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.supplier.s_nationkey)]","Execution Info":"time:432.2ms, loops:6, build_hash_table:{total:870.8µs, fetch:864.1µs, build:6.73µs}, probe:{concurrency:5, total:1.78s, max:363.7ms, probe:1.8ms, fetch:1.78s}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":0.025,"Actual Rows":1,"Task":"root","Total Time":708676,"Max Time":708676,"Access Object":"","Operation Info":"data:Selection_52","Execution Info":"time:708.7µs, loops:2, cop_task: {num: 1, max: 58.4ms, proc_keys: 25, rpc_num: 1, rpc_time: 58.4ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":245,"Plans":[{"Node Id":"Selection","Plan Rows":0.025,"Actual Rows":1,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"eq(new0107.nation.n_name, \"ALGERIA\")","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:nation, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":10000,"Actual Rows":10000,"Task":"root","Total Time":328140108,"Max Time":328140108,"Access Object":"","Operation Info":"data:TableFullScan_49","Execution Info":"time:328.1ms, loops:11, cop_task: {num: 1, max: 349.3ms, proc_keys: 10000, tot_proc: 162ms, tot_wait: 50ms, rpc_num: 1, rpc_time: 349.2ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":750762,"Plans":[{"Node Id":"TableFullScan","Plan Rows":10000,"Actual Rows":10000,"Task":"cop[tikv]","Total Time":13000000,"Max Time":13000000,"Access Object":"","Operation Info":"table:supplier, keep order:false","Execution Info":"tikv_task:{time:13ms, loops:14}, scan_detail: {total_process_keys: 10000, total_process_keys_size: 1815466, total_keys: 10001, rocksdb: {delete_skipped_count: 0, key_skipped_count: 10000, block: {cache_hit_count: 33, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"HashAgg","Plan Rows":2547.961871329696,"Actual Rows":3734,"Task":"root","Total Time":2931183395,"Max Time":2931183395,"Access Object":"","Operation Info":"group by:new0107.partsupp.ps_suppkey, funcs:firstrow(new0107.partsupp.ps_suppkey)-\u003enew0107.partsupp.ps_suppkey","Execution Info":"time:2.93s, loops:6, partial_worker:{wall_time:2.925465641s, concurrency:5, task_num:5, tot_wait:14.453594574s, tot_exec:3.495903ms, tot_time:14.457927951s, max:2.892537197s, p95:2.892537197s}, final_worker:{wall_time:2.931195532s, concurrency:5, task_num:25, tot_wait:14.505400085s, tot_exec:5.500881ms, tot_time:14.510925415s, max:2.903303892s, p95:2.903303892s}","Disk":0,"Memory":1073229,"Plans":[{"Node Id":"Selection","Plan Rows":2547.961871329696,"Actual Rows":4608,"Task":"root","Total Time":2887580215,"Max Time":2887580215,"Access Object":"","Operation Info":"gt(cast(new0107.partsupp.ps_availqty, decimal(20,0) BINARY), mul(0.5, Column#44))","Execution Info":"time:2.89s, loops:6","Disk":0,"Memory":60656,"Plans":[{"Node Id":"HashAgg","Plan Rows":3184.9523391621196,"Actual Rows":8576,"Task":"root","Total Time":2884790250,"Max Time":2884790250,"Access Object":"","Operation Info":"group by:new0107.partsupp.ps_partkey, new0107.partsupp.ps_suppkey, funcs:firstrow(new0107.partsupp.ps_suppkey)-\u003enew0107.partsupp.ps_suppkey, funcs:firstrow(new0107.partsupp.ps_availqty)-\u003enew0107.partsupp.ps_availqty, funcs:sum(new0107.lineitem.l_quantity)-\u003eColumn#44","Execution Info":"time:2.88s, loops:12, partial_worker:{wall_time:2.862189563s, concurrency:5, task_num:16, tot_wait:14.198469887s, tot_exec:15.255792ms, tot_time:14.215099439s, max:2.844414664s, p95:2.844414664s}, final_worker:{wall_time:2.887602765s, concurrency:5, task_num:25, tot_wait:14.330701795s, tot_exec:42.739413ms, tot_time:14.373457422s, max:2.884280657s, p95:2.884280657s}","Disk":0,"Memory":4064897,"Plans":[{"Node Id":"HashJoin","Plan Rows":64843.663285959956,"Actual Rows":10496,"Task":"root","Total Time":2837283682,"Max Time":2837283682,"Access Object":"","Operation Info":"left outer join, equal:[eq(new0107.partsupp.ps_partkey, new0107.lineitem.l_partkey) eq(new0107.partsupp.ps_suppkey, new0107.lineitem.l_suppkey)]","Execution Info":"time:2.84s, loops:17, build_hash_table:{total:2.59s, fetch:2.58s, build:8.54ms}, probe:{concurrency:5, total:14.1s, max:2.81s, probe:361.5ms, fetch:13.7s}","Disk":0,"Memory":303864,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":3184.9523391621196,"Actual Rows":8576,"Task":"root","Total Time":2585250751,"Max Time":2585250751,"Access Object":"","Operation Info":"inner join, inner:IndexLookUp_64, outer key:new0107.part.p_partkey, inner key:new0107.partsupp.ps_partkey, equal cond:eq(new0107.part.p_partkey, new0107.partsupp.ps_partkey)","Execution Info":"time:2.59s, loops:13, inner:{total:6.99s, concurrency:5, task:6, construct:4.8ms, fetch:6.89s, build:822.3µs, join:100.8ms}","Disk":0,"Memory":838775,"Plans":[{"Node Id":"TableReader","Plan Rows":784.1352659017139,"Actual Rows":2144,"Task":"root","Total Time":941256414,"Max Time":941256414,"Access Object":"","Operation Info":"data:Selection_95","Execution Info":"time:941.3ms, loops:8, cop_task: {num: 1, max: 875.7ms, proc_keys: 200000, tot_proc: 739ms, rpc_num: 1, rpc_time: 875.7ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":109156,"Plans":[{"Node Id":"Selection","Plan Rows":784.1352659017139,"Actual Rows":2144,"Task":"cop[tikv]","Total Time":234000000,"Max Time":234000000,"Access Object":"","Operation Info":"like(new0107.part.p_name, \"green%\", 92)","Execution Info":"tikv_task:{time:234ms, loops:200}, scan_detail: {total_process_keys: 200000, total_process_keys_size: 32687576, total_keys: 200001, rocksdb: {delete_skipped_count: 0, key_skipped_count: 200000, block: {cache_hit_count: 546, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":200000,"Actual Rows":200000,"Task":"cop[tikv]","Total Time":206000000,"Max Time":206000000,"Access Object":"","Operation Info":"table:part, keep order:false","Execution Info":"tikv_task:{time:206ms, loops:200}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"IndexLookUp","Plan Rows":4.061738424045491,"Actual Rows":8576,"Task":"root","Total Time":6870802337,"Max Time":1607861149,"Access Object":"","Operation Info":"","Execution Info":"time:6.87s, loops:19, index_task: {total_time: 3.35s, fetch_handle: 3.35s, build: 55.7µs, wait: 30.5µs}, table_task: {total_time: 4.14s, num: 10, concurrency: 30}","Disk":0,"Memory":239428,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":4.061738424045491,"Actual Rows":8576,"Task":"cop[tikv]","Total Time":67000000,"Max Time":30000000,"Access Object":"","Operation Info":"table:partsupp, index:PRIMARY(PS_PARTKEY, PS_SUPPKEY), range: decided by [eq(new0107.partsupp.ps_partkey, new0107.part.p_partkey)], keep order:false","Execution Info":"time:3.34s, loops:25, cop_task: {num: 6, max: 1.17s, min: 86.9ms, avg: 479ms, p95: 1.17s, max_proc_keys: 4100, p95_proc_keys: 4100, tot_proc: 79ms, tot_wait: 4ms, rpc_num: 11, rpc_time: 5.66s, copr_cache_hit_ratio: 0.00}, tikv_task:{proc max:30ms, min:2ms, p80:20ms, p95:30ms, iters:36, tasks:6}, scan_detail: {total_process_keys: 8576, total_process_keys_size: 454528, total_keys: 10720, rocksdb: {delete_skipped_count: 0, key_skipped_count: 8576, block: {cache_hit_count: 8583, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]},{"Node Id":"TableRowIDScan","Plan Rows":4.061738424045491,"Actual Rows":8576,"Task":"cop[tikv]","Total Time":58000000,"Max Time":15000000,"Access Object":"","Operation Info":"table:partsupp, keep order:false","Execution Info":"time:4.13s, loops:24, cop_task: {num: 11, max: 838.6ms, min: 51.1ms, avg: 353.4ms, p95: 838.6ms, max_proc_keys: 2048, p95_proc_keys: 2048, tot_proc: 59ms, tot_wait: 18ms, rpc_num: 21, rpc_time: 7.72s, copr_cache_hit_ratio: 0.00}, tikv_task:{proc max:15ms, min:0s, p80:7ms, p95:15ms, iters:50, tasks:11}, scan_detail: {total_process_keys: 8576, total_process_keys_size: 1607645, total_keys: 10705, rocksdb: {delete_skipped_count: 0, key_skipped_count: 8576, block: {cache_hit_count: 8541, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":599374.3333333333,"Actual Rows":606222,"Task":"root","Total Time":809782187,"Max Time":809782187,"Access Object":"","Operation Info":"data:Selection_100","Execution Info":"time:809.8ms, loops:592, cop_task: {num: 9, max: 2.2s, min: 589.6ms, avg: 1.3s, p95: 2.2s, max_proc_keys: 512775, p95_proc_keys: 512775, tot_proc: 7.09s, tot_wait: 380ms, rpc_num: 9, rpc_time: 11.7s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":38950643,"Plans":[{"Node Id":"Selection","Plan Rows":599374.3333333333,"Actual Rows":606222,"Task":"cop[tikv]","Total Time":4423000000,"Max Time":656000000,"Access Object":"","Operation Info":"ge(new0107.lineitem.l_shipdate, 1993-01-01 00:00:00.000000), lt(new0107.lineitem.l_shipdate, 1994-01-01 00:00:00.000000)","Execution Info":"tikv_task:{proc max:656ms, min:273ms, p80:546ms, p95:656ms, iters:3959, tasks:9}, scan_detail: {total_process_keys: 4009984, total_process_keys_size: 787655655, total_keys: 4009993, rocksdb: {delete_skipped_count: 0, key_skipped_count: 4009984, block: {cache_hit_count: 12898, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4155000000,"Max Time":600000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:600ms, min:257ms, p80:522ms, p95:600ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  s_name,  s_address from  supplier,  nation where  s_suppkey in (   select    ps_suppkey   from    partsupp   where    ps_partkey in (     select      p_partkey     from      part     where      p_name like 'green%'    )    and ps_availqty > (     select      0.5 * sum(l_quantity)     from      lineitem     where      l_partkey = ps_partkey      and l_suppkey = ps_suppkey      and l_shipdate >= '1993-01-01'      and l_shipdate < date_add('1993-01-01', interval '1' year)    )  )  and s_nationkey = n_nationkey  and n_name = 'ALGERIA' order by  s_name;

{"Node Id":"Sort","Plan Rows":2946.178694158076,"Actual Rows":175,"Task":"root","Total Time":21030570562,"Max Time":21030570562,"Access Object":"","Operation Info":"new0107.nation.n_name, Column#53:desc","Execution Info":"time:21s, loops:2","Disk":0,"Memory":17276,"Plans":[{"Node Id":"Projection","Plan Rows":2946.178694158076,"Actual Rows":175,"Task":"root","Total Time":21030341160,"Max Time":21030341160,"Access Object":"","Operation Info":"new0107.nation.n_name, Column#53, Column#55","Execution Info":"time:21s, loops:6, Concurrency:5","Disk":0,"Memory":25628,"Plans":[{"Node Id":"HashAgg","Plan Rows":2946.178694158076,"Actual Rows":175,"Task":"root","Total Time":20980136880,"Max Time":20980136880,"Access Object":"","Operation Info":"group by:Column#67, Column#68, funcs:sum(Column#64)-\u003eColumn#55, funcs:firstrow(Column#65)-\u003enew0107.nation.n_name, funcs:firstrow(Column#66)-\u003eColumn#53","Execution Info":"time:21s, loops:6, partial_worker:{wall_time:20.968325995s, concurrency:5, task_num:216, tot_wait:1m43.700502515s, tot_exec:1.092664567s, tot_time:1m44.793524688s, max:20.95882954s, p95:20.95882954s}, final_worker:{wall_time:20.980507742s, concurrency:5, task_num:25, tot_wait:1m44.826340341s, tot_exec:901.087µs, tot_time:1m44.827250302s, max:20.966226168s, p95:20.966226168s}","Disk":0,"Memory":1375637,"Plans":[{"Node Id":"Projection","Plan Rows":3331507.8607707974,"Actual Rows":217738,"Task":"root","Total Time":20954194941,"Max Time":20954194941,"Access Object":"","Operation Info":"minus(mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount)), mul(new0107.partsupp.ps_supplycost, new0107.lineitem.l_quantity))-\u003eColumn#64, new0107.nation.n_name, extract(YEAR, new0107.orders.o_orderdate)-\u003eColumn#66, new0107.nation.n_name, extract(YEAR, new0107.orders.o_orderdate)-\u003eColumn#68","Execution Info":"time:21s, loops:217, Concurrency:5","Disk":0,"Memory":1522488,"Plans":[{"Node Id":"Projection","Plan Rows":3331507.8607707974,"Actual Rows":217738,"Task":"root","Total Time":20942727374,"Max Time":20942727374,"Access Object":"","Operation Info":"new0107.lineitem.l_quantity, new0107.lineitem.l_extendedprice, new0107.lineitem.l_discount, new0107.partsupp.ps_supplycost, new0107.orders.o_orderdate, new0107.nation.n_name","Execution Info":"time:20.9s, loops:217, Concurrency:5","Disk":0,"Memory":1931248,"Plans":[{"Node Id":"HashJoin","Plan Rows":3331507.8607707974,"Actual Rows":217738,"Task":"root","Total Time":20932621208,"Max Time":20932621208,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)]","Execution Info":"time:20.9s, loops:217, build_hash_table:{total:4.86s, fetch:962.4ms, build:3.89s}, probe:{concurrency:5, total:1m44.6s, max:20.9s, probe:6.47s, fetch:1m38.1s}","Disk":0,"Memory":16507392,"Plans":[{"Node Id":"HashJoin","Plan Rows":3274265.4576647705,"Actual Rows":217928,"Task":"root","Total Time":20907332099,"Max Time":20907332099,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.lineitem.l_suppkey, new0107.partsupp.ps_suppkey) eq(new0107.lineitem.l_partkey, new0107.partsupp.ps_partkey)]","Execution Info":"time:20.9s, loops:217, build_hash_table:{total:6.38s, fetch:4.43s, build:1.94s}, probe:{concurrency:5, total:1m44.5s, max:20.9s, probe:7.99s, fetch:1m36.5s}","Disk":0,"Memory":45451936,"Plans":[{"Node Id":"HashJoin","Plan Rows":3257501.218521527,"Actual Rows":217928,"Task":"root","Total Time":16904968672,"Max Time":16904968672,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.lineitem.l_partkey, new0107.part.p_partkey)]","Execution Info":"time:16.9s, loops:217, build_hash_table:{total:630.6ms, fetch:503.9ms, build:126.7ms}, probe:{concurrency:5, total:1m44.4s, max:20.9s, probe:30.6s, fetch:1m13.8s}","Disk":0,"Memory":587600,"Plans":[{"Node Id":"HashJoin","Plan Rows":4009984,"Actual Rows":4009984,"Task":"root","Total Time":16885135317,"Max Time":16885135317,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.supplier.s_suppkey, new0107.lineitem.l_suppkey)]","Execution Info":"time:16.9s, loops:3920, build_hash_table:{total:898.5ms, fetch:894ms, build:4.57ms}, probe:{concurrency:5, total:1m44.2s, max:20.9s, probe:1m28.2s, fetch:16s}","Disk":0,"Memory":271000,"Plans":[{"Node Id":"HashJoin","Plan Rows":10000,"Actual Rows":10000,"Task":"root","Total Time":897920600,"Max Time":897920600,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.supplier.s_nationkey)]","Execution Info":"time:897.9ms, loops:11, build_hash_table:{total:132.3ms, fetch:131.9ms, build:327.3µs}, probe:{concurrency:5, total:4.41s, max:894.6ms, probe:517.5ms, fetch:3.89s}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":25,"Actual Rows":25,"Task":"root","Total Time":131851314,"Max Time":131851314,"Access Object":"","Operation Info":"data:TableFullScan_106","Execution Info":"time:131.9ms, loops:2, cop_task: {num: 1, max: 215.9ms, proc_keys: 25, tot_proc: 1ms, tot_wait: 115ms, rpc_num: 1, rpc_time: 215.9ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":808,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":1000000,"Max Time":1000000,"Access Object":"","Operation Info":"table:nation, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:1ms, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]},{"Node Id":"TableReader","Plan Rows":10000,"Actual Rows":10000,"Task":"root","Total Time":629114780,"Max Time":629114780,"Access Object":"","Operation Info":"data:TableFullScan_104","Execution Info":"time:629.1ms, loops:11, cop_task: {num: 1, max: 675.1ms, proc_keys: 0, rpc_num: 1, rpc_time: 675ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":160504,"Plans":[{"Node Id":"TableFullScan","Plan Rows":10000,"Actual Rows":10000,"Task":"cop[tikv]","Total Time":7000000,"Max Time":7000000,"Access Object":"","Operation Info":"table:supplier, keep order:false","Execution Info":"tikv_task:{time:7ms, loops:14}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":4009984,"Actual Rows":4009984,"Task":"root","Total Time":2697086813,"Max Time":2697086813,"Access Object":"","Operation Info":"data:TableFullScan_108","Execution Info":"time:2.7s, loops:3924, cop_task: {num: 9, max: 4.48s, min: 2.06s, avg: 3.09s, p95: 4.48s, max_proc_keys: 512775, p95_proc_keys: 512775, tot_proc: 16.5s, tot_wait: 683ms, rpc_num: 9, rpc_time: 27.8s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":577661255,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":5200000000,"Max Time":777000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:777ms, min:410ms, p80:690ms, p95:777ms, iters:3959, tasks:9}, scan_detail: {total_process_keys: 4009984, total_process_keys_size: 787655655, total_keys: 4009993, rocksdb: {delete_skipped_count: 0, key_skipped_count: 4009984, block: {cache_hit_count: 12898, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":160000,"Actual Rows":10899,"Task":"root","Total Time":503530714,"Max Time":503530714,"Access Object":"","Operation Info":"data:Selection_111","Execution Info":"time:503.5ms, loops:12, cop_task: {num: 1, max: 325.4ms, proc_keys: 0, rpc_num: 1, rpc_time: 325.4ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":508461,"Plans":[{"Node Id":"Selection","Plan Rows":160000,"Actual Rows":10899,"Task":"cop[tikv]","Total Time":357000000,"Max Time":357000000,"Access Object":"","Operation Info":"like(new0107.part.p_name, \"%dim%\", 92)","Execution Info":"tikv_task:{time:357ms, loops:200}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":200000,"Actual Rows":200000,"Task":"cop[tikv]","Total Time":222000000,"Max Time":222000000,"Access Object":"","Operation Info":"table:part, keep order:false","Execution Info":"tikv_task:{time:222ms, loops:200}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"TableReader","Plan Rows":800000,"Actual Rows":800000,"Task":"root","Total Time":3742215086,"Max Time":3742215086,"Access Object":"","Operation Info":"data:TableFullScan_113","Execution Info":"time:3.74s, loops:783, cop_task: {num: 2, max: 4.45s, min: 1.26s, avg: 2.86s, p95: 4.45s, max_proc_keys: 529029, p95_proc_keys: 529029, tot_proc: 3.28s, tot_wait: 273ms, rpc_num: 2, rpc_time: 5.71s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":44825524,"Plans":[{"Node Id":"TableFullScan","Plan Rows":800000,"Actual Rows":800000,"Task":"cop[tikv]","Total Time":771000000,"Max Time":511000000,"Access Object":"","Operation Info":"table:partsupp, keep order:false","Execution Info":"tikv_task:{proc max:511ms, min:260ms, p80:511ms, p95:511ms, iters:790, tasks:2}, scan_detail: {total_process_keys: 800000, total_process_keys_size: 150608990, total_keys: 800002, rocksdb: {delete_skipped_count: 0, key_skipped_count: 800000, block: {cache_hit_count: 2473, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":1094656,"Actual Rows":1001472,"Task":"root","Total Time":505059844,"Max Time":505059844,"Access Object":"","Operation Info":"data:TableFullScan_115","Execution Info":"time:505.1ms, loops:980, cop_task: {num: 2, max: 630.2ms, min: 371.3ms, avg: 500.7ms, p95: 630.2ms, rpc_num: 2, rpc_time: 1s, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":16047433,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":757000000,"Max Time":437000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:437ms, min:320ms, p80:437ms, p95:437ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  nation,  o_year,  sum(amount) as sum_profit from  (   select    n_name as nation,    extract(year from o_orderdate) as o_year,    l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount   from    part,    supplier,    lineitem,    partsupp,    orders,    nation   where    s_suppkey = l_suppkey    and ps_suppkey = l_suppkey    and ps_partkey = l_partkey    and p_partkey = l_partkey    and o_orderkey = l_orderkey    and s_nationkey = n_nationkey    and p_name like '%dim%'  ) as profit group by  nation,  o_year order by  nation,  o_year desc;

{"Node Id":"Sort","Plan Rows":8.43216,"Actual Rows":18333,"Task":"root","Total Time":2151721494,"Max Time":2151721494,"Access Object":"","Operation Info":"Column#23:desc, new0107.part.p_brand, new0107.part.p_type, new0107.part.p_size","Execution Info":"time:2.15s, loops:19","Disk":0,"Memory":1362656,"Plans":[{"Node Id":"Projection","Plan Rows":8.43216,"Actual Rows":18333,"Task":"root","Total Time":1996864239,"Max Time":1996864239,"Access Object":"","Operation Info":"new0107.part.p_brand, new0107.part.p_type, new0107.part.p_size, Column#23","Execution Info":"time:2s, loops:19, Concurrency:OFF","Disk":0,"Memory":1328656,"Plans":[{"Node Id":"HashAgg","Plan Rows":8.43216,"Actual Rows":18333,"Task":"root","Total Time":1996772342,"Max Time":1996772342,"Access Object":"","Operation Info":"group by:new0107.part.p_brand, new0107.part.p_size, new0107.part.p_type, funcs:count(distinct new0107.partsupp.ps_suppkey)-\u003eColumn#23, funcs:firstrow(new0107.part.p_brand)-\u003enew0107.part.p_brand, funcs:firstrow(new0107.part.p_type)-\u003enew0107.part.p_type, funcs:firstrow(new0107.part.p_size)-\u003enew0107.part.p_size","Execution Info":"time:2s, loops:19","Disk":0,"Memory":8761243,"Plans":[{"Node Id":"HashJoin","Plan Rows":45665.63769293257,"Actual Rows":119078,"Task":"root","Total Time":961847178,"Max Time":961847178,"Access Object":"","Operation Info":"anti semi join, equal:[eq(new0107.partsupp.ps_suppkey, new0107.supplier.s_suppkey)]","Execution Info":"time:961.8ms, loops:119, build_hash_table:{total:61.1ms, fetch:61.1ms, build:8.88µs}, probe:{concurrency:5, total:9.9s, max:1.98s, probe:3.29s, fetch:6.61s}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"Projection","Plan Rows":57082.04711616571,"Actual Rows":119136,"Task":"root","Total Time":1543542656,"Max Time":1543542656,"Access Object":"","Operation Info":"new0107.partsupp.ps_suppkey, new0107.part.p_brand, new0107.part.p_type, new0107.part.p_size","Execution Info":"time:1.54s, loops:120, Concurrency:5","Disk":0,"Memory":760800,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":57082.04711616571,"Actual Rows":119136,"Task":"root","Total Time":1632886325,"Max Time":1632886325,"Access Object":"","Operation Info":"inner join, inner:IndexReader_33, outer key:new0107.part.p_partkey, inner key:new0107.partsupp.ps_partkey, equal cond:eq(new0107.part.p_partkey, new0107.partsupp.ps_partkey)","Execution Info":"time:1.63s, loops:120, inner:{total:4.54s, concurrency:5, task:9, construct:37.6ms, fetch:2.63s, build:144.2ms, join:1.87s}","Disk":0,"Memory":9857301,"Plans":[{"Node Id":"TableReader","Plan Rows":14053.599999999999,"Actual Rows":29784,"Task":"root","Total Time":77786131,"Max Time":77786131,"Access Object":"","Operation Info":"data:Selection_60","Execution Info":"time:77.8ms, loops:35, cop_task: {num: 1, max: 44.7ms, proc_keys: 0, rpc_num: 1, rpc_time: 44.7ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":1817788,"Plans":[{"Node Id":"Selection","Plan Rows":14053.599999999999,"Actual Rows":29784,"Task":"cop[tikv]","Total Time":324000000,"Max Time":324000000,"Access Object":"","Operation Info":"in(new0107.part.p_size, 48, 19, 12, 4, 41, 7, 21, 39), ne(new0107.part.p_brand, \"Brand#34\"), not(like(new0107.part.p_type, \"LARGE BRUSHED%\", 92))","Execution Info":"tikv_task:{time:324ms, loops:200}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":200000,"Actual Rows":200000,"Task":"cop[tikv]","Total Time":261000000,"Max Time":261000000,"Access Object":"","Operation Info":"table:part, keep order:false","Execution Info":"tikv_task:{time:261ms, loops:200}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"IndexReader","Plan Rows":4.061738424045491,"Actual Rows":119136,"Task":"root","Total Time":2234799887,"Max Time":776353720,"Access Object":"","Operation Info":"index:IndexRangeScan_32","Execution Info":"time:2.23s, loops:133, cop_task: {num: 9, max: 749.9ms, min: 23.4ms, avg: 225.5ms, p95: 749.9ms, max_proc_keys: 53228, p95_proc_keys: 53228, tot_proc: 1.22s, tot_wait: 88ms, rpc_num: 17, rpc_time: 4.03s, copr_cache_hit_ratio: 0.11}","Disk":0,"Memory":68398,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":4.061738424045491,"Actual Rows":119136,"Task":"cop[tikv]","Total Time":932000000,"Max Time":389000000,"Access Object":"","Operation Info":"table:partsupp, index:PRIMARY(PS_PARTKEY, PS_SUPPKEY), range: decided by [eq(new0107.partsupp.ps_partkey, new0107.part.p_partkey)], keep order:false","Execution Info":"tikv_task:{proc max:389ms, min:1ms, p80:345ms, p95:389ms, iters:159, tasks:9}, scan_detail: {total_process_keys: 117188, total_process_keys_size: 6210964, total_keys: 146485, rocksdb: {delete_skipped_count: 0, key_skipped_count: 117188, block: {cache_hit_count: 117275, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"TableReader","Plan Rows":8000,"Actual Rows":4,"Task":"root","Total Time":61085089,"Max Time":61085089,"Access Object":"","Operation Info":"data:Selection_67","Execution Info":"time:61.1ms, loops:2, cop_task: {num: 1, max: 61ms, proc_keys: 0, rpc_num: 1, rpc_time: 60.9ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":572,"Plans":[{"Node Id":"Selection","Plan Rows":8000,"Actual Rows":4,"Task":"cop[tikv]","Total Time":16000000,"Max Time":16000000,"Access Object":"","Operation Info":"like(new0107.supplier.s_comment, \"%Customer%Complaints%\", 92)","Execution Info":"tikv_task:{time:16ms, loops:14}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":10000,"Actual Rows":10000,"Task":"cop[tikv]","Total Time":9000000,"Max Time":9000000,"Access Object":"","Operation Info":"table:supplier, keep order:false","Execution Info":"tikv_task:{time:9ms, loops:14}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  p_brand,  p_type,  p_size,  count(distinct ps_suppkey) as supplier_cnt from  partsupp,  part where  p_partkey = ps_partkey  and p_brand <> 'Brand#34'  and p_type not like 'LARGE BRUSHED%'  and p_size in (48, 19, 12, 4, 41, 7, 21, 39)  and ps_suppkey not in (   select    s_suppkey   from    supplier   where    s_comment like '%Customer%Complaints%'  ) group by  p_brand,  p_type,  p_size order by  supplier_cnt desc,  p_brand,  p_type,  p_size;

{"Node Id":"Sort","Plan Rows":149568,"Actual Rows":33,"Task":"root","Total Time":6864045404,"Max Time":6864045404,"Access Object":"","Operation Info":"Column#19:desc, Column#18:desc","Execution Info":"time:6.86s, loops:2","Disk":0,"Memory":3720,"Plans":[{"Node Id":"Projection","Plan Rows":149568,"Actual Rows":33,"Task":"root","Total Time":6863995261,"Max Time":6863995261,"Access Object":"","Operation Info":"Column#18, Column#19","Execution Info":"time:6.86s, loops:6, Concurrency:5","Disk":0,"Memory":7440,"Plans":[{"Node Id":"HashAgg","Plan Rows":149568,"Actual Rows":33,"Task":"root","Total Time":6863813386,"Max Time":6863813386,"Access Object":"","Operation Info":"group by:Column#18, funcs:count(1)-\u003eColumn#19, funcs:firstrow(Column#18)-\u003eColumn#18","Execution Info":"time:6.86s, loops:6, partial_worker:{wall_time:6.863742566s, concurrency:5, task_num:150, tot_wait:34.289472443s, tot_exec:27.517455ms, tot_time:34.317102454s, max:6.863446398s, p95:6.863446398s}, final_worker:{wall_time:6.863905206s, concurrency:5, task_num:25, tot_wait:34.317789562s, tot_exec:164.727µs, tot_time:34.317961728s, max:6.863614098s, p95:6.863614098s}","Disk":0,"Memory":229446,"Plans":[{"Node Id":"HashAgg","Plan Rows":149568,"Actual Rows":150000,"Task":"root","Total Time":6863057007,"Max Time":6863057007,"Access Object":"","Operation Info":"group by:new0107.customer.c_custkey, funcs:count(new0107.orders.o_orderkey)-\u003eColumn#18","Execution Info":"time:6.86s, loops:151, partial_worker:{wall_time:5.608657565s, concurrency:5, task_num:1020, tot_wait:22.042383394s, tot_exec:5.485644075s, tot_time:27.821203434s, max:5.607373717s, p95:5.607373717s}, final_worker:{wall_time:6.863277735s, concurrency:5, task_num:25, tot_wait:27.958377167s, tot_exec:4.633707771s, tot_time:32.592109806s, max:6.863076256s, p95:6.863076256s}","Disk":0,"Memory":59670603,"Plans":[{"Node Id":"HashJoin","Plan Rows":878254.1720154043,"Actual Rows":1040728,"Task":"root","Total Time":5437399917,"Max Time":5437399917,"Access Object":"","Operation Info":"left outer join, equal:[eq(new0107.customer.c_custkey, new0107.orders.o_custkey)]","Execution Info":"time:5.44s, loops:1021, build_hash_table:{total:368.1ms, fetch:108.6ms, build:259.6ms}, probe:{concurrency:5, total:27.1s, max:5.41s, probe:16s, fetch:11s}","Disk":0,"Memory":1262960,"Plans":[{"Node Id":"TableReader","Plan Rows":150000,"Actual Rows":150000,"Task":"root","Total Time":107261809,"Max Time":107261809,"Access Object":"","Operation Info":"data:TableFullScan_17","Execution Info":"time:107.3ms, loops:148, cop_task: {num: 1, max: 106.5ms, proc_keys: 0, rpc_num: 1, rpc_time: 106.4ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":1202294,"Plans":[{"Node Id":"TableFullScan","Plan Rows":150000,"Actual Rows":150000,"Task":"cop[tikv]","Total Time":89000000,"Max Time":89000000,"Access Object":"","Operation Info":"table:customer, keep order:false","Execution Info":"tikv_task:{time:89ms, loops:151}","Disk":0,"Memory":0,"Plans":[]}]},{"Node Id":"TableReader","Plan Rows":875724.8,"Actual Rows":990658,"Task":"root","Total Time":2035985021,"Max Time":2035985021,"Access Object":"","Operation Info":"data:Selection_20","Execution Info":"time:2.04s, loops:980, cop_task: {num: 2, max: 2.05s, min: 2.02s, avg: 2.03s, p95: 2.05s, max_proc_keys: 583494, p95_proc_keys: 583494, tot_proc: 1.81s, tot_wait: 2ms, rpc_num: 2, rpc_time: 4.07s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":71780726,"Plans":[{"Node Id":"Selection","Plan Rows":875724.8,"Actual Rows":990658,"Task":"cop[tikv]","Total Time":1512000000,"Max Time":882000000,"Access Object":"","Operation Info":"not(like(new0107.orders.o_comment, \"%pending%deposits%\", 92))","Execution Info":"tikv_task:{proc max:882ms, min:630ms, p80:882ms, p95:882ms, iters:987, tasks:2}, scan_detail: {total_process_keys: 1001472, total_process_keys_size: 151717700, total_keys: 1001474, rocksdb: {delete_skipped_count: 0, key_skipped_count: 1001472, block: {cache_hit_count: 2529, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":917000000,"Max Time":530000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:530ms, min:387ms, p80:530ms, p95:530ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  c_count,  count(*) as custdist from  (   select    c_custkey,    count(o_orderkey) as c_count   from    customer left outer join orders on     c_custkey = o_custkey     and o_comment not like '%pending%deposits%'   group by    c_custkey  ) c_orders group by  c_count order by  custdist desc,  c_count desc;

{"Node Id":"Projection","Plan Rows":100,"Actual Rows":6,"Task":"root","Total Time":15237993118,"Max Time":15237993118,"Access Object":"","Operation Info":"new0107.customer.c_name, new0107.customer.c_custkey, new0107.orders.o_orderkey, new0107.orders.o_orderdate, new0107.orders.o_totalprice, Column#54","Execution Info":"time:15.2s, loops:2, Concurrency:OFF","Disk":0,"Memory":4600,"Plans":[{"Node Id":"TopN","Plan Rows":100,"Actual Rows":6,"Task":"root","Total Time":15237984807,"Max Time":15237984807,"Access Object":"","Operation Info":"new0107.orders.o_totalprice:desc, new0107.orders.o_orderdate, offset:0, count:100","Execution Info":"time:15.2s, loops:2","Disk":0,"Memory":9248,"Plans":[{"Node Id":"HashAgg","Plan Rows":807403.0718960115,"Actual Rows":6,"Task":"root","Total Time":15237903674,"Max Time":15237903674,"Access Object":"","Operation Info":"group by:new0107.customer.c_custkey, new0107.customer.c_name, new0107.orders.o_orderdate, new0107.orders.o_orderkey, new0107.orders.o_totalprice, funcs:sum(new0107.lineitem.l_quantity)-\u003eColumn#54, funcs:firstrow(new0107.customer.c_custkey)-\u003enew0107.customer.c_custkey, funcs:firstrow(new0107.customer.c_name)-\u003enew0107.customer.c_name, funcs:firstrow(new0107.orders.o_orderkey)-\u003enew0107.orders.o_orderkey, funcs:firstrow(new0107.orders.o_totalprice)-\u003enew0107.orders.o_totalprice, funcs:firstrow(new0107.orders.o_orderdate)-\u003enew0107.orders.o_orderdate","Execution Info":"time:15.2s, loops:4, partial_worker:{wall_time:15.229665444s, concurrency:5, task_num:2, tot_wait:1m15.781067242s, tot_exec:112.425µs, tot_time:1m15.781193625s, max:15.15624821s, p95:15.15624821s}, final_worker:{wall_time:0s, concurrency:5, task_num:4, tot_wait:1m15.93214358s, tot_exec:2.219625ms, tot_time:1m15.934369551s, max:15.187478609s, p95:15.187478609s}","Disk":0,"Memory":54302,"Plans":[{"Node Id":"HashJoin","Plan Rows":3273498.568184062,"Actual Rows":42,"Task":"root","Total Time":15163580902,"Max Time":15163580902,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.orders.o_orderkey, new0107.lineitem.l_orderkey)]","Execution Info":"time:15.2s, loops:3, build_hash_table:{total:14.5s, fetch:14.5s, build:47.1µs}, probe:{concurrency:5, total:1m15.6s, max:15.2s, probe:2.14s, fetch:1m13.5s}","Disk":0,"Memory":15860,"Plans":[{"Node Id":"HashJoin","Plan Rows":807403.0718960115,"Actual Rows":6,"Task":"root","Total Time":14494496207,"Max Time":14494496207,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.orders.o_orderkey, new0107.lineitem.l_orderkey)]","Execution Info":"time:14.5s, loops:6, build_hash_table:{total:11.1s, fetch:11.1s, build:13.1µs}, probe:{concurrency:5, total:1m12.5s, max:14.5s, probe:454.9ms, fetch:1m12s}","Disk":0,"Memory":49664,"Plans":[{"Node Id":"HashJoin","Plan Rows":1097817.7150192554,"Actual Rows":1001472,"Task":"root","Total Time":6804960353,"Max Time":6804960353,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.customer.c_custkey, new0107.orders.o_custkey)]","Execution Info":"time:6.8s, loops:980, build_hash_table:{total:3.38s, fetch:2.36s, build:1.02s}, probe:{concurrency:5, total:1m12.4s, max:14.5s, probe:55.1s, fetch:17.3s}","Disk":0,"Memory":5182368,"Plans":[{"Node Id":"TableReader","Plan Rows":150000,"Actual Rows":150000,"Task":"root","Total Time":2022357935,"Max Time":2022357935,"Access Object":"","Operation Info":"data:TableFullScan_88","Execution Info":"time:2.02s, loops:148, cop_task: {num: 1, max: 1.87s, proc_keys: 0, rpc_num: 1, rpc_time: 1.87s, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":5105005,"Plans":[{"Node Id":"TableFullScan","Plan Rows":150000,"Actual Rows":150000,"Task":"cop[tikv]","Total Time":169000000,"Max Time":169000000,"Access Object":"","Operation Info":"table:customer, keep order:false","Execution Info":"tikv_task:{time:169ms, loops:151}","Disk":0,"Memory":0,"Plans":[]}]},{"Node Id":"TableReader","Plan Rows":1094656,"Actual Rows":1001472,"Task":"root","Total Time":1898130182,"Max Time":1898130182,"Access Object":"","Operation Info":"data:TableFullScan_86","Execution Info":"time:1.9s, loops:980, cop_task: {num: 2, max: 2.42s, min: 1.9s, avg: 2.16s, p95: 2.42s, max_proc_keys: 583494, p95_proc_keys: 583494, tot_proc: 2.59s, tot_wait: 31ms, rpc_num: 2, rpc_time: 4.32s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":64133924,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":1051000000,"Max Time":577000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:577ms, min:474ms, p80:577ms, p95:577ms, iters:987, tasks:2}, scan_detail: {total_process_keys: 1001472, total_process_keys_size: 151717700, total_keys: 1001474, rocksdb: {delete_skipped_count: 0, key_skipped_count: 1001472, block: {cache_hit_count: 2529, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"Selection","Plan Rows":791244.8,"Actual Rows":6,"Task":"root","Total Time":11069419735,"Max Time":11069419735,"Access Object":"","Operation Info":"gt(Column#52, 314)","Execution Info":"time:11.1s, loops:2","Disk":0,"Memory":50944,"Plans":[{"Node Id":"HashAgg","Plan Rows":989056,"Actual Rows":1002367,"Task":"root","Total Time":9805345957,"Max Time":9805345957,"Access Object":"","Operation Info":"group by:new0107.lineitem.l_orderkey, funcs:sum(Column#66)-\u003eColumn#52, funcs:firstrow(new0107.lineitem.l_orderkey)-\u003enew0107.lineitem.l_orderkey","Execution Info":"time:9.81s, loops:983, partial_worker:{wall_time:6.18238625s, concurrency:5, task_num:9, tot_wait:1.829368564s, tot_exec:23.867022488s, tot_time:26.601059258s, max:6.180909782s, p95:6.180909782s}, final_worker:{wall_time:11.069710256s, concurrency:5, task_num:25, tot_wait:22.722691623s, tot_exec:29.059180982s, tot_time:51.781902544s, max:11.013698823s, p95:11.013698823s}","Disk":0,"Memory":350268292,"Plans":[{"Node Id":"TableReader","Plan Rows":989056,"Actual Rows":1002374,"Task":"root","Total Time":2068958571,"Max Time":2068958571,"Access Object":"","Operation Info":"data:HashAgg_91","Execution Info":"time:2.07s, loops:10, cop_task: {num: 9, max: 1.89s, min: 25.5ms, avg: 821.4ms, p95: 1.89s, rpc_num: 9, rpc_time: 7.39s, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":11707110,"Plans":[{"Node Id":"HashAgg","Plan Rows":989056,"Actual Rows":1002374,"Task":"cop[tikv]","Total Time":5051000000,"Max Time":713000000,"Access Object":"","Operation Info":"group by:new0107.lineitem.l_orderkey, funcs:sum(new0107.lineitem.l_quantity)-\u003eColumn#66","Execution Info":"tikv_task:{proc max:713ms, min:301ms, p80:675ms, p95:713ms, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":3708000000,"Max Time":535000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:535ms, min:241ms, p80:502ms, p95:535ms, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]},{"Node Id":"TableReader","Plan Rows":4009984,"Actual Rows":4009984,"Task":"root","Total Time":1285135961,"Max Time":1285135961,"Access Object":"","Operation Info":"data:TableFullScan_101","Execution Info":"time:1.29s, loops:3924, cop_task: {num: 9, max: 2.49s, min: 1.21s, avg: 1.76s, p95: 2.49s, max_proc_keys: 512775, p95_proc_keys: 512775, tot_proc: 7.54s, tot_wait: 68ms, rpc_num: 9, rpc_time: 15.9s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":192576058,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":3724000000,"Max Time":490000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:490ms, min:217ms, p80:486ms, p95:490ms, iters:3959, tasks:9}, scan_detail: {total_process_keys: 4009984, total_process_keys_size: 787655655, total_keys: 4009993, rocksdb: {delete_skipped_count: 0, key_skipped_count: 4009984, block: {cache_hit_count: 12898, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}
/*PLACEHOLDER*/ select  c_name,  c_custkey,  o_orderkey,  o_orderdate,  o_totalprice,  sum(l_quantity) from  customer,  orders,  lineitem where  o_orderkey in (   select    l_orderkey   from    lineitem   group by    l_orderkey having     sum(l_quantity) > 314  )  and c_custkey = o_custkey  and o_orderkey = l_orderkey group by  c_name,  c_custkey,  o_orderkey,  o_orderdate,  o_totalprice order by  o_totalprice desc,  o_orderdate limit 100;

{"Node Id":"Sort","Plan Rows":2946.178694158076,"Actual Rows":175,"Task":"root","Total Time":18844970440,"Max Time":18844970440,"Access Object":"","Operation Info":"new0107.nation.n_name, Column#53:desc","Execution Info":"time:18.8s, loops:2","Disk":0,"Memory":17276,"Plans":[{"Node Id":"Projection","Plan Rows":2946.178694158076,"Actual Rows":175,"Task":"root","Total Time":18844603797,"Max Time":18844603797,"Access Object":"","Operation Info":"new0107.nation.n_name, Column#53, Column#55","Execution Info":"time:18.8s, loops:6, Concurrency:5","Disk":0,"Memory":25628,"Plans":[{"Node Id":"HashAgg","Plan Rows":2946.178694158076,"Actual Rows":175,"Task":"root","Total Time":18842826834,"Max Time":18842826834,"Access Object":"","Operation Info":"group by:Column#67, Column#68, funcs:sum(Column#64)-\u003eColumn#55, funcs:firstrow(Column#65)-\u003enew0107.nation.n_name, funcs:firstrow(Column#66)-\u003eColumn#53","Execution Info":"time:18.8s, loops:6, partial_worker:{wall_time:18.842518118s, concurrency:5, task_num:215, tot_wait:1m33.264078038s, tot_exec:850.462607ms, tot_time:1m34.114872604s, max:18.824659602s, p95:18.824659602s}, final_worker:{wall_time:18.843271038s, concurrency:5, task_num:25, tot_wait:1m34.171901609s, tot_exec:1.080719ms, tot_time:1m34.172993314s, max:18.841298498s, p95:18.841298498s}","Disk":0,"Memory":1378206,"Plans":[{"Node Id":"Projection","Plan Rows":3331507.8607707974,"Actual Rows":217738,"Task":"root","Total Time":18819901310,"Max Time":18819901310,"Access Object":"","Operation Info":"minus(mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount)), mul(new0107.partsupp.ps_supplycost, new0107.lineitem.l_quantity))-\u003eColumn#64, new0107.nation.n_name, extract(YEAR, new0107.orders.o_orderdate)-\u003eColumn#66, new0107.nation.n_name, extract(YEAR, new0107.orders.o_orderdate)-\u003eColumn#68","Execution Info":"time:18.8s, loops:216, Concurrency:5","Disk":0,"Memory":1519160,"Plans":[{"Node Id":"Projection","Plan Rows":3331507.8607707974,"Actual Rows":217738,"Task":"root","Total Time":18661920965,"Max Time":18661920965,"Access Object":"","Operation Info":"new0107.lineitem.l_quantity, new0107.lineitem.l_extendedprice, new0107.lineitem.l_discount, new0107.partsupp.ps_supplycost, new0107.orders.o_orderdate, new0107.nation.n_name","Execution Info":"time:18.7s, loops:216, Concurrency:5","Disk":0,"Memory":1932528,"Plans":[{"Node Id":"HashJoin","Plan Rows":3331507.8607707974,"Actual Rows":217738,"Task":"root","Total Time":18809707717,"Max Time":18809707717,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)]","Execution Info":"time:18.8s, loops:216, build_hash_table:{total:4.87s, fetch:660ms, build:4.21s}, probe:{concurrency:5, total:1m34s, max:18.8s, probe:4.74s, fetch:1m29.3s}","Disk":0,"Memory":16507392,"Plans":[{"Node Id":"HashJoin","Plan Rows":3274265.4576647705,"Actual Rows":217928,"Task":"root","Total Time":18748185839,"Max Time":18748185839,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.lineitem.l_suppkey, new0107.partsupp.ps_suppkey) eq(new0107.lineitem.l_partkey, new0107.partsupp.ps_partkey)]","Execution Info":"time:18.7s, loops:216, build_hash_table:{total:8.17s, fetch:2.93s, build:5.25s}, probe:{concurrency:5, total:1m33.9s, max:18.8s, probe:5.94s, fetch:1m28s}","Disk":0,"Memory":45451936,"Plans":[{"Node Id":"HashJoin","Plan Rows":3257501.218521527,"Actual Rows":217928,"Task":"root","Total Time":12776691128,"Max Time":12776691128,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.lineitem.l_partkey, new0107.part.p_partkey)]","Execution Info":"time:12.8s, loops:216, build_hash_table:{total:56.3ms, fetch:53.4ms, build:2.89ms}, probe:{concurrency:5, total:1m33.6s, max:18.7s, probe:38.8s, fetch:54.8s}","Disk":0,"Memory":587600,"Plans":[{"Node Id":"HashJoin","Plan Rows":4009984,"Actual Rows":4009984,"Task":"root","Total Time":12759709312,"Max Time":12759709312,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.supplier.s_suppkey, new0107.lineitem.l_suppkey)]","Execution Info":"time:12.8s, loops:3920, build_hash_table:{total:788.9ms, fetch:785.4ms, build:3.57ms}, probe:{concurrency:5, total:1m33.5s, max:18.7s, probe:1m20.8s, fetch:12.6s}","Disk":0,"Memory":271000,"Plans":[{"Node Id":"HashJoin","Plan Rows":10000,"Actual Rows":10000,"Task":"root","Total Time":788624843,"Max Time":788624843,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.supplier.s_nationkey)]","Execution Info":"time:788.6ms, loops:11, build_hash_table:{total:45.8ms, fetch:45.8ms, build:20.9µs}, probe:{concurrency:5, total:3.77s, max:787.6ms, probe:1.36s, fetch:2.41s}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":25,"Actual Rows":25,"Task":"root","Total Time":45698480,"Max Time":45698480,"Access Object":"","Operation Info":"data:TableFullScan_106","Execution Info":"time:45.7ms, loops:2, cop_task: {num: 1, max: 75.7ms, proc_keys: 25, rpc_num: 1, rpc_time: 75.6ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":794,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:nation, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]},{"Node Id":"TableReader","Plan Rows":10000,"Actual Rows":10000,"Task":"root","Total Time":385783344,"Max Time":385783344,"Access Object":"","Operation Info":"data:TableFullScan_104","Execution Info":"time:385.8ms, loops:11, cop_task: {num: 1, max: 202.3ms, proc_keys: 0, rpc_num: 1, rpc_time: 202.3ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":160504,"Plans":[{"Node Id":"TableFullScan","Plan Rows":10000,"Actual Rows":10000,"Task":"cop[tikv]","Total Time":7000000,"Max Time":7000000,"Access Object":"","Operation Info":"table:supplier, keep order:false","Execution Info":"tikv_task:{time:7ms, loops:14}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":4009984,"Actual Rows":4009984,"Task":"root","Total Time":2128869719,"Max Time":2128869719,"Access Object":"","Operation Info":"data:TableFullScan_108","Execution Info":"time:2.13s, loops:3924, cop_task: {num: 9, max: 4.25s, min: 1.97s, avg: 2.9s, p95: 4.25s, max_proc_keys: 512775, p95_proc_keys: 512775, tot_proc: 13.8s, tot_wait: 205ms, rpc_num: 9, rpc_time: 26.1s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":577661261,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":5021000000,"Max Time":751000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:751ms, min:325ms, p80:744ms, p95:751ms, iters:3959, tasks:9}, scan_detail: {total_process_keys: 4009984, total_process_keys_size: 787655655, total_keys: 4009993, rocksdb: {delete_skipped_count: 0, key_skipped_count: 4009984, block: {cache_hit_count: 12898, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":160000,"Actual Rows":10899,"Task":"root","Total Time":53233807,"Max Time":53233807,"Access Object":"","Operation Info":"data:Selection_111","Execution Info":"time:53.2ms, loops:12, cop_task: {num: 1, max: 64ms, proc_keys: 0, rpc_num: 1, rpc_time: 64ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":508461,"Plans":[{"Node Id":"Selection","Plan Rows":160000,"Actual Rows":10899,"Task":"cop[tikv]","Total Time":357000000,"Max Time":357000000,"Access Object":"","Operation Info":"like(new0107.part.p_name, \"%dim%\", 92)","Execution Info":"tikv_task:{time:357ms, loops:200}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":200000,"Actual Rows":200000,"Task":"cop[tikv]","Total Time":222000000,"Max Time":222000000,"Access Object":"","Operation Info":"table:part, keep order:false","Execution Info":"tikv_task:{time:222ms, loops:200}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"TableReader","Plan Rows":800000,"Actual Rows":800000,"Task":"root","Total Time":2176143605,"Max Time":2176143605,"Access Object":"","Operation Info":"data:TableFullScan_113","Execution Info":"time:2.18s, loops:783, cop_task: {num: 2, max: 2.25s, min: 2.11s, avg: 2.18s, p95: 2.25s, max_proc_keys: 529029, p95_proc_keys: 529029, tot_proc: 2.59s, tot_wait: 144ms, rpc_num: 2, rpc_time: 4.37s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":44825516,"Plans":[{"Node Id":"TableFullScan","Plan Rows":800000,"Actual Rows":800000,"Task":"cop[tikv]","Total Time":797000000,"Max Time":538000000,"Access Object":"","Operation Info":"table:partsupp, keep order:false","Execution Info":"tikv_task:{proc max:538ms, min:259ms, p80:538ms, p95:538ms, iters:790, tasks:2}, scan_detail: {total_process_keys: 800000, total_process_keys_size: 150608990, total_keys: 800002, rocksdb: {delete_skipped_count: 0, key_skipped_count: 800000, block: {cache_hit_count: 2473, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":1094656,"Actual Rows":1001472,"Task":"root","Total Time":75196598,"Max Time":75196598,"Access Object":"","Operation Info":"data:TableFullScan_115","Execution Info":"time:75.2ms, loops:980, cop_task: {num: 2, max: 113.6ms, min: 63.2ms, avg: 88.4ms, p95: 113.6ms, rpc_num: 2, rpc_time: 176.7ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":16047433,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":757000000,"Max Time":437000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:437ms, min:320ms, p80:437ms, p95:437ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  nation,  o_year,  sum(amount) as sum_profit from  (   select    n_name as nation,    extract(year from o_orderdate) as o_year,    l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount   from    part,    supplier,    lineitem,    partsupp,    orders,    nation   where    s_suppkey = l_suppkey    and ps_suppkey = l_suppkey    and ps_partkey = l_partkey    and p_partkey = l_partkey    and o_orderkey = l_orderkey    and s_nationkey = n_nationkey    and p_name like '%dim%'  ) as profit group by  nation,  o_year order by  nation,  o_year desc;

{"Node Id":"Projection","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":2125251815,"Max Time":2125251815,"Access Object":"","Operation Info":"div(mul(100.00, Column#27), Column#28)-\u003eColumn#29","Execution Info":"time:2.13s, loops:2, Concurrency:OFF","Disk":0,"Memory":2856,"Plans":[{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":2125212570,"Max Time":2125212570,"Access Object":"","Operation Info":"funcs:sum(Column#31)-\u003eColumn#27, funcs:sum(Column#32)-\u003eColumn#28","Execution Info":"time:2.13s, loops:2, partial_worker:{wall_time:2.112350124s, concurrency:5, task_num:54, tot_wait:10.221463655s, tot_exec:8.283169ms, tot_time:10.229796125s, max:2.045972878s, p95:2.045972878s}, final_worker:{wall_time:2.12531154s, concurrency:5, task_num:5, tot_wait:10.543400535s, tot_exec:46.742µs, tot_time:10.543453716s, max:2.111241106s, p95:2.111241106s}","Disk":0,"Memory":972200,"Plans":[{"Node Id":"Projection","Plan Rows":51569.74907482635,"Actual Rows":51967,"Task":"root","Total Time":1958975992,"Max Time":1958975992,"Access Object":"","Operation Info":"case(like(new0107.part.p_type, PROMO%, 92), mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount)), 0)-\u003eColumn#31, mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount))-\u003eColumn#32","Execution Info":"time:1.96s, loops:55, Concurrency:5","Disk":0,"Memory":1092680,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":51569.74907482635,"Actual Rows":51967,"Task":"root","Total Time":1931031332,"Max Time":1931031332,"Access Object":"","Operation Info":"inner join, inner:TableReader_12, outer key:new0107.lineitem.l_partkey, inner key:new0107.part.p_partkey, equal cond:eq(new0107.lineitem.l_partkey, new0107.part.p_partkey)","Execution Info":"time:1.93s, loops:55, inner:{total:4.64s, concurrency:5, task:10, construct:352.3ms, fetch:4.08s, build:56.1ms, join:211.5ms}","Disk":0,"Memory":13588168,"Plans":[{"Node Id":"TableReader","Plan Rows":50785.88888888899,"Actual Rows":51967,"Task":"root","Total Time":284646490,"Max Time":284646490,"Access Object":"","Operation Info":"data:Selection_23","Execution Info":"time:284.6ms, loops:56, cop_task: {num: 9, max: 285.6ms, min: 116.4ms, avg: 139.5ms, p95: 285.6ms, rpc_num: 9, rpc_time: 1.25s, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":1253293,"Plans":[{"Node Id":"Selection","Plan Rows":50785.88888888899,"Actual Rows":51967,"Task":"cop[tikv]","Total Time":4273000000,"Max Time":589000000,"Access Object":"","Operation Info":"ge(new0107.lineitem.l_shipdate, 1996-12-01 00:00:00.000000), lt(new0107.lineitem.l_shipdate, 1997-01-01 00:00:00.000000)","Execution Info":"tikv_task:{proc max:589ms, min:269ms, p80:517ms, p95:589ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4063000000,"Max Time":562000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:562ms, min:255ms, p80:494ms, p95:562ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":1,"Actual Rows":50242,"Task":"root","Total Time":3977712668,"Max Time":1578842059,"Access Object":"","Operation Info":"data:TableRangeScan_11","Execution Info":"time:3.98s, loops:64, cop_task: {num: 10, max: 1.48s, min: 103ms, avg: 337.7ms, p95: 1.48s, max_proc_keys: 18252, p95_proc_keys: 18252, tot_proc: 512ms, tot_wait: 24ms, rpc_num: 19, rpc_time: 6.62s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":50242,"Task":"cop[tikv]","Total Time":502000000,"Max Time":160000000,"Access Object":"","Operation Info":"table:part, range: decided by [new0107.lineitem.l_partkey], keep order:false","Execution Info":"tikv_task:{proc max:160ms, min:2ms, p80:151ms, p95:160ms, iters:90, tasks:10}, scan_detail: {total_process_keys: 50242, total_process_keys_size: 8212640, total_keys: 53303, rocksdb: {delete_skipped_count: 0, key_skipped_count: 6353, block: {cache_hit_count: 61076, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}
/*PLACEHOLDER*/ select  100.00 * sum(case   when p_type like 'PROMO%'    then l_extendedprice * (1 - l_discount)   else 0  end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from  lineitem,  part where  l_partkey = p_partkey  and l_shipdate >= '1996-12-01'  and l_shipdate < date_add('1996-12-01', interval '1' month);

{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":942408727,"Max Time":942408727,"Access Object":"","Operation Info":"funcs:sum(Column#28)-\u003eColumn#27","Execution Info":"time:942.4ms, loops:2, partial_worker:{wall_time:940.841546ms, concurrency:5, task_num:5, tot_wait:4.641672034s, tot_exec:93.733µs, tot_time:4.64179786s, max:928.382714ms, p95:928.382714ms}, final_worker:{wall_time:942.45217ms, concurrency:5, task_num:5, tot_wait:4.704071912s, tot_exec:41.874µs, tot_time:4.704117898s, max:940.909465ms, p95:940.909465ms}","Disk":0,"Memory":20052,"Plans":[{"Node Id":"Projection","Plan Rows":2810.7054154138987,"Actual Rows":72,"Task":"root","Total Time":870951225,"Max Time":870951225,"Access Object":"","Operation Info":"mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount))-\u003eColumn#28","Execution Info":"time:871ms, loops:6, Concurrency:5","Disk":0,"Memory":22968,"Plans":[{"Node Id":"HashJoin","Plan Rows":2810.7054154138987,"Actual Rows":72,"Task":"root","Total Time":870421433,"Max Time":870421433,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.part.p_partkey, new0107.lineitem.l_partkey)], other cond:or(and(and(eq(new0107.part.p_brand, \"Brand#52\"), in(new0107.part.p_container, \"SM CASE\", \"SM BOX\", \"SM PACK\", \"SM PKG\")), and(ge(new0107.lineitem.l_quantity, 4), and(le(new0107.lineitem.l_quantity, 14), le(new0107.part.p_size, 5)))), or(and(and(eq(new0107.part.p_brand, \"Brand#11\"), in(new0107.part.p_container, \"MED BAG\", \"MED BOX\", \"MED PKG\", \"MED PACK\")), and(ge(new0107.lineitem.l_quantity, 18), and(le(new0107.lineitem.l_quantity, 28), le(new0107.part.p_size, 10)))), and(and(eq(new0107.part.p_brand, \"Brand#51\"), in(new0107.part.p_container, \"LG CASE\", \"LG BOX\", \"LG PACK\", \"LG PKG\")), and(ge(new0107.lineitem.l_quantity, 29), and(le(new0107.lineitem.l_quantity, 39), le(new0107.part.p_size, 15))))))","Execution Info":"time:870.4ms, loops:6, build_hash_table:{total:287.6ms, fetch:287.4ms, build:139.6µs}, probe:{concurrency:5, total:3.94s, max:825.2ms, probe:17.2ms, fetch:3.92s}","Disk":0,"Memory":50112,"Plans":[{"Node Id":"TableReader","Plan Rows":138.05455049694,"Actual Rows":453,"Task":"root","Total Time":287275759,"Max Time":287275759,"Access Object":"","Operation Info":"data:Selection_30","Execution Info":"time:287.3ms, loops:2, cop_task: {num: 1, max: 302.9ms, proc_keys: 200000, tot_proc: 285ms, tot_wait: 1ms, rpc_num: 1, rpc_time: 302.9ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":30709,"Plans":[{"Node Id":"Selection","Plan Rows":138.05455049694,"Actual Rows":453,"Task":"cop[tikv]","Total Time":281000000,"Max Time":281000000,"Access Object":"","Operation Info":"ge(new0107.part.p_size, 1), or(and(eq(new0107.part.p_brand, \"Brand#52\"), and(in(new0107.part.p_container, \"SM CASE\", \"SM BOX\", \"SM PACK\", \"SM PKG\"), le(new0107.part.p_size, 5))), or(and(eq(new0107.part.p_brand, \"Brand#11\"), and(in(new0107.part.p_container, \"MED BAG\", \"MED BOX\", \"MED PKG\", \"MED PACK\"), le(new0107.part.p_size, 10))), and(eq(new0107.part.p_brand, \"Brand#51\"), and(in(new0107.part.p_container, \"LG CASE\", \"LG BOX\", \"LG PACK\", \"LG PKG\"), le(new0107.part.p_size, 15)))))","Execution Info":"tikv_task:{time:281ms, loops:200}, scan_detail: {total_process_keys: 200000, total_process_keys_size: 32687576, total_keys: 200001, rocksdb: {delete_skipped_count: 0, key_skipped_count: 200000, block: {cache_hit_count: 546, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":200000,"Actual Rows":200000,"Task":"cop[tikv]","Total Time":168000000,"Max Time":168000000,"Access Object":"","Operation Info":"table:part, keep order:false","Execution Info":"tikv_task:{time:168ms, loops:200}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":182075.37432781045,"Actual Rows":94250,"Task":"root","Total Time":365227683,"Max Time":365227683,"Access Object":"","Operation Info":"data:Selection_27","Execution Info":"time:365.2ms, loops:93, cop_task: {num: 9, max: 506.4ms, min: 37.9ms, avg: 196.1ms, p95: 506.4ms, rpc_num: 9, rpc_time: 1.77s, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":10308001,"Plans":[{"Node Id":"Selection","Plan Rows":182075.37432781045,"Actual Rows":94250,"Task":"cop[tikv]","Total Time":7506000000,"Max Time":1015000000,"Access Object":"","Operation Info":"eq(new0107.lineitem.l_shipinstruct, \"DELIVER IN PERSON\"), in(new0107.lineitem.l_shipmode, \"AIR\", \"AIR REG\"), or(and(ge(new0107.lineitem.l_quantity, 4), le(new0107.lineitem.l_quantity, 14)), or(and(ge(new0107.lineitem.l_quantity, 18), le(new0107.lineitem.l_quantity, 28)), and(ge(new0107.lineitem.l_quantity, 29), le(new0107.lineitem.l_quantity, 39))))","Execution Info":"tikv_task:{proc max:1.02s, min:507ms, p80:962ms, p95:1.02s, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4827000000,"Max Time":676000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:676ms, min:347ms, p80:624ms, p95:676ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}
/*PLACEHOLDER*/ select  sum(l_extendedprice* (1 - l_discount)) as revenue from  lineitem,  part where  (   p_partkey = l_partkey   and p_brand = 'Brand#52'   and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')   and l_quantity >= 4 and l_quantity <= 4 + 10   and p_size between 1 and 5   and l_shipmode in ('AIR', 'AIR REG')   and l_shipinstruct = 'DELIVER IN PERSON'  )  or  (   p_partkey = l_partkey   and p_brand = 'Brand#11'   and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')   and l_quantity >= 18 and l_quantity <= 18 + 10   and p_size between 1 and 10   and l_shipmode in ('AIR', 'AIR REG')   and l_shipinstruct = 'DELIVER IN PERSON'  )  or  (   p_partkey = l_partkey   and p_brand = 'Brand#51'   and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')   and l_quantity >= 29 and l_quantity <= 29 + 10   and p_size between 1 and 15   and l_shipmode in ('AIR', 'AIR REG')   and l_shipinstruct = 'DELIVER IN PERSON'  );

{"Node Id":"Projection","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":4127844779,"Max Time":4127844779,"Access Object":"","Operation Info":"div(Column#46, 7.0)-\u003eColumn#47","Execution Info":"time:4.13s, loops:2, Concurrency:OFF","Disk":0,"Memory":1428,"Plans":[{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":4127793343,"Max Time":4127793343,"Access Object":"","Operation Info":"funcs:sum(new0107.lineitem.l_extendedprice)-\u003eColumn#46","Execution Info":"time:4.13s, loops:2, partial_worker:{wall_time:4.127722325s, concurrency:5, task_num:5, tot_wait:20.626778022s, tot_exec:329.861µs, tot_time:20.627155828s, max:4.125853378s, p95:4.125853378s}, final_worker:{wall_time:0s, concurrency:5, task_num:5, tot_wait:20.637063982s, tot_exec:81.355µs, tot_time:20.637150057s, max:4.127481602s, p95:4.127481602s}","Disk":0,"Memory":36064,"Plans":[{"Node Id":"HashJoin","Plan Rows":1210.4745245946383,"Actual Rows":421,"Task":"root","Total Time":4041370741,"Max Time":4041370741,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.part.p_partkey, new0107.lineitem.l_partkey)], other cond:lt(new0107.lineitem.l_quantity, mul(0.2, Column#44))","Execution Info":"time:4.04s, loops:6, build_hash_table:{total:3.46s, fetch:3.46s, build:819µs}, probe:{concurrency:5, total:20.1s, max:4.02s, probe:104.1ms, fetch:20s}","Disk":0,"Memory":608496,"Plans":[{"Node Id":"HashJoin","Plan Rows":1210.4745245946383,"Actual Rows":4588,"Task":"root","Total Time":3457919292,"Max Time":3457919292,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.part.p_partkey, new0107.lineitem.l_partkey)]","Execution Info":"time:3.46s, loops:8, build_hash_table:{total:1.01s, fetch:1.01s, build:92.8µs}, probe:{concurrency:5, total:17.2s, max:3.44s, probe:1.98s, fetch:15.2s}","Disk":0,"Memory":41680,"Plans":[{"Node Id":"TableReader","Plan Rows":59.45536499999999,"Actual Rows":233,"Task":"root","Total Time":1011185386,"Max Time":1011185386,"Access Object":"","Operation Info":"data:Selection_39","Execution Info":"time:1.01s, loops:2, cop_task: {num: 1, max: 974.7ms, proc_keys: 0, rpc_num: 1, rpc_time: 974.6ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":16064,"Plans":[{"Node Id":"Selection","Plan Rows":59.45536499999999,"Actual Rows":233,"Task":"cop[tikv]","Total Time":230000000,"Max Time":230000000,"Access Object":"","Operation Info":"eq(new0107.part.p_brand, \"Brand#44\"), eq(new0107.part.p_container, \"WRAP PKG\")","Execution Info":"tikv_task:{time:230ms, loops:200}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":200000,"Actual Rows":200000,"Task":"cop[tikv]","Total Time":194000000,"Max Time":194000000,"Access Object":"","Operation Info":"table:part, keep order:false","Execution Info":"tikv_task:{time:194ms, loops:200}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":4009984,"Actual Rows":4009984,"Task":"root","Total Time":2574837294,"Max Time":2574837294,"Access Object":"","Operation Info":"data:TableFullScan_36","Execution Info":"time:2.57s, loops:3924, cop_task: {num: 9, max: 2.94s, min: 1.63s, avg: 2.46s, p95: 2.94s, max_proc_keys: 512775, p95_proc_keys: 512775, tot_proc: 8.01s, tot_wait: 205ms, rpc_num: 9, rpc_time: 22.1s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":203773277,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":3829000000,"Max Time":539000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:539ms, min:228ms, p80:489ms, p95:539ms, iters:3959, tasks:9}, scan_detail: {total_process_keys: 4009984, total_process_keys_size: 787655655, total_keys: 4009993, rocksdb: {delete_skipped_count: 0, key_skipped_count: 4009984, block: {cache_hit_count: 12898, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"HashAgg","Plan Rows":196960,"Actual Rows":200000,"Task":"root","Total Time":3427740745,"Max Time":3427740745,"Access Object":"","Operation Info":"group by:new0107.lineitem.l_partkey, funcs:avg(Column#50, Column#51)-\u003eColumn#44, funcs:firstrow(new0107.lineitem.l_partkey)-\u003enew0107.lineitem.l_partkey","Execution Info":"time:3.43s, loops:200, partial_worker:{wall_time:2.758611447s, concurrency:5, task_num:9, tot_wait:1.780495484s, tot_exec:10.968513262s, tot_time:13.27955934s, max:2.743787509s, p95:2.743787509s}, final_worker:{wall_time:4.019153132s, concurrency:5, task_num:25, tot_wait:12.826875427s, tot_exec:6.104791503s, tot_time:18.931721388s, max:3.964861686s, p95:3.964861686s}","Disk":0,"Memory":242275356,"Plans":[{"Node Id":"TableReader","Plan Rows":196960,"Actual Rows":1590811,"Task":"root","Total Time":779068325,"Max Time":779068325,"Access Object":"","Operation Info":"data:HashAgg_41","Execution Info":"time:779.1ms, loops:10, cop_task: {num: 9, max: 510.1ms, min: 166.8ms, avg: 322.7ms, p95: 510.1ms, rpc_num: 9, rpc_time: 2.9s, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":30274772,"Plans":[{"Node Id":"HashAgg","Plan Rows":196960,"Actual Rows":1590811,"Task":"cop[tikv]","Total Time":8618000000,"Max Time":1120000000,"Access Object":"","Operation Info":"group by:new0107.lineitem.l_partkey, funcs:count(new0107.lineitem.l_quantity)-\u003eColumn#50, funcs:sum(new0107.lineitem.l_quantity)-\u003eColumn#51","Execution Info":"tikv_task:{proc max:1.12s, min:574ms, p80:1.09s, p95:1.12s, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4380000000,"Max Time":570000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:570ms, min:362ms, p80:563ms, p95:570ms, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  sum(l_extendedprice) / 7.0 as avg_yearly from  lineitem,  part where  p_partkey = l_partkey  and p_brand = 'Brand#44'  and p_container = 'WRAP PKG'  and l_quantity < (   select    0.2 * avg(l_quantity)   from    lineitem   where    l_partkey = p_partkey  );
create view revenue0 (supplier_no, total_revenue) as  select   l_suppkey,   sum(l_extendedprice * (1 - l_discount))  from   lineitem  where   l_shipdate >= '1997-07-01'   and l_shipdate < date_add('1997-07-01', interval '3' month)  group by   l_suppkey;

{"Node Id":"Sort","Plan Rows":10,"Actual Rows":152,"Task":"root","Total Time":5328376202,"Max Time":5328376202,"Access Object":"","Operation Info":"new0107.supplier.s_name","Execution Info":"time:5.33s, loops:2","Disk":0,"Memory":13568,"Plans":[{"Node Id":"HashJoin","Plan Rows":10,"Actual Rows":152,"Task":"root","Total Time":5328182928,"Max Time":5328182928,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.supplier.s_suppkey, new0107.partsupp.ps_suppkey)]","Execution Info":"time:5.33s, loops:6, build_hash_table:{total:285ms, fetch:284.7ms, build:297.9µs}, probe:{concurrency:5, total:26.6s, max:5.33s, probe:1.11ms, fetch:26.6s}","Disk":0,"Memory":35428,"Plans":[{"Node Id":"HashJoin","Plan Rows":10,"Actual Rows":420,"Task":"root","Total Time":284667552,"Max Time":284667552,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.supplier.s_nationkey)]","Execution Info":"time:284.7ms, loops:6, build_hash_table:{total:210.9ms, fetch:210.9ms, build:23.8µs}, probe:{concurrency:5, total:1.38s, max:276.9ms, probe:2.78ms, fetch:1.37s}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":0.025,"Actual Rows":1,"Task":"root","Total Time":210661818,"Max Time":210661818,"Access Object":"","Operation Info":"data:Selection_52","Execution Info":"time:210.7ms, loops:2, cop_task: {num: 1, max: 147.5ms, proc_keys: 25, rpc_num: 1, rpc_time: 147.4ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":249,"Plans":[{"Node Id":"Selection","Plan Rows":0.025,"Actual Rows":1,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"eq(new0107.nation.n_name, \"ALGERIA\")","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:nation, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":10000,"Actual Rows":10000,"Task":"root","Total Time":270664419,"Max Time":270664419,"Access Object":"","Operation Info":"data:TableFullScan_49","Execution Info":"time:270.7ms, loops:11, cop_task: {num: 1, max: 271.2ms, proc_keys: 0, rpc_num: 1, rpc_time: 271.2ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":750729,"Plans":[{"Node Id":"TableFullScan","Plan Rows":10000,"Actual Rows":10000,"Task":"cop[tikv]","Total Time":13000000,"Max Time":13000000,"Access Object":"","Operation Info":"table:supplier, keep order:false","Execution Info":"tikv_task:{time:13ms, loops:14}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"HashAgg","Plan Rows":2547.961871329696,"Actual Rows":3734,"Task":"root","Total Time":5326217825,"Max Time":5326217825,"Access Object":"","Operation Info":"group by:new0107.partsupp.ps_suppkey, funcs:firstrow(new0107.partsupp.ps_suppkey)-\u003enew0107.partsupp.ps_suppkey","Execution Info":"time:5.33s, loops:6, partial_worker:{wall_time:5.324232484s, concurrency:5, task_num:5, tot_wait:26.572518453s, tot_exec:3.524281ms, tot_time:26.576552479s, max:5.315892662s, p95:5.315892662s}, final_worker:{wall_time:5.326223592s, concurrency:5, task_num:25, tot_wait:26.598726843s, tot_exec:5.569678ms, tot_time:26.604326965s, max:5.321704648s, p95:5.321704648s}","Disk":0,"Memory":1073369,"Plans":[{"Node Id":"Selection","Plan Rows":2547.961871329696,"Actual Rows":4608,"Task":"root","Total Time":5314140691,"Max Time":5314140691,"Access Object":"","Operation Info":"gt(cast(new0107.partsupp.ps_availqty, decimal(20,0) BINARY), mul(0.5, Column#44))","Execution Info":"time:5.31s, loops:6","Disk":0,"Memory":60656,"Plans":[{"Node Id":"HashAgg","Plan Rows":3184.9523391621196,"Actual Rows":8576,"Task":"root","Total Time":5216252570,"Max Time":5216252570,"Access Object":"","Operation Info":"group by:new0107.partsupp.ps_partkey, new0107.partsupp.ps_suppkey, funcs:firstrow(new0107.partsupp.ps_suppkey)-\u003enew0107.partsupp.ps_suppkey, funcs:firstrow(new0107.partsupp.ps_availqty)-\u003enew0107.partsupp.ps_availqty, funcs:sum(new0107.lineitem.l_quantity)-\u003eColumn#44","Execution Info":"time:5.22s, loops:12, partial_worker:{wall_time:5.210873797s, concurrency:5, task_num:15, tot_wait:25.289676631s, tot_exec:338.773928ms, tot_time:25.631340925s, max:5.161081055s, p95:5.161081055s}, final_worker:{wall_time:5.314137472s, concurrency:5, task_num:25, tot_wait:26.14581678s, tot_exec:310.050063ms, tot_time:26.455885518s, max:5.304029322s, p95:5.304029322s}","Disk":0,"Memory":4013257,"Plans":[{"Node Id":"HashJoin","Plan Rows":64843.663285959956,"Actual Rows":10496,"Task":"root","Total Time":5094067263,"Max Time":5094067263,"Access Object":"","Operation Info":"left outer join, equal:[eq(new0107.partsupp.ps_partkey, new0107.lineitem.l_partkey) eq(new0107.partsupp.ps_suppkey, new0107.lineitem.l_suppkey)]","Execution Info":"time:5.09s, loops:16, build_hash_table:{total:4.77s, fetch:4.76s, build:9.73ms}, probe:{concurrency:5, total:25.1s, max:5.07s, probe:716.3ms, fetch:24.4s}","Disk":0,"Memory":290232,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":3184.9523391621196,"Actual Rows":8576,"Task":"root","Total Time":4771195011,"Max Time":4771195011,"Access Object":"","Operation Info":"inner join, inner:IndexLookUp_64, outer key:new0107.part.p_partkey, inner key:new0107.partsupp.ps_partkey, equal cond:eq(new0107.part.p_partkey, new0107.partsupp.ps_partkey)","Execution Info":"time:4.77s, loops:13, inner:{total:7.08s, concurrency:5, task:6, construct:82.4ms, fetch:6.78s, build:1.22ms, join:214.9ms}","Disk":0,"Memory":793313,"Plans":[{"Node Id":"TableReader","Plan Rows":784.1352659017139,"Actual Rows":2144,"Task":"root","Total Time":187929188,"Max Time":187929188,"Access Object":"","Operation Info":"data:Selection_95","Execution Info":"time:187.9ms, loops:8, cop_task: {num: 1, max: 88.9ms, proc_keys: 0, rpc_num: 1, rpc_time: 88.9ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":109118,"Plans":[{"Node Id":"Selection","Plan Rows":784.1352659017139,"Actual Rows":2144,"Task":"cop[tikv]","Total Time":234000000,"Max Time":234000000,"Access Object":"","Operation Info":"like(new0107.part.p_name, \"green%\", 92)","Execution Info":"tikv_task:{time:234ms, loops:200}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":200000,"Actual Rows":200000,"Task":"cop[tikv]","Total Time":206000000,"Max Time":206000000,"Access Object":"","Operation Info":"table:part, keep order:false","Execution Info":"tikv_task:{time:206ms, loops:200}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"IndexLookUp","Plan Rows":4.061738424045491,"Actual Rows":8576,"Task":"root","Total Time":6773380554,"Max Time":4309931056,"Access Object":"","Operation Info":"","Execution Info":"time:6.77s, loops:19, index_task: {total_time: 1.61s, fetch_handle: 1.61s, build: 16.8µs, wait: 35.7µs}, table_task: {total_time: 4.52s, num: 10, concurrency: 30}","Disk":0,"Memory":20048,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":4.061738424045491,"Actual Rows":8576,"Task":"cop[tikv]","Total Time":114000000,"Max Time":83000000,"Access Object":"","Operation Info":"table:partsupp, index:PRIMARY(PS_PARTKEY, PS_SUPPKEY), range: decided by [eq(new0107.partsupp.ps_partkey, new0107.part.p_partkey)], keep order:false","Execution Info":"time:1.61s, loops:25, cop_task: {num: 6, max: 759.5ms, min: 51.9ms, avg: 218.1ms, p95: 759.5ms, max_proc_keys: 4100, p95_proc_keys: 4100, tot_proc: 107ms, tot_wait: 16ms, rpc_num: 11, rpc_time: 2.56s, copr_cache_hit_ratio: 0.00}, tikv_task:{proc max:83ms, min:2ms, p80:11ms, p95:83ms, iters:36, tasks:6}, scan_detail: {total_process_keys: 7544, total_process_keys_size: 399832, total_keys: 9430, rocksdb: {delete_skipped_count: 0, key_skipped_count: 7544, block: {cache_hit_count: 7551, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]},{"Node Id":"TableRowIDScan","Plan Rows":4.061738424045491,"Actual Rows":8576,"Task":"cop[tikv]","Total Time":56000000,"Max Time":13000000,"Access Object":"","Operation Info":"table:partsupp, keep order:false","Execution Info":"time:3.3s, loops:24, cop_task: {num: 11, max: 556ms, min: 181.7ms, avg: 289.6ms, p95: 556ms, max_proc_keys: 2048, p95_proc_keys: 2048, tot_proc: 126ms, tot_wait: 54ms, rpc_num: 20, rpc_time: 5.91s, copr_cache_hit_ratio: 0.09}, tikv_task:{proc max:13ms, min:0s, p80:7ms, p95:13ms, iters:50, tasks:11}, scan_detail: {total_process_keys: 5536, total_process_keys_size: 1041336, total_keys: 6910, rocksdb: {delete_skipped_count: 0, key_skipped_count: 5536, block: {cache_hit_count: 5512, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":599374.3333333333,"Actual Rows":606222,"Task":"root","Total Time":152612709,"Max Time":152612709,"Access Object":"","Operation Info":"data:Selection_100","Execution Info":"time:152.6ms, loops:592, cop_task: {num: 9, max: 360.7ms, min: 87.2ms, avg: 209.8ms, p95: 360.7ms, rpc_num: 9, rpc_time: 1.89s, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":38950283,"Plans":[{"Node Id":"Selection","Plan Rows":599374.3333333333,"Actual Rows":606222,"Task":"cop[tikv]","Total Time":4423000000,"Max Time":656000000,"Access Object":"","Operation Info":"ge(new0107.lineitem.l_shipdate, 1993-01-01 00:00:00.000000), lt(new0107.lineitem.l_shipdate, 1994-01-01 00:00:00.000000)","Execution Info":"tikv_task:{proc max:656ms, min:273ms, p80:546ms, p95:656ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4155000000,"Max Time":600000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:600ms, min:257ms, p80:522ms, p95:600ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  s_name,  s_address from  supplier,  nation where  s_suppkey in (   select    ps_suppkey   from    partsupp   where    ps_partkey in (     select      p_partkey     from      part     where      p_name like 'green%'    )    and ps_availqty > (     select      0.5 * sum(l_quantity)     from      lineitem     where      l_partkey = ps_partkey      and l_suppkey = ps_suppkey      and l_shipdate >= '1993-01-01'      and l_shipdate < date_add('1993-01-01', interval '1' year)    )  )  and s_nationkey = n_nationkey  and n_name = 'ALGERIA' order by  s_name;

{"Node Id":"Sort","Plan Rows":2946.178694158076,"Actual Rows":175,"Task":"root","Total Time":19239491908,"Max Time":19239491908,"Access Object":"","Operation Info":"new0107.nation.n_name, Column#53:desc","Execution Info":"time:19.2s, loops:2","Disk":0,"Memory":17276,"Plans":[{"Node Id":"Projection","Plan Rows":2946.178694158076,"Actual Rows":175,"Task":"root","Total Time":19232061944,"Max Time":19232061944,"Access Object":"","Operation Info":"new0107.nation.n_name, Column#53, Column#55","Execution Info":"time:19.2s, loops:6, Concurrency:5","Disk":0,"Memory":25628,"Plans":[{"Node Id":"HashAgg","Plan Rows":2946.178694158076,"Actual Rows":175,"Task":"root","Total Time":19231893098,"Max Time":19231893098,"Access Object":"","Operation Info":"group by:Column#67, Column#68, funcs:sum(Column#64)-\u003eColumn#55, funcs:firstrow(Column#65)-\u003enew0107.nation.n_name, funcs:firstrow(Column#66)-\u003eColumn#53","Execution Info":"time:19.2s, loops:6, partial_worker:{wall_time:19.23106257s, concurrency:5, task_num:215, tot_wait:1m35.190128231s, tot_exec:955.183238ms, tot_time:1m36.145600299s, max:19.229205859s, p95:19.229205859s}, final_worker:{wall_time:19.262016066s, concurrency:5, task_num:25, tot_wait:1m36.15170547s, tot_exec:976.855µs, tot_time:1m36.152691206s, max:19.230737395s, p95:19.230737395s}","Disk":0,"Memory":1376160,"Plans":[{"Node Id":"Projection","Plan Rows":3331507.8607707974,"Actual Rows":217738,"Task":"root","Total Time":18804702808,"Max Time":18804702808,"Access Object":"","Operation Info":"minus(mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount)), mul(new0107.partsupp.ps_supplycost, new0107.lineitem.l_quantity))-\u003eColumn#64, new0107.nation.n_name, extract(YEAR, new0107.orders.o_orderdate)-\u003eColumn#66, new0107.nation.n_name, extract(YEAR, new0107.orders.o_orderdate)-\u003eColumn#68","Execution Info":"time:18.8s, loops:216, Concurrency:5","Disk":0,"Memory":1506104,"Plans":[{"Node Id":"Projection","Plan Rows":3331507.8607707974,"Actual Rows":217738,"Task":"root","Total Time":18564947544,"Max Time":18564947544,"Access Object":"","Operation Info":"new0107.lineitem.l_quantity, new0107.lineitem.l_extendedprice, new0107.lineitem.l_discount, new0107.partsupp.ps_supplycost, new0107.orders.o_orderdate, new0107.nation.n_name","Execution Info":"time:18.6s, loops:216, Concurrency:5","Disk":0,"Memory":1930992,"Plans":[{"Node Id":"HashJoin","Plan Rows":3331507.8607707974,"Actual Rows":217738,"Task":"root","Total Time":17590454422,"Max Time":17590454422,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)]","Execution Info":"time:17.6s, loops:216, build_hash_table:{total:4.51s, fetch:791.4ms, build:3.72s}, probe:{concurrency:5, total:1m36.1s, max:19.2s, probe:7.23s, fetch:1m28.9s}","Disk":0,"Memory":16511744,"Plans":[{"Node Id":"HashJoin","Plan Rows":3274265.4576647705,"Actual Rows":217928,"Task":"root","Total Time":19220052660,"Max Time":19220052660,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.lineitem.l_suppkey, new0107.partsupp.ps_suppkey) eq(new0107.lineitem.l_partkey, new0107.partsupp.ps_partkey)]","Execution Info":"time:19.2s, loops:216, build_hash_table:{total:6.01s, fetch:3.64s, build:2.37s}, probe:{concurrency:5, total:1m36.1s, max:19.2s, probe:9.05s, fetch:1m27s}","Disk":0,"Memory":45451936,"Plans":[{"Node Id":"HashJoin","Plan Rows":3257501.218521527,"Actual Rows":217928,"Task":"root","Total Time":16085359997,"Max Time":16085359997,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.lineitem.l_partkey, new0107.part.p_partkey)]","Execution Info":"time:16.1s, loops:216, build_hash_table:{total:580.7ms, fetch:471.3ms, build:109.4ms}, probe:{concurrency:5, total:1m36.1s, max:19.2s, probe:28s, fetch:1m8s}","Disk":0,"Memory":587600,"Plans":[{"Node Id":"HashJoin","Plan Rows":4009984,"Actual Rows":4009984,"Task":"root","Total Time":16219160008,"Max Time":16219160008,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.supplier.s_suppkey, new0107.lineitem.l_suppkey)]","Execution Info":"time:16.2s, loops:3919, build_hash_table:{total:607.6ms, fetch:401.7ms, build:206ms}, probe:{concurrency:5, total:1m35.8s, max:19.2s, probe:1m20.3s, fetch:15.5s}","Disk":0,"Memory":271000,"Plans":[{"Node Id":"HashJoin","Plan Rows":10000,"Actual Rows":10000,"Task":"root","Total Time":506324548,"Max Time":506324548,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.supplier.s_nationkey)]","Execution Info":"time:506.3ms, loops:11, build_hash_table:{total:397.1ms, fetch:397.1ms, build:45.7µs}, probe:{concurrency:5, total:3.02s, max:605.5ms, probe:622.3ms, fetch:2.4s}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":25,"Actual Rows":25,"Task":"root","Total Time":396964693,"Max Time":396964693,"Access Object":"","Operation Info":"data:TableFullScan_106","Execution Info":"time:397ms, loops:2, cop_task: {num: 1, max: 399.6ms, proc_keys: 25, rpc_num: 1, rpc_time: 399.5ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":798,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:nation, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]},{"Node Id":"TableReader","Plan Rows":10000,"Actual Rows":10000,"Task":"root","Total Time":360510413,"Max Time":360510413,"Access Object":"","Operation Info":"data:TableFullScan_104","Execution Info":"time:360.5ms, loops:11, cop_task: {num: 1, max: 292.4ms, proc_keys: 0, rpc_num: 1, rpc_time: 292.4ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":160500,"Plans":[{"Node Id":"TableFullScan","Plan Rows":10000,"Actual Rows":10000,"Task":"cop[tikv]","Total Time":7000000,"Max Time":7000000,"Access Object":"","Operation Info":"table:supplier, keep order:false","Execution Info":"tikv_task:{time:7ms, loops:14}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":4009984,"Actual Rows":4009984,"Task":"root","Total Time":2603487128,"Max Time":2603487128,"Access Object":"","Operation Info":"data:TableFullScan_108","Execution Info":"time:2.6s, loops:3924, cop_task: {num: 9, max: 3.84s, min: 2.38s, avg: 3.21s, p95: 3.84s, max_proc_keys: 512775, p95_proc_keys: 512775, tot_proc: 14.5s, tot_wait: 157ms, rpc_num: 9, rpc_time: 28.9s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":577661251,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":5593000000,"Max Time":855000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:855ms, min:331ms, p80:835ms, p95:855ms, iters:3959, tasks:9}, scan_detail: {total_process_keys: 4009984, total_process_keys_size: 787655655, total_keys: 4009993, rocksdb: {delete_skipped_count: 0, key_skipped_count: 4009984, block: {cache_hit_count: 12898, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":160000,"Actual Rows":10899,"Task":"root","Total Time":423421557,"Max Time":423421557,"Access Object":"","Operation Info":"data:Selection_111","Execution Info":"time:423.4ms, loops:12, cop_task: {num: 1, max: 400ms, proc_keys: 0, rpc_num: 1, rpc_time: 400ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":508461,"Plans":[{"Node Id":"Selection","Plan Rows":160000,"Actual Rows":10899,"Task":"cop[tikv]","Total Time":357000000,"Max Time":357000000,"Access Object":"","Operation Info":"like(new0107.part.p_name, \"%dim%\", 92)","Execution Info":"tikv_task:{time:357ms, loops:200}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":200000,"Actual Rows":200000,"Task":"cop[tikv]","Total Time":222000000,"Max Time":222000000,"Access Object":"","Operation Info":"table:part, keep order:false","Execution Info":"tikv_task:{time:222ms, loops:200}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"TableReader","Plan Rows":800000,"Actual Rows":800000,"Task":"root","Total Time":3223603305,"Max Time":3223603305,"Access Object":"","Operation Info":"data:TableFullScan_113","Execution Info":"time:3.22s, loops:783, cop_task: {num: 2, max: 3.73s, min: 3.22s, avg: 3.48s, p95: 3.73s, max_proc_keys: 529029, p95_proc_keys: 529029, tot_proc: 2.92s, tot_wait: 60ms, rpc_num: 2, rpc_time: 6.96s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":44825522,"Plans":[{"Node Id":"TableFullScan","Plan Rows":800000,"Actual Rows":800000,"Task":"cop[tikv]","Total Time":811000000,"Max Time":556000000,"Access Object":"","Operation Info":"table:partsupp, keep order:false","Execution Info":"tikv_task:{proc max:556ms, min:255ms, p80:556ms, p95:556ms, iters:790, tasks:2}, scan_detail: {total_process_keys: 800000, total_process_keys_size: 150608990, total_keys: 800002, rocksdb: {delete_skipped_count: 0, key_skipped_count: 800000, block: {cache_hit_count: 2473, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":1094656,"Actual Rows":1001472,"Task":"root","Total Time":414834119,"Max Time":414834119,"Access Object":"","Operation Info":"data:TableFullScan_115","Execution Info":"time:414.8ms, loops:980, cop_task: {num: 2, max: 292.5ms, min: 279ms, avg: 285.8ms, p95: 292.5ms, rpc_num: 2, rpc_time: 571.4ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":16047424,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":757000000,"Max Time":437000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:437ms, min:320ms, p80:437ms, p95:437ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  nation,  o_year,  sum(amount) as sum_profit from  (   select    n_name as nation,    extract(year from o_orderdate) as o_year,    l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount   from    part,    supplier,    lineitem,    partsupp,    orders,    nation   where    s_suppkey = l_suppkey    and ps_suppkey = l_suppkey    and ps_partkey = l_partkey    and p_partkey = l_partkey    and o_orderkey = l_orderkey    and s_nationkey = n_nationkey    and p_name like '%dim%'  ) as profit group by  nation,  o_year order by  nation,  o_year desc;

{"Node Id":"Projection","Plan Rows":6.4,"Actual Rows":100,"Task":"root","Total Time":11895471889,"Max Time":11895471889,"Access Object":"","Operation Info":"new0107.supplier.s_name, Column#72","Execution Info":"time:11.9s, loops:2, Concurrency:OFF","Disk":0,"Memory":4728,"Plans":[{"Node Id":"TopN","Plan Rows":6.4,"Actual Rows":100,"Task":"root","Total Time":11895463479,"Max Time":11895463479,"Access Object":"","Operation Info":"Column#72:desc, new0107.supplier.s_name, offset:0, count:100","Execution Info":"time:11.9s, loops:2","Disk":0,"Memory":12344,"Plans":[{"Node Id":"HashAgg","Plan Rows":6.4,"Actual Rows":414,"Task":"root","Total Time":11895241948,"Max Time":11895241948,"Access Object":"","Operation Info":"group by:new0107.supplier.s_name, funcs:count(1)-\u003eColumn#72, funcs:firstrow(new0107.supplier.s_name)-\u003enew0107.supplier.s_name","Execution Info":"time:11.9s, loops:6, partial_worker:{wall_time:11.895096569s, concurrency:5, task_num:3, tot_wait:59.457549569s, tot_exec:2.926868ms, tot_time:59.460635779s, max:11.892407664s, p95:11.892407664s}, final_worker:{wall_time:0s, concurrency:5, task_num:15, tot_wait:59.46451728s, tot_exec:1.40619ms, tot_time:59.465930001s, max:11.893290197s, p95:11.893290197s}","Disk":0,"Memory":348386,"Plans":[{"Node Id":"IndexJoin","Plan Rows":700.57984,"Actual Rows":2750,"Task":"root","Total Time":11890202180,"Max Time":11890202180,"Access Object":"","Operation Info":"anti semi join, inner:IndexLookUp_39, outer key:new0107.lineitem.l_orderkey, inner key:new0107.lineitem.l_orderkey, equal cond:eq(new0107.lineitem.l_orderkey, new0107.lineitem.l_orderkey), other cond:ne(new0107.lineitem.l_suppkey, new0107.lineitem.l_suppkey)","Execution Info":"time:11.9s, loops:4, inner:{total:23.2s, concurrency:5, task:10, construct:713.1ms, fetch:22s, build:444.4ms}, probe:842.7ms","Disk":0,"Memory":16990811,"Plans":[{"Node Id":"IndexJoin","Plan Rows":875.7248,"Actual Rows":49059,"Task":"root","Total Time":6785973668,"Max Time":6785973668,"Access Object":"","Operation Info":"semi join, inner:IndexLookUp_80, outer key:new0107.lineitem.l_orderkey, inner key:new0107.lineitem.l_orderkey, equal cond:eq(new0107.lineitem.l_orderkey, new0107.lineitem.l_orderkey), other cond:ne(new0107.lineitem.l_suppkey, new0107.lineitem.l_suppkey), ne(new0107.lineitem.l_suppkey, new0107.supplier.s_suppkey)","Execution Info":"time:6.79s, loops:53, inner:{total:13.4s, concurrency:5, task:10, construct:112.7ms, fetch:12.5s, build:808ms}, probe:881.3ms","Disk":0,"Memory":15529743,"Plans":[{"Node Id":"IndexJoin","Plan Rows":1094.656,"Actual Rows":50936,"Task":"root","Total Time":3352702378,"Max Time":3352702378,"Access Object":"","Operation Info":"inner join, inner:TableReader_95, outer key:new0107.lineitem.l_orderkey, inner key:new0107.orders.o_orderkey, equal cond:eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)","Execution Info":"time:3.35s, loops:55, inner:{total:5.59s, concurrency:5, task:12, construct:690.2ms, fetch:4.88s, build:19.8ms}, probe:416.8ms","Disk":0,"Memory":16146014,"Plans":[{"Node Id":"HashJoin","Plan Rows":4009.984,"Actual Rows":105617,"Task":"root","Total Time":1993190285,"Max Time":1993190285,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.supplier.s_suppkey, new0107.lineitem.l_suppkey)]","Execution Info":"time:1.99s, loops:106, build_hash_table:{total:295.8ms, fetch:295.6ms, build:214.1µs}, probe:{concurrency:5, total:9.7s, max:1.97s, probe:2.93s, fetch:6.77s}","Disk":0,"Memory":19640,"Plans":[{"Node Id":"HashJoin","Plan Rows":10,"Actual Rows":415,"Task":"root","Total Time":295514677,"Max Time":295514677,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.supplier.s_nationkey)]","Execution Info":"time:295.5ms, loops:6, build_hash_table:{total:249.4ms, fetch:249.4ms, build:11.3µs}, probe:{concurrency:5, total:1.39s, max:295.3ms, probe:1.79ms, fetch:1.38s}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":0.025,"Actual Rows":1,"Task":"root","Total Time":249268346,"Max Time":249268346,"Access Object":"","Operation Info":"data:Selection_124","Execution Info":"time:249.3ms, loops:2, cop_task: {num: 1, max: 265ms, proc_keys: 25, tot_proc: 1ms, tot_wait: 6ms, rpc_num: 1, rpc_time: 265ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":259,"Plans":[{"Node Id":"Selection","Plan Rows":0.025,"Actual Rows":1,"Task":"cop[tikv]","Total Time":1000000,"Max Time":1000000,"Access Object":"","Operation Info":"eq(new0107.nation.n_name, \"EGYPT\")","Execution Info":"tikv_task:{time:1ms, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":1000000,"Max Time":1000000,"Access Object":"","Operation Info":"table:nation, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:1ms, loops:1}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":10000,"Actual Rows":10000,"Task":"root","Total Time":216337585,"Max Time":216337585,"Access Object":"","Operation Info":"data:TableFullScan_121","Execution Info":"time:216.3ms, loops:11, cop_task: {num: 1, max: 232ms, proc_keys: 10000, tot_proc: 33ms, tot_wait: 2ms, rpc_num: 1, rpc_time: 232ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":420763,"Plans":[{"Node Id":"TableFullScan","Plan Rows":10000,"Actual Rows":10000,"Task":"cop[tikv]","Total Time":8000000,"Max Time":8000000,"Access Object":"","Operation Info":"table:supplier, keep order:false","Execution Info":"tikv_task:{time:8ms, loops:14}, scan_detail: {total_process_keys: 10000, total_process_keys_size: 1815466, total_keys: 10001, rocksdb: {delete_skipped_count: 0, key_skipped_count: 10000, block: {cache_hit_count: 33, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":3207987.2,"Actual Rows":2534187,"Task":"root","Total Time":1253240062,"Max Time":1253240062,"Access Object":"","Operation Info":"data:Selection_127","Execution Info":"time:1.25s, loops:2468, cop_task: {num: 9, max: 1.69s, min: 704.3ms, avg: 1.37s, p95: 1.69s, max_proc_keys: 512775, p95_proc_keys: 512775, tot_proc: 8.38s, tot_wait: 97ms, rpc_num: 9, rpc_time: 12.3s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":37550116,"Plans":[{"Node Id":"Selection","Plan Rows":3207987.2,"Actual Rows":2534187,"Task":"cop[tikv]","Total Time":5546000000,"Max Time":794000000,"Access Object":"","Operation Info":"gt(new0107.lineitem.l_receiptdate, new0107.lineitem.l_commitdate)","Execution Info":"tikv_task:{proc max:794ms, min:404ms, p80:692ms, p95:794ms, iters:3959, tasks:9}, scan_detail: {total_process_keys: 4009984, total_process_keys_size: 787655655, total_keys: 4009993, rocksdb: {delete_skipped_count: 0, key_skipped_count: 4009984, block: {cache_hit_count: 12898, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4975000000,"Max Time":755000000,"Access Object":"","Operation Info":"table:l1, keep order:false","Execution Info":"tikv_task:{proc max:755ms, min:308ms, p80:628ms, p95:755ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"TableReader","Plan Rows":0.001,"Actual Rows":48356,"Task":"root","Total Time":4730057626,"Max Time":888237002,"Access Object":"","Operation Info":"data:Selection_94","Execution Info":"time:4.73s, loops:65, cop_task: {num: 19, max: 582.9ms, min: 54.8ms, avg: 259.7ms, p95: 582.9ms, max_proc_keys: 18401, p95_proc_keys: 18401, tot_proc: 1.61s, tot_wait: 68ms, rpc_num: 37, rpc_time: 9.81s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":0,"Plans":[{"Node Id":"Selection","Plan Rows":0.001,"Actual Rows":48356,"Task":"cop[tikv]","Total Time":1560000000,"Max Time":345000000,"Access Object":"","Operation Info":"eq(new0107.orders.o_orderstatus, \"F\")","Execution Info":"tikv_task:{proc max:345ms, min:0s, p80:142ms, p95:345ms, iters:178, tasks:19}, scan_detail: {total_process_keys: 100124, total_process_keys_size: 15170084, total_keys: 108158, rocksdb: {delete_skipped_count: 0, key_skipped_count: 16673, block: {cache_hit_count: 131374, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":100124,"Task":"cop[tikv]","Total Time":1547000000,"Max Time":343000000,"Access Object":"","Operation Info":"table:orders, range: decided by [new0107.lineitem.l_orderkey], keep order:false","Execution Info":"tikv_task:{proc max:343ms, min:0s, p80:141ms, p95:343ms, iters:178, tasks:19}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"IndexLookUp","Plan Rows":4.054354859583279,"Actual Rows":239380,"Task":"root","Total Time":11895154147,"Max Time":2435264088,"Access Object":"","Operation Info":"","Execution Info":"time:11.9s, loops:249, index_task: {total_time: 6.08s, fetch_handle: 6.08s, build: 75.4µs, wait: 110µs}, table_task: {total_time: 20.2s, num: 40, concurrency: 50}","Disk":0,"Memory":232536,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":4.054354859583279,"Actual Rows":239380,"Task":"cop[tikv]","Total Time":1846000000,"Max Time":310000000,"Access Object":"","Operation Info":"table:l2, index:PRIMARY(L_ORDERKEY, L_LINENUMBER), range: decided by [eq(new0107.lineitem.l_orderkey, new0107.lineitem.l_orderkey)], keep order:false","Execution Info":"time:6.06s, loops:263, cop_task: {num: 20, max: 1.79s, min: 38ms, avg: 499.1ms, p95: 1.79s, max_proc_keys: 29807, p95_proc_keys: 29807, tot_proc: 1.92s, tot_wait: 209ms, rpc_num: 39, rpc_time: 19.9s, copr_cache_hit_ratio: 0.00}, tikv_task:{proc max:310ms, min:2ms, p80:186ms, p95:310ms, iters:322, tasks:20}, scan_detail: {total_process_keys: 239380, total_process_keys_size: 12687140, total_keys: 287738, rocksdb: {delete_skipped_count: 0, key_skipped_count: 239380, block: {cache_hit_count: 193605, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]},{"Node Id":"TableRowIDScan","Plan Rows":4.054354859583279,"Actual Rows":239380,"Task":"cop[tikv]","Total Time":1755000000,"Max Time":176000000,"Access Object":"","Operation Info":"table:l2, keep order:false","Execution Info":"time:19.7s, loops:302, cop_task: {num: 55, max: 1.25s, min: 24.7ms, avg: 308.7ms, p95: 1.04s, max_proc_keys: 20480, p95_proc_keys: 15328, tot_proc: 2.72s, tot_wait: 580ms, rpc_num: 109, rpc_time: 33.9s, copr_cache_hit_ratio: 0.00}, tikv_task:{proc max:176ms, min:0s, p80:50ms, p95:133ms, iters:483, tasks:55}, scan_detail: {total_process_keys: 239380, total_process_keys_size: 47013118, total_keys: 283644, rocksdb: {delete_skipped_count: 0, key_skipped_count: 237674, block: {cache_hit_count: 165795, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"IndexLookUp","Plan Rows":4.054354859583279,"Actual Rows":165987,"Task":"root","Total Time":17486516484,"Max Time":3719337557,"Access Object":"","Operation Info":"","Execution Info":"time:17.5s, loops:177, index_task: {total_time: 6.77s, fetch_handle: 6.62s, build: 96.6µs, wait: 143ms}, table_task: {total_time: 18.7s, num: 40, concurrency: 50}","Disk":0,"Memory":142192,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":5.067943574479099,"Actual Rows":237493,"Task":"cop[tikv]","Total Time":2205000000,"Max Time":338000000,"Access Object":"","Operation Info":"table:l3, index:PRIMARY(L_ORDERKEY, L_LINENUMBER), range: decided by [eq(new0107.lineitem.l_orderkey, new0107.lineitem.l_orderkey)], keep order:false","Execution Info":"time:6.48s, loops:262, cop_task: {num: 20, max: 1.29s, min: 72.9ms, avg: 536.5ms, p95: 1.29s, max_proc_keys: 29600, p95_proc_keys: 29600, tot_proc: 2.95s, tot_wait: 302ms, rpc_num: 39, rpc_time: 20.2s, copr_cache_hit_ratio: 0.00}, tikv_task:{proc max:338ms, min:2ms, p80:226ms, p95:338ms, iters:321, tasks:20}, scan_detail: {total_process_keys: 237493, total_process_keys_size: 12587129, total_keys: 283972, rocksdb: {delete_skipped_count: 0, key_skipped_count: 237493, block: {cache_hit_count: 186089, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]},{"Node Id":"Selection","Plan Rows":4.054354859583279,"Actual Rows":165987,"Task":"cop[tikv]","Total Time":1952000000,"Max Time":203000000,"Access Object":"","Operation Info":"gt(new0107.lineitem.l_receiptdate, new0107.lineitem.l_commitdate)","Execution Info":"time:18.3s, loops:223, cop_task: {num: 55, max: 3.11s, min: 31.5ms, avg: 309.9ms, p95: 768.9ms, max_proc_keys: 20480, p95_proc_keys: 16384, tot_proc: 4.74s, tot_wait: 507ms, rpc_num: 109, rpc_time: 34s, copr_cache_hit_ratio: 0.00}, tikv_task:{proc max:203ms, min:0s, p80:60ms, p95:124ms, iters:486, tasks:55}, scan_detail: {total_process_keys: 237493, total_process_keys_size: 46642329, total_keys: 281751, rocksdb: {delete_skipped_count: 0, key_skipped_count: 237478, block: {cache_hit_count: 162648, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRowIDScan","Plan Rows":5.067943574479099,"Actual Rows":237493,"Task":"cop[tikv]","Total Time":1904000000,"Max Time":185000000,"Access Object":"","Operation Info":"table:l3, keep order:false","Execution Info":"tikv_task:{proc max:185ms, min:0s, p80:60ms, p95:116ms, iters:486, tasks:55}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  s_name,  count(*) as numwait from  supplier,  lineitem l1,  orders,  nation where  s_suppkey = l1.l_suppkey  and o_orderkey = l1.l_orderkey  and o_orderstatus = 'F'  and l1.l_receiptdate > l1.l_commitdate  and exists (   select    *   from    lineitem l2   where    l2.l_orderkey = l1.l_orderkey    and l2.l_suppkey <> l1.l_suppkey  )  and not exists (   select    *   from    lineitem l3   where    l3.l_orderkey = l1.l_orderkey    and l3.l_suppkey <> l1.l_suppkey    and l3.l_receiptdate > l3.l_commitdate  )  and s_nationkey = n_nationkey  and n_name = 'EGYPT' group by  s_name order by  numwait desc,  s_name limit 100;

{"Node Id":"Projection","Plan Rows":20,"Actual Rows":20,"Task":"root","Total Time":10342609084,"Max Time":10342609084,"Access Object":"","Operation Info":"new0107.customer.c_custkey, new0107.customer.c_name, Column#39, new0107.customer.c_acctbal, new0107.nation.n_name, new0107.customer.c_address, new0107.customer.c_phone, new0107.customer.c_comment","Execution Info":"time:10.3s, loops:2, Concurrency:OFF","Disk":0,"Memory":9184,"Plans":[{"Node Id":"TopN","Plan Rows":20,"Actual Rows":20,"Task":"root","Total Time":10342596487,"Max Time":10342596487,"Access Object":"","Operation Info":"Column#39:desc, offset:0, count:20","Execution Info":"time:10.3s, loops:2","Disk":0,"Memory":332280,"Plans":[{"Node Id":"HashAgg","Plan Rows":41373.958195989835,"Actual Rows":27560,"Task":"root","Total Time":10225896271,"Max Time":10225896271,"Access Object":"","Operation Info":"group by:Column#53, Column#54, Column#55, Column#56, Column#57, Column#58, Column#59, funcs:sum(Column#45)-\u003eColumn#39, funcs:firstrow(Column#46)-\u003enew0107.customer.c_custkey, funcs:firstrow(Column#47)-\u003enew0107.customer.c_name, funcs:firstrow(Column#48)-\u003enew0107.customer.c_address, funcs:firstrow(Column#49)-\u003enew0107.customer.c_phone, funcs:firstrow(Column#50)-\u003enew0107.customer.c_acctbal, funcs:firstrow(Column#51)-\u003enew0107.customer.c_comment, funcs:firstrow(Column#52)-\u003enew0107.nation.n_name","Execution Info":"time:10.2s, loops:31, partial_worker:{wall_time:10.132327652s, concurrency:5, task_num:79, tot_wait:48.935183228s, tot_exec:1.355441222s, tot_time:50.371990066s, max:10.112121429s, p95:10.112121429s}, final_worker:{wall_time:10.342756636s, concurrency:5, task_num:25, tot_wait:50.586967368s, tot_exec:869.019224ms, tot_time:51.456024232s, max:10.334543332s, p95:10.334543332s}","Disk":0,"Memory":42498923,"Plans":[{"Node Id":"Projection","Plan Rows":167744.70847210684,"Actual Rows":76675,"Task":"root","Total Time":10043759317,"Max Time":10043759317,"Access Object":"","Operation Info":"mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount))-\u003eColumn#45, new0107.customer.c_custkey, new0107.customer.c_name, new0107.customer.c_address, new0107.customer.c_phone, new0107.customer.c_acctbal, new0107.customer.c_comment, new0107.nation.n_name, new0107.customer.c_custkey, new0107.customer.c_name, new0107.customer.c_acctbal, new0107.customer.c_phone, new0107.nation.n_name, new0107.customer.c_address, new0107.customer.c_comment","Execution Info":"time:10s, loops:80, Concurrency:5","Disk":0,"Memory":4707088,"Plans":[{"Node Id":"Projection","Plan Rows":167744.70847210684,"Actual Rows":76675,"Task":"root","Total Time":10039964355,"Max Time":10039964355,"Access Object":"","Operation Info":"new0107.customer.c_custkey, new0107.customer.c_name, new0107.customer.c_address, new0107.customer.c_phone, new0107.customer.c_acctbal, new0107.customer.c_comment, new0107.lineitem.l_extendedprice, new0107.lineitem.l_discount, new0107.nation.n_name","Execution Info":"time:10s, loops:80, Concurrency:5","Disk":0,"Memory":3534856,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":167744.70847210684,"Actual Rows":76675,"Task":"root","Total Time":10037461756,"Max Time":10037461756,"Access Object":"","Operation Info":"inner join, inner:IndexLookUp_32, outer key:new0107.orders.o_orderkey, inner key:new0107.lineitem.l_orderkey, equal cond:eq(new0107.orders.o_orderkey, new0107.lineitem.l_orderkey)","Execution Info":"time:10s, loops:80, inner:{total:30s, concurrency:5, task:10, construct:556.9ms, fetch:26.6s, build:310.4ms, join:2.84s}","Disk":0,"Memory":23699876,"Plans":[{"Node Id":"HashJoin","Plan Rows":41373.958195989835,"Actual Rows":38190,"Task":"root","Total Time":2151567020,"Max Time":2151567020,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.customer.c_custkey, new0107.orders.o_custkey)]","Execution Info":"time:2.15s, loops:41, build_hash_table:{total:249.8ms, fetch:137.1ms, build:112.7ms}, probe:{concurrency:5, total:10.7s, max:2.15s, probe:587.8ms, fetch:10.2s}","Disk":0,"Memory":1157088,"Plans":[{"Node Id":"HashJoin","Plan Rows":150000,"Actual Rows":150000,"Task":"root","Total Time":2093992554,"Max Time":2093992554,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.customer.c_nationkey)]","Execution Info":"time:2.09s, loops:148, build_hash_table:{total:167.3ms, fetch:167.2ms, build:36.4µs}, probe:{concurrency:5, total:10.5s, max:2.14s, probe:2.54s, fetch:7.95s}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":25,"Actual Rows":25,"Task":"root","Total Time":167077181,"Max Time":167077181,"Access Object":"","Operation Info":"data:TableFullScan_60","Execution Info":"time:167.1ms, loops:2, cop_task: {num: 1, max: 159.7ms, proc_keys: 25, rpc_num: 1, rpc_time: 159.6ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":794,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:nation, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]},{"Node Id":"TableReader","Plan Rows":150000,"Actual Rows":150000,"Task":"root","Total Time":1555327414,"Max Time":1555327414,"Access Object":"","Operation Info":"data:TableFullScan_58","Execution Info":"time:1.56s, loops:148, cop_task: {num: 1, max: 1.53s, proc_keys: 150000, tot_proc: 346ms, tot_wait: 1ms, rpc_num: 1, rpc_time: 1.53s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":32798874,"Plans":[{"Node Id":"TableFullScan","Plan Rows":150000,"Actual Rows":150000,"Task":"cop[tikv]","Total Time":181000000,"Max Time":181000000,"Access Object":"","Operation Info":"table:customer, keep order:false","Execution Info":"tikv_task:{time:181ms, loops:151}, scan_detail: {total_process_keys: 150000, total_process_keys_size: 30533765, total_keys: 150001, rocksdb: {delete_skipped_count: 0, key_skipped_count: 150000, block: {cache_hit_count: 502, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":41254.801196385386,"Actual Rows":38190,"Task":"root","Total Time":136026246,"Max Time":136026246,"Access Object":"","Operation Info":"data:Selection_63","Execution Info":"time:136ms, loops:39, cop_task: {num: 2, max: 105.5ms, min: 79.4ms, avg: 92.5ms, p95: 105.5ms, rpc_num: 2, rpc_time: 184.9ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":946375,"Plans":[{"Node Id":"Selection","Plan Rows":41254.801196385386,"Actual Rows":38190,"Task":"cop[tikv]","Total Time":1112000000,"Max Time":769000000,"Access Object":"","Operation Info":"ge(new0107.orders.o_orderdate, 1993-08-01 00:00:00.000000), lt(new0107.orders.o_orderdate, 1993-11-01 00:00:00.000000)","Execution Info":"tikv_task:{proc max:769ms, min:343ms, p80:769ms, p95:769ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":1060000000,"Max Time":740000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:740ms, min:320ms, p80:740ms, p95:740ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"IndexLookUp","Plan Rows":4.054354859583279,"Actual Rows":76675,"Task":"root","Total Time":25763908923,"Max Time":4632187620,"Access Object":"","Operation Info":"","Execution Info":"time:25.8s, loops:91, index_task: {total_time: 14.4s, fetch_handle: 14.4s, build: 117.7µs, wait: 119.6µs}, table_task: {total_time: 27.8s, num: 38, concurrency: 50}","Disk":0,"Memory":274848,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":16.31766974151436,"Actual Rows":153298,"Task":"cop[tikv]","Total Time":2012000000,"Max Time":326000000,"Access Object":"","Operation Info":"table:lineitem, index:PRIMARY(L_ORDERKEY, L_LINENUMBER), range: decided by [eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)], keep order:false","Execution Info":"time:12.9s, loops:182, cop_task: {num: 40, max: 3.91s, min: 31.5ms, avg: 689.7ms, p95: 3.25s, max_proc_keys: 19517, p95_proc_keys: 16592, tot_proc: 6.91s, tot_wait: 3.29s, rpc_num: 76, rpc_time: 53s, copr_cache_hit_ratio: 0.00}, tikv_task:{proc max:326ms, min:7ms, p80:113ms, p95:176ms, iters:329, tasks:40}, scan_detail: {total_process_keys: 153298, total_process_keys_size: 8124794, total_keys: 191488, rocksdb: {delete_skipped_count: 0, key_skipped_count: 153298, block: {cache_hit_count: 152871, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]},{"Node Id":"Selection","Plan Rows":4.054354859583279,"Actual Rows":76675,"Task":"cop[tikv]","Total Time":1972000000,"Max Time":197000000,"Access Object":"","Operation Info":"eq(new0107.lineitem.l_returnflag, \"R\")","Execution Info":"time:25.7s, loops:134, cop_task: {num: 132, max: 1.49s, min: 14.1ms, avg: 368.7ms, p95: 971.5ms, max_proc_keys: 8840, p95_proc_keys: 4389, tot_proc: 3.93s, tot_wait: 1.42s, rpc_num: 259, rpc_time: 1m36s, copr_cache_hit_ratio: 0.00}, tikv_task:{proc max:197ms, min:0s, p80:19ms, p95:64ms, iters:658, tasks:132}, scan_detail: {total_process_keys: 153298, total_process_keys_size: 30112421, total_keys: 185884, rocksdb: {delete_skipped_count: 0, key_skipped_count: 148053, block: {cache_hit_count: 129259, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRowIDScan","Plan Rows":16.31766974151436,"Actual Rows":153298,"Task":"cop[tikv]","Total Time":1935000000,"Max Time":195000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:195ms, min:0s, p80:19ms, p95:63ms, iters:658, tasks:132}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  c_custkey,  c_name,  sum(l_extendedprice * (1 - l_discount)) as revenue,  c_acctbal,  n_name,  c_address,  c_phone,  c_comment from  customer,  orders,  lineitem,  nation where  c_custkey = o_custkey  and l_orderkey = o_orderkey  and o_orderdate >= '1993-08-01'  and o_orderdate < date_add('1993-08-01', interval '3' month)  and l_returnflag = 'R'  and c_nationkey = n_nationkey group by  c_custkey,  c_name,  c_acctbal,  c_phone,  n_name,  c_address,  c_comment order by  revenue desc limit 20;

{"Node Id":"Sort","Plan Rows":307.48077797816654,"Actual Rows":1,"Task":"root","Total Time":330753099,"Max Time":330753099,"Access Object":"","Operation Info":"new0107.supplier.s_suppkey","Execution Info":"time:330.8ms, loops:2","Disk":0,"Memory":3684,"Plans":[{"Node Id":"IndexJoin","Plan Rows":307.48077797816654,"Actual Rows":1,"Task":"root","Total Time":330414708,"Max Time":330414708,"Access Object":"","Operation Info":"inner join, inner:TableReader_62, outer key:new0107.lineitem.l_suppkey, inner key:new0107.supplier.s_suppkey, equal cond:eq(new0107.lineitem.l_suppkey, new0107.supplier.s_suppkey)","Execution Info":"time:330.4ms, loops:2, inner:{total:88.1ms, concurrency:5, task:1, construct:2.55ms, fetch:85.5ms, build:9.68µs}, probe:7.21µs","Disk":0,"Memory":108177,"Plans":[{"Node Id":"TableReader","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":82235356,"Max Time":82235356,"Access Object":"","Operation Info":"data:TableRangeScan_61","Execution Info":"time:82.2ms, loops:2, cop_task: {num: 1, max: 80.9ms, proc_keys: 1, rpc_num: 1, rpc_time: 80.9ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":1,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:supplier, range: decided by [new0107.lineitem.l_suppkey], keep order:false","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 1, total_process_keys_size: 129, total_keys: 1, rocksdb: {delete_skipped_count: 0, key_skipped_count: 0, block: {cache_hit_count: 3, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]},{"Node Id":"Selection","Plan Rows":307.48077797816654,"Actual Rows":1,"Task":"root","Total Time":355843131,"Max Time":355843131,"Access Object":"","Operation Info":"eq(Column#25, 1479126.6609)","Execution Info":"time:355.8ms, loops:3","Disk":0,"Memory":50944,"Plans":[{"Node Id":"HashAgg","Plan Rows":384.3509724727081,"Actual Rows":10000,"Task":"root","Total Time":352267563,"Max Time":352267563,"Access Object":"","Operation Info":"group by:new0107.lineitem.l_suppkey, funcs:sum(Column#46)-\u003eColumn#25, funcs:firstrow(new0107.lineitem.l_suppkey)-\u003enew0107.lineitem.l_suppkey","Execution Info":"time:352.3ms, loops:13, partial_worker:{wall_time:347.809401ms, concurrency:5, task_num:9, tot_wait:1.033150284s, tot_exec:44.671457ms, tot_time:1.162226572s, max:300.173396ms, p95:300.173396ms}, final_worker:{wall_time:351.578509ms, concurrency:5, task_num:25, tot_wait:1.515836273s, tot_exec:38.95811ms, tot_time:1.554817995s, max:312.927334ms, p95:312.927334ms}","Disk":0,"Memory":10269512,"Plans":[{"Node Id":"TableReader","Plan Rows":384.3509724727081,"Actual Rows":72907,"Task":"root","Total Time":187922527,"Max Time":187922527,"Access Object":"","Operation Info":"data:HashAgg_73","Execution Info":"time:187.9ms, loops:10, cop_task: {num: 9, max: 197.6ms, min: 70ms, avg: 117.3ms, p95: 197.6ms, rpc_num: 9, rpc_time: 1.06s, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":2700301,"Plans":[{"Node Id":"HashAgg","Plan Rows":384.3509724727081,"Actual Rows":72907,"Task":"cop[tikv]","Total Time":4716000000,"Max Time":640000000,"Access Object":"","Operation Info":"group by:new0107.lineitem.l_suppkey, funcs:sum(mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount)))-\u003eColumn#46","Execution Info":"tikv_task:{proc max:640ms, min:266ms, p80:587ms, p95:640ms, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"Selection","Plan Rows":154124.125,"Actual Rows":154277,"Task":"cop[tikv]","Total Time":4328000000,"Max Time":595000000,"Access Object":"","Operation Info":"ge(new0107.lineitem.l_shipdate, 1997-07-01 00:00:00.000000), lt(new0107.lineitem.l_shipdate, 1997-10-01 00:00:00.000000)","Execution Info":"tikv_task:{proc max:595ms, min:238ms, p80:528ms, p95:595ms, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4093000000,"Max Time":572000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:572ms, min:216ms, p80:504ms, p95:572ms, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
 /*PLACEHOLDER*/ select  s_suppkey,  s_name,  s_address,  s_phone,  total_revenue from  supplier,  revenue0 where  s_suppkey = supplier_no  and total_revenue = (   select    max(total_revenue)   from    revenue0  ) order by  s_suppkey;
create view revenue0 (supplier_no, total_revenue) as  select   l_suppkey,   sum(l_extendedprice * (1 - l_discount))  from   lineitem  where   l_shipdate >= '1997-07-01'   and l_shipdate < date_add('1997-07-01', interval '3' month)  group by   l_suppkey;

{"Node Id":"Projection","Plan Rows":20,"Actual Rows":20,"Task":"root","Total Time":7772321706,"Max Time":7772321706,"Access Object":"","Operation Info":"new0107.customer.c_custkey, new0107.customer.c_name, Column#39, new0107.customer.c_acctbal, new0107.nation.n_name, new0107.customer.c_address, new0107.customer.c_phone, new0107.customer.c_comment","Execution Info":"time:7.77s, loops:2, Concurrency:OFF","Disk":0,"Memory":9184,"Plans":[{"Node Id":"TopN","Plan Rows":20,"Actual Rows":20,"Task":"root","Total Time":7772307755,"Max Time":7772307755,"Access Object":"","Operation Info":"Column#39:desc, offset:0, count:20","Execution Info":"time:7.77s, loops:2","Disk":0,"Memory":307704,"Plans":[{"Node Id":"HashAgg","Plan Rows":41373.958195989835,"Actual Rows":27560,"Task":"root","Total Time":7766934617,"Max Time":7766934617,"Access Object":"","Operation Info":"group by:Column#53, Column#54, Column#55, Column#56, Column#57, Column#58, Column#59, funcs:sum(Column#45)-\u003eColumn#39, funcs:firstrow(Column#46)-\u003enew0107.customer.c_custkey, funcs:firstrow(Column#47)-\u003enew0107.customer.c_name, funcs:firstrow(Column#48)-\u003enew0107.customer.c_address, funcs:firstrow(Column#49)-\u003enew0107.customer.c_phone, funcs:firstrow(Column#50)-\u003enew0107.customer.c_acctbal, funcs:firstrow(Column#51)-\u003enew0107.customer.c_comment, funcs:firstrow(Column#52)-\u003enew0107.nation.n_name","Execution Info":"time:7.77s, loops:31, partial_worker:{wall_time:7.147415795s, concurrency:5, task_num:78, tot_wait:34.440700955s, tot_exec:885.285869ms, tot_time:35.417945088s, max:7.106152258s, p95:7.106152258s}, final_worker:{wall_time:7.772468153s, concurrency:5, task_num:25, tot_wait:35.489834092s, tot_exec:1.544263811s, tot_time:37.034118795s, max:7.730595849s, p95:7.730595849s}","Disk":0,"Memory":42856566,"Plans":[{"Node Id":"Projection","Plan Rows":167744.70847210684,"Actual Rows":76675,"Task":"root","Total Time":7038507100,"Max Time":7038507100,"Access Object":"","Operation Info":"mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount))-\u003eColumn#45, new0107.customer.c_custkey, new0107.customer.c_name, new0107.customer.c_address, new0107.customer.c_phone, new0107.customer.c_acctbal, new0107.customer.c_comment, new0107.nation.n_name, new0107.customer.c_custkey, new0107.customer.c_name, new0107.customer.c_acctbal, new0107.customer.c_phone, new0107.nation.n_name, new0107.customer.c_address, new0107.customer.c_comment","Execution Info":"time:7.04s, loops:79, Concurrency:5","Disk":0,"Memory":4689512,"Plans":[{"Node Id":"Projection","Plan Rows":167744.70847210684,"Actual Rows":76675,"Task":"root","Total Time":7013289827,"Max Time":7013289827,"Access Object":"","Operation Info":"new0107.customer.c_custkey, new0107.customer.c_name, new0107.customer.c_address, new0107.customer.c_phone, new0107.customer.c_acctbal, new0107.customer.c_comment, new0107.lineitem.l_extendedprice, new0107.lineitem.l_discount, new0107.nation.n_name","Execution Info":"time:7.01s, loops:79, Concurrency:5","Disk":0,"Memory":3524792,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":167744.70847210684,"Actual Rows":76675,"Task":"root","Total Time":7001300346,"Max Time":7001300346,"Access Object":"","Operation Info":"inner join, inner:IndexLookUp_32, outer key:new0107.orders.o_orderkey, inner key:new0107.lineitem.l_orderkey, equal cond:eq(new0107.orders.o_orderkey, new0107.lineitem.l_orderkey)","Execution Info":"time:7s, loops:79, inner:{total:14.8s, concurrency:5, task:10, construct:567.4ms, fetch:13s, build:552.2ms, join:1.26s}","Disk":0,"Memory":23629320,"Plans":[{"Node Id":"HashJoin","Plan Rows":41373.958195989835,"Actual Rows":38190,"Task":"root","Total Time":3847099920,"Max Time":3847099920,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.customer.c_custkey, new0107.orders.o_custkey)]","Execution Info":"time:3.85s, loops:41, build_hash_table:{total:610.7ms, fetch:228ms, build:382.7ms}, probe:{concurrency:5, total:20.3s, max:4.07s, probe:1.77s, fetch:18.5s}","Disk":0,"Memory":1157088,"Plans":[{"Node Id":"HashJoin","Plan Rows":150000,"Actual Rows":150000,"Task":"root","Total Time":3856337867,"Max Time":3856337867,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.customer.c_nationkey)]","Execution Info":"time:3.86s, loops:148, build_hash_table:{total:317.4ms, fetch:317.4ms, build:71.2µs}, probe:{concurrency:5, total:20.2s, max:4.05s, probe:11.2s, fetch:9s}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":25,"Actual Rows":25,"Task":"root","Total Time":310044299,"Max Time":310044299,"Access Object":"","Operation Info":"data:TableFullScan_60","Execution Info":"time:310ms, loops:2, cop_task: {num: 1, max: 276.4ms, proc_keys: 25, rpc_num: 1, rpc_time: 276.4ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":798,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:nation, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]},{"Node Id":"TableReader","Plan Rows":150000,"Actual Rows":150000,"Task":"root","Total Time":1660804472,"Max Time":1660804472,"Access Object":"","Operation Info":"data:TableFullScan_58","Execution Info":"time:1.66s, loops:148, cop_task: {num: 1, max: 1.18s, proc_keys: 150000, tot_proc: 338ms, tot_wait: 10ms, rpc_num: 1, rpc_time: 1.18s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":32798874,"Plans":[{"Node Id":"TableFullScan","Plan Rows":150000,"Actual Rows":150000,"Task":"cop[tikv]","Total Time":185000000,"Max Time":185000000,"Access Object":"","Operation Info":"table:customer, keep order:false","Execution Info":"tikv_task:{time:185ms, loops:151}, scan_detail: {total_process_keys: 150000, total_process_keys_size: 30533765, total_keys: 150001, rocksdb: {delete_skipped_count: 0, key_skipped_count: 150000, block: {cache_hit_count: 502, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":41254.801196385386,"Actual Rows":38190,"Task":"root","Total Time":135287175,"Max Time":135287175,"Access Object":"","Operation Info":"data:Selection_63","Execution Info":"time:135.3ms, loops:39, cop_task: {num: 2, max: 373.2ms, min: 124ms, avg: 248.6ms, p95: 373.2ms, rpc_num: 2, rpc_time: 497.2ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":946379,"Plans":[{"Node Id":"Selection","Plan Rows":41254.801196385386,"Actual Rows":38190,"Task":"cop[tikv]","Total Time":1112000000,"Max Time":769000000,"Access Object":"","Operation Info":"ge(new0107.orders.o_orderdate, 1993-08-01 00:00:00.000000), lt(new0107.orders.o_orderdate, 1993-11-01 00:00:00.000000)","Execution Info":"tikv_task:{proc max:769ms, min:343ms, p80:769ms, p95:769ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":1060000000,"Max Time":740000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:740ms, min:320ms, p80:740ms, p95:740ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"IndexLookUp","Plan Rows":4.054354859583279,"Actual Rows":76675,"Task":"root","Total Time":10091347208,"Max Time":1473441250,"Access Object":"","Operation Info":"","Execution Info":"time:10.1s, loops:91, index_task: {total_time: 6.22s, fetch_handle: 6.04s, build: 96.6µs, wait: 174.3ms}, table_task: {total_time: 11.2s, num: 37, concurrency: 50}","Disk":0,"Memory":312160,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":16.31766974151436,"Actual Rows":153298,"Task":"cop[tikv]","Total Time":1656000000,"Max Time":169000000,"Access Object":"","Operation Info":"table:lineitem, index:PRIMARY(L_ORDERKEY, L_LINENUMBER), range: decided by [eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)], keep order:false","Execution Info":"time:6.03s, loops:185, cop_task: {num: 40, max: 994.9ms, min: 70ms, avg: 420.4ms, p95: 994.6ms, max_proc_keys: 19638, p95_proc_keys: 16365, tot_proc: 3.22s, tot_wait: 906ms, rpc_num: 76, rpc_time: 31.2s, copr_cache_hit_ratio: 0.00}, tikv_task:{proc max:169ms, min:5ms, p80:75ms, p95:161ms, iters:333, tasks:40}, scan_detail: {total_process_keys: 153298, total_process_keys_size: 8124794, total_keys: 191488, rocksdb: {delete_skipped_count: 0, key_skipped_count: 153298, block: {cache_hit_count: 152871, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]},{"Node Id":"Selection","Plan Rows":4.054354859583279,"Actual Rows":76675,"Task":"cop[tikv]","Total Time":2129000000,"Max Time":104000000,"Access Object":"","Operation Info":"eq(new0107.lineitem.l_returnflag, \"R\")","Execution Info":"time:11s, loops:131, cop_task: {num: 134, max: 601.6ms, min: 15.4ms, avg: 178.4ms, p95: 599.1ms, max_proc_keys: 8916, p95_proc_keys: 4124, tot_proc: 3.03s, tot_wait: 1.3s, rpc_num: 262, rpc_time: 45.2s, copr_cache_hit_ratio: 0.00}, tikv_task:{proc max:104ms, min:0s, p80:21ms, p95:69ms, iters:670, tasks:134}, scan_detail: {total_process_keys: 153298, total_process_keys_size: 30112421, total_keys: 185883, rocksdb: {delete_skipped_count: 0, key_skipped_count: 148054, block: {cache_hit_count: 129262, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRowIDScan","Plan Rows":16.31766974151436,"Actual Rows":153298,"Task":"cop[tikv]","Total Time":2091000000,"Max Time":103000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:103ms, min:0s, p80:21ms, p95:69ms, iters:670, tasks:134}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  c_custkey,  c_name,  sum(l_extendedprice * (1 - l_discount)) as revenue,  c_acctbal,  n_name,  c_address,  c_phone,  c_comment from  customer,  orders,  lineitem,  nation where  c_custkey = o_custkey  and l_orderkey = o_orderkey  and o_orderdate >= '1993-08-01'  and o_orderdate < date_add('1993-08-01', interval '3' month)  and l_returnflag = 'R'  and c_nationkey = n_nationkey group by  c_custkey,  c_name,  c_acctbal,  c_phone,  n_name,  c_address,  c_comment order by  revenue desc limit 20;

{"Node Id":"Sort","Plan Rows":30863.36,"Actual Rows":4,"Task":"root","Total Time":1681475250,"Max Time":1681475250,"Access Object":"","Operation Info":"Column#31","Execution Info":"time:1.68s, loops:2","Disk":0,"Memory":9712,"Plans":[{"Node Id":"Projection","Plan Rows":30863.36,"Actual Rows":4,"Task":"root","Total Time":1681410849,"Max Time":1681410849,"Access Object":"","Operation Info":"Column#31, Column#32, Column#33","Execution Info":"time:1.68s, loops:5, Concurrency:5","Disk":0,"Memory":24280,"Plans":[{"Node Id":"HashAgg","Plan Rows":30863.36,"Actual Rows":4,"Task":"root","Total Time":1659973083,"Max Time":1659973083,"Access Object":"","Operation Info":"group by:Column#37, funcs:count(1)-\u003eColumn#32, funcs:sum(Column#35)-\u003eColumn#33, funcs:firstrow(Column#36)-\u003eColumn#31","Execution Info":"time:1.66s, loops:5, partial_worker:{wall_time:1.658793291s, concurrency:5, task_num:7, tot_wait:8.278134191s, tot_exec:1.845802ms, tot_time:8.280018367s, max:1.658431292s, p95:1.658431292s}, final_worker:{wall_time:1.659003738s, concurrency:5, task_num:18, tot_wait:8.286745622s, tot_exec:6.108892ms, tot_time:8.292860812s, max:1.658595535s, p95:1.658595535s}","Disk":0,"Memory":367991,"Plans":[{"Node Id":"Projection","Plan Rows":32000,"Actual Rows":3679,"Task":"root","Total Time":1646196687,"Max Time":1646196687,"Access Object":"","Operation Info":"new0107.customer.c_acctbal, substring(new0107.customer.c_phone, 1, 2)-\u003eColumn#36, substring(new0107.customer.c_phone, 1, 2)-\u003eColumn#37","Execution Info":"time:1.65s, loops:8, Concurrency:5","Disk":0,"Memory":146928,"Plans":[{"Node Id":"HashJoin","Plan Rows":32000,"Actual Rows":3679,"Task":"root","Total Time":1645901176,"Max Time":1645901176,"Access Object":"","Operation Info":"anti semi join, equal:[eq(new0107.customer.c_custkey, new0107.orders.o_custkey)]","Execution Info":"time:1.65s, loops:8, build_hash_table:{total:1.46s, fetch:668.5ms, build:786.6ms}, probe:{concurrency:5, total:7.95s, max:1.65s, probe:362.1ms, fetch:7.59s}","Disk":0,"Memory":8255872,"Plans":[{"Node Id":"TableReader","Plan Rows":40000,"Actual Rows":10834,"Task":"root","Total Time":369783336,"Max Time":369783336,"Access Object":"","Operation Info":"data:Selection_43","Execution Info":"time:369.8ms, loops:12, cop_task: {num: 1, max: 344.3ms, proc_keys: 150000, tot_proc: 251ms, tot_wait: 3ms, rpc_num: 1, rpc_time: 344.3ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":775191,"Plans":[{"Node Id":"Selection","Plan Rows":40000,"Actual Rows":10834,"Task":"cop[tikv]","Total Time":245000000,"Max Time":245000000,"Access Object":"","Operation Info":"gt(new0107.customer.c_acctbal, 5001.433377), in(substring(new0107.customer.c_phone, 1, 2), \"20\", \"40\", \"22\", \"30\", \"39\", \"42\", \"21\")","Execution Info":"tikv_task:{time:245ms, loops:151}, scan_detail: {total_process_keys: 150000, total_process_keys_size: 30533765, total_keys: 150001, rocksdb: {delete_skipped_count: 0, key_skipped_count: 150000, block: {cache_hit_count: 502, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":150000,"Actual Rows":150000,"Task":"cop[tikv]","Total Time":202000000,"Max Time":202000000,"Access Object":"","Operation Info":"table:customer, keep order:false","Execution Info":"tikv_task:{time:202ms, loops:151}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":1094656,"Actual Rows":1001472,"Task":"root","Total Time":626611445,"Max Time":626611445,"Access Object":"","Operation Info":"data:TableFullScan_45","Execution Info":"time:626.6ms, loops:980, cop_task: {num: 2, max: 701.7ms, min: 605.3ms, avg: 653.5ms, p95: 701.7ms, max_proc_keys: 583494, p95_proc_keys: 583494, tot_proc: 1.12s, tot_wait: 3ms, rpc_num: 2, rpc_time: 1.31s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":8025844,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":1079000000,"Max Time":572000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:572ms, min:507ms, p80:572ms, p95:572ms, iters:987, tasks:2}, scan_detail: {total_process_keys: 1001472, total_process_keys_size: 151717700, total_keys: 1001474, rocksdb: {delete_skipped_count: 0, key_skipped_count: 1001472, block: {cache_hit_count: 2529, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  cntrycode,  count(*) as numcust,  sum(c_acctbal) as totacctbal from  (   select    substring(c_phone from 1 for 2) as cntrycode,    c_acctbal   from    customer   where    substring(c_phone from 1 for 2) in     ('20', '40', '22', '30', '39', '42', '21')    and c_acctbal > (     select      avg(c_acctbal)     from      customer     where      c_acctbal > 0.00      and substring(c_phone from 1 for 2) in       ('20', '40', '22', '30', '39', '42', '21')    )    and not exists (     select      *     from      orders     where      o_custkey = c_custkey    )  ) as custsale group by  cntrycode order by  cntrycode;

{"Node Id":"Projection","Plan Rows":20,"Actual Rows":20,"Task":"root","Total Time":4340645312,"Max Time":4340645312,"Access Object":"","Operation Info":"new0107.customer.c_custkey, new0107.customer.c_name, Column#39, new0107.customer.c_acctbal, new0107.nation.n_name, new0107.customer.c_address, new0107.customer.c_phone, new0107.customer.c_comment","Execution Info":"time:4.34s, loops:2, Concurrency:OFF","Disk":0,"Memory":9184,"Plans":[{"Node Id":"TopN","Plan Rows":20,"Actual Rows":20,"Task":"root","Total Time":4340628362,"Max Time":4340628362,"Access Object":"","Operation Info":"Column#39:desc, offset:0, count:20","Execution Info":"time:4.34s, loops:2","Disk":0,"Memory":332280,"Plans":[{"Node Id":"HashAgg","Plan Rows":41373.958195989835,"Actual Rows":27560,"Task":"root","Total Time":4274208216,"Max Time":4274208216,"Access Object":"","Operation Info":"group by:Column#53, Column#54, Column#55, Column#56, Column#57, Column#58, Column#59, funcs:sum(Column#45)-\u003eColumn#39, funcs:firstrow(Column#46)-\u003enew0107.customer.c_custkey, funcs:firstrow(Column#47)-\u003enew0107.customer.c_name, funcs:firstrow(Column#48)-\u003enew0107.customer.c_address, funcs:firstrow(Column#49)-\u003enew0107.customer.c_phone, funcs:firstrow(Column#50)-\u003enew0107.customer.c_acctbal, funcs:firstrow(Column#51)-\u003enew0107.customer.c_comment, funcs:firstrow(Column#52)-\u003enew0107.nation.n_name","Execution Info":"time:4.27s, loops:31, partial_worker:{wall_time:4.230944889s, concurrency:5, task_num:78, tot_wait:20.214018387s, tot_exec:783.832165ms, tot_time:21.011489238s, max:4.210594263s, p95:4.210594263s}, final_worker:{wall_time:4.390286867s, concurrency:5, task_num:25, tot_wait:21.194866478s, tot_exec:370.663847ms, tot_time:21.565565285s, max:4.331904241s, p95:4.331904241s}","Disk":0,"Memory":42175957,"Plans":[{"Node Id":"Projection","Plan Rows":167744.70847210684,"Actual Rows":76675,"Task":"root","Total Time":4183177716,"Max Time":4183177716,"Access Object":"","Operation Info":"mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount))-\u003eColumn#45, new0107.customer.c_custkey, new0107.customer.c_name, new0107.customer.c_address, new0107.customer.c_phone, new0107.customer.c_acctbal, new0107.customer.c_comment, new0107.nation.n_name, new0107.customer.c_custkey, new0107.customer.c_name, new0107.customer.c_acctbal, new0107.customer.c_phone, new0107.nation.n_name, new0107.customer.c_address, new0107.customer.c_comment","Execution Info":"time:4.18s, loops:79, Concurrency:5","Disk":0,"Memory":4702224,"Plans":[{"Node Id":"Projection","Plan Rows":167744.70847210684,"Actual Rows":76675,"Task":"root","Total Time":4163741608,"Max Time":4163741608,"Access Object":"","Operation Info":"new0107.customer.c_custkey, new0107.customer.c_name, new0107.customer.c_address, new0107.customer.c_phone, new0107.customer.c_acctbal, new0107.customer.c_comment, new0107.lineitem.l_extendedprice, new0107.lineitem.l_discount, new0107.nation.n_name","Execution Info":"time:4.16s, loops:79, Concurrency:5","Disk":0,"Memory":3504912,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":167744.70847210684,"Actual Rows":76675,"Task":"root","Total Time":4181892108,"Max Time":4181892108,"Access Object":"","Operation Info":"inner join, inner:IndexLookUp_32, outer key:new0107.orders.o_orderkey, inner key:new0107.lineitem.l_orderkey, equal cond:eq(new0107.orders.o_orderkey, new0107.lineitem.l_orderkey)","Execution Info":"time:4.18s, loops:79, inner:{total:11.9s, concurrency:5, task:10, construct:103.9ms, fetch:10.1s, build:165.2ms, join:1.65s}","Disk":0,"Memory":23711917,"Plans":[{"Node Id":"HashJoin","Plan Rows":41373.958195989835,"Actual Rows":38190,"Task":"root","Total Time":1358443988,"Max Time":1358443988,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.customer.c_custkey, new0107.orders.o_custkey)]","Execution Info":"time:1.36s, loops:41, build_hash_table:{total:243.1ms, fetch:161ms, build:82.1ms}, probe:{concurrency:5, total:7.04s, max:1.41s, probe:332.8ms, fetch:6.7s}","Disk":0,"Memory":1157088,"Plans":[{"Node Id":"HashJoin","Plan Rows":150000,"Actual Rows":150000,"Task":"root","Total Time":1401271512,"Max Time":1401271512,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.customer.c_nationkey)]","Execution Info":"time:1.4s, loops:148, build_hash_table:{total:261.4ms, fetch:261.3ms, build:17.3µs}, probe:{concurrency:5, total:6.98s, max:1.4s, probe:2.47s, fetch:4.52s}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":25,"Actual Rows":25,"Task":"root","Total Time":261300919,"Max Time":261300919,"Access Object":"","Operation Info":"data:TableFullScan_60","Execution Info":"time:261.3ms, loops:2, cop_task: {num: 1, max: 167.5ms, proc_keys: 25, rpc_num: 1, rpc_time: 167.5ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":794,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:nation, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]},{"Node Id":"TableReader","Plan Rows":150000,"Actual Rows":150000,"Task":"root","Total Time":778553729,"Max Time":778553729,"Access Object":"","Operation Info":"data:TableFullScan_58","Execution Info":"time:778.6ms, loops:148, cop_task: {num: 1, max: 744.5ms, proc_keys: 150000, tot_proc: 376ms, tot_wait: 2ms, rpc_num: 1, rpc_time: 744.5ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":32798874,"Plans":[{"Node Id":"TableFullScan","Plan Rows":150000,"Actual Rows":150000,"Task":"cop[tikv]","Total Time":217000000,"Max Time":217000000,"Access Object":"","Operation Info":"table:customer, keep order:false","Execution Info":"tikv_task:{time:217ms, loops:151}, scan_detail: {total_process_keys: 150000, total_process_keys_size: 30533765, total_keys: 150001, rocksdb: {delete_skipped_count: 0, key_skipped_count: 150000, block: {cache_hit_count: 502, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":41254.801196385386,"Actual Rows":38190,"Task":"root","Total Time":160436076,"Max Time":160436076,"Access Object":"","Operation Info":"data:Selection_63","Execution Info":"time:160.4ms, loops:39, cop_task: {num: 2, max: 190.5ms, min: 158.8ms, avg: 174.6ms, p95: 190.5ms, rpc_num: 2, rpc_time: 349.2ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":946375,"Plans":[{"Node Id":"Selection","Plan Rows":41254.801196385386,"Actual Rows":38190,"Task":"cop[tikv]","Total Time":1112000000,"Max Time":769000000,"Access Object":"","Operation Info":"ge(new0107.orders.o_orderdate, 1993-08-01 00:00:00.000000), lt(new0107.orders.o_orderdate, 1993-11-01 00:00:00.000000)","Execution Info":"tikv_task:{proc max:769ms, min:343ms, p80:769ms, p95:769ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":1060000000,"Max Time":740000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:740ms, min:320ms, p80:740ms, p95:740ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"IndexLookUp","Plan Rows":4.054354859583279,"Actual Rows":76675,"Task":"root","Total Time":9933712000,"Max Time":1329658992,"Access Object":"","Operation Info":"","Execution Info":"time:9.93s, loops:92, index_task: {total_time: 4.74s, fetch_handle: 4.45s, build: 77.7µs, wait: 283.9ms}, table_task: {total_time: 16s, num: 37, concurrency: 50}","Disk":0,"Memory":271856,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":16.31766974151436,"Actual Rows":153298,"Task":"cop[tikv]","Total Time":1464000000,"Max Time":213000000,"Access Object":"","Operation Info":"table:lineitem, index:PRIMARY(L_ORDERKEY, L_LINENUMBER), range: decided by [eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)], keep order:false","Execution Info":"time:4.42s, loops:184, cop_task: {num: 40, max: 734.2ms, min: 14.6ms, avg: 179.8ms, p95: 712.8ms, max_proc_keys: 19494, p95_proc_keys: 16616, tot_proc: 1.7s, tot_wait: 367ms, rpc_num: 76, rpc_time: 13.5s, copr_cache_hit_ratio: 0.00}, tikv_task:{proc max:213ms, min:6ms, p80:54ms, p95:206ms, iters:331, tasks:40}, scan_detail: {total_process_keys: 153298, total_process_keys_size: 8124794, total_keys: 191488, rocksdb: {delete_skipped_count: 0, key_skipped_count: 153298, block: {cache_hit_count: 152871, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]},{"Node Id":"Selection","Plan Rows":4.054354859583279,"Actual Rows":76675,"Task":"cop[tikv]","Total Time":1787000000,"Max Time":138000000,"Access Object":"","Operation Info":"eq(new0107.lineitem.l_returnflag, \"R\")","Execution Info":"time:15.7s, loops:129, cop_task: {num: 131, max: 725.9ms, min: 12.7ms, avg: 213.6ms, p95: 523.4ms, max_proc_keys: 8249, p95_proc_keys: 4096, tot_proc: 8.39s, tot_wait: 3.16s, rpc_num: 259, rpc_time: 55.1s, copr_cache_hit_ratio: 0.00}, tikv_task:{proc max:138ms, min:0s, p80:17ms, p95:56ms, iters:666, tasks:131}, scan_detail: {total_process_keys: 153298, total_process_keys_size: 30112421, total_keys: 185900, rocksdb: {delete_skipped_count: 0, key_skipped_count: 148062, block: {cache_hit_count: 129260, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRowIDScan","Plan Rows":16.31766974151436,"Actual Rows":153298,"Task":"cop[tikv]","Total Time":1758000000,"Max Time":137000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:137ms, min:0s, p80:17ms, p95:56ms, iters:666, tasks:131}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  c_custkey,  c_name,  sum(l_extendedprice * (1 - l_discount)) as revenue,  c_acctbal,  n_name,  c_address,  c_phone,  c_comment from  customer,  orders,  lineitem,  nation where  c_custkey = o_custkey  and l_orderkey = o_orderkey  and o_orderdate >= '1993-08-01'  and o_orderdate < date_add('1993-08-01', interval '3' month)  and l_returnflag = 'R'  and c_nationkey = n_nationkey group by  c_custkey,  c_name,  c_acctbal,  c_phone,  n_name,  c_address,  c_comment order by  revenue desc limit 20;

{"Node Id":"Projection","Plan Rows":640,"Actual Rows":838,"Task":"root","Total Time":1984338445,"Max Time":1984338445,"Access Object":"","Operation Info":"new0107.partsupp.ps_partkey, Column#35","Execution Info":"time:1.98s, loops:2, Concurrency:OFF","Disk":0,"Memory":48256,"Plans":[{"Node Id":"Sort","Plan Rows":640,"Actual Rows":838,"Task":"root","Total Time":1984319267,"Max Time":1984319267,"Access Object":"","Operation Info":"Column#35:desc","Execution Info":"time:1.98s, loops:2","Disk":0,"Memory":48256,"Plans":[{"Node Id":"Selection","Plan Rows":640,"Actual Rows":838,"Task":"root","Total Time":1972916209,"Max Time":1972916209,"Access Object":"","Operation Info":"gt(Column#35, 8147162.905283000000)","Execution Info":"time:1.97s, loops:2","Disk":0,"Memory":50944,"Plans":[{"Node Id":"HashAgg","Plan Rows":800,"Actual Rows":30670,"Task":"root","Total Time":1860935053,"Max Time":1860935053,"Access Object":"","Operation Info":"group by:Column#61, funcs:sum(Column#59)-\u003eColumn#35, funcs:firstrow(Column#60)-\u003enew0107.partsupp.ps_partkey","Execution Info":"time:1.86s, loops:34, partial_worker:{wall_time:1.843494696s, concurrency:5, task_num:36, tot_wait:8.634403063s, tot_exec:278.186996ms, tot_time:8.928854557s, max:1.797176029s, p95:1.797176029s}, final_worker:{wall_time:1.995448588s, concurrency:5, task_num:25, tot_wait:9.247641811s, tot_exec:272.637748ms, tot_time:9.520296643s, max:1.956770198s, p95:1.956770198s}","Disk":0,"Memory":9689557,"Plans":[{"Node Id":"Projection","Plan Rows":800,"Actual Rows":32480,"Task":"root","Total Time":1775750324,"Max Time":1775750324,"Access Object":"","Operation Info":"mul(new0107.partsupp.ps_supplycost, cast(new0107.partsupp.ps_availqty, decimal(20,0) BINARY))-\u003eColumn#59, new0107.partsupp.ps_partkey, new0107.partsupp.ps_partkey","Execution Info":"time:1.78s, loops:37, Concurrency:OFF","Disk":0,"Memory":300656,"Plans":[{"Node Id":"HashJoin","Plan Rows":800,"Actual Rows":32480,"Task":"root","Total Time":1724344473,"Max Time":1724344473,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.supplier.s_suppkey, new0107.partsupp.ps_suppkey)]","Execution Info":"time:1.72s, loops:37, build_hash_table:{total:488.3ms, fetch:488.1ms, build:193.9µs}, probe:{concurrency:5, total:8.78s, max:1.77s, probe:1.72s, fetch:7.06s}","Disk":0,"Memory":4976,"Plans":[{"Node Id":"HashJoin","Plan Rows":10,"Actual Rows":406,"Task":"root","Total Time":488215496,"Max Time":488215496,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.supplier.s_nationkey)]","Execution Info":"time:488.2ms, loops:6, build_hash_table:{total:232ms, fetch:232ms, build:8µs}, probe:{concurrency:5, total:1.78s, max:388ms, probe:1.2ms, fetch:1.78s}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":0.025,"Actual Rows":1,"Task":"root","Total Time":231938613,"Max Time":231938613,"Access Object":"","Operation Info":"data:Selection_88","Execution Info":"time:231.9ms, loops:2, cop_task: {num: 1, max: 307.7ms, proc_keys: 25, rpc_num: 1, rpc_time: 307.7ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":252,"Plans":[{"Node Id":"Selection","Plan Rows":0.025,"Actual Rows":1,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"eq(new0107.nation.n_name, \"MOZAMBIQUE\")","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:nation, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":10000,"Actual Rows":10000,"Task":"root","Total Time":99591,"Max Time":99591,"Access Object":"","Operation Info":"data:TableFullScan_85","Execution Info":"time:99.6µs, loops:11, cop_task: {num: 1, max: 77.4ms, proc_keys: 0, rpc_num: 1, rpc_time: 77.3ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":160504,"Plans":[{"Node Id":"TableFullScan","Plan Rows":10000,"Actual Rows":10000,"Task":"cop[tikv]","Total Time":7000000,"Max Time":7000000,"Access Object":"","Operation Info":"table:supplier, keep order:false","Execution Info":"tikv_task:{time:7ms, loops:14}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":800000,"Actual Rows":800000,"Task":"root","Total Time":1301280053,"Max Time":1301280053,"Access Object":"","Operation Info":"data:TableFullScan_90","Execution Info":"time:1.3s, loops:783, cop_task: {num: 2, max: 1.51s, min: 1.09s, avg: 1.3s, p95: 1.51s, max_proc_keys: 529029, p95_proc_keys: 529029, tot_proc: 2.11s, tot_wait: 16ms, rpc_num: 2, rpc_time: 2.6s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":51231847,"Plans":[{"Node Id":"TableFullScan","Plan Rows":800000,"Actual Rows":800000,"Task":"cop[tikv]","Total Time":936000000,"Max Time":627000000,"Access Object":"","Operation Info":"table:partsupp, keep order:false","Execution Info":"tikv_task:{proc max:627ms, min:309ms, p80:627ms, p95:627ms, iters:790, tasks:2}, scan_detail: {total_process_keys: 800000, total_process_keys_size: 150608990, total_keys: 800002, rocksdb: {delete_skipped_count: 0, key_skipped_count: 800000, block: {cache_hit_count: 2473, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  ps_partkey,  sum(ps_supplycost * ps_availqty) as value from  partsupp,  supplier,  nation where  ps_suppkey = s_suppkey  and s_nationkey = n_nationkey  and n_name = 'MOZAMBIQUE' group by  ps_partkey having   sum(ps_supplycost * ps_availqty) > (    select     sum(ps_supplycost * ps_availqty) * 0.0001000000    from     partsupp,     supplier,     nation    where     ps_suppkey = s_suppkey     and s_nationkey = n_nationkey     and n_name = 'MOZAMBIQUE'   ) order by  value desc;

{"Node Id":"Sort","Plan Rows":2.937928795775128,"Actual Rows":4,"Task":"root","Total Time":478776366,"Max Time":478776366,"Access Object":"","Operation Info":"new0107.lineitem.l_returnflag, new0107.lineitem.l_linestatus","Execution Info":"time:478.8ms, loops:2","Disk":0,"Memory":34872,"Plans":[{"Node Id":"Projection","Plan Rows":2.937928795775128,"Actual Rows":4,"Task":"root","Total Time":478410571,"Max Time":478410571,"Access Object":"","Operation Info":"new0107.lineitem.l_returnflag, new0107.lineitem.l_linestatus, Column#18, Column#19, Column#20, Column#21, Column#22, Column#23, Column#24, Column#25","Execution Info":"time:478.4ms, loops:4, Concurrency:OFF","Disk":0,"Memory":11624,"Plans":[{"Node Id":"HashAgg","Plan Rows":2.937928795775128,"Actual Rows":4,"Task":"root","Total Time":478372320,"Max Time":478372320,"Access Object":"","Operation Info":"group by:new0107.lineitem.l_linestatus, new0107.lineitem.l_returnflag, funcs:sum(Column#26)-\u003eColumn#18, funcs:sum(Column#27)-\u003eColumn#19, funcs:sum(Column#28)-\u003eColumn#20, funcs:sum(Column#29)-\u003eColumn#21, funcs:avg(Column#30, Column#31)-\u003eColumn#22, funcs:avg(Column#32, Column#33)-\u003eColumn#23, funcs:avg(Column#34, Column#35)-\u003eColumn#24, funcs:count(Column#36)-\u003eColumn#25, funcs:firstrow(new0107.lineitem.l_returnflag)-\u003enew0107.lineitem.l_returnflag, funcs:firstrow(new0107.lineitem.l_linestatus)-\u003enew0107.lineitem.l_linestatus","Execution Info":"time:478.4ms, loops:4, partial_worker:{wall_time:309.658439ms, concurrency:5, task_num:1, tot_wait:1.342674047s, tot_exec:1.349456ms, tot_time:1.344049289s, max:268.815831ms, p95:268.815831ms}, final_worker:{wall_time:0s, concurrency:5, task_num:3, tot_wait:1.971934293s, tot_exec:8.74085ms, tot_time:1.980681669s, max:419.34587ms, p95:419.34587ms}","Disk":0,"Memory":136884,"Plans":[{"Node Id":"TableReader","Plan Rows":2.937928795775128,"Actual Rows":36,"Task":"root","Total Time":253792999,"Max Time":253792999,"Access Object":"","Operation Info":"data:HashAgg_9","Execution Info":"time:253.8ms, loops:2, cop_task: {num: 9, max: 217.7ms, min: 18.3ms, avg: 68.9ms, p95: 217.7ms, rpc_num: 9, rpc_time: 619.9ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":3162,"Plans":[{"Node Id":"HashAgg","Plan Rows":2.937928795775128,"Actual Rows":36,"Task":"cop[tikv]","Total Time":10706000000,"Max Time":1409000000,"Access Object":"","Operation Info":"group by:new0107.lineitem.l_linestatus, new0107.lineitem.l_returnflag, funcs:sum(new0107.lineitem.l_quantity)-\u003eColumn#26, funcs:sum(new0107.lineitem.l_extendedprice)-\u003eColumn#27, funcs:sum(mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount)))-\u003eColumn#28, funcs:sum(mul(mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount)), plus(1, new0107.lineitem.l_tax)))-\u003eColumn#29, funcs:count(new0107.lineitem.l_quantity)-\u003eColumn#30, funcs:sum(new0107.lineitem.l_quantity)-\u003eColumn#31, funcs:count(new0107.lineitem.l_extendedprice)-\u003eColumn#32, funcs:sum(new0107.lineitem.l_extendedprice)-\u003eColumn#33, funcs:count(new0107.lineitem.l_discount)-\u003eColumn#34, funcs:sum(new0107.lineitem.l_discount)-\u003eColumn#35, funcs:count(1)-\u003eColumn#36","Execution Info":"tikv_task:{proc max:1.41s, min:649ms, p80:1.33s, p95:1.41s, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"Selection","Plan Rows":3927015.821399177,"Actual Rows":3928532,"Task":"cop[tikv]","Total Time":4744000000,"Max Time":663000000,"Access Object":"","Operation Info":"le(new0107.lineitem.l_shipdate, 1998-08-15 00:00:00.000000)","Execution Info":"tikv_task:{proc max:663ms, min:265ms, p80:603ms, p95:663ms, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4545000000,"Max Time":642000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:642ms, min:256ms, p80:578ms, p95:642ms, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  l_returnflag,  l_linestatus,  sum(l_quantity) as sum_qty,  sum(l_extendedprice) as sum_base_price,  sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,  sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,  avg(l_quantity) as avg_qty,  avg(l_extendedprice) as avg_price,  avg(l_discount) as avg_disc,  count(*) as count_order from  lineitem where  l_shipdate <= date_sub('1998-12-01', interval 108 day) group by  l_returnflag,  l_linestatus order by  l_returnflag,  l_linestatus;

{"Node Id":"Projection","Plan Rows":640,"Actual Rows":838,"Task":"root","Total Time":1475598208,"Max Time":1475598208,"Access Object":"","Operation Info":"new0107.partsupp.ps_partkey, Column#35","Execution Info":"time:1.48s, loops:2, Concurrency:OFF","Disk":0,"Memory":48256,"Plans":[{"Node Id":"Sort","Plan Rows":640,"Actual Rows":838,"Task":"root","Total Time":1475575019,"Max Time":1475575019,"Access Object":"","Operation Info":"Column#35:desc","Execution Info":"time:1.48s, loops:2","Disk":0,"Memory":48256,"Plans":[{"Node Id":"Selection","Plan Rows":640,"Actual Rows":838,"Task":"root","Total Time":1474912933,"Max Time":1474912933,"Access Object":"","Operation Info":"gt(Column#35, 8147162.905283000000)","Execution Info":"time:1.47s, loops:2","Disk":0,"Memory":50944,"Plans":[{"Node Id":"HashAgg","Plan Rows":800,"Actual Rows":30670,"Task":"root","Total Time":1472773831,"Max Time":1472773831,"Access Object":"","Operation Info":"group by:Column#61, funcs:sum(Column#59)-\u003eColumn#35, funcs:firstrow(Column#60)-\u003enew0107.partsupp.ps_partkey","Execution Info":"time:1.47s, loops:34, partial_worker:{wall_time:1.408343543s, concurrency:5, task_num:35, tot_wait:6.686791828s, tot_exec:22.672394ms, tot_time:6.712712912s, max:1.351600747s, p95:1.351600747s}, final_worker:{wall_time:0s, concurrency:5, task_num:25, tot_wait:6.881218659s, tot_exec:278.727068ms, tot_time:7.159964481s, max:1.47379271s, p95:1.47379271s}","Disk":0,"Memory":9689421,"Plans":[{"Node Id":"Projection","Plan Rows":800,"Actual Rows":32480,"Task":"root","Total Time":1308819043,"Max Time":1308819043,"Access Object":"","Operation Info":"mul(new0107.partsupp.ps_supplycost, cast(new0107.partsupp.ps_availqty, decimal(20,0) BINARY))-\u003eColumn#59, new0107.partsupp.ps_partkey, new0107.partsupp.ps_partkey","Execution Info":"time:1.31s, loops:36, Concurrency:OFF","Disk":0,"Memory":299888,"Plans":[{"Node Id":"HashJoin","Plan Rows":800,"Actual Rows":32480,"Task":"root","Total Time":1288662413,"Max Time":1288662413,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.supplier.s_suppkey, new0107.partsupp.ps_suppkey)]","Execution Info":"time:1.29s, loops:36, build_hash_table:{total:422.7ms, fetch:422.5ms, build:220.8µs}, probe:{concurrency:5, total:6.54s, max:1.31s, probe:781.9ms, fetch:5.76s}","Disk":0,"Memory":4976,"Plans":[{"Node Id":"HashJoin","Plan Rows":10,"Actual Rows":406,"Task":"root","Total Time":422588417,"Max Time":422588417,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.supplier.s_nationkey)]","Execution Info":"time:422.6ms, loops:6, build_hash_table:{total:211.4ms, fetch:211.3ms, build:9.09µs}, probe:{concurrency:5, total:1.56s, max:336.8ms, probe:1.26ms, fetch:1.56s}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":0.025,"Actual Rows":1,"Task":"root","Total Time":211281151,"Max Time":211281151,"Access Object":"","Operation Info":"data:Selection_88","Execution Info":"time:211.3ms, loops:2, cop_task: {num: 1, max: 207.9ms, proc_keys: 25, rpc_num: 1, rpc_time: 207.8ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":252,"Plans":[{"Node Id":"Selection","Plan Rows":0.025,"Actual Rows":1,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"eq(new0107.nation.n_name, \"MOZAMBIQUE\")","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:nation, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":10000,"Actual Rows":10000,"Task":"root","Total Time":134360608,"Max Time":134360608,"Access Object":"","Operation Info":"data:TableFullScan_85","Execution Info":"time:134.4ms, loops:11, cop_task: {num: 1, max: 128.5ms, proc_keys: 0, rpc_num: 1, rpc_time: 128.5ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":160504,"Plans":[{"Node Id":"TableFullScan","Plan Rows":10000,"Actual Rows":10000,"Task":"cop[tikv]","Total Time":7000000,"Max Time":7000000,"Access Object":"","Operation Info":"table:supplier, keep order:false","Execution Info":"tikv_task:{time:7ms, loops:14}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":800000,"Actual Rows":800000,"Task":"root","Total Time":1069662757,"Max Time":1069662757,"Access Object":"","Operation Info":"data:TableFullScan_90","Execution Info":"time:1.07s, loops:783, cop_task: {num: 2, max: 1.2s, min: 624.7ms, avg: 913.1ms, p95: 1.2s, max_proc_keys: 529029, p95_proc_keys: 529029, tot_proc: 1.23s, tot_wait: 126ms, rpc_num: 2, rpc_time: 1.83s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":51231846,"Plans":[{"Node Id":"TableFullScan","Plan Rows":800000,"Actual Rows":800000,"Task":"cop[tikv]","Total Time":747000000,"Max Time":488000000,"Access Object":"","Operation Info":"table:partsupp, keep order:false","Execution Info":"tikv_task:{proc max:488ms, min:259ms, p80:488ms, p95:488ms, iters:790, tasks:2}, scan_detail: {total_process_keys: 800000, total_process_keys_size: 150608990, total_keys: 800002, rocksdb: {delete_skipped_count: 0, key_skipped_count: 800000, block: {cache_hit_count: 2473, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  ps_partkey,  sum(ps_supplycost * ps_availqty) as value from  partsupp,  supplier,  nation where  ps_suppkey = s_suppkey  and s_nationkey = n_nationkey  and n_name = 'MOZAMBIQUE' group by  ps_partkey having   sum(ps_supplycost * ps_availqty) > (    select     sum(ps_supplycost * ps_availqty) * 0.0001000000    from     partsupp,     supplier,     nation    where     ps_suppkey = s_suppkey     and s_nationkey = n_nationkey     and n_name = 'MOZAMBIQUE'   ) order by  value desc;

{"Node Id":"Projection","Plan Rows":6.4,"Actual Rows":100,"Task":"root","Total Time":5429371237,"Max Time":5429371237,"Access Object":"","Operation Info":"new0107.supplier.s_name, Column#72","Execution Info":"time:5.43s, loops:2, Concurrency:OFF","Disk":0,"Memory":4728,"Plans":[{"Node Id":"TopN","Plan Rows":6.4,"Actual Rows":100,"Task":"root","Total Time":5429363192,"Max Time":5429363192,"Access Object":"","Operation Info":"Column#72:desc, new0107.supplier.s_name, offset:0, count:100","Execution Info":"time:5.43s, loops:2","Disk":0,"Memory":12344,"Plans":[{"Node Id":"HashAgg","Plan Rows":6.4,"Actual Rows":414,"Task":"root","Total Time":5428863341,"Max Time":5428863341,"Access Object":"","Operation Info":"group by:new0107.supplier.s_name, funcs:count(1)-\u003eColumn#72, funcs:firstrow(new0107.supplier.s_name)-\u003enew0107.supplier.s_name","Execution Info":"time:5.43s, loops:6, partial_worker:{wall_time:5.427413473s, concurrency:5, task_num:3, tot_wait:27.101814014s, tot_exec:1.632191ms, tot_time:27.103585662s, max:5.420879041s, p95:5.420879041s}, final_worker:{wall_time:0s, concurrency:5, task_num:15, tot_wait:27.113141609s, tot_exec:878.78µs, tot_time:27.114027769s, max:5.423188205s, p95:5.423188205s}","Disk":0,"Memory":349362,"Plans":[{"Node Id":"IndexJoin","Plan Rows":2611.2567138461536,"Actual Rows":2750,"Task":"root","Total Time":5366131715,"Max Time":5366131715,"Access Object":"","Operation Info":"anti semi join, inner:IndexLookUp_39, outer key:new0107.lineitem.l_orderkey, inner key:new0107.lineitem.l_orderkey, equal cond:eq(new0107.lineitem.l_orderkey, new0107.lineitem.l_orderkey), other cond:ne(new0107.lineitem.l_suppkey, new0107.lineitem.l_suppkey)","Execution Info":"time:5.37s, loops:4, inner:{total:6.81s, concurrency:5, task:10, construct:129.2ms, fetch:6.57s, build:103.7ms}, probe:164.2ms","Disk":0,"Memory":14971431,"Plans":[{"Node Id":"IndexJoin","Plan Rows":3264.070892307692,"Actual Rows":49059,"Task":"root","Total Time":4192463710,"Max Time":4192463710,"Access Object":"","Operation Info":"semi join, inner:IndexLookUp_80, outer key:new0107.lineitem.l_orderkey, inner key:new0107.lineitem.l_orderkey, equal cond:eq(new0107.lineitem.l_orderkey, new0107.lineitem.l_orderkey), other cond:ne(new0107.lineitem.l_suppkey, new0107.lineitem.l_suppkey), ne(new0107.lineitem.l_suppkey, new0107.supplier.s_suppkey)","Execution Info":"time:4.19s, loops:53, inner:{total:10.2s, concurrency:5, task:10, construct:260ms, fetch:9.84s, build:54.7ms}, probe:446ms","Disk":0,"Memory":15145391,"Plans":[{"Node Id":"IndexJoin","Plan Rows":4080.0886153846145,"Actual Rows":50936,"Task":"root","Total Time":1868434426,"Max Time":1868434426,"Access Object":"","Operation Info":"inner join, inner:TableReader_95, outer key:new0107.lineitem.l_orderkey, inner key:new0107.orders.o_orderkey, equal cond:eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)","Execution Info":"time:1.87s, loops:55, inner:{total:3.84s, concurrency:5, task:12, construct:351.5ms, fetch:3.47s, build:18.8ms}, probe:186.8ms","Disk":0,"Memory":16231981,"Plans":[{"Node Id":"HashJoin","Plan Rows":4009.984,"Actual Rows":105617,"Task":"root","Total Time":1394291270,"Max Time":1394291270,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.supplier.s_suppkey, new0107.lineitem.l_suppkey)]","Execution Info":"time:1.39s, loops:108, build_hash_table:{total:325.1ms, fetch:325ms, build:182.1µs}, probe:{concurrency:5, total:9.49s, max:1.9s, probe:4.8s, fetch:4.68s}","Disk":0,"Memory":19640,"Plans":[{"Node Id":"HashJoin","Plan Rows":10,"Actual Rows":415,"Task":"root","Total Time":322535383,"Max Time":322535383,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.supplier.s_nationkey)]","Execution Info":"time:322.5ms, loops:6, build_hash_table:{total:264.9ms, fetch:264.9ms, build:9.16µs}, probe:{concurrency:5, total:1.55s, max:320.9ms, probe:1.45ms, fetch:1.55s}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":0.025,"Actual Rows":1,"Task":"root","Total Time":264850002,"Max Time":264850002,"Access Object":"","Operation Info":"data:Selection_124","Execution Info":"time:264.9ms, loops:2, cop_task: {num: 1, max: 166.7ms, proc_keys: 25, rpc_num: 1, rpc_time: 166.7ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":243,"Plans":[{"Node Id":"Selection","Plan Rows":0.025,"Actual Rows":1,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"eq(new0107.nation.n_name, \"EGYPT\")","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:nation, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":10000,"Actual Rows":10000,"Task":"root","Total Time":180680048,"Max Time":180680048,"Access Object":"","Operation Info":"data:TableFullScan_121","Execution Info":"time:180.7ms, loops:11, cop_task: {num: 1, max: 85.3ms, proc_keys: 0, rpc_num: 1, rpc_time: 85.3ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":420732,"Plans":[{"Node Id":"TableFullScan","Plan Rows":10000,"Actual Rows":10000,"Task":"cop[tikv]","Total Time":8000000,"Max Time":8000000,"Access Object":"","Operation Info":"table:supplier, keep order:false","Execution Info":"tikv_task:{time:8ms, loops:14}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":3207987.2,"Actual Rows":2534187,"Task":"root","Total Time":497417467,"Max Time":497417467,"Access Object":"","Operation Info":"data:Selection_127","Execution Info":"time:497.4ms, loops:2468, cop_task: {num: 9, max: 192.6ms, min: 23.2ms, avg: 119.5ms, p95: 192.6ms, rpc_num: 9, rpc_time: 1.08s, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":81253918,"Plans":[{"Node Id":"Selection","Plan Rows":3207987.2,"Actual Rows":2534187,"Task":"cop[tikv]","Total Time":5546000000,"Max Time":794000000,"Access Object":"","Operation Info":"gt(new0107.lineitem.l_receiptdate, new0107.lineitem.l_commitdate)","Execution Info":"tikv_task:{proc max:794ms, min:404ms, p80:692ms, p95:794ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4975000000,"Max Time":755000000,"Access Object":"","Operation Info":"table:l1, keep order:false","Execution Info":"tikv_task:{proc max:755ms, min:308ms, p80:628ms, p95:755ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"TableReader","Plan Rows":0.45678627040378006,"Actual Rows":48357,"Task":"root","Total Time":3194931407,"Max Time":565186316,"Access Object":"","Operation Info":"data:Selection_94","Execution Info":"time:3.19s, loops:65, cop_task: {num: 16, max: 477.2ms, min: 70.7ms, avg: 205.7ms, p95: 477.2ms, max_proc_keys: 17414, p95_proc_keys: 17414, tot_proc: 1.54s, tot_wait: 148ms, rpc_num: 31, rpc_time: 6.5s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":0,"Plans":[{"Node Id":"Selection","Plan Rows":0.45678627040378006,"Actual Rows":48357,"Task":"cop[tikv]","Total Time":1410000000,"Max Time":359000000,"Access Object":"","Operation Info":"eq(new0107.orders.o_orderstatus, \"F\")","Execution Info":"tikv_task:{proc max:359ms, min:7ms, p80:124ms, p95:359ms, iters:167, tasks:16}, scan_detail: {total_process_keys: 100126, total_process_keys_size: 15170382, total_keys: 108157, rocksdb: {delete_skipped_count: 0, key_skipped_count: 16668, block: {cache_hit_count: 131415, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":100126,"Task":"cop[tikv]","Total Time":1401000000,"Max Time":355000000,"Access Object":"","Operation Info":"table:orders, range: decided by [new0107.lineitem.l_orderkey], keep order:false","Execution Info":"tikv_task:{proc max:355ms, min:7ms, p80:123ms, p95:355ms, iters:167, tasks:16}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"IndexLookUp","Plan Rows":4.054354859583279,"Actual Rows":239373,"Task":"root","Total Time":9506963660,"Max Time":1345652788,"Access Object":"","Operation Info":"","Execution Info":"time:9.51s, loops:249, index_task: {total_time: 3.51s, fetch_handle: 3.16s, build: 91.2µs, wait: 343.8ms}, table_task: {total_time: 14.1s, num: 40, concurrency: 50}","Disk":0,"Memory":228632,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":4.054354859583279,"Actual Rows":239373,"Task":"cop[tikv]","Total Time":1967000000,"Max Time":394000000,"Access Object":"","Operation Info":"table:l2, index:PRIMARY(L_ORDERKEY, L_LINENUMBER), range: decided by [eq(new0107.lineitem.l_orderkey, new0107.lineitem.l_orderkey)], keep order:false","Execution Info":"time:3.09s, loops:265, cop_task: {num: 19, max: 604.3ms, min: 39.7ms, avg: 253.7ms, p95: 604.3ms, max_proc_keys: 58721, p95_proc_keys: 58721, tot_proc: 2.78s, tot_wait: 318ms, rpc_num: 37, rpc_time: 9.57s, copr_cache_hit_ratio: 0.11}, tikv_task:{proc max:394ms, min:1ms, p80:236ms, p95:394ms, iters:318, tasks:19}, scan_detail: {total_process_keys: 235767, total_process_keys_size: 12495651, total_keys: 283391, rocksdb: {delete_skipped_count: 0, key_skipped_count: 235767, block: {cache_hit_count: 190667, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]},{"Node Id":"TableRowIDScan","Plan Rows":4.054354859583279,"Actual Rows":239373,"Task":"cop[tikv]","Total Time":2082000000,"Max Time":144000000,"Access Object":"","Operation Info":"table:l2, keep order:false","Execution Info":"time:13.8s, loops:300, cop_task: {num: 54, max: 798.7ms, min: 19.7ms, avg: 260.4ms, p95: 566.5ms, max_proc_keys: 20480, p95_proc_keys: 15545, tot_proc: 6.9s, tot_wait: 1.4s, rpc_num: 107, rpc_time: 28s, copr_cache_hit_ratio: 0.06}, tikv_task:{proc max:144ms, min:1ms, p80:79ms, p95:128ms, iters:482, tasks:54}, scan_detail: {total_process_keys: 234317, total_process_keys_size: 46019217, total_keys: 277649, rocksdb: {delete_skipped_count: 0, key_skipped_count: 232649, block: {cache_hit_count: 161994, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"IndexLookUp","Plan Rows":4.05435485958328,"Actual Rows":165987,"Task":"root","Total Time":6352820088,"Max Time":1100147824,"Access Object":"","Operation Info":"","Execution Info":"time:6.35s, loops:178, index_task: {total_time: 2.98s, fetch_handle: 2.79s, build: 58.3µs, wait: 182.9ms}, table_task: {total_time: 8.85s, num: 40, concurrency: 50}","Disk":0,"Memory":287728,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":5.0679435744790995,"Actual Rows":237493,"Task":"cop[tikv]","Total Time":1503000000,"Max Time":297000000,"Access Object":"","Operation Info":"table:l3, index:PRIMARY(L_ORDERKEY, L_LINENUMBER), range: decided by [eq(new0107.lineitem.l_orderkey, new0107.lineitem.l_orderkey)], keep order:false","Execution Info":"time:2.78s, loops:262, cop_task: {num: 19, max: 403.5ms, min: 28.8ms, avg: 204ms, p95: 403.5ms, max_proc_keys: 58248, p95_proc_keys: 58248, tot_proc: 1.82s, tot_wait: 285ms, rpc_num: 37, rpc_time: 7.72s, copr_cache_hit_ratio: 0.11}, tikv_task:{proc max:297ms, min:0s, p80:140ms, p95:297ms, iters:316, tasks:19}, scan_detail: {total_process_keys: 233138, total_process_keys_size: 12356314, total_keys: 278763, rocksdb: {delete_skipped_count: 0, key_skipped_count: 233138, block: {cache_hit_count: 182668, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]},{"Node Id":"Selection","Plan Rows":4.05435485958328,"Actual Rows":165987,"Task":"cop[tikv]","Total Time":1775000000,"Max Time":120000000,"Access Object":"","Operation Info":"gt(new0107.lineitem.l_receiptdate, new0107.lineitem.l_commitdate)","Execution Info":"time:8.76s, loops:221, cop_task: {num: 54, max: 430.4ms, min: 20.8ms, avg: 143.4ms, p95: 360.2ms, max_proc_keys: 20480, p95_proc_keys: 14007, tot_proc: 3.63s, tot_wait: 1.05s, rpc_num: 107, rpc_time: 15.4s, copr_cache_hit_ratio: 0.07}, tikv_task:{proc max:120ms, min:0s, p80:70ms, p95:95ms, iters:479, tasks:54}, scan_detail: {total_process_keys: 231713, total_process_keys_size: 45507576, total_keys: 274903, rocksdb: {delete_skipped_count: 0, key_skipped_count: 231700, block: {cache_hit_count: 158368, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRowIDScan","Plan Rows":5.0679435744790995,"Actual Rows":237493,"Task":"cop[tikv]","Total Time":1743000000,"Max Time":118000000,"Access Object":"","Operation Info":"table:l3, keep order:false","Execution Info":"tikv_task:{proc max:118ms, min:0s, p80:70ms, p95:95ms, iters:479, tasks:54}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  s_name,  count(*) as numwait from  supplier,  lineitem l1,  orders,  nation where  s_suppkey = l1.l_suppkey  and o_orderkey = l1.l_orderkey  and o_orderstatus = 'F'  and l1.l_receiptdate > l1.l_commitdate  and exists (   select    *   from    lineitem l2   where    l2.l_orderkey = l1.l_orderkey    and l2.l_suppkey <> l1.l_suppkey  )  and not exists (   select    *   from    lineitem l3   where    l3.l_orderkey = l1.l_orderkey    and l3.l_suppkey <> l1.l_suppkey    and l3.l_receiptdate > l3.l_commitdate  )  and s_nationkey = n_nationkey  and n_name = 'EGYPT' group by  s_name order by  numwait desc,  s_name limit 100;

{"Node Id":"Sort","Plan Rows":1,"Actual Rows":2,"Task":"root","Total Time":745519758,"Max Time":745519758,"Access Object":"","Operation Info":"new0107.lineitem.l_shipmode","Execution Info":"time:745.5ms, loops:2","Disk":0,"Memory":6968,"Plans":[{"Node Id":"Projection","Plan Rows":1,"Actual Rows":2,"Task":"root","Total Time":745476454,"Max Time":745476454,"Access Object":"","Operation Info":"new0107.lineitem.l_shipmode, Column#27, Column#28","Execution Info":"time:745.5ms, loops:3, Concurrency:OFF","Disk":0,"Memory":3484,"Plans":[{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":2,"Task":"root","Total Time":745471486,"Max Time":745471486,"Access Object":"","Operation Info":"group by:Column#40, funcs:sum(Column#37)-\u003eColumn#27, funcs:sum(Column#38)-\u003eColumn#28, funcs:firstrow(Column#39)-\u003enew0107.lineitem.l_shipmode","Execution Info":"time:745.5ms, loops:3, partial_worker:{wall_time:745.428345ms, concurrency:5, task_num:24, tot_wait:3.68136131s, tot_exec:7.877446ms, tot_time:3.689269016s, max:737.992494ms, p95:737.992494ms}, final_worker:{wall_time:745.580315ms, concurrency:5, task_num:10, tot_wait:3.687359806s, tot_exec:133.27µs, tot_time:3.687498257s, max:737.511568ms, p95:737.511568ms}","Disk":0,"Memory":1197589,"Plans":[{"Node Id":"Projection","Plan Rows":137139.56931393046,"Actual Rows":20757,"Task":"root","Total Time":737854078,"Max Time":737854078,"Access Object":"","Operation Info":"cast(case(or(eq(new0107.orders.o_orderpriority, 1-URGENT), eq(new0107.orders.o_orderpriority, 2-HIGH)), 1, 0), decimal(20,0) BINARY)-\u003eColumn#37, cast(case(and(ne(new0107.orders.o_orderpriority, 1-URGENT), ne(new0107.orders.o_orderpriority, 2-HIGH)), 1, 0), decimal(20,0) BINARY)-\u003eColumn#38, new0107.lineitem.l_shipmode, new0107.lineitem.l_shipmode","Execution Info":"time:737.9ms, loops:25, Concurrency:5","Disk":0,"Memory":305000,"Plans":[{"Node Id":"Projection","Plan Rows":137139.56931393046,"Actual Rows":20757,"Task":"root","Total Time":736710907,"Max Time":736710907,"Access Object":"","Operation Info":"new0107.orders.o_orderpriority, new0107.lineitem.l_shipmode","Execution Info":"time:736.7ms, loops:25, Concurrency:5","Disk":0,"Memory":111924,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":137139.56931393046,"Actual Rows":20757,"Task":"root","Total Time":736512379,"Max Time":736512379,"Access Object":"","Operation Info":"inner join, inner:TableReader_17, outer key:new0107.lineitem.l_orderkey, inner key:new0107.orders.o_orderkey, equal cond:eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)","Execution Info":"time:736.5ms, loops:25, inner:{total:2.22s, concurrency:5, task:9, construct:27.4ms, fetch:1.66s, build:3.78ms, join:531.2ms}","Disk":0,"Memory":3861456,"Plans":[{"Node Id":"TableReader","Plan Rows":134783.21932571862,"Actual Rows":20773,"Task":"root","Total Time":85176076,"Max Time":85176076,"Access Object":"","Operation Info":"data:Selection_49","Execution Info":"time:85.2ms, loops:26, cop_task: {num: 9, max: 51.6ms, min: 31.2ms, avg: 43.8ms, p95: 51.6ms, rpc_num: 9, rpc_time: 394.2ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":270836,"Plans":[{"Node Id":"Selection","Plan Rows":134783.21932571862,"Actual Rows":20773,"Task":"cop[tikv]","Total Time":4954000000,"Max Time":647000000,"Access Object":"","Operation Info":"ge(new0107.lineitem.l_receiptdate, 1997-01-01 00:00:00.000000), in(new0107.lineitem.l_shipmode, \"RAIL\", \"FOB\"), lt(new0107.lineitem.l_commitdate, new0107.lineitem.l_receiptdate), lt(new0107.lineitem.l_receiptdate, 1998-01-01 00:00:00.000000), lt(new0107.lineitem.l_shipdate, new0107.lineitem.l_commitdate)","Execution Info":"tikv_task:{proc max:647ms, min:292ms, p80:636ms, p95:647ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4041000000,"Max Time":548000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:548ms, min:233ms, p80:537ms, p95:548ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":1,"Actual Rows":19515,"Task":"root","Total Time":1521306719,"Max Time":371121754,"Access Object":"","Operation Info":"data:TableRangeScan_16","Execution Info":"time:1.52s, loops:33, cop_task: {num: 13, max: 254.1ms, min: 27.5ms, avg: 113ms, p95: 254.1ms, max_proc_keys: 3888, p95_proc_keys: 3888, tot_proc: 351ms, tot_wait: 43ms, rpc_num: 25, rpc_time: 2.91s, copr_cache_hit_ratio: 0.23}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":19515,"Task":"cop[tikv]","Total Time":332000000,"Max Time":84000000,"Access Object":"","Operation Info":"table:orders, range: decided by [new0107.lineitem.l_orderkey], keep order:false","Execution Info":"tikv_task:{proc max:84ms, min:3ms, p80:47ms, p95:84ms, iters:71, tasks:13}, scan_detail: {total_process_keys: 18599, total_process_keys_size: 2818971, total_keys: 18928, rocksdb: {delete_skipped_count: 0, key_skipped_count: 637, block: {cache_hit_count: 24623, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  l_shipmode,  sum(case   when o_orderpriority = '1-URGENT'    or o_orderpriority = '2-HIGH'    then 1   else 0  end) as high_line_count,  sum(case   when o_orderpriority <> '1-URGENT'    and o_orderpriority <> '2-HIGH'    then 1   else 0  end) as low_line_count from  orders,  lineitem where  o_orderkey = l_orderkey  and l_shipmode in ('RAIL', 'FOB')  and l_commitdate < l_receiptdate  and l_shipdate < l_commitdate  and l_receiptdate >= '1997-01-01'  and l_receiptdate < date_add('1997-01-01', interval '1' year) group by  l_shipmode order by  l_shipmode;

{"Node Id":"Sort","Plan Rows":1,"Actual Rows":2,"Task":"root","Total Time":1280180057,"Max Time":1280180057,"Access Object":"","Operation Info":"new0107.lineitem.l_shipmode","Execution Info":"time:1.28s, loops:2","Disk":0,"Memory":6968,"Plans":[{"Node Id":"Projection","Plan Rows":1,"Actual Rows":2,"Task":"root","Total Time":1280142544,"Max Time":1280142544,"Access Object":"","Operation Info":"new0107.lineitem.l_shipmode, Column#27, Column#28","Execution Info":"time:1.28s, loops:3, Concurrency:OFF","Disk":0,"Memory":3484,"Plans":[{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":2,"Task":"root","Total Time":1280136584,"Max Time":1280136584,"Access Object":"","Operation Info":"group by:Column#40, funcs:sum(Column#37)-\u003eColumn#27, funcs:sum(Column#38)-\u003eColumn#28, funcs:firstrow(Column#39)-\u003enew0107.lineitem.l_shipmode","Execution Info":"time:1.28s, loops:3, partial_worker:{wall_time:1.280082556s, concurrency:5, task_num:24, tot_wait:6.388295023s, tot_exec:7.767599ms, tot_time:6.396162783s, max:1.279313361s, p95:1.279313361s}, final_worker:{wall_time:1.280273488s, concurrency:5, task_num:10, tot_wait:6.396821235s, tot_exec:162.338µs, tot_time:6.396988334s, max:1.279412319s, p95:1.279412319s}","Disk":0,"Memory":1176410,"Plans":[{"Node Id":"Projection","Plan Rows":137139.56931393046,"Actual Rows":20757,"Task":"root","Total Time":1278716676,"Max Time":1278716676,"Access Object":"","Operation Info":"cast(case(or(eq(new0107.orders.o_orderpriority, 1-URGENT), eq(new0107.orders.o_orderpriority, 2-HIGH)), 1, 0), decimal(20,0) BINARY)-\u003eColumn#37, cast(case(and(ne(new0107.orders.o_orderpriority, 1-URGENT), ne(new0107.orders.o_orderpriority, 2-HIGH)), 1, 0), decimal(20,0) BINARY)-\u003eColumn#38, new0107.lineitem.l_shipmode, new0107.lineitem.l_shipmode","Execution Info":"time:1.28s, loops:25, Concurrency:5","Disk":0,"Memory":535424,"Plans":[{"Node Id":"Projection","Plan Rows":137139.56931393046,"Actual Rows":20757,"Task":"root","Total Time":1256118533,"Max Time":1256118533,"Access Object":"","Operation Info":"new0107.orders.o_orderpriority, new0107.lineitem.l_shipmode","Execution Info":"time:1.26s, loops:25, Concurrency:5","Disk":0,"Memory":112508,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":137139.56931393046,"Actual Rows":20757,"Task":"root","Total Time":1277789735,"Max Time":1277789735,"Access Object":"","Operation Info":"inner join, inner:TableReader_17, outer key:new0107.lineitem.l_orderkey, inner key:new0107.orders.o_orderkey, equal cond:eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)","Execution Info":"time:1.28s, loops:25, inner:{total:3.55s, concurrency:5, task:9, construct:92.4ms, fetch:2.6s, build:4.55ms, join:864.2ms}","Disk":0,"Memory":3840071,"Plans":[{"Node Id":"TableReader","Plan Rows":134783.21932571862,"Actual Rows":20773,"Task":"root","Total Time":149920759,"Max Time":149920759,"Access Object":"","Operation Info":"data:Selection_49","Execution Info":"time:149.9ms, loops:26, cop_task: {num: 9, max: 49.9ms, min: 39.6ms, avg: 46.1ms, p95: 49.9ms, rpc_num: 9, rpc_time: 414.7ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":261061,"Plans":[{"Node Id":"Selection","Plan Rows":134783.21932571862,"Actual Rows":20773,"Task":"cop[tikv]","Total Time":4954000000,"Max Time":647000000,"Access Object":"","Operation Info":"ge(new0107.lineitem.l_receiptdate, 1997-01-01 00:00:00.000000), in(new0107.lineitem.l_shipmode, \"RAIL\", \"FOB\"), lt(new0107.lineitem.l_commitdate, new0107.lineitem.l_receiptdate), lt(new0107.lineitem.l_receiptdate, 1998-01-01 00:00:00.000000), lt(new0107.lineitem.l_shipdate, new0107.lineitem.l_commitdate)","Execution Info":"tikv_task:{proc max:647ms, min:292ms, p80:636ms, p95:647ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4041000000,"Max Time":548000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:548ms, min:233ms, p80:537ms, p95:548ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":1,"Actual Rows":19516,"Task":"root","Total Time":2298758686,"Max Time":373681921,"Access Object":"","Operation Info":"data:TableRangeScan_16","Execution Info":"time:2.3s, loops:34, cop_task: {num: 11, max: 361.7ms, min: 63.7ms, avg: 135.6ms, p95: 361.7ms, max_proc_keys: 6152, p95_proc_keys: 6152, tot_proc: 230ms, tot_wait: 123ms, rpc_num: 21, rpc_time: 2.84s, copr_cache_hit_ratio: 0.09}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":19516,"Task":"cop[tikv]","Total Time":222000000,"Max Time":69000000,"Access Object":"","Operation Info":"table:orders, range: decided by [new0107.lineitem.l_orderkey], keep order:false","Execution Info":"tikv_task:{proc max:69ms, min:1ms, p80:34ms, p95:69ms, iters:64, tasks:11}, scan_detail: {total_process_keys: 19036, total_process_keys_size: 2885929, total_keys: 19367, rocksdb: {delete_skipped_count: 0, key_skipped_count: 641, block: {cache_hit_count: 24672, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  l_shipmode,  sum(case   when o_orderpriority = '1-URGENT'    or o_orderpriority = '2-HIGH'    then 1   else 0  end) as high_line_count,  sum(case   when o_orderpriority <> '1-URGENT'    and o_orderpriority <> '2-HIGH'    then 1   else 0  end) as low_line_count from  orders,  lineitem where  o_orderkey = l_orderkey  and l_shipmode in ('RAIL', 'FOB')  and l_commitdate < l_receiptdate  and l_shipdate < l_commitdate  and l_receiptdate >= '1997-01-01'  and l_receiptdate < date_add('1997-01-01', interval '1' year) group by  l_shipmode order by  l_shipmode;

{"Node Id":"Projection","Plan Rows":100,"Actual Rows":6,"Task":"root","Total Time":11776122682,"Max Time":11776122682,"Access Object":"","Operation Info":"new0107.customer.c_name, new0107.customer.c_custkey, new0107.orders.o_orderkey, new0107.orders.o_orderdate, new0107.orders.o_totalprice, Column#54","Execution Info":"time:11.8s, loops:2, Concurrency:OFF","Disk":0,"Memory":4600,"Plans":[{"Node Id":"TopN","Plan Rows":100,"Actual Rows":6,"Task":"root","Total Time":11776081484,"Max Time":11776081484,"Access Object":"","Operation Info":"new0107.orders.o_totalprice:desc, new0107.orders.o_orderdate, offset:0, count:100","Execution Info":"time:11.8s, loops:2","Disk":0,"Memory":9248,"Plans":[{"Node Id":"HashAgg","Plan Rows":807403.0718960115,"Actual Rows":6,"Task":"root","Total Time":11776012619,"Max Time":11776012619,"Access Object":"","Operation Info":"group by:new0107.customer.c_custkey, new0107.customer.c_name, new0107.orders.o_orderdate, new0107.orders.o_orderkey, new0107.orders.o_totalprice, funcs:sum(new0107.lineitem.l_quantity)-\u003eColumn#54, funcs:firstrow(new0107.customer.c_custkey)-\u003enew0107.customer.c_custkey, funcs:firstrow(new0107.customer.c_name)-\u003enew0107.customer.c_name, funcs:firstrow(new0107.orders.o_orderkey)-\u003enew0107.orders.o_orderkey, funcs:firstrow(new0107.orders.o_totalprice)-\u003enew0107.orders.o_totalprice, funcs:firstrow(new0107.orders.o_orderdate)-\u003enew0107.orders.o_orderdate","Execution Info":"time:11.8s, loops:4, partial_worker:{wall_time:11.73877572s, concurrency:5, task_num:3, tot_wait:58.617860474s, tot_exec:149.844µs, tot_time:58.618025254s, max:11.723659581s, p95:11.723659581s}, final_worker:{wall_time:0s, concurrency:5, task_num:3, tot_wait:58.620880068s, tot_exec:105.122µs, tot_time:58.620989464s, max:11.724252537s, p95:11.724252537s}","Disk":0,"Memory":50456,"Plans":[{"Node Id":"HashJoin","Plan Rows":3273498.568184062,"Actual Rows":42,"Task":"root","Total Time":11700025679,"Max Time":11700025679,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.orders.o_orderkey, new0107.lineitem.l_orderkey)]","Execution Info":"time:11.7s, loops:4, build_hash_table:{total:11.1s, fetch:11.1s, build:20µs}, probe:{concurrency:5, total:58.3s, max:11.7s, probe:1.48s, fetch:56.8s}","Disk":0,"Memory":9516,"Plans":[{"Node Id":"HashJoin","Plan Rows":807403.0718960115,"Actual Rows":6,"Task":"root","Total Time":11104865083,"Max Time":11104865083,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.orders.o_orderkey, new0107.lineitem.l_orderkey)]","Execution Info":"time:11.1s, loops:4, build_hash_table:{total:8.2s, fetch:8.2s, build:18.1µs}, probe:{concurrency:5, total:55.4s, max:11.1s, probe:348.4ms, fetch:55.1s}","Disk":0,"Memory":49664,"Plans":[{"Node Id":"HashJoin","Plan Rows":1097817.7150192554,"Actual Rows":1001472,"Task":"root","Total Time":6405726944,"Max Time":6405726944,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.customer.c_custkey, new0107.orders.o_custkey)]","Execution Info":"time:6.41s, loops:981, build_hash_table:{total:3.29s, fetch:2.57s, build:723.1ms}, probe:{concurrency:5, total:55.3s, max:11.1s, probe:35.5s, fetch:19.8s}","Disk":0,"Memory":5182368,"Plans":[{"Node Id":"TableReader","Plan Rows":150000,"Actual Rows":150000,"Task":"root","Total Time":2562989634,"Max Time":2562989634,"Access Object":"","Operation Info":"data:TableFullScan_88","Execution Info":"time:2.56s, loops:148, cop_task: {num: 1, max: 456.6ms, proc_keys: 0, rpc_num: 1, rpc_time: 456.5ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":5105005,"Plans":[{"Node Id":"TableFullScan","Plan Rows":150000,"Actual Rows":150000,"Task":"cop[tikv]","Total Time":169000000,"Max Time":169000000,"Access Object":"","Operation Info":"table:customer, keep order:false","Execution Info":"tikv_task:{time:169ms, loops:151}","Disk":0,"Memory":0,"Plans":[]}]},{"Node Id":"TableReader","Plan Rows":1094656,"Actual Rows":1001472,"Task":"root","Total Time":3504157134,"Max Time":3504157134,"Access Object":"","Operation Info":"data:TableFullScan_86","Execution Info":"time:3.5s, loops:980, cop_task: {num: 2, max: 4.11s, min: 3.53s, avg: 3.82s, p95: 4.11s, max_proc_keys: 583494, p95_proc_keys: 583494, tot_proc: 4.73s, tot_wait: 1ms, rpc_num: 2, rpc_time: 7.64s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":64133920,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":1842000000,"Max Time":1294000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:1.29s, min:548ms, p80:1.29s, p95:1.29s, iters:987, tasks:2}, scan_detail: {total_process_keys: 1001472, total_process_keys_size: 151717700, total_keys: 1001474, rocksdb: {delete_skipped_count: 0, key_skipped_count: 1001472, block: {cache_hit_count: 2529, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"Selection","Plan Rows":791244.8,"Actual Rows":6,"Task":"root","Total Time":8111673327,"Max Time":8111673327,"Access Object":"","Operation Info":"gt(Column#52, 314)","Execution Info":"time:8.11s, loops:2","Disk":0,"Memory":50944,"Plans":[{"Node Id":"HashAgg","Plan Rows":989056,"Actual Rows":1002367,"Task":"root","Total Time":7801752278,"Max Time":7801752278,"Access Object":"","Operation Info":"group by:new0107.lineitem.l_orderkey, funcs:sum(Column#66)-\u003eColumn#52, funcs:firstrow(new0107.lineitem.l_orderkey)-\u003enew0107.lineitem.l_orderkey","Execution Info":"time:7.8s, loops:983, partial_worker:{wall_time:5.449916563s, concurrency:5, task_num:9, tot_wait:1.046118963s, tot_exec:22.764336279s, tot_time:24.950786757s, max:5.447984991s, p95:5.447984991s}, final_worker:{wall_time:8.111975695s, concurrency:5, task_num:25, tot_wait:22.438290131s, tot_exec:17.384737894s, tot_time:39.823058461s, max:8.075291215s, p95:8.075291215s}","Disk":0,"Memory":350266771,"Plans":[{"Node Id":"TableReader","Plan Rows":989056,"Actual Rows":1002374,"Task":"root","Total Time":2520428833,"Max Time":2520428833,"Access Object":"","Operation Info":"data:HashAgg_91","Execution Info":"time:2.52s, loops:10, cop_task: {num: 9, max: 553.9ms, min: 136.2ms, avg: 271.7ms, p95: 553.9ms, rpc_num: 9, rpc_time: 2.45s, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":22806286,"Plans":[{"Node Id":"HashAgg","Plan Rows":989056,"Actual Rows":1002374,"Task":"cop[tikv]","Total Time":5051000000,"Max Time":713000000,"Access Object":"","Operation Info":"group by:new0107.lineitem.l_orderkey, funcs:sum(new0107.lineitem.l_quantity)-\u003eColumn#66","Execution Info":"tikv_task:{proc max:713ms, min:301ms, p80:675ms, p95:713ms, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":3708000000,"Max Time":535000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:535ms, min:241ms, p80:502ms, p95:535ms, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]},{"Node Id":"TableReader","Plan Rows":4009984,"Actual Rows":4009984,"Task":"root","Total Time":3119707948,"Max Time":3119707948,"Access Object":"","Operation Info":"data:TableFullScan_101","Execution Info":"time:3.12s, loops:3924, cop_task: {num: 9, max: 3.8s, min: 3.1s, avg: 3.43s, p95: 3.8s, max_proc_keys: 512775, p95_proc_keys: 512775, tot_proc: 20s, tot_wait: 39ms, rpc_num: 9, rpc_time: 30.9s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":192576061,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":8818000000,"Max Time":1484000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:1.48s, min:478ms, p80:1.45s, p95:1.48s, iters:3959, tasks:9}, scan_detail: {total_process_keys: 4009984, total_process_keys_size: 787655655, total_keys: 4009993, rocksdb: {delete_skipped_count: 0, key_skipped_count: 4009984, block: {cache_hit_count: 12898, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}
/*PLACEHOLDER*/ select  c_name,  c_custkey,  o_orderkey,  o_orderdate,  o_totalprice,  sum(l_quantity) from  customer,  orders,  lineitem where  o_orderkey in (   select    l_orderkey   from    lineitem   group by    l_orderkey having     sum(l_quantity) > 314  )  and c_custkey = o_custkey  and o_orderkey = l_orderkey group by  c_name,  c_custkey,  o_orderkey,  o_orderdate,  o_totalprice order by  o_totalprice desc,  o_orderdate limit 100;

{"Node Id":"Projection","Plan Rows":640,"Actual Rows":838,"Task":"root","Total Time":2029499376,"Max Time":2029499376,"Access Object":"","Operation Info":"new0107.partsupp.ps_partkey, Column#35","Execution Info":"time:2.03s, loops:2, Concurrency:OFF","Disk":0,"Memory":48256,"Plans":[{"Node Id":"Sort","Plan Rows":640,"Actual Rows":838,"Task":"root","Total Time":2012460473,"Max Time":2012460473,"Access Object":"","Operation Info":"Column#35:desc","Execution Info":"time:2.01s, loops:2","Disk":0,"Memory":48256,"Plans":[{"Node Id":"Selection","Plan Rows":640,"Actual Rows":838,"Task":"root","Total Time":1914829209,"Max Time":1914829209,"Access Object":"","Operation Info":"gt(Column#35, 8147162.905283000000)","Execution Info":"time:1.91s, loops:2","Disk":0,"Memory":50944,"Plans":[{"Node Id":"HashAgg","Plan Rows":800,"Actual Rows":30670,"Task":"root","Total Time":1912378430,"Max Time":1912378430,"Access Object":"","Operation Info":"group by:Column#61, funcs:sum(Column#59)-\u003eColumn#35, funcs:firstrow(Column#60)-\u003enew0107.partsupp.ps_partkey","Execution Info":"time:1.91s, loops:34, partial_worker:{wall_time:1.829679643s, concurrency:5, task_num:36, tot_wait:8.580658022s, tot_exec:42.622979ms, tot_time:8.626848499s, max:1.729736666s, p95:1.729736666s}, final_worker:{wall_time:1.953575947s, concurrency:5, task_num:25, tot_wait:9.315079287s, tot_exec:73.894237ms, tot_time:9.389002144s, max:1.907086831s, p95:1.907086831s}","Disk":0,"Memory":9689489,"Plans":[{"Node Id":"Projection","Plan Rows":800,"Actual Rows":32480,"Task":"root","Total Time":1718213620,"Max Time":1718213620,"Access Object":"","Operation Info":"mul(new0107.partsupp.ps_supplycost, cast(new0107.partsupp.ps_availqty, decimal(20,0) BINARY))-\u003eColumn#59, new0107.partsupp.ps_partkey, new0107.partsupp.ps_partkey","Execution Info":"time:1.72s, loops:37, Concurrency:OFF","Disk":0,"Memory":300656,"Plans":[{"Node Id":"HashJoin","Plan Rows":800,"Actual Rows":32480,"Task":"root","Total Time":1711890307,"Max Time":1711890307,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.supplier.s_suppkey, new0107.partsupp.ps_suppkey)]","Execution Info":"time:1.71s, loops:37, build_hash_table:{total:178.1ms, fetch:177.9ms, build:169.9µs}, probe:{concurrency:5, total:8.47s, max:1.7s, probe:843.9ms, fetch:7.62s}","Disk":0,"Memory":4976,"Plans":[{"Node Id":"HashJoin","Plan Rows":10,"Actual Rows":406,"Task":"root","Total Time":178015379,"Max Time":178015379,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.supplier.s_nationkey)]","Execution Info":"time:178ms, loops:6, build_hash_table:{total:18ms, fetch:18ms, build:7.66µs}, probe:{concurrency:5, total:799.2ms, max:170ms, probe:1.33ms, fetch:797.9ms}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":0.025,"Actual Rows":1,"Task":"root","Total Time":17888998,"Max Time":17888998,"Access Object":"","Operation Info":"data:Selection_88","Execution Info":"time:17.9ms, loops:2, cop_task: {num: 1, max: 7.18ms, proc_keys: 25, rpc_num: 1, rpc_time: 7.15ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":248,"Plans":[{"Node Id":"Selection","Plan Rows":0.025,"Actual Rows":1,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"eq(new0107.nation.n_name, \"MOZAMBIQUE\")","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:nation, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":10000,"Actual Rows":10000,"Task":"root","Total Time":119592589,"Max Time":119592589,"Access Object":"","Operation Info":"data:TableFullScan_85","Execution Info":"time:119.6ms, loops:11, cop_task: {num: 1, max: 102.2ms, proc_keys: 0, rpc_num: 1, rpc_time: 102.2ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":160504,"Plans":[{"Node Id":"TableFullScan","Plan Rows":10000,"Actual Rows":10000,"Task":"cop[tikv]","Total Time":7000000,"Max Time":7000000,"Access Object":"","Operation Info":"table:supplier, keep order:false","Execution Info":"tikv_task:{time:7ms, loops:14}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":800000,"Actual Rows":800000,"Task":"root","Total Time":1344137184,"Max Time":1344137184,"Access Object":"","Operation Info":"data:TableFullScan_90","Execution Info":"time:1.34s, loops:783, cop_task: {num: 2, max: 1.42s, min: 562.7ms, avg: 993ms, p95: 1.42s, max_proc_keys: 529029, p95_proc_keys: 529029, tot_proc: 1.19s, tot_wait: 2ms, rpc_num: 2, rpc_time: 1.99s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":51231847,"Plans":[{"Node Id":"TableFullScan","Plan Rows":800000,"Actual Rows":800000,"Task":"cop[tikv]","Total Time":961000000,"Max Time":636000000,"Access Object":"","Operation Info":"table:partsupp, keep order:false","Execution Info":"tikv_task:{proc max:636ms, min:325ms, p80:636ms, p95:636ms, iters:790, tasks:2}, scan_detail: {total_process_keys: 800000, total_process_keys_size: 150608990, total_keys: 800002, rocksdb: {delete_skipped_count: 0, key_skipped_count: 800000, block: {cache_hit_count: 2473, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  ps_partkey,  sum(ps_supplycost * ps_availqty) as value from  partsupp,  supplier,  nation where  ps_suppkey = s_suppkey  and s_nationkey = n_nationkey  and n_name = 'MOZAMBIQUE' group by  ps_partkey having   sum(ps_supplycost * ps_availqty) > (    select     sum(ps_supplycost * ps_availqty) * 0.0001000000    from     partsupp,     supplier,     nation    where     ps_suppkey = s_suppkey     and s_nationkey = n_nationkey     and n_name = 'MOZAMBIQUE'   ) order by  value desc;

{"Node Id":"Sort","Plan Rows":42035.97683311305,"Actual Rows":4,"Task":"root","Total Time":1695017869,"Max Time":1695017869,"Access Object":"","Operation Info":"Column#31","Execution Info":"time:1.7s, loops:2","Disk":0,"Memory":9712,"Plans":[{"Node Id":"Projection","Plan Rows":42035.97683311305,"Actual Rows":4,"Task":"root","Total Time":1694911775,"Max Time":1694911775,"Access Object":"","Operation Info":"Column#31, Column#32, Column#33","Execution Info":"time:1.69s, loops:5, Concurrency:5","Disk":0,"Memory":24280,"Plans":[{"Node Id":"HashAgg","Plan Rows":42035.97683311305,"Actual Rows":4,"Task":"root","Total Time":1694649591,"Max Time":1694649591,"Access Object":"","Operation Info":"group by:Column#37, funcs:count(1)-\u003eColumn#32, funcs:sum(Column#35)-\u003eColumn#33, funcs:firstrow(Column#36)-\u003eColumn#31","Execution Info":"time:1.69s, loops:5, partial_worker:{wall_time:1.69452484s, concurrency:5, task_num:7, tot_wait:8.460765758s, tot_exec:1.962239ms, tot_time:8.462777711s, max:1.694198755s, p95:1.694198755s}, final_worker:{wall_time:1.697322739s, concurrency:5, task_num:20, tot_wait:8.463382941s, tot_exec:7.990362ms, tot_time:8.471380557s, max:1.694322705s, p95:1.694322705s}","Disk":0,"Memory":387014,"Plans":[{"Node Id":"Projection","Plan Rows":43584.08347826087,"Actual Rows":3679,"Task":"root","Total Time":1685457326,"Max Time":1685457326,"Access Object":"","Operation Info":"new0107.customer.c_acctbal, substring(new0107.customer.c_phone, 1, 2)-\u003eColumn#36, substring(new0107.customer.c_phone, 1, 2)-\u003eColumn#37","Execution Info":"time:1.69s, loops:8, Concurrency:5","Disk":0,"Memory":310258,"Plans":[{"Node Id":"HashJoin","Plan Rows":43584.08347826087,"Actual Rows":3679,"Task":"root","Total Time":1592171761,"Max Time":1592171761,"Access Object":"","Operation Info":"anti semi join, equal:[eq(new0107.customer.c_custkey, new0107.orders.o_custkey)]","Execution Info":"time:1.59s, loops:8, build_hash_table:{total:1.49s, fetch:240.2ms, build:1.25s}, probe:{concurrency:5, total:7.97s, max:1.65s, probe:264ms, fetch:7.71s}","Disk":0,"Memory":8253696,"Plans":[{"Node Id":"TableReader","Plan Rows":54480.10434782609,"Actual Rows":10834,"Task":"root","Total Time":186354673,"Max Time":186354673,"Access Object":"","Operation Info":"data:Selection_43","Execution Info":"time:186.4ms, loops:12, cop_task: {num: 1, max: 121.8ms, proc_keys: 0, rpc_num: 1, rpc_time: 121.8ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":775145,"Plans":[{"Node Id":"Selection","Plan Rows":54480.10434782609,"Actual Rows":10834,"Task":"cop[tikv]","Total Time":245000000,"Max Time":245000000,"Access Object":"","Operation Info":"gt(new0107.customer.c_acctbal, 5001.433377), in(substring(new0107.customer.c_phone, 1, 2), \"20\", \"40\", \"22\", \"30\", \"39\", \"42\", \"21\")","Execution Info":"tikv_task:{time:245ms, loops:151}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":150000,"Actual Rows":150000,"Task":"cop[tikv]","Total Time":202000000,"Max Time":202000000,"Access Object":"","Operation Info":"table:customer, keep order:false","Execution Info":"tikv_task:{time:202ms, loops:151}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":1094656,"Actual Rows":1001472,"Task":"root","Total Time":92951991,"Max Time":92951991,"Access Object":"","Operation Info":"data:TableFullScan_45","Execution Info":"time:93ms, loops:980, cop_task: {num: 2, max: 100.3ms, min: 87.4ms, avg: 93.8ms, p95: 100.3ms, rpc_num: 2, rpc_time: 187.6ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":8025811,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":1079000000,"Max Time":572000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:572ms, min:507ms, p80:572ms, p95:572ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  cntrycode,  count(*) as numcust,  sum(c_acctbal) as totacctbal from  (   select    substring(c_phone from 1 for 2) as cntrycode,    c_acctbal   from    customer   where    substring(c_phone from 1 for 2) in     ('20', '40', '22', '30', '39', '42', '21')    and c_acctbal > (     select      avg(c_acctbal)     from      customer     where      c_acctbal > 0.00      and substring(c_phone from 1 for 2) in       ('20', '40', '22', '30', '39', '42', '21')    )    and not exists (     select      *     from      orders     where      o_custkey = c_custkey    )  ) as custsale group by  cntrycode order by  cntrycode;

{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":1107143535,"Max Time":1107143535,"Access Object":"","Operation Info":"funcs:sum(Column#28)-\u003eColumn#27","Execution Info":"time:1.11s, loops:2, partial_worker:{wall_time:1.107079116s, concurrency:5, task_num:5, tot_wait:5.483168161s, tot_exec:129.083µs, tot_time:5.483310255s, max:1.096671949s, p95:1.096671949s}, final_worker:{wall_time:1.107200634s, concurrency:5, task_num:5, tot_wait:5.483613908s, tot_exec:38.845µs, tot_time:5.483656233s, max:1.096766102s, p95:1.096766102s}","Disk":0,"Memory":19956,"Plans":[{"Node Id":"Projection","Plan Rows":2810.7054154138987,"Actual Rows":72,"Task":"root","Total Time":1094437107,"Max Time":1094437107,"Access Object":"","Operation Info":"mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount))-\u003eColumn#28","Execution Info":"time:1.09s, loops:6, Concurrency:5","Disk":0,"Memory":22968,"Plans":[{"Node Id":"HashJoin","Plan Rows":2810.7054154138987,"Actual Rows":72,"Task":"root","Total Time":1057021244,"Max Time":1057021244,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.part.p_partkey, new0107.lineitem.l_partkey)], other cond:or(and(and(eq(new0107.part.p_brand, \"Brand#52\"), in(new0107.part.p_container, \"SM CASE\", \"SM BOX\", \"SM PACK\", \"SM PKG\")), and(ge(new0107.lineitem.l_quantity, 4), and(le(new0107.lineitem.l_quantity, 14), le(new0107.part.p_size, 5)))), or(and(and(eq(new0107.part.p_brand, \"Brand#11\"), in(new0107.part.p_container, \"MED BAG\", \"MED BOX\", \"MED PKG\", \"MED PACK\")), and(ge(new0107.lineitem.l_quantity, 18), and(le(new0107.lineitem.l_quantity, 28), le(new0107.part.p_size, 10)))), and(and(eq(new0107.part.p_brand, \"Brand#51\"), in(new0107.part.p_container, \"LG CASE\", \"LG BOX\", \"LG PACK\", \"LG PKG\")), and(ge(new0107.lineitem.l_quantity, 29), and(le(new0107.lineitem.l_quantity, 39), le(new0107.part.p_size, 15))))))","Execution Info":"time:1.06s, loops:6, build_hash_table:{total:264.7ms, fetch:264.6ms, build:148.9µs}, probe:{concurrency:5, total:4.67s, max:936.5ms, probe:1.78s, fetch:2.88s}","Disk":0,"Memory":50112,"Plans":[{"Node Id":"TableReader","Plan Rows":138.05455049694,"Actual Rows":453,"Task":"root","Total Time":264401958,"Max Time":264401958,"Access Object":"","Operation Info":"data:Selection_30","Execution Info":"time:264.4ms, loops:2, cop_task: {num: 1, max: 328.7ms, proc_keys: 0, rpc_num: 1, rpc_time: 328.7ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":30667,"Plans":[{"Node Id":"Selection","Plan Rows":138.05455049694,"Actual Rows":453,"Task":"cop[tikv]","Total Time":281000000,"Max Time":281000000,"Access Object":"","Operation Info":"ge(new0107.part.p_size, 1), or(and(eq(new0107.part.p_brand, \"Brand#52\"), and(in(new0107.part.p_container, \"SM CASE\", \"SM BOX\", \"SM PACK\", \"SM PKG\"), le(new0107.part.p_size, 5))), or(and(eq(new0107.part.p_brand, \"Brand#11\"), and(in(new0107.part.p_container, \"MED BAG\", \"MED BOX\", \"MED PKG\", \"MED PACK\"), le(new0107.part.p_size, 10))), and(eq(new0107.part.p_brand, \"Brand#51\"), and(in(new0107.part.p_container, \"LG CASE\", \"LG BOX\", \"LG PACK\", \"LG PKG\"), le(new0107.part.p_size, 15)))))","Execution Info":"tikv_task:{time:281ms, loops:200}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":200000,"Actual Rows":200000,"Task":"cop[tikv]","Total Time":168000000,"Max Time":168000000,"Access Object":"","Operation Info":"table:part, keep order:false","Execution Info":"tikv_task:{time:168ms, loops:200}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":182075.37432781045,"Actual Rows":94250,"Task":"root","Total Time":317422363,"Max Time":317422363,"Access Object":"","Operation Info":"data:Selection_27","Execution Info":"time:317.4ms, loops:93, cop_task: {num: 9, max: 264.6ms, min: 4.09ms, avg: 103.4ms, p95: 264.6ms, rpc_num: 9, rpc_time: 927.2ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":13939181,"Plans":[{"Node Id":"Selection","Plan Rows":182075.37432781045,"Actual Rows":94250,"Task":"cop[tikv]","Total Time":7506000000,"Max Time":1015000000,"Access Object":"","Operation Info":"eq(new0107.lineitem.l_shipinstruct, \"DELIVER IN PERSON\"), in(new0107.lineitem.l_shipmode, \"AIR\", \"AIR REG\"), or(and(ge(new0107.lineitem.l_quantity, 4), le(new0107.lineitem.l_quantity, 14)), or(and(ge(new0107.lineitem.l_quantity, 18), le(new0107.lineitem.l_quantity, 28)), and(ge(new0107.lineitem.l_quantity, 29), le(new0107.lineitem.l_quantity, 39))))","Execution Info":"tikv_task:{proc max:1.02s, min:507ms, p80:962ms, p95:1.02s, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4827000000,"Max Time":676000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:676ms, min:347ms, p80:624ms, p95:676ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}
/*PLACEHOLDER*/ select  sum(l_extendedprice* (1 - l_discount)) as revenue from  lineitem,  part where  (   p_partkey = l_partkey   and p_brand = 'Brand#52'   and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')   and l_quantity >= 4 and l_quantity <= 4 + 10   and p_size between 1 and 5   and l_shipmode in ('AIR', 'AIR REG')   and l_shipinstruct = 'DELIVER IN PERSON'  )  or  (   p_partkey = l_partkey   and p_brand = 'Brand#11'   and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')   and l_quantity >= 18 and l_quantity <= 18 + 10   and p_size between 1 and 10   and l_shipmode in ('AIR', 'AIR REG')   and l_shipinstruct = 'DELIVER IN PERSON'  )  or  (   p_partkey = l_partkey   and p_brand = 'Brand#51'   and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')   and l_quantity >= 29 and l_quantity <= 29 + 10   and p_size between 1 and 15   and l_shipmode in ('AIR', 'AIR REG')   and l_shipinstruct = 'DELIVER IN PERSON'  );

{"Node Id":"Projection","Plan Rows":100,"Actual Rows":100,"Task":"root","Total Time":3230093599,"Max Time":3230093599,"Access Object":"","Operation Info":"new0107.supplier.s_acctbal, new0107.supplier.s_name, new0107.nation.n_name, new0107.part.p_partkey, new0107.part.p_mfgr, new0107.supplier.s_address, new0107.supplier.s_phone, new0107.supplier.s_comment","Execution Info":"time:3.23s, loops:2, Concurrency:OFF","Disk":0,"Memory":29808,"Plans":[{"Node Id":"TopN","Plan Rows":100,"Actual Rows":100,"Task":"root","Total Time":3230068486,"Max Time":3230068486,"Access Object":"","Operation Info":"new0107.supplier.s_acctbal:desc, new0107.nation.n_name, new0107.supplier.s_name, new0107.part.p_partkey, offset:0, count:100","Execution Info":"time:3.23s, loops:2","Disk":0,"Memory":143768,"Plans":[{"Node Id":"Projection","Plan Rows":160,"Actual Rows":485,"Task":"root","Total Time":3228979838,"Max Time":3228979838,"Access Object":"","Operation Info":"new0107.part.p_partkey, new0107.part.p_mfgr, new0107.supplier.s_name, new0107.supplier.s_address, new0107.supplier.s_phone, new0107.supplier.s_acctbal, new0107.supplier.s_comment, new0107.nation.n_name","Execution Info":"time:3.23s, loops:2, Concurrency:OFF","Disk":0,"Memory":139888,"Plans":[{"Node Id":"HashJoin","Plan Rows":160,"Actual Rows":485,"Task":"root","Total Time":3228966708,"Max Time":3228966708,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.part.p_partkey, new0107.partsupp.ps_partkey) eq(new0107.partsupp.ps_supplycost, Column#50)]","Execution Info":"time:3.23s, loops:2, build_hash_table:{total:3.22s, fetch:3.14s, build:78.1ms}, probe:{concurrency:5, total:16.1s, max:3.22s, probe:2.2ms, fetch:16.1s}","Disk":0,"Memory":5761024,"Plans":[{"Node Id":"IndexJoin","Plan Rows":203.08692120227457,"Actual Rows":649,"Task":"root","Total Time":3200945671,"Max Time":3200945671,"Access Object":"","Operation Info":"inner join, inner:TableReader_53, outer key:new0107.partsupp.ps_partkey, inner key:new0107.part.p_partkey, equal cond:eq(new0107.partsupp.ps_partkey, new0107.part.p_partkey)","Execution Info":"time:3.2s, loops:2, inner:{total:5s, concurrency:5, task:14, construct:1.02s, fetch:3.98s, build:652.7µs}, probe:74.8ms","Disk":0,"Memory":59682441,"Plans":[{"Node Id":"HashJoin","Plan Rows":200,"Actual Rows":160240,"Task":"root","Total Time":1935021252,"Max Time":1935021252,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.supplier.s_suppkey, new0107.partsupp.ps_suppkey)]","Execution Info":"time:1.94s, loops:161, build_hash_table:{total:345.6ms, fetch:276.4ms, build:69.2ms}, probe:{concurrency:5, total:13.1s, max:2.64s, probe:6.63s, fetch:6.52s}","Disk":0,"Memory":600408,"Plans":[{"Node Id":"HashJoin","Plan Rows":2.5,"Actual Rows":2003,"Task":"root","Total Time":290976687,"Max Time":290976687,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.supplier.s_nationkey)]","Execution Info":"time:291ms, loops:7, build_hash_table:{total:192.4ms, fetch:192.4ms, build:10.4µs}, probe:{concurrency:5, total:1.46s, max:295.3ms, probe:123.5ms, fetch:1.34s}","Disk":0,"Memory":1000,"Plans":[{"Node Id":"HashJoin","Plan Rows":0.00625,"Actual Rows":5,"Task":"root","Total Time":192328394,"Max Time":192328394,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.region.r_regionkey, new0107.nation.n_regionkey)]","Execution Info":"time:192.3ms, loops:2, build_hash_table:{total:161.1ms, fetch:161.1ms, build:10.3µs}, probe:{concurrency:5, total:831.4ms, max:167.7ms, probe:28.2µs, fetch:831.3ms}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":0.005,"Actual Rows":1,"Task":"root","Total Time":160992265,"Max Time":160992265,"Access Object":"","Operation Info":"data:Selection_84","Execution Info":"time:161ms, loops:2, cop_task: {num: 1, max: 148.3ms, proc_keys: 5, rpc_num: 1, rpc_time: 148.3ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":246,"Plans":[{"Node Id":"Selection","Plan Rows":0.005,"Actual Rows":1,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"eq(new0107.region.r_name, \"ASIA\")","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 5, total_process_keys_size: 559, total_keys: 6, rocksdb: {delete_skipped_count: 0, key_skipped_count: 5, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":5,"Actual Rows":5,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:region, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":25,"Actual Rows":25,"Task":"root","Total Time":44091283,"Max Time":44091283,"Access Object":"","Operation Info":"data:TableFullScan_81","Execution Info":"time:44.1ms, loops:2, cop_task: {num: 1, max: 78.5ms, proc_keys: 25, rpc_num: 1, rpc_time: 78.5ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":1002,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:nation, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":10000,"Actual Rows":10000,"Task":"root","Total Time":148947308,"Max Time":148947308,"Access Object":"","Operation Info":"data:TableFullScan_86","Execution Info":"time:148.9ms, loops:11, cop_task: {num: 1, max: 52.8ms, proc_keys: 0, rpc_num: 1, rpc_time: 52.8ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":2086986,"Plans":[{"Node Id":"TableFullScan","Plan Rows":10000,"Actual Rows":10000,"Task":"cop[tikv]","Total Time":20000000,"Max Time":20000000,"Access Object":"","Operation Info":"table:supplier, keep order:false","Execution Info":"tikv_task:{time:20ms, loops:14}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":800000,"Actual Rows":800000,"Task":"root","Total Time":1065486391,"Max Time":1065486391,"Access Object":"","Operation Info":"data:TableFullScan_88","Execution Info":"time:1.07s, loops:783, cop_task: {num: 2, max: 1.27s, min: 621ms, avg: 943.9ms, p95: 1.27s, max_proc_keys: 529029, p95_proc_keys: 529029, tot_proc: 1.26s, tot_wait: 5ms, rpc_num: 2, rpc_time: 1.89s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":44825522,"Plans":[{"Node Id":"TableFullScan","Plan Rows":800000,"Actual Rows":800000,"Task":"cop[tikv]","Total Time":862000000,"Max Time":595000000,"Access Object":"","Operation Info":"table:partsupp, keep order:false","Execution Info":"tikv_task:{proc max:595ms, min:267ms, p80:595ms, p95:595ms, iters:790, tasks:2}, scan_detail: {total_process_keys: 800000, total_process_keys_size: 150608990, total_keys: 800002, rocksdb: {delete_skipped_count: 0, key_skipped_count: 800000, block: {cache_hit_count: 2473, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":0.008704000000000002,"Actual Rows":485,"Task":"root","Total Time":3484720013,"Max Time":441737169,"Access Object":"","Operation Info":"data:Selection_52","Execution Info":"time:3.48s, loops:27, cop_task: {num: 14, max: 350.2ms, min: 16.6ms, avg: 180.4ms, p95: 350.2ms, max_proc_keys: 18926, p95_proc_keys: 18926, tot_proc: 1.3s, tot_wait: 41ms, rpc_num: 27, rpc_time: 5s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":0,"Plans":[{"Node Id":"Selection","Plan Rows":0.008704000000000002,"Actual Rows":485,"Task":"cop[tikv]","Total Time":1291000000,"Max Time":281000000,"Access Object":"","Operation Info":"eq(new0107.part.p_size, 30), like(new0107.part.p_type, \"%STEEL\", 92)","Execution Info":"tikv_task:{proc max:281ms, min:5ms, p80:182ms, p95:281ms, iters:176, tasks:14}, scan_detail: {total_process_keys: 118079, total_process_keys_size: 19298478, total_keys: 146972, rocksdb: {delete_skipped_count: 0, key_skipped_count: 98393, block: {cache_hit_count: 136577, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":118079,"Task":"cop[tikv]","Total Time":1280000000,"Max Time":279000000,"Access Object":"","Operation Info":"table:part, range: decided by [new0107.partsupp.ps_partkey], keep order:false","Execution Info":"tikv_task:{proc max:279ms, min:5ms, p80:181ms, p95:279ms, iters:176, tasks:14}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"Selection","Plan Rows":160,"Actual Rows":118067,"Task":"root","Total Time":3065220746,"Max Time":3065220746,"Access Object":"","Operation Info":"not(isnull(Column#50))","Execution Info":"time:3.07s, loops:117","Disk":0,"Memory":50944,"Plans":[{"Node Id":"HashAgg","Plan Rows":200,"Actual Rows":118067,"Task":"root","Total Time":3027365228,"Max Time":3027365228,"Access Object":"","Operation Info":"group by:new0107.partsupp.ps_partkey, funcs:min(new0107.partsupp.ps_supplycost)-\u003eColumn#50, funcs:firstrow(new0107.partsupp.ps_partkey)-\u003enew0107.partsupp.ps_partkey","Execution Info":"time:3.03s, loops:120, partial_worker:{wall_time:2.960657502s, concurrency:5, task_num:159, tot_wait:9.431737432s, tot_exec:3.736793235s, tot_time:13.189287404s, max:2.910708212s, p95:2.910708212s}, final_worker:{wall_time:3.217450888s, concurrency:5, task_num:25, tot_wait:14.359751226s, tot_exec:1.601855479s, tot_time:15.961648318s, max:3.213892653s, p95:3.213892653s}","Disk":0,"Memory":41020533,"Plans":[{"Node Id":"HashJoin","Plan Rows":200,"Actual Rows":160240,"Task":"root","Total Time":2367740877,"Max Time":2367740877,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.supplier.s_suppkey, new0107.partsupp.ps_suppkey)]","Execution Info":"time:2.37s, loops:160, build_hash_table:{total:340.4ms, fetch:339.7ms, build:750.2µs}, probe:{concurrency:5, total:10.8s, max:2.44s, probe:6.64s, fetch:4.13s}","Disk":0,"Memory":26400,"Plans":[{"Node Id":"HashJoin","Plan Rows":2.5,"Actual Rows":2003,"Task":"root","Total Time":340225217,"Max Time":340225217,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.supplier.s_nationkey)]","Execution Info":"time:340.2ms, loops:7, build_hash_table:{total:125.3ms, fetch:125.3ms, build:8.57µs}, probe:{concurrency:5, total:1.05s, max:261.4ms, probe:168.4ms, fetch:878.7ms}","Disk":0,"Memory":372,"Plans":[{"Node Id":"HashJoin","Plan Rows":0.00625,"Actual Rows":5,"Task":"root","Total Time":125309994,"Max Time":125309994,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.region.r_regionkey, new0107.nation.n_regionkey)]","Execution Info":"time:125.3ms, loops:2, build_hash_table:{total:123.4ms, fetch:123.4ms, build:10.7µs}, probe:{concurrency:5, total:622.9ms, max:124.9ms, probe:24.2µs, fetch:622.8ms}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":0.005,"Actual Rows":1,"Task":"root","Total Time":123312003,"Max Time":123312003,"Access Object":"","Operation Info":"data:Selection_117","Execution Info":"time:123.3ms, loops:2, cop_task: {num: 1, max: 44.3ms, proc_keys: 5, rpc_num: 1, rpc_time: 44.2ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":246,"Plans":[{"Node Id":"Selection","Plan Rows":0.005,"Actual Rows":1,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"eq(new0107.region.r_name, \"ASIA\")","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 5, total_process_keys_size: 559, total_keys: 6, rocksdb: {delete_skipped_count: 0, key_skipped_count: 5, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":5,"Actual Rows":5,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:region, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":25,"Actual Rows":25,"Task":"root","Total Time":20286634,"Max Time":20286634,"Access Object":"","Operation Info":"data:TableFullScan_114","Execution Info":"time:20.3ms, loops:2, cop_task: {num: 1, max: 43.9ms, proc_keys: 25, rpc_num: 1, rpc_time: 43.9ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":613,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:nation, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":10000,"Actual Rows":10000,"Task":"root","Total Time":39650557,"Max Time":39650557,"Access Object":"","Operation Info":"data:TableFullScan_119","Execution Info":"time:39.7ms, loops:11, cop_task: {num: 1, max: 65.3ms, proc_keys: 0, rpc_num: 1, rpc_time: 65.3ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":160504,"Plans":[{"Node Id":"TableFullScan","Plan Rows":10000,"Actual Rows":10000,"Task":"cop[tikv]","Total Time":7000000,"Max Time":7000000,"Access Object":"","Operation Info":"table:supplier, keep order:false","Execution Info":"tikv_task:{time:7ms, loops:14}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":800000,"Actual Rows":800000,"Task":"root","Total Time":810362437,"Max Time":810362437,"Access Object":"","Operation Info":"data:TableFullScan_121","Execution Info":"time:810.4ms, loops:783, cop_task: {num: 2, max: 1.13s, min: 701.3ms, avg: 914ms, p95: 1.13s, max_proc_keys: 529029, p95_proc_keys: 529029, tot_proc: 1.16s, tot_wait: 3ms, rpc_num: 2, rpc_time: 1.83s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":44825523,"Plans":[{"Node Id":"TableFullScan","Plan Rows":800000,"Actual Rows":800000,"Task":"cop[tikv]","Total Time":856000000,"Max Time":562000000,"Access Object":"","Operation Info":"table:partsupp, keep order:false","Execution Info":"tikv_task:{proc max:562ms, min:294ms, p80:562ms, p95:562ms, iters:790, tasks:2}, scan_detail: {total_process_keys: 800000, total_process_keys_size: 150608990, total_keys: 800002, rocksdb: {delete_skipped_count: 0, key_skipped_count: 800000, block: {cache_hit_count: 2473, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  s_acctbal,  s_name,  n_name,  p_partkey,  p_mfgr,  s_address,  s_phone,  s_comment from  part,  supplier,  partsupp,  nation,  region where  p_partkey = ps_partkey  and s_suppkey = ps_suppkey  and p_size = 30  and p_type like '%STEEL'  and s_nationkey = n_nationkey  and n_regionkey = r_regionkey  and r_name = 'ASIA'  and ps_supplycost = (   select    min(ps_supplycost)   from    partsupp,    supplier,    nation,    region   where    p_partkey = ps_partkey    and s_suppkey = ps_suppkey    and s_nationkey = n_nationkey    and n_regionkey = r_regionkey    and r_name = 'ASIA'  ) order by  s_acctbal desc,  n_name,  s_name,  p_partkey limit 100;

{"Node Id":"Sort","Plan Rows":1,"Actual Rows":2,"Task":"root","Total Time":384080308,"Max Time":384080308,"Access Object":"","Operation Info":"new0107.lineitem.l_shipmode","Execution Info":"time:384.1ms, loops:2","Disk":0,"Memory":6968,"Plans":[{"Node Id":"Projection","Plan Rows":1,"Actual Rows":2,"Task":"root","Total Time":384017405,"Max Time":384017405,"Access Object":"","Operation Info":"new0107.lineitem.l_shipmode, Column#27, Column#28","Execution Info":"time:384ms, loops:3, Concurrency:OFF","Disk":0,"Memory":3484,"Plans":[{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":2,"Task":"root","Total Time":383998922,"Max Time":383998922,"Access Object":"","Operation Info":"group by:Column#40, funcs:sum(Column#37)-\u003eColumn#27, funcs:sum(Column#38)-\u003eColumn#28, funcs:firstrow(Column#39)-\u003enew0107.lineitem.l_shipmode","Execution Info":"time:384ms, loops:3, partial_worker:{wall_time:379.317318ms, concurrency:5, task_num:24, tot_wait:1.766588634s, tot_exec:6.534594ms, tot_time:1.773149201s, max:354.64375ms, p95:354.64375ms}, final_worker:{wall_time:384.335511ms, concurrency:5, task_num:10, tot_wait:1.90660875s, tot_exec:155.523µs, tot_time:1.906771772s, max:381.972735ms, p95:381.972735ms}","Disk":0,"Memory":1194391,"Plans":[{"Node Id":"Projection","Plan Rows":137139.56931393046,"Actual Rows":20757,"Task":"root","Total Time":352859085,"Max Time":352859085,"Access Object":"","Operation Info":"cast(case(or(eq(new0107.orders.o_orderpriority, 1-URGENT), eq(new0107.orders.o_orderpriority, 2-HIGH)), 1, 0), decimal(20,0) BINARY)-\u003eColumn#37, cast(case(and(ne(new0107.orders.o_orderpriority, 1-URGENT), ne(new0107.orders.o_orderpriority, 2-HIGH)), 1, 0), decimal(20,0) BINARY)-\u003eColumn#38, new0107.lineitem.l_shipmode, new0107.lineitem.l_shipmode","Execution Info":"time:352.9ms, loops:25, Concurrency:5","Disk":0,"Memory":560144,"Plans":[{"Node Id":"Projection","Plan Rows":137139.56931393046,"Actual Rows":20757,"Task":"root","Total Time":349139076,"Max Time":349139076,"Access Object":"","Operation Info":"new0107.orders.o_orderpriority, new0107.lineitem.l_shipmode","Execution Info":"time:349.1ms, loops:25, Concurrency:5","Disk":0,"Memory":117600,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":137139.56931393046,"Actual Rows":20757,"Task":"root","Total Time":352151190,"Max Time":352151190,"Access Object":"","Operation Info":"inner join, inner:TableReader_17, outer key:new0107.lineitem.l_orderkey, inner key:new0107.orders.o_orderkey, equal cond:eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)","Execution Info":"time:352.2ms, loops:25, inner:{total:1.13s, concurrency:5, task:9, construct:37.5ms, fetch:978.9ms, build:3.64ms, join:117.7ms}","Disk":0,"Memory":3864210,"Plans":[{"Node Id":"TableReader","Plan Rows":134783.21932571862,"Actual Rows":20773,"Task":"root","Total Time":79233997,"Max Time":79233997,"Access Object":"","Operation Info":"data:Selection_49","Execution Info":"time:79.2ms, loops:26, cop_task: {num: 9, max: 60.6ms, min: 35.2ms, avg: 45.8ms, p95: 60.6ms, rpc_num: 9, rpc_time: 412.4ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":271070,"Plans":[{"Node Id":"Selection","Plan Rows":134783.21932571862,"Actual Rows":20773,"Task":"cop[tikv]","Total Time":4954000000,"Max Time":647000000,"Access Object":"","Operation Info":"ge(new0107.lineitem.l_receiptdate, 1997-01-01 00:00:00.000000), in(new0107.lineitem.l_shipmode, \"RAIL\", \"FOB\"), lt(new0107.lineitem.l_commitdate, new0107.lineitem.l_receiptdate), lt(new0107.lineitem.l_receiptdate, 1998-01-01 00:00:00.000000), lt(new0107.lineitem.l_shipdate, new0107.lineitem.l_commitdate)","Execution Info":"tikv_task:{proc max:647ms, min:292ms, p80:636ms, p95:647ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4041000000,"Max Time":548000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:548ms, min:233ms, p80:537ms, p95:548ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":1,"Actual Rows":19515,"Task":"root","Total Time":963290551,"Max Time":175800634,"Access Object":"","Operation Info":"data:TableRangeScan_16","Execution Info":"time:963.3ms, loops:34, cop_task: {num: 12, max: 137.7ms, min: 39.6ms, avg: 85.7ms, p95: 137.7ms, max_proc_keys: 3866, p95_proc_keys: 3866, tot_proc: 322ms, tot_wait: 18ms, rpc_num: 23, rpc_time: 2s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":19515,"Task":"cop[tikv]","Total Time":317000000,"Max Time":67000000,"Access Object":"","Operation Info":"table:orders, range: decided by [new0107.lineitem.l_orderkey], keep order:false","Execution Info":"tikv_task:{proc max:67ms, min:1ms, p80:57ms, p95:67ms, iters:67, tasks:12}, scan_detail: {total_process_keys: 19515, total_process_keys_size: 2958195, total_keys: 19858, rocksdb: {delete_skipped_count: 0, key_skipped_count: 665, block: {cache_hit_count: 25711, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  l_shipmode,  sum(case   when o_orderpriority = '1-URGENT'    or o_orderpriority = '2-HIGH'    then 1   else 0  end) as high_line_count,  sum(case   when o_orderpriority <> '1-URGENT'    and o_orderpriority <> '2-HIGH'    then 1   else 0  end) as low_line_count from  orders,  lineitem where  o_orderkey = l_orderkey  and l_shipmode in ('RAIL', 'FOB')  and l_commitdate < l_receiptdate  and l_shipdate < l_commitdate  and l_receiptdate >= '1997-01-01'  and l_receiptdate < date_add('1997-01-01', interval '1' year) group by  l_shipmode order by  l_shipmode;

{"Node Id":"Sort","Plan Rows":10,"Actual Rows":152,"Task":"root","Total Time":1224668643,"Max Time":1224668643,"Access Object":"","Operation Info":"new0107.supplier.s_name","Execution Info":"time:1.22s, loops:2","Disk":0,"Memory":13568,"Plans":[{"Node Id":"HashJoin","Plan Rows":10,"Actual Rows":152,"Task":"root","Total Time":1224457828,"Max Time":1224457828,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.supplier.s_suppkey, new0107.partsupp.ps_suppkey)]","Execution Info":"time:1.22s, loops:6, build_hash_table:{total:212ms, fetch:211.8ms, build:181µs}, probe:{concurrency:5, total:6s, max:1.2s, probe:48.2ms, fetch:5.96s}","Disk":0,"Memory":35428,"Plans":[{"Node Id":"HashJoin","Plan Rows":10,"Actual Rows":420,"Task":"root","Total Time":211757506,"Max Time":211757506,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.supplier.s_nationkey)]","Execution Info":"time:211.8ms, loops:6, build_hash_table:{total:58.1ms, fetch:58.1ms, build:8.7µs}, probe:{concurrency:5, total:899.3ms, max:197.9ms, probe:1.47ms, fetch:897.8ms}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":0.025,"Actual Rows":1,"Task":"root","Total Time":58060076,"Max Time":58060076,"Access Object":"","Operation Info":"data:Selection_52","Execution Info":"time:58.1ms, loops:2, cop_task: {num: 1, max: 38.4ms, proc_keys: 25, tot_proc: 2ms, tot_wait: 4ms, rpc_num: 1, rpc_time: 38.4ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":255,"Plans":[{"Node Id":"Selection","Plan Rows":0.025,"Actual Rows":1,"Task":"cop[tikv]","Total Time":2000000,"Max Time":2000000,"Access Object":"","Operation Info":"eq(new0107.nation.n_name, \"ALGERIA\")","Execution Info":"tikv_task:{time:2ms, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:nation, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":10000,"Actual Rows":10000,"Task":"root","Total Time":107991890,"Max Time":107991890,"Access Object":"","Operation Info":"data:TableFullScan_49","Execution Info":"time:108ms, loops:11, cop_task: {num: 1, max: 63.3ms, proc_keys: 0, rpc_num: 1, rpc_time: 63.3ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":750725,"Plans":[{"Node Id":"TableFullScan","Plan Rows":10000,"Actual Rows":10000,"Task":"cop[tikv]","Total Time":13000000,"Max Time":13000000,"Access Object":"","Operation Info":"table:supplier, keep order:false","Execution Info":"tikv_task:{time:13ms, loops:14}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"HashAgg","Plan Rows":2547.961871329696,"Actual Rows":3734,"Task":"root","Total Time":1197521607,"Max Time":1197521607,"Access Object":"","Operation Info":"group by:new0107.partsupp.ps_suppkey, funcs:firstrow(new0107.partsupp.ps_suppkey)-\u003enew0107.partsupp.ps_suppkey","Execution Info":"time:1.2s, loops:6, partial_worker:{wall_time:1.073127846s, concurrency:5, task_num:5, tot_wait:5.34328591s, tot_exec:2.670632ms, tot_time:5.346365824s, max:1.069701515s, p95:1.069701515s}, final_worker:{wall_time:1.197541108s, concurrency:5, task_num:25, tot_wait:5.622203418s, tot_exec:3.880352ms, tot_time:5.626094743s, max:1.138856502s, p95:1.138856502s}","Disk":0,"Memory":1073662,"Plans":[{"Node Id":"Selection","Plan Rows":2547.961871329696,"Actual Rows":4608,"Task":"root","Total Time":1068511967,"Max Time":1068511967,"Access Object":"","Operation Info":"gt(cast(new0107.partsupp.ps_availqty, decimal(20,0) BINARY), mul(0.5, Column#44))","Execution Info":"time:1.07s, loops:6","Disk":0,"Memory":60656,"Plans":[{"Node Id":"HashAgg","Plan Rows":3184.9523391621196,"Actual Rows":8576,"Task":"root","Total Time":1023949433,"Max Time":1023949433,"Access Object":"","Operation Info":"group by:new0107.partsupp.ps_partkey, new0107.partsupp.ps_suppkey, funcs:firstrow(new0107.partsupp.ps_suppkey)-\u003enew0107.partsupp.ps_suppkey, funcs:firstrow(new0107.partsupp.ps_availqty)-\u003enew0107.partsupp.ps_availqty, funcs:sum(new0107.lineitem.l_quantity)-\u003eColumn#44","Execution Info":"time:1.02s, loops:12, partial_worker:{wall_time:1.015390741s, concurrency:5, task_num:17, tot_wait:4.942161017s, tot_exec:11.360501ms, tot_time:4.95480773s, max:995.061091ms, p95:995.061091ms}, final_worker:{wall_time:1.068517828s, concurrency:5, task_num:25, tot_wait:5.038652784s, tot_exec:248.934102ms, tot_time:5.287600108s, max:1.067969999s, p95:1.067969999s}","Disk":0,"Memory":4015444,"Plans":[{"Node Id":"HashJoin","Plan Rows":64843.663285959956,"Actual Rows":10496,"Task":"root","Total Time":975172515,"Max Time":975172515,"Access Object":"","Operation Info":"left outer join, equal:[eq(new0107.partsupp.ps_partkey, new0107.lineitem.l_partkey) eq(new0107.partsupp.ps_suppkey, new0107.lineitem.l_suppkey)]","Execution Info":"time:975.2ms, loops:18, build_hash_table:{total:578.3ms, fetch:574.9ms, build:3.44ms}, probe:{concurrency:5, total:4.5s, max:926.8ms, probe:678.2ms, fetch:3.82s}","Disk":0,"Memory":303864,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":3184.9523391621196,"Actual Rows":8576,"Task":"root","Total Time":577738437,"Max Time":577738437,"Access Object":"","Operation Info":"inner join, inner:IndexLookUp_64, outer key:new0107.part.p_partkey, inner key:new0107.partsupp.ps_partkey, equal cond:eq(new0107.part.p_partkey, new0107.partsupp.ps_partkey)","Execution Info":"time:577.7ms, loops:13, inner:{total:1.96s, concurrency:5, task:6, construct:1.72ms, fetch:1.76s, build:3.4ms, join:206.5ms}","Disk":0,"Memory":886577,"Plans":[{"Node Id":"TableReader","Plan Rows":784.1352659017139,"Actual Rows":2144,"Task":"root","Total Time":69229394,"Max Time":69229394,"Access Object":"","Operation Info":"data:Selection_95","Execution Info":"time:69.2ms, loops:8, cop_task: {num: 1, max: 43.6ms, proc_keys: 0, rpc_num: 1, rpc_time: 43.5ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":109114,"Plans":[{"Node Id":"Selection","Plan Rows":784.1352659017139,"Actual Rows":2144,"Task":"cop[tikv]","Total Time":234000000,"Max Time":234000000,"Access Object":"","Operation Info":"like(new0107.part.p_name, \"green%\", 92)","Execution Info":"tikv_task:{time:234ms, loops:200}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":200000,"Actual Rows":200000,"Task":"cop[tikv]","Total Time":206000000,"Max Time":206000000,"Access Object":"","Operation Info":"table:part, keep order:false","Execution Info":"tikv_task:{time:206ms, loops:200}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"IndexLookUp","Plan Rows":4.061738424045491,"Actual Rows":8576,"Task":"root","Total Time":1753665127,"Max Time":502873827,"Access Object":"","Operation Info":"","Execution Info":"time:1.75s, loops:19, index_task: {total_time: 712.7ms, fetch_handle: 712.6ms, build: 13.4µs, wait: 21.7µs}, table_task: {total_time: 1.21s, num: 10, concurrency: 30}","Disk":0,"Memory":239428,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":4.061738424045491,"Actual Rows":8576,"Task":"cop[tikv]","Total Time":63000000,"Max Time":27000000,"Access Object":"","Operation Info":"table:partsupp, index:PRIMARY(PS_PARTKEY, PS_SUPPKEY), range: decided by [eq(new0107.partsupp.ps_partkey, new0107.part.p_partkey)], keep order:false","Execution Info":"time:712ms, loops:25, cop_task: {num: 6, max: 226.4ms, min: 29.7ms, avg: 94.6ms, p95: 226.4ms, max_proc_keys: 4100, p95_proc_keys: 4100, tot_proc: 48ms, tot_wait: 1ms, rpc_num: 11, rpc_time: 1.09s, copr_cache_hit_ratio: 0.33}, tikv_task:{proc max:27ms, min:2ms, p80:16ms, p95:27ms, iters:36, tasks:6}, scan_detail: {total_process_keys: 6992, total_process_keys_size: 370576, total_keys: 8740, rocksdb: {delete_skipped_count: 0, key_skipped_count: 6992, block: {cache_hit_count: 6999, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]},{"Node Id":"TableRowIDScan","Plan Rows":4.061738424045491,"Actual Rows":8576,"Task":"cop[tikv]","Total Time":75000000,"Max Time":23000000,"Access Object":"","Operation Info":"table:partsupp, keep order:false","Execution Info":"time:1.21s, loops:24, cop_task: {num: 11, max: 117.6ms, min: 33.4ms, avg: 82.6ms, p95: 117.6ms, max_proc_keys: 2048, p95_proc_keys: 2048, tot_proc: 50ms, tot_wait: 42ms, rpc_num: 21, rpc_time: 1.78s, copr_cache_hit_ratio: 0.36}, tikv_task:{proc max:23ms, min:0s, p80:7ms, p95:23ms, iters:50, tasks:11}, scan_detail: {total_process_keys: 4984, total_process_keys_size: 936122, total_keys: 6222, rocksdb: {delete_skipped_count: 0, key_skipped_count: 4984, block: {cache_hit_count: 4966, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":599374.3333333333,"Actual Rows":606222,"Task":"root","Total Time":124522576,"Max Time":124522576,"Access Object":"","Operation Info":"data:Selection_100","Execution Info":"time:124.5ms, loops:592, cop_task: {num: 9, max: 154.3ms, min: 22ms, avg: 52ms, p95: 154.3ms, rpc_num: 9, rpc_time: 468.1ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":38950303,"Plans":[{"Node Id":"Selection","Plan Rows":599374.3333333333,"Actual Rows":606222,"Task":"cop[tikv]","Total Time":4423000000,"Max Time":656000000,"Access Object":"","Operation Info":"ge(new0107.lineitem.l_shipdate, 1993-01-01 00:00:00.000000), lt(new0107.lineitem.l_shipdate, 1994-01-01 00:00:00.000000)","Execution Info":"tikv_task:{proc max:656ms, min:273ms, p80:546ms, p95:656ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4155000000,"Max Time":600000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:600ms, min:257ms, p80:522ms, p95:600ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  s_name,  s_address from  supplier,  nation where  s_suppkey in (   select    ps_suppkey   from    partsupp   where    ps_partkey in (     select      p_partkey     from      part     where      p_name like 'green%'    )    and ps_availqty > (     select      0.5 * sum(l_quantity)     from      lineitem     where      l_partkey = ps_partkey      and l_suppkey = ps_suppkey      and l_shipdate >= '1993-01-01'      and l_shipdate < date_add('1993-01-01', interval '1' year)    )  )  and s_nationkey = n_nationkey  and n_name = 'ALGERIA' order by  s_name;

{"Node Id":"Projection","Plan Rows":100,"Actual Rows":100,"Task":"root","Total Time":3355851941,"Max Time":3355851941,"Access Object":"","Operation Info":"new0107.supplier.s_acctbal, new0107.supplier.s_name, new0107.nation.n_name, new0107.part.p_partkey, new0107.part.p_mfgr, new0107.supplier.s_address, new0107.supplier.s_phone, new0107.supplier.s_comment","Execution Info":"time:3.36s, loops:2, Concurrency:OFF","Disk":0,"Memory":29808,"Plans":[{"Node Id":"TopN","Plan Rows":100,"Actual Rows":100,"Task":"root","Total Time":3355828744,"Max Time":3355828744,"Access Object":"","Operation Info":"new0107.supplier.s_acctbal:desc, new0107.nation.n_name, new0107.supplier.s_name, new0107.part.p_partkey, offset:0, count:100","Execution Info":"time:3.36s, loops:2","Disk":0,"Memory":143768,"Plans":[{"Node Id":"Projection","Plan Rows":160,"Actual Rows":485,"Task":"root","Total Time":3296742526,"Max Time":3296742526,"Access Object":"","Operation Info":"new0107.part.p_partkey, new0107.part.p_mfgr, new0107.supplier.s_name, new0107.supplier.s_address, new0107.supplier.s_phone, new0107.supplier.s_acctbal, new0107.supplier.s_comment, new0107.nation.n_name","Execution Info":"time:3.3s, loops:2, Concurrency:OFF","Disk":0,"Memory":139888,"Plans":[{"Node Id":"HashJoin","Plan Rows":160,"Actual Rows":485,"Task":"root","Total Time":3296728443,"Max Time":3296728443,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.part.p_partkey, new0107.partsupp.ps_partkey) eq(new0107.partsupp.ps_supplycost, Column#50)]","Execution Info":"time:3.3s, loops:2, build_hash_table:{total:3.29s, fetch:2.54s, build:747.4ms}, probe:{concurrency:5, total:16.5s, max:3.3s, probe:1.85ms, fetch:16.5s}","Disk":0,"Memory":5761024,"Plans":[{"Node Id":"IndexJoin","Plan Rows":203.08692120227457,"Actual Rows":649,"Task":"root","Total Time":2160655911,"Max Time":2160655911,"Access Object":"","Operation Info":"inner join, inner:TableReader_53, outer key:new0107.partsupp.ps_partkey, inner key:new0107.part.p_partkey, equal cond:eq(new0107.partsupp.ps_partkey, new0107.part.p_partkey)","Execution Info":"time:2.16s, loops:2, inner:{total:5.26s, concurrency:5, task:14, construct:818.1ms, fetch:4.44s, build:369.7µs}, probe:326.8ms","Disk":0,"Memory":59543288,"Plans":[{"Node Id":"HashJoin","Plan Rows":200,"Actual Rows":160240,"Task":"root","Total Time":1412881812,"Max Time":1412881812,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.supplier.s_suppkey, new0107.partsupp.ps_suppkey)]","Execution Info":"time:1.41s, loops:160, build_hash_table:{total:193.7ms, fetch:193.2ms, build:538.7µs}, probe:{concurrency:5, total:6.81s, max:1.43s, probe:3.07s, fetch:3.74s}","Disk":0,"Memory":598488,"Plans":[{"Node Id":"HashJoin","Plan Rows":2.5,"Actual Rows":2003,"Task":"root","Total Time":193322516,"Max Time":193322516,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.supplier.s_nationkey)]","Execution Info":"time:193.3ms, loops:7, build_hash_table:{total:150.1ms, fetch:150.1ms, build:8.81µs}, probe:{concurrency:5, total:887.9ms, max:182.7ms, probe:34.6ms, fetch:853.2ms}","Disk":0,"Memory":1000,"Plans":[{"Node Id":"HashJoin","Plan Rows":0.00625,"Actual Rows":5,"Task":"root","Total Time":150058709,"Max Time":150058709,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.region.r_regionkey, new0107.nation.n_regionkey)]","Execution Info":"time:150.1ms, loops:2, build_hash_table:{total:53ms, fetch:53ms, build:8.09µs}, probe:{concurrency:5, total:567.5ms, max:126.7ms, probe:23.4µs, fetch:567.5ms}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":0.005,"Actual Rows":1,"Task":"root","Total Time":52939691,"Max Time":52939691,"Access Object":"","Operation Info":"data:Selection_84","Execution Info":"time:52.9ms, loops:2, cop_task: {num: 1, max: 119.1ms, proc_keys: 5, rpc_num: 1, rpc_time: 119.1ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":246,"Plans":[{"Node Id":"Selection","Plan Rows":0.005,"Actual Rows":1,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"eq(new0107.region.r_name, \"ASIA\")","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 5, total_process_keys_size: 559, total_keys: 6, rocksdb: {delete_skipped_count: 0, key_skipped_count: 5, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":5,"Actual Rows":5,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:region, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":25,"Actual Rows":25,"Task":"root","Total Time":60591894,"Max Time":60591894,"Access Object":"","Operation Info":"data:TableFullScan_81","Execution Info":"time:60.6ms, loops:2, cop_task: {num: 1, max: 123.9ms, proc_keys: 25, rpc_num: 1, rpc_time: 123.9ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":1006,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:nation, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":10000,"Actual Rows":10000,"Task":"root","Total Time":47186250,"Max Time":47186250,"Access Object":"","Operation Info":"data:TableFullScan_86","Execution Info":"time:47.2ms, loops:11, cop_task: {num: 1, max: 89.3ms, proc_keys: 0, rpc_num: 1, rpc_time: 89.3ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":2086986,"Plans":[{"Node Id":"TableFullScan","Plan Rows":10000,"Actual Rows":10000,"Task":"cop[tikv]","Total Time":20000000,"Max Time":20000000,"Access Object":"","Operation Info":"table:supplier, keep order:false","Execution Info":"tikv_task:{time:20ms, loops:14}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":800000,"Actual Rows":800000,"Task":"root","Total Time":720760459,"Max Time":720760459,"Access Object":"","Operation Info":"data:TableFullScan_88","Execution Info":"time:720.8ms, loops:783, cop_task: {num: 2, max: 955.9ms, min: 717.4ms, avg: 836.6ms, p95: 955.9ms, max_proc_keys: 529029, p95_proc_keys: 529029, tot_proc: 1.17s, tot_wait: 1ms, rpc_num: 2, rpc_time: 1.67s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":44825519,"Plans":[{"Node Id":"TableFullScan","Plan Rows":800000,"Actual Rows":800000,"Task":"cop[tikv]","Total Time":940000000,"Max Time":555000000,"Access Object":"","Operation Info":"table:partsupp, keep order:false","Execution Info":"tikv_task:{proc max:555ms, min:385ms, p80:555ms, p95:555ms, iters:790, tasks:2}, scan_detail: {total_process_keys: 800000, total_process_keys_size: 150608990, total_keys: 800002, rocksdb: {delete_skipped_count: 0, key_skipped_count: 800000, block: {cache_hit_count: 2473, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":0.008704000000000002,"Actual Rows":486,"Task":"root","Total Time":3782873326,"Max Time":571948463,"Access Object":"","Operation Info":"data:Selection_52","Execution Info":"time:3.78s, loops:27, cop_task: {num: 14, max: 486.5ms, min: 31.6ms, avg: 210ms, p95: 486.5ms, max_proc_keys: 18949, p95_proc_keys: 18949, tot_proc: 1.69s, tot_wait: 77ms, rpc_num: 27, rpc_time: 5.85s, copr_cache_hit_ratio: 0.29}","Disk":0,"Memory":0,"Plans":[{"Node Id":"Selection","Plan Rows":0.008704000000000002,"Actual Rows":486,"Task":"cop[tikv]","Total Time":1617000000,"Max Time":386000000,"Access Object":"","Operation Info":"eq(new0107.part.p_size, 30), like(new0107.part.p_type, \"%STEEL\", 92)","Execution Info":"tikv_task:{proc max:386ms, min:5ms, p80:270ms, p95:386ms, iters:176, tasks:14}, scan_detail: {total_process_keys: 115038, total_process_keys_size: 18802077, total_keys: 143212, rocksdb: {delete_skipped_count: 0, key_skipped_count: 95847, block: {cache_hit_count: 133171, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":118080,"Task":"cop[tikv]","Total Time":1603000000,"Max Time":384000000,"Access Object":"","Operation Info":"table:part, range: decided by [new0107.partsupp.ps_partkey], keep order:false","Execution Info":"tikv_task:{proc max:384ms, min:5ms, p80:266ms, p95:384ms, iters:176, tasks:14}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"Selection","Plan Rows":160,"Actual Rows":118067,"Task":"root","Total Time":2453758191,"Max Time":2453758191,"Access Object":"","Operation Info":"not(isnull(Column#50))","Execution Info":"time:2.45s, loops:117","Disk":0,"Memory":50944,"Plans":[{"Node Id":"HashAgg","Plan Rows":200,"Actual Rows":118067,"Task":"root","Total Time":2399236528,"Max Time":2399236528,"Access Object":"","Operation Info":"group by:new0107.partsupp.ps_partkey, funcs:min(new0107.partsupp.ps_supplycost)-\u003eColumn#50, funcs:firstrow(new0107.partsupp.ps_partkey)-\u003enew0107.partsupp.ps_partkey","Execution Info":"time:2.4s, loops:120, partial_worker:{wall_time:2.044776409s, concurrency:5, task_num:160, tot_wait:9.004934355s, tot_exec:648.482317ms, tot_time:9.797125957s, max:2.043321279s, p95:2.043321279s}, final_worker:{wall_time:3.290899669s, concurrency:5, task_num:25, tot_wait:10.39037252s, tot_exec:4.193609118s, tot_time:14.584008106s, max:3.286198578s, p95:3.286198578s}","Disk":0,"Memory":38201648,"Plans":[{"Node Id":"HashJoin","Plan Rows":200,"Actual Rows":160240,"Task":"root","Total Time":1916996436,"Max Time":1916996436,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.supplier.s_suppkey, new0107.partsupp.ps_suppkey)]","Execution Info":"time:1.92s, loops:161, build_hash_table:{total:195.4ms, fetch:194.8ms, build:543.6µs}, probe:{concurrency:5, total:9.54s, max:1.91s, probe:3.37s, fetch:6.18s}","Disk":0,"Memory":26400,"Plans":[{"Node Id":"HashJoin","Plan Rows":2.5,"Actual Rows":2003,"Task":"root","Total Time":195216515,"Max Time":195216515,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.supplier.s_nationkey)]","Execution Info":"time:195.2ms, loops:7, build_hash_table:{total:168.8ms, fetch:168.8ms, build:7.07µs}, probe:{concurrency:5, total:949.8ms, max:190.4ms, probe:22.5ms, fetch:927.3ms}","Disk":0,"Memory":372,"Plans":[{"Node Id":"HashJoin","Plan Rows":0.00625,"Actual Rows":5,"Task":"root","Total Time":168809474,"Max Time":168809474,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.region.r_regionkey, new0107.nation.n_regionkey)]","Execution Info":"time:168.8ms, loops:2, build_hash_table:{total:145.3ms, fetch:145.3ms, build:6.85µs}, probe:{concurrency:5, total:819.8ms, max:168.6ms, probe:22µs, fetch:819.8ms}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":0.005,"Actual Rows":1,"Task":"root","Total Time":145271110,"Max Time":145271110,"Access Object":"","Operation Info":"data:Selection_117","Execution Info":"time:145.3ms, loops:2, cop_task: {num: 1, max: 81.6ms, proc_keys: 5, rpc_num: 1, rpc_time: 81.6ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":242,"Plans":[{"Node Id":"Selection","Plan Rows":0.005,"Actual Rows":1,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"eq(new0107.region.r_name, \"ASIA\")","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 5, total_process_keys_size: 559, total_keys: 6, rocksdb: {delete_skipped_count: 0, key_skipped_count: 5, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":5,"Actual Rows":5,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:region, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":25,"Actual Rows":25,"Task":"root","Total Time":125745423,"Max Time":125745423,"Access Object":"","Operation Info":"data:TableFullScan_114","Execution Info":"time:125.7ms, loops:2, cop_task: {num: 1, max: 83.1ms, proc_keys: 25, rpc_num: 1, rpc_time: 83.1ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":613,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:nation, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":10000,"Actual Rows":10000,"Task":"root","Total Time":117982452,"Max Time":117982452,"Access Object":"","Operation Info":"data:TableFullScan_119","Execution Info":"time:118ms, loops:11, cop_task: {num: 1, max: 76.5ms, proc_keys: 0, rpc_num: 1, rpc_time: 76.5ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":160504,"Plans":[{"Node Id":"TableFullScan","Plan Rows":10000,"Actual Rows":10000,"Task":"cop[tikv]","Total Time":7000000,"Max Time":7000000,"Access Object":"","Operation Info":"table:supplier, keep order:false","Execution Info":"tikv_task:{time:7ms, loops:14}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":800000,"Actual Rows":800000,"Task":"root","Total Time":975003812,"Max Time":975003812,"Access Object":"","Operation Info":"data:TableFullScan_121","Execution Info":"time:975ms, loops:783, cop_task: {num: 2, max: 1.27s, min: 869.3ms, avg: 1.07s, p95: 1.27s, max_proc_keys: 529029, p95_proc_keys: 529029, tot_proc: 1.44s, tot_wait: 1ms, rpc_num: 2, rpc_time: 2.14s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":44825519,"Plans":[{"Node Id":"TableFullScan","Plan Rows":800000,"Actual Rows":800000,"Task":"cop[tikv]","Total Time":1166000000,"Max Time":627000000,"Access Object":"","Operation Info":"table:partsupp, keep order:false","Execution Info":"tikv_task:{proc max:627ms, min:539ms, p80:627ms, p95:627ms, iters:790, tasks:2}, scan_detail: {total_process_keys: 800000, total_process_keys_size: 150608990, total_keys: 800002, rocksdb: {delete_skipped_count: 0, key_skipped_count: 800000, block: {cache_hit_count: 2473, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  s_acctbal,  s_name,  n_name,  p_partkey,  p_mfgr,  s_address,  s_phone,  s_comment from  part,  supplier,  partsupp,  nation,  region where  p_partkey = ps_partkey  and s_suppkey = ps_suppkey  and p_size = 30  and p_type like '%STEEL'  and s_nationkey = n_nationkey  and n_regionkey = r_regionkey  and r_name = 'ASIA'  and ps_supplycost = (   select    min(ps_supplycost)   from    partsupp,    supplier,    nation,    region   where    p_partkey = ps_partkey    and s_suppkey = ps_suppkey    and s_nationkey = n_nationkey    and n_regionkey = r_regionkey    and r_name = 'ASIA'  ) order by  s_acctbal desc,  n_name,  s_name,  p_partkey limit 100;

{"Node Id":"Sort","Plan Rows":149568,"Actual Rows":33,"Task":"root","Total Time":5868743005,"Max Time":5868743005,"Access Object":"","Operation Info":"Column#19:desc, Column#18:desc","Execution Info":"time:5.87s, loops:2","Disk":0,"Memory":3720,"Plans":[{"Node Id":"Projection","Plan Rows":149568,"Actual Rows":33,"Task":"root","Total Time":5868669123,"Max Time":5868669123,"Access Object":"","Operation Info":"Column#18, Column#19","Execution Info":"time:5.87s, loops:6, Concurrency:5","Disk":0,"Memory":7440,"Plans":[{"Node Id":"HashAgg","Plan Rows":149568,"Actual Rows":33,"Task":"root","Total Time":5845348183,"Max Time":5845348183,"Access Object":"","Operation Info":"group by:Column#18, funcs:count(1)-\u003eColumn#19, funcs:firstrow(Column#18)-\u003eColumn#18","Execution Info":"time:5.85s, loops:6, partial_worker:{wall_time:5.845189175s, concurrency:5, task_num:150, tot_wait:29.202539218s, tot_exec:21.422854ms, tot_time:29.224075846s, max:5.844837886s, p95:5.844837886s}, final_worker:{wall_time:5.845482908s, concurrency:5, task_num:25, tot_wait:29.22505089s, tot_exec:171.677µs, tot_time:29.225230024s, max:5.845096766s, p95:5.845096766s}","Disk":0,"Memory":229472,"Plans":[{"Node Id":"HashAgg","Plan Rows":149568,"Actual Rows":150000,"Task":"root","Total Time":5844452635,"Max Time":5844452635,"Access Object":"","Operation Info":"group by:new0107.customer.c_custkey, funcs:count(new0107.orders.o_orderkey)-\u003eColumn#18","Execution Info":"time:5.84s, loops:151, partial_worker:{wall_time:5.674208235s, concurrency:5, task_num:1021, tot_wait:23.489331686s, tot_exec:2.555771589s, tot_time:26.860299737s, max:5.576926207s, p95:5.576926207s}, final_worker:{wall_time:5.844664423s, concurrency:5, task_num:25, tot_wait:27.210486777s, tot_exec:1.669678765s, tot_time:28.880204115s, max:5.844384232s, p95:5.844384232s}","Disk":0,"Memory":59677373,"Plans":[{"Node Id":"HashJoin","Plan Rows":878254.1720154043,"Actual Rows":1040728,"Task":"root","Total Time":5148456900,"Max Time":5148456900,"Access Object":"","Operation Info":"left outer join, equal:[eq(new0107.customer.c_custkey, new0107.orders.o_custkey)]","Execution Info":"time:5.15s, loops:1022, build_hash_table:{total:942.3ms, fetch:18ms, build:924.4ms}, probe:{concurrency:5, total:23.9s, max:4.78s, probe:16.3s, fetch:7.64s}","Disk":0,"Memory":1262960,"Plans":[{"Node Id":"TableReader","Plan Rows":150000,"Actual Rows":150000,"Task":"root","Total Time":2193985,"Max Time":2193985,"Access Object":"","Operation Info":"data:TableFullScan_17","Execution Info":"time:2.19ms, loops:148, cop_task: {num: 1, max: 129.2ms, proc_keys: 0, rpc_num: 1, rpc_time: 129.2ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":1202294,"Plans":[{"Node Id":"TableFullScan","Plan Rows":150000,"Actual Rows":150000,"Task":"cop[tikv]","Total Time":89000000,"Max Time":89000000,"Access Object":"","Operation Info":"table:customer, keep order:false","Execution Info":"tikv_task:{time:89ms, loops:151}","Disk":0,"Memory":0,"Plans":[]}]},{"Node Id":"TableReader","Plan Rows":875724.8,"Actual Rows":990658,"Task":"root","Total Time":1141448385,"Max Time":1141448385,"Access Object":"","Operation Info":"data:Selection_20","Execution Info":"time:1.14s, loops:980, cop_task: {num: 2, max: 1.7s, min: 1.26s, avg: 1.48s, p95: 1.7s, max_proc_keys: 583494, p95_proc_keys: 583494, tot_proc: 2.37s, tot_wait: 4ms, rpc_num: 2, rpc_time: 2.96s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":71780726,"Plans":[{"Node Id":"Selection","Plan Rows":875724.8,"Actual Rows":990658,"Task":"cop[tikv]","Total Time":2117000000,"Max Time":1204000000,"Access Object":"","Operation Info":"not(like(new0107.orders.o_comment, \"%pending%deposits%\", 92))","Execution Info":"tikv_task:{proc max:1.2s, min:913ms, p80:1.2s, p95:1.2s, iters:987, tasks:2}, scan_detail: {total_process_keys: 1001472, total_process_keys_size: 151717700, total_keys: 1001474, rocksdb: {delete_skipped_count: 0, key_skipped_count: 1001472, block: {cache_hit_count: 2529, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":1377000000,"Max Time":777000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:777ms, min:600ms, p80:777ms, p95:777ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  c_count,  count(*) as custdist from  (   select    c_custkey,    count(o_orderkey) as c_count   from    customer left outer join orders on     c_custkey = o_custkey     and o_comment not like '%pending%deposits%'   group by    c_custkey  ) c_orders group by  c_count order by  custdist desc,  c_count desc;

{"Node Id":"Sort","Plan Rows":149568,"Actual Rows":33,"Task":"root","Total Time":5953678531,"Max Time":5953678531,"Access Object":"","Operation Info":"Column#19:desc, Column#18:desc","Execution Info":"time:5.95s, loops:2","Disk":0,"Memory":3720,"Plans":[{"Node Id":"Projection","Plan Rows":149568,"Actual Rows":33,"Task":"root","Total Time":5953624931,"Max Time":5953624931,"Access Object":"","Operation Info":"Column#18, Column#19","Execution Info":"time:5.95s, loops:6, Concurrency:5","Disk":0,"Memory":7440,"Plans":[{"Node Id":"HashAgg","Plan Rows":149568,"Actual Rows":33,"Task":"root","Total Time":5948683977,"Max Time":5948683977,"Access Object":"","Operation Info":"group by:Column#18, funcs:count(1)-\u003eColumn#19, funcs:firstrow(Column#18)-\u003eColumn#18","Execution Info":"time:5.95s, loops:6, partial_worker:{wall_time:5.914810632s, concurrency:5, task_num:150, tot_wait:28.733267119s, tot_exec:141.584863ms, tot_time:28.874984892s, max:5.864939115s, p95:5.864939115s}, final_worker:{wall_time:5.948781427s, concurrency:5, task_num:25, tot_wait:29.676578796s, tot_exec:235.718µs, tot_time:29.676824258s, max:5.942150455s, p95:5.942150455s}","Disk":0,"Memory":229420,"Plans":[{"Node Id":"HashAgg","Plan Rows":149568,"Actual Rows":150000,"Task":"root","Total Time":5752166791,"Max Time":5752166791,"Access Object":"","Operation Info":"group by:new0107.customer.c_custkey, funcs:count(new0107.orders.o_orderkey)-\u003eColumn#18","Execution Info":"time:5.75s, loops:151, partial_worker:{wall_time:5.227598565s, concurrency:5, task_num:1021, tot_wait:22.374868558s, tot_exec:2.20930816s, tot_time:25.468555549s, max:5.217033754s, p95:5.217033754s}, final_worker:{wall_time:5.752373455s, concurrency:5, task_num:25, tot_wait:25.019532437s, tot_exec:2.937122506s, tot_time:27.956681539s, max:5.733952153s, p95:5.733952153s}","Disk":0,"Memory":59675539,"Plans":[{"Node Id":"HashJoin","Plan Rows":878254.1720154043,"Actual Rows":1040728,"Task":"root","Total Time":4829205161,"Max Time":4829205161,"Access Object":"","Operation Info":"left outer join, equal:[eq(new0107.customer.c_custkey, new0107.orders.o_custkey)]","Execution Info":"time:4.83s, loops:1022, build_hash_table:{total:1.7s, fetch:1.29s, build:407.3ms}, probe:{concurrency:5, total:21.3s, max:4.37s, probe:11.9s, fetch:9.42s}","Disk":0,"Memory":1262960,"Plans":[{"Node Id":"TableReader","Plan Rows":150000,"Actual Rows":150000,"Task":"root","Total Time":133269423,"Max Time":133269423,"Access Object":"","Operation Info":"data:TableFullScan_17","Execution Info":"time:133.3ms, loops:148, cop_task: {num: 1, max: 160.5ms, proc_keys: 0, rpc_num: 1, rpc_time: 160.4ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":1202294,"Plans":[{"Node Id":"TableFullScan","Plan Rows":150000,"Actual Rows":150000,"Task":"cop[tikv]","Total Time":89000000,"Max Time":89000000,"Access Object":"","Operation Info":"table:customer, keep order:false","Execution Info":"tikv_task:{time:89ms, loops:151}","Disk":0,"Memory":0,"Plans":[]}]},{"Node Id":"TableReader","Plan Rows":875724.8,"Actual Rows":990658,"Task":"root","Total Time":1232579296,"Max Time":1232579296,"Access Object":"","Operation Info":"data:Selection_20","Execution Info":"time:1.23s, loops:980, cop_task: {num: 2, max: 1.72s, min: 1.19s, avg: 1.46s, p95: 1.72s, max_proc_keys: 583494, p95_proc_keys: 583494, tot_proc: 2.37s, tot_wait: 6ms, rpc_num: 2, rpc_time: 2.92s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":71780726,"Plans":[{"Node Id":"Selection","Plan Rows":875724.8,"Actual Rows":990658,"Task":"cop[tikv]","Total Time":2090000000,"Max Time":1254000000,"Access Object":"","Operation Info":"not(like(new0107.orders.o_comment, \"%pending%deposits%\", 92))","Execution Info":"tikv_task:{proc max:1.25s, min:836ms, p80:1.25s, p95:1.25s, iters:987, tasks:2}, scan_detail: {total_process_keys: 1001472, total_process_keys_size: 151717700, total_keys: 1001474, rocksdb: {delete_skipped_count: 0, key_skipped_count: 1001472, block: {cache_hit_count: 2529, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":1245000000,"Max Time":740000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:740ms, min:505ms, p80:740ms, p95:740ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  c_count,  count(*) as custdist from  (   select    c_custkey,    count(o_orderkey) as c_count   from    customer left outer join orders on     c_custkey = o_custkey     and o_comment not like '%pending%deposits%'   group by    c_custkey  ) c_orders group by  c_count order by  custdist desc,  c_count desc;

{"Node Id":"Projection","Plan Rows":10,"Actual Rows":10,"Task":"root","Total Time":3963169076,"Max Time":3963169076,"Access Object":"","Operation Info":"new0107.lineitem.l_orderkey, Column#35, new0107.orders.o_orderdate, new0107.orders.o_shippriority","Execution Info":"time:3.96s, loops:2, Concurrency:OFF","Disk":0,"Memory":2544,"Plans":[{"Node Id":"TopN","Plan Rows":10,"Actual Rows":10,"Task":"root","Total Time":3963159238,"Max Time":3963159238,"Access Object":"","Operation Info":"Column#35:desc, new0107.orders.o_orderdate, offset:0, count:10","Execution Info":"time:3.96s, loops:2","Disk":0,"Memory":78560,"Plans":[{"Node Id":"HashAgg","Plan Rows":535774.7154925766,"Actual Rows":7662,"Task":"root","Total Time":3961684174,"Max Time":3961684174,"Access Object":"","Operation Info":"group by:Column#48, Column#49, Column#50, funcs:sum(Column#44)-\u003eColumn#35, funcs:firstrow(Column#45)-\u003enew0107.orders.o_orderdate, funcs:firstrow(Column#46)-\u003enew0107.orders.o_shippriority, funcs:firstrow(Column#47)-\u003enew0107.lineitem.l_orderkey","Execution Info":"time:3.96s, loops:11, partial_worker:{wall_time:3.956383771s, concurrency:5, task_num:21, tot_wait:19.482308392s, tot_exec:23.143386ms, tot_time:19.50665626s, max:3.902617624s, p95:3.902617624s}, final_worker:{wall_time:3.963277399s, concurrency:5, task_num:25, tot_wait:19.562087684s, tot_exec:33.636661ms, tot_time:19.595751343s, max:3.919494731s, p95:3.919494731s}","Disk":0,"Memory":3608856,"Plans":[{"Node Id":"Projection","Plan Rows":795926.0114565928,"Actual Rows":20167,"Task":"root","Total Time":3899002738,"Max Time":3899002738,"Access Object":"","Operation Info":"mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount))-\u003eColumn#44, new0107.orders.o_orderdate, new0107.orders.o_shippriority, new0107.lineitem.l_orderkey, new0107.lineitem.l_orderkey, new0107.orders.o_orderdate, new0107.orders.o_shippriority","Execution Info":"time:3.9s, loops:22, Concurrency:5","Disk":0,"Memory":676236,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":795926.0114565928,"Actual Rows":20167,"Task":"root","Total Time":3898272566,"Max Time":3898272566,"Access Object":"","Operation Info":"inner join, inner:IndexLookUp_27, outer key:new0107.orders.o_orderkey, inner key:new0107.lineitem.l_orderkey, equal cond:eq(new0107.orders.o_orderkey, new0107.lineitem.l_orderkey)","Execution Info":"time:3.9s, loops:22, inner:{total:14s, concurrency:5, task:12, construct:446.7ms, fetch:13.1s, build:264ms, join:454.3ms}","Disk":0,"Memory":23045951,"Plans":[{"Node Id":"HashJoin","Plan Rows":196313.84992738423,"Actual Rows":96277,"Task":"root","Total Time":521161411,"Max Time":521161411,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.customer.c_custkey, new0107.orders.o_custkey)]","Execution Info":"time:521.2ms, loops:100, build_hash_table:{total:150.2ms, fetch:101.2ms, build:49ms}, probe:{concurrency:5, total:5.36s, max:1.07s, probe:4.37s, fetch:988.6ms}","Disk":0,"Memory":977192,"Plans":[{"Node Id":"TableReader","Plan Rows":21774,"Actual Rows":29752,"Task":"root","Total Time":100812139,"Max Time":100812139,"Access Object":"","Operation Info":"data:Selection_75","Execution Info":"time:100.8ms, loops:30, cop_task: {num: 1, max: 82.3ms, proc_keys: 0, rpc_num: 1, rpc_time: 82.3ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":778280,"Plans":[{"Node Id":"Selection","Plan Rows":21774,"Actual Rows":29752,"Task":"cop[tikv]","Total Time":164000000,"Max Time":164000000,"Access Object":"","Operation Info":"eq(new0107.customer.c_mktsegment, \"AUTOMOBILE\")","Execution Info":"tikv_task:{time:164ms, loops:151}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":150000,"Actual Rows":150000,"Task":"cop[tikv]","Total Time":138000000,"Max Time":138000000,"Access Object":"","Operation Info":"table:customer, keep order:false","Execution Info":"tikv_task:{time:138ms, loops:151}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":730104.3924398626,"Actual Rows":484673,"Task":"root","Total Time":90373592,"Max Time":90373592,"Access Object":"","Operation Info":"data:Selection_72","Execution Info":"time:90.4ms, loops:473, cop_task: {num: 2, max: 82.1ms, min: 76.4ms, avg: 79.2ms, p95: 82.1ms, rpc_num: 2, rpc_time: 158.5ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":15547598,"Plans":[{"Node Id":"Selection","Plan Rows":730104.3924398626,"Actual Rows":484673,"Task":"cop[tikv]","Total Time":937000000,"Max Time":541000000,"Access Object":"","Operation Info":"lt(new0107.orders.o_orderdate, 1995-03-13 00:00:00.000000)","Execution Info":"tikv_task:{proc max:541ms, min:396ms, p80:541ms, p95:541ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":885000000,"Max Time":510000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:510ms, min:375ms, p80:510ms, p95:510ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"IndexLookUp","Plan Rows":4.054354859583279,"Actual Rows":20167,"Task":"root","Total Time":12059284482,"Max Time":1892223317,"Access Object":"","Operation Info":"","Execution Info":"time:12.1s, loops:39, index_task: {total_time: 7s, fetch_handle: 7s, build: 129.1µs, wait: 155.4µs}, table_task: {total_time: 14.5s, num: 57, concurrency: 60}","Disk":0,"Memory":159360,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":7.484459202807528,"Actual Rows":384652,"Task":"cop[tikv]","Total Time":3536000000,"Max Time":793000000,"Access Object":"","Operation Info":"table:lineitem, index:PRIMARY(L_ORDERKEY, L_LINENUMBER), range: decided by [eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)], keep order:false","Execution Info":"time:6.82s, loops:413, cop_task: {num: 22, max: 896.9ms, min: 85.1ms, avg: 365.3ms, p95: 887.3ms, max_proc_keys: 85173, p95_proc_keys: 81034, tot_proc: 4.24s, tot_wait: 802ms, rpc_num: 43, rpc_time: 15.7s, copr_cache_hit_ratio: 0.00}, tikv_task:{proc max:793ms, min:9ms, p80:276ms, p95:587ms, iters:478, tasks:22}, scan_detail: {total_process_keys: 384652, total_process_keys_size: 20386556, total_keys: 480929, rocksdb: {delete_skipped_count: 0, key_skipped_count: 384652, block: {cache_hit_count: 385413, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]},{"Node Id":"Selection","Plan Rows":4.054354859583279,"Actual Rows":20167,"Task":"cop[tikv]","Total Time":3289000000,"Max Time":171000000,"Access Object":"","Operation Info":"gt(new0107.lineitem.l_shipdate, 1995-03-13 00:00:00.000000)","Execution Info":"time:13.2s, loops:118, cop_task: {num: 78, max: 302.6ms, min: 17.9ms, avg: 140.6ms, p95: 296.4ms, max_proc_keys: 20480, p95_proc_keys: 16501, tot_proc: 3.5s, tot_wait: 353ms, rpc_num: 155, rpc_time: 21.9s, copr_cache_hit_ratio: 0.19}, tikv_task:{proc max:171ms, min:0s, p80:79ms, p95:141ms, iters:730, tasks:78}, scan_detail: {total_process_keys: 355275, total_process_keys_size: 69793299, total_keys: 425132, rocksdb: {delete_skipped_count: 0, key_skipped_count: 344840, block: {cache_hit_count: 271007, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRowIDScan","Plan Rows":7.484459202807528,"Actual Rows":384652,"Task":"cop[tikv]","Total Time":3253000000,"Max Time":170000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:170ms, min:0s, p80:78ms, p95:141ms, iters:730, tasks:78}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  l_orderkey,  sum(l_extendedprice * (1 - l_discount)) as revenue,  o_orderdate,  o_shippriority from  customer,  orders,  lineitem where  c_mktsegment = 'AUTOMOBILE'  and c_custkey = o_custkey  and l_orderkey = o_orderkey  and o_orderdate < '1995-03-13'  and l_shipdate > '1995-03-13' group by  l_orderkey,  o_orderdate,  o_shippriority order by  revenue desc,  o_orderdate limit 10;

{"Node Id":"Projection","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":1187810052,"Max Time":1187810052,"Access Object":"","Operation Info":"div(mul(100.00, Column#27), Column#28)-\u003eColumn#29","Execution Info":"time:1.19s, loops:2, Concurrency:OFF","Disk":0,"Memory":2856,"Plans":[{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":1139896586,"Max Time":1139896586,"Access Object":"","Operation Info":"funcs:sum(Column#31)-\u003eColumn#27, funcs:sum(Column#32)-\u003eColumn#28","Execution Info":"time:1.14s, loops:2, partial_worker:{wall_time:1.139875713s, concurrency:5, task_num:54, tot_wait:5.686893273s, tot_exec:9.939681ms, tot_time:5.696877055s, max:1.139386722s, p95:1.139386722s}, final_worker:{wall_time:1.177496058s, concurrency:5, task_num:5, tot_wait:5.80972654s, tot_exec:34.551µs, tot_time:5.809766532s, max:1.17699639s, p95:1.17699639s}","Disk":0,"Memory":972200,"Plans":[{"Node Id":"Projection","Plan Rows":51569.74907482635,"Actual Rows":51967,"Task":"root","Total Time":1139017118,"Max Time":1139017118,"Access Object":"","Operation Info":"case(like(new0107.part.p_type, PROMO%, 92), mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount)), 0)-\u003eColumn#31, mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount))-\u003eColumn#32","Execution Info":"time:1.14s, loops:55, Concurrency:5","Disk":0,"Memory":1059912,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":51569.74907482635,"Actual Rows":51967,"Task":"root","Total Time":1126522932,"Max Time":1126522932,"Access Object":"","Operation Info":"inner join, inner:TableReader_12, outer key:new0107.lineitem.l_partkey, inner key:new0107.part.p_partkey, equal cond:eq(new0107.lineitem.l_partkey, new0107.part.p_partkey)","Execution Info":"time:1.13s, loops:55, inner:{total:3.45s, concurrency:5, task:10, construct:254.3ms, fetch:2.7s, build:35.8ms, join:488.9ms}","Disk":0,"Memory":13582872,"Plans":[{"Node Id":"TableReader","Plan Rows":50785.88888888899,"Actual Rows":51967,"Task":"root","Total Time":117550731,"Max Time":117550731,"Access Object":"","Operation Info":"data:Selection_23","Execution Info":"time:117.6ms, loops:56, cop_task: {num: 9, max: 91.7ms, min: 61.2ms, avg: 76.8ms, p95: 91.7ms, rpc_num: 9, rpc_time: 691.1ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":1265869,"Plans":[{"Node Id":"Selection","Plan Rows":50785.88888888899,"Actual Rows":51967,"Task":"cop[tikv]","Total Time":4273000000,"Max Time":589000000,"Access Object":"","Operation Info":"ge(new0107.lineitem.l_shipdate, 1996-12-01 00:00:00.000000), lt(new0107.lineitem.l_shipdate, 1997-01-01 00:00:00.000000)","Execution Info":"tikv_task:{proc max:589ms, min:269ms, p80:517ms, p95:589ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4063000000,"Max Time":562000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:562ms, min:255ms, p80:494ms, p95:562ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":1,"Actual Rows":50199,"Task":"root","Total Time":2318836431,"Max Time":414241285,"Access Object":"","Operation Info":"data:TableRangeScan_11","Execution Info":"time:2.32s, loops:66, cop_task: {num: 10, max: 375.7ms, min: 61.7ms, avg: 162ms, p95: 375.7ms, max_proc_keys: 18228, p95_proc_keys: 18228, tot_proc: 721ms, tot_wait: 62ms, rpc_num: 19, rpc_time: 3.16s, copr_cache_hit_ratio: 0.10}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":50199,"Task":"cop[tikv]","Total Time":606000000,"Max Time":233000000,"Access Object":"","Operation Info":"table:part, range: decided by [new0107.lineitem.l_partkey], keep order:false","Execution Info":"tikv_task:{proc max:233ms, min:1ms, p80:190ms, p95:233ms, iters:90, tasks:10}, scan_detail: {total_process_keys: 50070, total_process_keys_size: 8184852, total_keys: 53197, rocksdb: {delete_skipped_count: 0, key_skipped_count: 6497, block: {cache_hit_count: 60870, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}
/*PLACEHOLDER*/ select  100.00 * sum(case   when p_type like 'PROMO%'    then l_extendedprice * (1 - l_discount)   else 0  end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from  lineitem,  part where  l_partkey = p_partkey  and l_shipdate >= '1996-12-01'  and l_shipdate < date_add('1996-12-01', interval '1' month);
 drop view revenue0;

{"Node Id":"Sort","Plan Rows":149568,"Actual Rows":33,"Task":"root","Total Time":5120145348,"Max Time":5120145348,"Access Object":"","Operation Info":"Column#19:desc, Column#18:desc","Execution Info":"time:5.12s, loops:2","Disk":0,"Memory":3720,"Plans":[{"Node Id":"Projection","Plan Rows":149568,"Actual Rows":33,"Task":"root","Total Time":5120095351,"Max Time":5120095351,"Access Object":"","Operation Info":"Column#18, Column#19","Execution Info":"time:5.12s, loops:6, Concurrency:5","Disk":0,"Memory":7440,"Plans":[{"Node Id":"HashAgg","Plan Rows":149568,"Actual Rows":33,"Task":"root","Total Time":5119868269,"Max Time":5119868269,"Access Object":"","Operation Info":"group by:Column#18, funcs:count(1)-\u003eColumn#19, funcs:firstrow(Column#18)-\u003eColumn#18","Execution Info":"time:5.12s, loops:6, partial_worker:{wall_time:5.119798788s, concurrency:5, task_num:150, tot_wait:25.577123084s, tot_exec:20.544095ms, tot_time:25.597777096s, max:5.119588758s, p95:5.119588758s}, final_worker:{wall_time:5.120037118s, concurrency:5, task_num:25, tot_wait:25.598587576s, tot_exec:185.364µs, tot_time:25.59877999s, max:5.119787763s, p95:5.119787763s}","Disk":0,"Memory":229524,"Plans":[{"Node Id":"HashAgg","Plan Rows":149568,"Actual Rows":150000,"Task":"root","Total Time":5119254812,"Max Time":5119254812,"Access Object":"","Operation Info":"group by:new0107.customer.c_custkey, funcs:count(new0107.orders.o_orderkey)-\u003eColumn#18","Execution Info":"time:5.12s, loops:151, partial_worker:{wall_time:4.692253514s, concurrency:5, task_num:1021, tot_wait:20.755177066s, tot_exec:2.43455743s, tot_time:23.288867445s, max:4.679748247s, p95:4.679748247s}, final_worker:{wall_time:5.119414999s, concurrency:5, task_num:25, tot_wait:23.376610233s, tot_exec:1.67697901s, tot_time:25.053634975s, max:5.119264042s, p95:5.119264042s}","Disk":0,"Memory":59673061,"Plans":[{"Node Id":"HashJoin","Plan Rows":878254.1720154043,"Actual Rows":1040728,"Task":"root","Total Time":4589293013,"Max Time":4589293013,"Access Object":"","Operation Info":"left outer join, equal:[eq(new0107.customer.c_custkey, new0107.orders.o_custkey)]","Execution Info":"time:4.59s, loops:1022, build_hash_table:{total:654ms, fetch:289.6ms, build:364.4ms}, probe:{concurrency:5, total:21.7s, max:4.39s, probe:13.6s, fetch:8.08s}","Disk":0,"Memory":1262960,"Plans":[{"Node Id":"TableReader","Plan Rows":150000,"Actual Rows":150000,"Task":"root","Total Time":288356113,"Max Time":288356113,"Access Object":"","Operation Info":"data:TableFullScan_17","Execution Info":"time:288.4ms, loops:148, cop_task: {num: 1, max: 287.9ms, proc_keys: 0, rpc_num: 1, rpc_time: 287.9ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":1202298,"Plans":[{"Node Id":"TableFullScan","Plan Rows":150000,"Actual Rows":150000,"Task":"cop[tikv]","Total Time":89000000,"Max Time":89000000,"Access Object":"","Operation Info":"table:customer, keep order:false","Execution Info":"tikv_task:{time:89ms, loops:151}","Disk":0,"Memory":0,"Plans":[]}]},{"Node Id":"TableReader","Plan Rows":875724.8,"Actual Rows":990658,"Task":"root","Total Time":1530907407,"Max Time":1530907407,"Access Object":"","Operation Info":"data:Selection_20","Execution Info":"time:1.53s, loops:980, cop_task: {num: 2, max: 1.67s, min: 1.42s, avg: 1.54s, p95: 1.67s, max_proc_keys: 583494, p95_proc_keys: 583494, tot_proc: 2.23s, tot_wait: 2ms, rpc_num: 2, rpc_time: 3.09s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":71780726,"Plans":[{"Node Id":"Selection","Plan Rows":875724.8,"Actual Rows":990658,"Task":"cop[tikv]","Total Time":1979000000,"Max Time":1056000000,"Access Object":"","Operation Info":"not(like(new0107.orders.o_comment, \"%pending%deposits%\", 92))","Execution Info":"tikv_task:{proc max:1.06s, min:923ms, p80:1.06s, p95:1.06s, iters:987, tasks:2}, scan_detail: {total_process_keys: 1001472, total_process_keys_size: 151717700, total_keys: 1001474, rocksdb: {delete_skipped_count: 0, key_skipped_count: 1001472, block: {cache_hit_count: 2529, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":1212000000,"Max Time":612000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:612ms, min:600ms, p80:612ms, p95:612ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  c_count,  count(*) as custdist from  (   select    c_custkey,    count(o_orderkey) as c_count   from    customer left outer join orders on     c_custkey = o_custkey     and o_comment not like '%pending%deposits%'   group by    c_custkey  ) c_orders group by  c_count order by  custdist desc,  c_count desc;

{"Node Id":"Projection","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":1417848642,"Max Time":1417848642,"Access Object":"","Operation Info":"div(mul(100.00, Column#27), Column#28)-\u003eColumn#29","Execution Info":"time:1.42s, loops:2, Concurrency:OFF","Disk":0,"Memory":2856,"Plans":[{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":1417817728,"Max Time":1417817728,"Access Object":"","Operation Info":"funcs:sum(Column#31)-\u003eColumn#27, funcs:sum(Column#32)-\u003eColumn#28","Execution Info":"time:1.42s, loops:2, partial_worker:{wall_time:1.4175742s, concurrency:5, task_num:54, tot_wait:6.943672578s, tot_exec:80.544767ms, tot_time:7.024265126s, max:1.416572584s, p95:1.416572584s}, final_worker:{wall_time:1.417896025s, concurrency:5, task_num:5, tot_wait:7.084822818s, tot_exec:53.396µs, tot_time:7.084880149s, max:1.417042319s, p95:1.417042319s}","Disk":0,"Memory":955816,"Plans":[{"Node Id":"Projection","Plan Rows":51569.74907482635,"Actual Rows":51967,"Task":"root","Total Time":1401445812,"Max Time":1401445812,"Access Object":"","Operation Info":"case(like(new0107.part.p_type, PROMO%, 92), mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount)), 0)-\u003eColumn#31, mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount))-\u003eColumn#32","Execution Info":"time:1.4s, loops:55, Concurrency:5","Disk":0,"Memory":1043528,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":51569.74907482635,"Actual Rows":51967,"Task":"root","Total Time":1380354634,"Max Time":1380354634,"Access Object":"","Operation Info":"inner join, inner:TableReader_12, outer key:new0107.lineitem.l_partkey, inner key:new0107.part.p_partkey, equal cond:eq(new0107.lineitem.l_partkey, new0107.part.p_partkey)","Execution Info":"time:1.38s, loops:55, inner:{total:5.32s, concurrency:5, task:10, construct:643.9ms, fetch:3.96s, build:83.7ms, join:713.2ms}","Disk":0,"Memory":13617378,"Plans":[{"Node Id":"TableReader","Plan Rows":50785.88888888899,"Actual Rows":51967,"Task":"root","Total Time":107987003,"Max Time":107987003,"Access Object":"","Operation Info":"data:Selection_23","Execution Info":"time:108ms, loops:56, cop_task: {num: 9, max: 90.7ms, min: 82.3ms, avg: 86.7ms, p95: 90.7ms, rpc_num: 9, rpc_time: 780.4ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":1252717,"Plans":[{"Node Id":"Selection","Plan Rows":50785.88888888899,"Actual Rows":51967,"Task":"cop[tikv]","Total Time":4273000000,"Max Time":589000000,"Access Object":"","Operation Info":"ge(new0107.lineitem.l_shipdate, 1996-12-01 00:00:00.000000), lt(new0107.lineitem.l_shipdate, 1997-01-01 00:00:00.000000)","Execution Info":"tikv_task:{proc max:589ms, min:269ms, p80:517ms, p95:589ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4063000000,"Max Time":562000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:562ms, min:255ms, p80:494ms, p95:562ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":1,"Actual Rows":50278,"Task":"root","Total Time":3784955297,"Max Time":527857789,"Access Object":"","Operation Info":"data:TableRangeScan_11","Execution Info":"time:3.78s, loops:65, cop_task: {num: 10, max: 496.4ms, min: 84ms, avg: 233.3ms, p95: 496.4ms, max_proc_keys: 18303, p95_proc_keys: 18303, tot_proc: 1.26s, tot_wait: 337ms, rpc_num: 19, rpc_time: 4.54s, copr_cache_hit_ratio: 0.20}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":50278,"Task":"cop[tikv]","Total Time":592000000,"Max Time":212000000,"Access Object":"","Operation Info":"table:part, range: decided by [new0107.lineitem.l_partkey], keep order:false","Execution Info":"tikv_task:{proc max:212ms, min:1ms, p80:149ms, p95:212ms, iters:89, tasks:10}, scan_detail: {total_process_keys: 49887, total_process_keys_size: 8155002, total_keys: 53015, rocksdb: {delete_skipped_count: 0, key_skipped_count: 6488, block: {cache_hit_count: 60496, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}
/*PLACEHOLDER*/ select  100.00 * sum(case   when p_type like 'PROMO%'    then l_extendedprice * (1 - l_discount)   else 0  end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from  lineitem,  part where  l_partkey = p_partkey  and l_shipdate >= '1996-12-01'  and l_shipdate < date_add('1996-12-01', interval '1' month);

{"Node Id":"Sort","Plan Rows":1,"Actual Rows":5,"Task":"root","Total Time":3274717299,"Max Time":3274717299,"Access Object":"","Operation Info":"new0107.orders.o_orderpriority","Execution Info":"time:3.27s, loops:2","Disk":0,"Memory":4000,"Plans":[{"Node Id":"Projection","Plan Rows":1,"Actual Rows":5,"Task":"root","Total Time":3274669228,"Max Time":3274669228,"Access Object":"","Operation Info":"new0107.orders.o_orderpriority, Column#27","Execution Info":"time:3.27s, loops:5, Concurrency:OFF","Disk":0,"Memory":1000,"Plans":[{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":5,"Task":"root","Total Time":3274659747,"Max Time":3274659747,"Access Object":"","Operation Info":"group by:new0107.orders.o_orderpriority, funcs:count(1)-\u003eColumn#27, funcs:firstrow(new0107.orders.o_orderpriority)-\u003enew0107.orders.o_orderpriority","Execution Info":"time:3.27s, loops:5, partial_worker:{wall_time:3.274607839s, concurrency:5, task_num:34, tot_wait:16.309092584s, tot_exec:11.789217ms, tot_time:16.320962587s, max:3.273750608s, p95:3.273750608s}, final_worker:{wall_time:0s, concurrency:5, task_num:20, tot_wait:16.372345718s, tot_exec:329.76µs, tot_time:16.372682139s, max:3.274554679s, p95:3.274554679s}","Disk":0,"Memory":377511,"Plans":[{"Node Id":"IndexJoin","Plan Rows":33363.37979381443,"Actual Rows":34630,"Task":"root","Total Time":3207443200,"Max Time":3207443200,"Access Object":"","Operation Info":"semi join, inner:IndexLookUp_18, outer key:new0107.orders.o_orderkey, inner key:new0107.lineitem.l_orderkey, equal cond:eq(new0107.orders.o_orderkey, new0107.lineitem.l_orderkey)","Execution Info":"time:3.21s, loops:35, inner:{total:11.4s, concurrency:5, task:10, construct:169.8ms, fetch:11.2s, build:56.2ms}, probe:75.1ms","Disk":0,"Memory":10382184,"Plans":[{"Node Id":"TableReader","Plan Rows":41704.22474226803,"Actual Rows":37775,"Task":"root","Total Time":145423747,"Max Time":145423747,"Access Object":"","Operation Info":"data:Selection_39","Execution Info":"time:145.4ms, loops:42, cop_task: {num: 2, max: 146.4ms, min: 143.5ms, avg: 144.9ms, p95: 146.4ms, rpc_num: 2, rpc_time: 289.8ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":1261365,"Plans":[{"Node Id":"Selection","Plan Rows":41704.22474226803,"Actual Rows":37775,"Task":"cop[tikv]","Total Time":934000000,"Max Time":559000000,"Access Object":"","Operation Info":"ge(new0107.orders.o_orderdate, 1995-01-01 00:00:00.000000), lt(new0107.orders.o_orderdate, 1995-04-01 00:00:00.000000)","Execution Info":"tikv_task:{proc max:559ms, min:375ms, p80:559ms, p95:559ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":871000000,"Max Time":519000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:519ms, min:352ms, p80:519ms, p95:519ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"IndexLookUp","Plan Rows":4.054354859583279,"Actual Rows":95181,"Task":"root","Total Time":11035357131,"Max Time":1800146607,"Access Object":"","Operation Info":"","Execution Info":"time:11s, loops:109, index_task: {total_time: 4.93s, fetch_handle: 4.93s, build: 61.5µs, wait: 83.4µs}, table_task: {total_time: 12.4s, num: 31, concurrency: 50}","Disk":0,"Memory":208496,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":5.067943574479099,"Actual Rows":150845,"Task":"cop[tikv]","Total Time":1410000000,"Max Time":364000000,"Access Object":"","Operation Info":"table:lineitem, index:PRIMARY(L_ORDERKEY, L_LINENUMBER), range: decided by [eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)], keep order:false","Execution Info":"time:4.92s, loops:172, cop_task: {num: 14, max: 901.3ms, min: 118.5ms, avg: 454.8ms, p95: 901.3ms, max_proc_keys: 33223, p95_proc_keys: 33223, tot_proc: 4.42s, tot_wait: 1.02s, rpc_num: 27, rpc_time: 12.6s, copr_cache_hit_ratio: 0.14}, tikv_task:{proc max:364ms, min:2ms, p80:209ms, p95:364ms, iters:209, tasks:14}, scan_detail: {total_process_keys: 148981, total_process_keys_size: 7895993, total_keys: 186294, rocksdb: {delete_skipped_count: 0, key_skipped_count: 148981, block: {cache_hit_count: 149385, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]},{"Node Id":"Selection","Plan Rows":4.054354859583279,"Actual Rows":95181,"Task":"cop[tikv]","Total Time":1561000000,"Max Time":182000000,"Access Object":"","Operation Info":"lt(new0107.lineitem.l_commitdate, new0107.lineitem.l_receiptdate)","Execution Info":"time:12.2s, loops:143, cop_task: {num: 43, max: 846.4ms, min: 37.6ms, avg: 344.6ms, p95: 770.7ms, max_proc_keys: 16008, p95_proc_keys: 9525, tot_proc: 10.2s, tot_wait: 3.01s, rpc_num: 85, rpc_time: 29.5s, copr_cache_hit_ratio: 0.40}, tikv_task:{proc max:182ms, min:0s, p80:48ms, p95:135ms, iters:339, tasks:43}, scan_detail: {total_process_keys: 124935, total_process_keys_size: 24542233, total_keys: 150958, rocksdb: {delete_skipped_count: 0, key_skipped_count: 120800, block: {cache_hit_count: 100864, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRowIDScan","Plan Rows":5.067943574479099,"Actual Rows":150845,"Task":"cop[tikv]","Total Time":1531000000,"Max Time":179000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:179ms, min:0s, p80:48ms, p95:133ms, iters:339, tasks:43}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  o_orderpriority,  count(*) as order_count from  orders where  o_orderdate >= '1995-01-01'  and o_orderdate < date_add('1995-01-01', interval '3' month)  and exists (   select    *   from    lineitem   where    l_orderkey = o_orderkey    and l_commitdate < l_receiptdate  ) group by  o_orderpriority order by  o_orderpriority;

{"Node Id":"Projection","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":2295920231,"Max Time":2295920231,"Access Object":"","Operation Info":"div(mul(100.00, Column#27), Column#28)-\u003eColumn#29","Execution Info":"time:2.3s, loops:2, Concurrency:OFF","Disk":0,"Memory":2856,"Plans":[{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":2295883031,"Max Time":2295883031,"Access Object":"","Operation Info":"funcs:sum(Column#31)-\u003eColumn#27, funcs:sum(Column#32)-\u003eColumn#28","Execution Info":"time:2.3s, loops:2, partial_worker:{wall_time:2.295826723s, concurrency:5, task_num:54, tot_wait:11.186620008s, tot_exec:9.367611ms, tot_time:11.196034688s, max:2.239224399s, p95:2.239224399s}, final_worker:{wall_time:2.296017117s, concurrency:5, task_num:5, tot_wait:11.288104557s, tot_exec:48.711µs, tot_time:11.288157924s, max:2.257673981s, p95:2.257673981s}","Disk":0,"Memory":980424,"Plans":[{"Node Id":"Projection","Plan Rows":51569.74907482635,"Actual Rows":51967,"Task":"root","Total Time":2238533697,"Max Time":2238533697,"Access Object":"","Operation Info":"case(like(new0107.part.p_type, PROMO%, 92), mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount)), 0)-\u003eColumn#31, mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount))-\u003eColumn#32","Execution Info":"time:2.24s, loops:55, Concurrency:5","Disk":0,"Memory":1084520,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":51569.74907482635,"Actual Rows":51967,"Task":"root","Total Time":2141418769,"Max Time":2141418769,"Access Object":"","Operation Info":"inner join, inner:TableReader_12, outer key:new0107.lineitem.l_partkey, inner key:new0107.part.p_partkey, equal cond:eq(new0107.lineitem.l_partkey, new0107.part.p_partkey)","Execution Info":"time:2.14s, loops:55, inner:{total:6.35s, concurrency:5, task:10, construct:267.6ms, fetch:5.62s, build:89.1ms, join:463.1ms}","Disk":0,"Memory":13614931,"Plans":[{"Node Id":"TableReader","Plan Rows":50785.88888888899,"Actual Rows":51967,"Task":"root","Total Time":158906791,"Max Time":158906791,"Access Object":"","Operation Info":"data:Selection_23","Execution Info":"time:158.9ms, loops:56, cop_task: {num: 9, max: 151.2ms, min: 71.1ms, avg: 121.8ms, p95: 151.2ms, rpc_num: 9, rpc_time: 1.1s, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":1265869,"Plans":[{"Node Id":"Selection","Plan Rows":50785.88888888899,"Actual Rows":51967,"Task":"cop[tikv]","Total Time":4273000000,"Max Time":589000000,"Access Object":"","Operation Info":"ge(new0107.lineitem.l_shipdate, 1996-12-01 00:00:00.000000), lt(new0107.lineitem.l_shipdate, 1997-01-01 00:00:00.000000)","Execution Info":"tikv_task:{proc max:589ms, min:269ms, p80:517ms, p95:589ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4063000000,"Max Time":562000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:562ms, min:255ms, p80:494ms, p95:562ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":1,"Actual Rows":50219,"Task":"root","Total Time":5507292803,"Max Time":1251231841,"Access Object":"","Operation Info":"data:TableRangeScan_11","Execution Info":"time:5.51s, loops:65, cop_task: {num: 10, max: 1.22s, min: 96ms, avg: 495.3ms, p95: 1.22s, max_proc_keys: 18269, p95_proc_keys: 18269, tot_proc: 3.55s, tot_wait: 915ms, rpc_num: 19, rpc_time: 9.81s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":50219,"Task":"cop[tikv]","Total Time":599000000,"Max Time":185000000,"Access Object":"","Operation Info":"table:part, range: decided by [new0107.lineitem.l_partkey], keep order:false","Execution Info":"tikv_task:{proc max:185ms, min:1ms, p80:181ms, p95:185ms, iters:89, tasks:10}, scan_detail: {total_process_keys: 50219, total_process_keys_size: 8209043, total_keys: 53276, rocksdb: {delete_skipped_count: 0, key_skipped_count: 6374, block: {cache_hit_count: 61025, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}
/*PLACEHOLDER*/ select  100.00 * sum(case   when p_type like 'PROMO%'    then l_extendedprice * (1 - l_discount)   else 0  end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from  lineitem,  part where  l_partkey = p_partkey  and l_shipdate >= '1996-12-01'  and l_shipdate < date_add('1996-12-01', interval '1' month);

{"Node Id":"Projection","Plan Rows":10,"Actual Rows":10,"Task":"root","Total Time":4080073454,"Max Time":4080073454,"Access Object":"","Operation Info":"new0107.lineitem.l_orderkey, Column#35, new0107.orders.o_orderdate, new0107.orders.o_shippriority","Execution Info":"time:4.08s, loops:2, Concurrency:OFF","Disk":0,"Memory":2544,"Plans":[{"Node Id":"TopN","Plan Rows":10,"Actual Rows":10,"Task":"root","Total Time":4080061095,"Max Time":4080061095,"Access Object":"","Operation Info":"Column#35:desc, new0107.orders.o_orderdate, offset:0, count:10","Execution Info":"time:4.08s, loops:2","Disk":0,"Memory":78560,"Plans":[{"Node Id":"HashAgg","Plan Rows":535774.7154925766,"Actual Rows":7662,"Task":"root","Total Time":4078833298,"Max Time":4078833298,"Access Object":"","Operation Info":"group by:Column#48, Column#49, Column#50, funcs:sum(Column#44)-\u003eColumn#35, funcs:firstrow(Column#45)-\u003enew0107.orders.o_orderdate, funcs:firstrow(Column#46)-\u003enew0107.orders.o_shippriority, funcs:firstrow(Column#47)-\u003enew0107.lineitem.l_orderkey","Execution Info":"time:4.08s, loops:11, partial_worker:{wall_time:3.969175532s, concurrency:5, task_num:22, tot_wait:19.559261683s, tot_exec:66.01183ms, tot_time:19.628176882s, max:3.950298924s, p95:3.950298924s}, final_worker:{wall_time:4.097026678s, concurrency:5, task_num:25, tot_wait:20.154778003s, tot_exec:51.777935ms, tot_time:20.206572289s, max:4.064938072s, p95:4.064938072s}","Disk":0,"Memory":3538793,"Plans":[{"Node Id":"Projection","Plan Rows":795926.0114565928,"Actual Rows":20167,"Task":"root","Total Time":3907151332,"Max Time":3907151332,"Access Object":"","Operation Info":"mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount))-\u003eColumn#44, new0107.orders.o_orderdate, new0107.orders.o_shippriority, new0107.lineitem.l_orderkey, new0107.lineitem.l_orderkey, new0107.orders.o_orderdate, new0107.orders.o_shippriority","Execution Info":"time:3.91s, loops:23, Concurrency:5","Disk":0,"Memory":570072,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":795926.0114565928,"Actual Rows":20167,"Task":"root","Total Time":3905838405,"Max Time":3905838405,"Access Object":"","Operation Info":"inner join, inner:IndexLookUp_27, outer key:new0107.orders.o_orderkey, inner key:new0107.lineitem.l_orderkey, equal cond:eq(new0107.orders.o_orderkey, new0107.lineitem.l_orderkey)","Execution Info":"time:3.91s, loops:23, inner:{total:14.3s, concurrency:5, task:12, construct:764.1ms, fetch:13.2s, build:89.3ms, join:271ms}","Disk":0,"Memory":23045823,"Plans":[{"Node Id":"HashJoin","Plan Rows":196313.84992738423,"Actual Rows":96277,"Task":"root","Total Time":366534864,"Max Time":366534864,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.customer.c_custkey, new0107.orders.o_custkey)]","Execution Info":"time:366.5ms, loops:100, build_hash_table:{total:93.4ms, fetch:81.4ms, build:12ms}, probe:{concurrency:5, total:2.02s, max:417.9ms, probe:1.01s, fetch:1.01s}","Disk":0,"Memory":977192,"Plans":[{"Node Id":"TableReader","Plan Rows":21774,"Actual Rows":29752,"Task":"root","Total Time":73862482,"Max Time":73862482,"Access Object":"","Operation Info":"data:Selection_75","Execution Info":"time:73.9ms, loops:30, cop_task: {num: 1, max: 63.8ms, proc_keys: 0, rpc_num: 1, rpc_time: 63.8ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":778276,"Plans":[{"Node Id":"Selection","Plan Rows":21774,"Actual Rows":29752,"Task":"cop[tikv]","Total Time":164000000,"Max Time":164000000,"Access Object":"","Operation Info":"eq(new0107.customer.c_mktsegment, \"AUTOMOBILE\")","Execution Info":"tikv_task:{time:164ms, loops:151}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":150000,"Actual Rows":150000,"Task":"cop[tikv]","Total Time":138000000,"Max Time":138000000,"Access Object":"","Operation Info":"table:customer, keep order:false","Execution Info":"tikv_task:{time:138ms, loops:151}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":730104.3924398626,"Actual Rows":484673,"Task":"root","Total Time":77251711,"Max Time":77251711,"Access Object":"","Operation Info":"data:Selection_72","Execution Info":"time:77.3ms, loops:473, cop_task: {num: 2, max: 77.5ms, min: 70.9ms, avg: 74.2ms, p95: 77.5ms, rpc_num: 2, rpc_time: 148.3ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":15547598,"Plans":[{"Node Id":"Selection","Plan Rows":730104.3924398626,"Actual Rows":484673,"Task":"cop[tikv]","Total Time":937000000,"Max Time":541000000,"Access Object":"","Operation Info":"lt(new0107.orders.o_orderdate, 1995-03-13 00:00:00.000000)","Execution Info":"tikv_task:{proc max:541ms, min:396ms, p80:541ms, p95:541ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":885000000,"Max Time":510000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:510ms, min:375ms, p80:510ms, p95:510ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"IndexLookUp","Plan Rows":4.054354859583279,"Actual Rows":20167,"Task":"root","Total Time":13039938367,"Max Time":2865540847,"Access Object":"","Operation Info":"","Execution Info":"time:13s, loops:39, index_task: {total_time: 6.63s, fetch_handle: 6.63s, build: 92.1µs, wait: 133.2µs}, table_task: {total_time: 22.3s, num: 57, concurrency: 60}","Disk":0,"Memory":160384,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":7.484459202807528,"Actual Rows":384652,"Task":"cop[tikv]","Total Time":3591000000,"Max Time":834000000,"Access Object":"","Operation Info":"table:lineitem, index:PRIMARY(L_ORDERKEY, L_LINENUMBER), range: decided by [eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)], keep order:false","Execution Info":"time:6.56s, loops:412, cop_task: {num: 22, max: 1.61s, min: 47.1ms, avg: 360.5ms, p95: 1.51s, max_proc_keys: 87691, p95_proc_keys: 83957, tot_proc: 6.18s, tot_wait: 640ms, rpc_num: 43, rpc_time: 15.8s, copr_cache_hit_ratio: 0.05}, tikv_task:{proc max:834ms, min:1ms, p80:203ms, p95:762ms, iters:474, tasks:22}, scan_detail: {total_process_keys: 383124, total_process_keys_size: 20305572, total_keys: 479026, rocksdb: {delete_skipped_count: 0, key_skipped_count: 383124, block: {cache_hit_count: 383913, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]},{"Node Id":"Selection","Plan Rows":4.054354859583279,"Actual Rows":20167,"Task":"cop[tikv]","Total Time":3604000000,"Max Time":304000000,"Access Object":"","Operation Info":"gt(new0107.lineitem.l_shipdate, 1995-03-13 00:00:00.000000)","Execution Info":"time:21.9s, loops:118, cop_task: {num: 76, max: 971.9ms, min: 25.1ms, avg: 309.9ms, p95: 807.8ms, max_proc_keys: 20480, p95_proc_keys: 20480, tot_proc: 16.1s, tot_wait: 2.74s, rpc_num: 151, rpc_time: 47.1s, copr_cache_hit_ratio: 0.24}, tikv_task:{proc max:304ms, min:0s, p80:88ms, p95:173ms, iters:716, tasks:76}, scan_detail: {total_process_keys: 354673, total_process_keys_size: 69675827, total_keys: 424455, rocksdb: {delete_skipped_count: 0, key_skipped_count: 344256, block: {cache_hit_count: 270663, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRowIDScan","Plan Rows":7.484459202807528,"Actual Rows":384652,"Task":"cop[tikv]","Total Time":3570000000,"Max Time":302000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:302ms, min:0s, p80:87ms, p95:168ms, iters:716, tasks:76}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  l_orderkey,  sum(l_extendedprice * (1 - l_discount)) as revenue,  o_orderdate,  o_shippriority from  customer,  orders,  lineitem where  c_mktsegment = 'AUTOMOBILE'  and c_custkey = o_custkey  and l_orderkey = o_orderkey  and o_orderdate < '1995-03-13'  and l_shipdate > '1995-03-13' group by  l_orderkey,  o_orderdate,  o_shippriority order by  revenue desc,  o_orderdate limit 10;

{"Node Id":"Sort","Plan Rows":8.43216,"Actual Rows":18333,"Task":"root","Total Time":2732814754,"Max Time":2732814754,"Access Object":"","Operation Info":"Column#23:desc, new0107.part.p_brand, new0107.part.p_type, new0107.part.p_size","Execution Info":"time:2.73s, loops:19","Disk":0,"Memory":1362656,"Plans":[{"Node Id":"Projection","Plan Rows":8.43216,"Actual Rows":18333,"Task":"root","Total Time":2587856312,"Max Time":2587856312,"Access Object":"","Operation Info":"new0107.part.p_brand, new0107.part.p_type, new0107.part.p_size, Column#23","Execution Info":"time:2.59s, loops:19, Concurrency:OFF","Disk":0,"Memory":1328656,"Plans":[{"Node Id":"HashAgg","Plan Rows":8.43216,"Actual Rows":18333,"Task":"root","Total Time":2587774916,"Max Time":2587774916,"Access Object":"","Operation Info":"group by:new0107.part.p_brand, new0107.part.p_size, new0107.part.p_type, funcs:count(distinct new0107.partsupp.ps_suppkey)-\u003eColumn#23, funcs:firstrow(new0107.part.p_brand)-\u003enew0107.part.p_brand, funcs:firstrow(new0107.part.p_type)-\u003enew0107.part.p_type, funcs:firstrow(new0107.part.p_size)-\u003enew0107.part.p_size","Execution Info":"time:2.59s, loops:19","Disk":0,"Memory":8761243,"Plans":[{"Node Id":"HashJoin","Plan Rows":45665.63769293257,"Actual Rows":119078,"Task":"root","Total Time":2054533122,"Max Time":2054533122,"Access Object":"","Operation Info":"anti semi join, equal:[eq(new0107.partsupp.ps_suppkey, new0107.supplier.s_suppkey)]","Execution Info":"time:2.05s, loops:119, build_hash_table:{total:154.3ms, fetch:154.3ms, build:11.6µs}, probe:{concurrency:5, total:12.6s, max:2.53s, probe:962.8ms, fetch:11.6s}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"Projection","Plan Rows":57082.04711616571,"Actual Rows":119136,"Task":"root","Total Time":2388080076,"Max Time":2388080076,"Access Object":"","Operation Info":"new0107.partsupp.ps_suppkey, new0107.part.p_brand, new0107.part.p_type, new0107.part.p_size","Execution Info":"time:2.39s, loops:120, Concurrency:5","Disk":0,"Memory":760800,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":57082.04711616571,"Actual Rows":119136,"Task":"root","Total Time":2414033077,"Max Time":2414033077,"Access Object":"","Operation Info":"inner join, inner:IndexReader_33, outer key:new0107.part.p_partkey, inner key:new0107.partsupp.ps_partkey, equal cond:eq(new0107.part.p_partkey, new0107.partsupp.ps_partkey)","Execution Info":"time:2.41s, loops:120, inner:{total:6.73s, concurrency:5, task:9, construct:25.8ms, fetch:5.61s, build:56ms, join:1.09s}","Disk":0,"Memory":9857301,"Plans":[{"Node Id":"TableReader","Plan Rows":14053.599999999999,"Actual Rows":29784,"Task":"root","Total Time":96586667,"Max Time":96586667,"Access Object":"","Operation Info":"data:Selection_60","Execution Info":"time:96.6ms, loops:35, cop_task: {num: 1, max: 93.2ms, proc_keys: 0, rpc_num: 1, rpc_time: 93.2ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":1817788,"Plans":[{"Node Id":"Selection","Plan Rows":14053.599999999999,"Actual Rows":29784,"Task":"cop[tikv]","Total Time":324000000,"Max Time":324000000,"Access Object":"","Operation Info":"in(new0107.part.p_size, 48, 19, 12, 4, 41, 7, 21, 39), ne(new0107.part.p_brand, \"Brand#34\"), not(like(new0107.part.p_type, \"LARGE BRUSHED%\", 92))","Execution Info":"tikv_task:{time:324ms, loops:200}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":200000,"Actual Rows":200000,"Task":"cop[tikv]","Total Time":261000000,"Max Time":261000000,"Access Object":"","Operation Info":"table:part, keep order:false","Execution Info":"tikv_task:{time:261ms, loops:200}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"IndexReader","Plan Rows":4.061738424045491,"Actual Rows":119136,"Task":"root","Total Time":5491902655,"Max Time":969424614,"Access Object":"","Operation Info":"index:IndexRangeScan_32","Execution Info":"time:5.49s, loops:133, cop_task: {num: 9, max: 904ms, min: 59.4ms, avg: 564.9ms, p95: 904ms, max_proc_keys: 53228, p95_proc_keys: 53228, tot_proc: 3.96s, tot_wait: 717ms, rpc_num: 17, rpc_time: 10.1s, copr_cache_hit_ratio: 0.11}","Disk":0,"Memory":68404,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":4.061738424045491,"Actual Rows":119136,"Task":"cop[tikv]","Total Time":884000000,"Max Time":392000000,"Access Object":"","Operation Info":"table:partsupp, index:PRIMARY(PS_PARTKEY, PS_SUPPKEY), range: decided by [eq(new0107.partsupp.ps_partkey, new0107.part.p_partkey)], keep order:false","Execution Info":"tikv_task:{proc max:392ms, min:6ms, p80:175ms, p95:392ms, iters:159, tasks:9}, scan_detail: {total_process_keys: 117188, total_process_keys_size: 6210964, total_keys: 146485, rocksdb: {delete_skipped_count: 0, key_skipped_count: 117188, block: {cache_hit_count: 117275, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"TableReader","Plan Rows":8000,"Actual Rows":4,"Task":"root","Total Time":154218898,"Max Time":154218898,"Access Object":"","Operation Info":"data:Selection_67","Execution Info":"time:154.2ms, loops:2, cop_task: {num: 1, max: 141.9ms, proc_keys: 0, rpc_num: 1, rpc_time: 141.9ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":572,"Plans":[{"Node Id":"Selection","Plan Rows":8000,"Actual Rows":4,"Task":"cop[tikv]","Total Time":16000000,"Max Time":16000000,"Access Object":"","Operation Info":"like(new0107.supplier.s_comment, \"%Customer%Complaints%\", 92)","Execution Info":"tikv_task:{time:16ms, loops:14}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":10000,"Actual Rows":10000,"Task":"cop[tikv]","Total Time":9000000,"Max Time":9000000,"Access Object":"","Operation Info":"table:supplier, keep order:false","Execution Info":"tikv_task:{time:9ms, loops:14}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  p_brand,  p_type,  p_size,  count(distinct ps_suppkey) as supplier_cnt from  partsupp,  part where  p_partkey = ps_partkey  and p_brand <> 'Brand#34'  and p_type not like 'LARGE BRUSHED%'  and p_size in (48, 19, 12, 4, 41, 7, 21, 39)  and ps_suppkey not in (   select    s_suppkey   from    supplier   where    s_comment like '%Customer%Complaints%'  ) group by  p_brand,  p_type,  p_size order by  supplier_cnt desc,  p_brand,  p_type,  p_size;
create view revenue0 (supplier_no, total_revenue) as  select   l_suppkey,   sum(l_extendedprice * (1 - l_discount))  from   lineitem  where   l_shipdate >= '1997-07-01'   and l_shipdate < date_add('1997-07-01', interval '3' month)  group by   l_suppkey;

{"Node Id":"Projection","Plan Rows":6.4,"Actual Rows":100,"Task":"root","Total Time":6238850531,"Max Time":6238850531,"Access Object":"","Operation Info":"new0107.supplier.s_name, Column#72","Execution Info":"time:6.24s, loops:2, Concurrency:OFF","Disk":0,"Memory":4728,"Plans":[{"Node Id":"TopN","Plan Rows":6.4,"Actual Rows":100,"Task":"root","Total Time":6238841188,"Max Time":6238841188,"Access Object":"","Operation Info":"Column#72:desc, new0107.supplier.s_name, offset:0, count:100","Execution Info":"time:6.24s, loops:2","Disk":0,"Memory":12344,"Plans":[{"Node Id":"HashAgg","Plan Rows":6.4,"Actual Rows":414,"Task":"root","Total Time":6238604046,"Max Time":6238604046,"Access Object":"","Operation Info":"group by:new0107.supplier.s_name, funcs:count(1)-\u003eColumn#72, funcs:firstrow(new0107.supplier.s_name)-\u003enew0107.supplier.s_name","Execution Info":"time:6.24s, loops:6, partial_worker:{wall_time:6.238435392s, concurrency:5, task_num:3, tot_wait:31.177243683s, tot_exec:1.67018ms, tot_time:31.179087792s, max:6.235903808s, p95:6.235903808s}, final_worker:{wall_time:0s, concurrency:5, task_num:15, tot_wait:31.182118258s, tot_exec:854.66µs, tot_time:31.182978764s, max:6.236726601s, p95:6.236726601s}","Disk":0,"Memory":353184,"Plans":[{"Node Id":"IndexJoin","Plan Rows":2611.2567138461536,"Actual Rows":2750,"Task":"root","Total Time":6235022488,"Max Time":6235022488,"Access Object":"","Operation Info":"anti semi join, inner:IndexLookUp_39, outer key:new0107.lineitem.l_orderkey, inner key:new0107.lineitem.l_orderkey, equal cond:eq(new0107.lineitem.l_orderkey, new0107.lineitem.l_orderkey), other cond:ne(new0107.lineitem.l_suppkey, new0107.lineitem.l_suppkey)","Execution Info":"time:6.24s, loops:4, inner:{total:8.96s, concurrency:5, task:10, construct:149ms, fetch:8.57s, build:237.3ms}, probe:245.1ms","Disk":0,"Memory":15302979,"Plans":[{"Node Id":"IndexJoin","Plan Rows":3264.070892307692,"Actual Rows":49059,"Task":"root","Total Time":4965128866,"Max Time":4965128866,"Access Object":"","Operation Info":"semi join, inner:IndexLookUp_80, outer key:new0107.lineitem.l_orderkey, inner key:new0107.lineitem.l_orderkey, equal cond:eq(new0107.lineitem.l_orderkey, new0107.lineitem.l_orderkey), other cond:ne(new0107.lineitem.l_suppkey, new0107.lineitem.l_suppkey), ne(new0107.lineitem.l_suppkey, new0107.supplier.s_suppkey)","Execution Info":"time:4.97s, loops:53, inner:{total:9s, concurrency:5, task:10, construct:243.1ms, fetch:8.66s, build:97.7ms}, probe:170.2ms","Disk":0,"Memory":15163591,"Plans":[{"Node Id":"IndexJoin","Plan Rows":4080.0886153846145,"Actual Rows":50936,"Task":"root","Total Time":2593054754,"Max Time":2593054754,"Access Object":"","Operation Info":"inner join, inner:TableReader_95, outer key:new0107.lineitem.l_orderkey, inner key:new0107.orders.o_orderkey, equal cond:eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)","Execution Info":"time:2.59s, loops:55, inner:{total:4.54s, concurrency:5, task:12, construct:223.7ms, fetch:4.23s, build:89.4ms}, probe:132.8ms","Disk":0,"Memory":16188572,"Plans":[{"Node Id":"HashJoin","Plan Rows":4009.984,"Actual Rows":105617,"Task":"root","Total Time":1420155139,"Max Time":1420155139,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.supplier.s_suppkey, new0107.lineitem.l_suppkey)]","Execution Info":"time:1.42s, loops:108, build_hash_table:{total:295.4ms, fetch:295.2ms, build:197.4µs}, probe:{concurrency:5, total:9.49s, max:1.91s, probe:5.18s, fetch:4.31s}","Disk":0,"Memory":19640,"Plans":[{"Node Id":"HashJoin","Plan Rows":10,"Actual Rows":415,"Task":"root","Total Time":295261410,"Max Time":295261410,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.supplier.s_nationkey)]","Execution Info":"time:295.3ms, loops:6, build_hash_table:{total:157.9ms, fetch:157.9ms, build:8.29µs}, probe:{concurrency:5, total:1.37s, max:279.7ms, probe:1.67ms, fetch:1.37s}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":0.025,"Actual Rows":1,"Task":"root","Total Time":157740844,"Max Time":157740844,"Access Object":"","Operation Info":"data:Selection_124","Execution Info":"time:157.7ms, loops:2, cop_task: {num: 1, max: 157.3ms, proc_keys: 25, rpc_num: 1, rpc_time: 157.2ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":243,"Plans":[{"Node Id":"Selection","Plan Rows":0.025,"Actual Rows":1,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"eq(new0107.nation.n_name, \"EGYPT\")","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:nation, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":10000,"Actual Rows":10000,"Task":"root","Total Time":252792510,"Max Time":252792510,"Access Object":"","Operation Info":"data:TableFullScan_121","Execution Info":"time:252.8ms, loops:11, cop_task: {num: 1, max: 184.9ms, proc_keys: 0, rpc_num: 1, rpc_time: 184.9ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":420732,"Plans":[{"Node Id":"TableFullScan","Plan Rows":10000,"Actual Rows":10000,"Task":"cop[tikv]","Total Time":8000000,"Max Time":8000000,"Access Object":"","Operation Info":"table:supplier, keep order:false","Execution Info":"tikv_task:{time:8ms, loops:14}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":3207987.2,"Actual Rows":2534187,"Task":"root","Total Time":549024595,"Max Time":549024595,"Access Object":"","Operation Info":"data:Selection_127","Execution Info":"time:549ms, loops:2468, cop_task: {num: 9, max: 183.9ms, min: 89ms, avg: 131.1ms, p95: 183.9ms, rpc_num: 9, rpc_time: 1.18s, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":81253920,"Plans":[{"Node Id":"Selection","Plan Rows":3207987.2,"Actual Rows":2534187,"Task":"cop[tikv]","Total Time":5546000000,"Max Time":794000000,"Access Object":"","Operation Info":"gt(new0107.lineitem.l_receiptdate, new0107.lineitem.l_commitdate)","Execution Info":"tikv_task:{proc max:794ms, min:404ms, p80:692ms, p95:794ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4975000000,"Max Time":755000000,"Access Object":"","Operation Info":"table:l1, keep order:false","Execution Info":"tikv_task:{proc max:755ms, min:308ms, p80:628ms, p95:755ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"TableReader","Plan Rows":0.45678627040378006,"Actual Rows":48358,"Task":"root","Total Time":4024317349,"Max Time":525076355,"Access Object":"","Operation Info":"data:Selection_94","Execution Info":"time:4.02s, loops:65, cop_task: {num: 17, max: 492.5ms, min: 58.2ms, avg: 197.5ms, p95: 492.5ms, max_proc_keys: 18547, p95_proc_keys: 18547, tot_proc: 1.5s, tot_wait: 77ms, rpc_num: 33, rpc_time: 6.63s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":0,"Plans":[{"Node Id":"Selection","Plan Rows":0.45678627040378006,"Actual Rows":48358,"Task":"cop[tikv]","Total Time":1280000000,"Max Time":275000000,"Access Object":"","Operation Info":"eq(new0107.orders.o_orderstatus, \"F\")","Execution Info":"tikv_task:{proc max:275ms, min:9ms, p80:149ms, p95:275ms, iters:171, tasks:17}, scan_detail: {total_process_keys: 100127, total_process_keys_size: 15170521, total_keys: 108160, rocksdb: {delete_skipped_count: 0, key_skipped_count: 16672, block: {cache_hit_count: 131543, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":100127,"Task":"cop[tikv]","Total Time":1261000000,"Max Time":275000000,"Access Object":"","Operation Info":"table:orders, range: decided by [new0107.lineitem.l_orderkey], keep order:false","Execution Info":"tikv_task:{proc max:275ms, min:9ms, p80:146ms, p95:275ms, iters:171, tasks:17}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"IndexLookUp","Plan Rows":4.054354859583279,"Actual Rows":239382,"Task":"root","Total Time":8375637065,"Max Time":2237504251,"Access Object":"","Operation Info":"","Execution Info":"time:8.38s, loops:249, index_task: {total_time: 3.2s, fetch_handle: 3.2s, build: 77.3µs, wait: 106.6µs}, table_task: {total_time: 16.7s, num: 40, concurrency: 50}","Disk":0,"Memory":228296,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":4.054354859583279,"Actual Rows":239382,"Task":"cop[tikv]","Total Time":1906000000,"Max Time":412000000,"Access Object":"","Operation Info":"table:l2, index:PRIMARY(L_ORDERKEY, L_LINENUMBER), range: decided by [eq(new0107.lineitem.l_orderkey, new0107.lineitem.l_orderkey)], keep order:false","Execution Info":"time:3.19s, loops:264, cop_task: {num: 18, max: 1.01s, min: 75.3ms, avg: 309.5ms, p95: 1.01s, max_proc_keys: 45027, p95_proc_keys: 45027, tot_proc: 3.89s, tot_wait: 574ms, rpc_num: 35, rpc_time: 11s, copr_cache_hit_ratio: 0.00}, tikv_task:{proc max:412ms, min:2ms, p80:168ms, p95:412ms, iters:315, tasks:18}, scan_detail: {total_process_keys: 239382, total_process_keys_size: 12687246, total_keys: 287740, rocksdb: {delete_skipped_count: 0, key_skipped_count: 239382, block: {cache_hit_count: 193605, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]},{"Node Id":"TableRowIDScan","Plan Rows":4.054354859583279,"Actual Rows":239382,"Task":"cop[tikv]","Total Time":2026000000,"Max Time":169000000,"Access Object":"","Operation Info":"table:l2, keep order:false","Execution Info":"time:16.4s, loops:299, cop_task: {num: 52, max: 945.8ms, min: 30.3ms, avg: 351.4ms, p95: 814.3ms, max_proc_keys: 20448, p95_proc_keys: 15101, tot_proc: 12.6s, tot_wait: 2.95s, rpc_num: 103, rpc_time: 36.5s, copr_cache_hit_ratio: 0.00}, tikv_task:{proc max:169ms, min:1ms, p80:77ms, p95:142ms, iters:474, tasks:52}, scan_detail: {total_process_keys: 239382, total_process_keys_size: 47013492, total_keys: 283645, rocksdb: {delete_skipped_count: 0, key_skipped_count: 237679, block: {cache_hit_count: 165777, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"IndexLookUp","Plan Rows":4.05435485958328,"Actual Rows":165991,"Task":"root","Total Time":8293833640,"Max Time":1484692412,"Access Object":"","Operation Info":"","Execution Info":"time:8.29s, loops:177, index_task: {total_time: 3.71s, fetch_handle: 3.71s, build: 67.9µs, wait: 95.1µs}, table_task: {total_time: 10.9s, num: 40, concurrency: 50}","Disk":0,"Memory":32240,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":5.0679435744790995,"Actual Rows":237498,"Task":"cop[tikv]","Total Time":1787000000,"Max Time":393000000,"Access Object":"","Operation Info":"table:l3, index:PRIMARY(L_ORDERKEY, L_LINENUMBER), range: decided by [eq(new0107.lineitem.l_orderkey, new0107.lineitem.l_orderkey)], keep order:false","Execution Info":"time:3.68s, loops:260, cop_task: {num: 18, max: 579.4ms, min: 89.5ms, avg: 309.1ms, p95: 579.4ms, max_proc_keys: 44937, p95_proc_keys: 44937, tot_proc: 3.76s, tot_wait: 495ms, rpc_num: 35, rpc_time: 11s, copr_cache_hit_ratio: 0.00}, tikv_task:{proc max:393ms, min:1ms, p80:158ms, p95:393ms, iters:311, tasks:18}, scan_detail: {total_process_keys: 237498, total_process_keys_size: 12587394, total_keys: 283978, rocksdb: {delete_skipped_count: 0, key_skipped_count: 237498, block: {cache_hit_count: 186093, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]},{"Node Id":"Selection","Plan Rows":4.05435485958328,"Actual Rows":165991,"Task":"cop[tikv]","Total Time":1756000000,"Max Time":113000000,"Access Object":"","Operation Info":"gt(new0107.lineitem.l_receiptdate, new0107.lineitem.l_commitdate)","Execution Info":"time:10.3s, loops:221, cop_task: {num: 54, max: 780.6ms, min: 10.3ms, avg: 184.3ms, p95: 645.5ms, max_proc_keys: 20448, p95_proc_keys: 13177, tot_proc: 6.01s, tot_wait: 1.23s, rpc_num: 107, rpc_time: 19.8s, copr_cache_hit_ratio: 0.00}, tikv_task:{proc max:113ms, min:1ms, p80:61ms, p95:107ms, iters:484, tasks:54}, scan_detail: {total_process_keys: 237498, total_process_keys_size: 46643313, total_keys: 281761, rocksdb: {delete_skipped_count: 0, key_skipped_count: 237485, block: {cache_hit_count: 162654, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRowIDScan","Plan Rows":5.0679435744790995,"Actual Rows":237498,"Task":"cop[tikv]","Total Time":1711000000,"Max Time":111000000,"Access Object":"","Operation Info":"table:l3, keep order:false","Execution Info":"tikv_task:{proc max:111ms, min:1ms, p80:60ms, p95:106ms, iters:484, tasks:54}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  s_name,  count(*) as numwait from  supplier,  lineitem l1,  orders,  nation where  s_suppkey = l1.l_suppkey  and o_orderkey = l1.l_orderkey  and o_orderstatus = 'F'  and l1.l_receiptdate > l1.l_commitdate  and exists (   select    *   from    lineitem l2   where    l2.l_orderkey = l1.l_orderkey    and l2.l_suppkey <> l1.l_suppkey  )  and not exists (   select    *   from    lineitem l3   where    l3.l_orderkey = l1.l_orderkey    and l3.l_suppkey <> l1.l_suppkey    and l3.l_receiptdate > l3.l_commitdate  )  and s_nationkey = n_nationkey  and n_name = 'EGYPT' group by  s_name order by  numwait desc,  s_name limit 100;
create view revenue0 (supplier_no, total_revenue) as  select   l_suppkey,   sum(l_extendedprice * (1 - l_discount))  from   lineitem  where   l_shipdate >= '1997-07-01'   and l_shipdate < date_add('1997-07-01', interval '3' month)  group by   l_suppkey;

{"Node Id":"Sort","Plan Rows":1,"Actual Rows":5,"Task":"root","Total Time":2291146226,"Max Time":2291146226,"Access Object":"","Operation Info":"new0107.orders.o_orderpriority","Execution Info":"time:2.29s, loops:2","Disk":0,"Memory":4000,"Plans":[{"Node Id":"Projection","Plan Rows":1,"Actual Rows":5,"Task":"root","Total Time":2290261864,"Max Time":2290261864,"Access Object":"","Operation Info":"new0107.orders.o_orderpriority, Column#27","Execution Info":"time:2.29s, loops:5, Concurrency:OFF","Disk":0,"Memory":1000,"Plans":[{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":5,"Task":"root","Total Time":2289647168,"Max Time":2289647168,"Access Object":"","Operation Info":"group by:new0107.orders.o_orderpriority, funcs:count(1)-\u003eColumn#27, funcs:firstrow(new0107.orders.o_orderpriority)-\u003enew0107.orders.o_orderpriority","Execution Info":"time:2.29s, loops:5, partial_worker:{wall_time:2.28913351s, concurrency:5, task_num:34, tot_wait:11.325560262s, tot_exec:67.024246ms, tot_time:11.392634967s, max:2.279373423s, p95:2.279373423s}, final_worker:{wall_time:2.309012115s, concurrency:5, task_num:20, tot_wait:11.449168717s, tot_exec:723.578µs, tot_time:11.449900199s, max:2.290272377s, p95:2.290272377s}","Disk":0,"Memory":378413,"Plans":[{"Node Id":"IndexJoin","Plan Rows":33363.37979381443,"Actual Rows":34630,"Task":"root","Total Time":2214362031,"Max Time":2214362031,"Access Object":"","Operation Info":"semi join, inner:IndexLookUp_18, outer key:new0107.orders.o_orderkey, inner key:new0107.lineitem.l_orderkey, equal cond:eq(new0107.orders.o_orderkey, new0107.lineitem.l_orderkey)","Execution Info":"time:2.21s, loops:35, inner:{total:7.46s, concurrency:5, task:10, construct:46.6ms, fetch:7.18s, build:231.4ms}, probe:88.3ms","Disk":0,"Memory":10195519,"Plans":[{"Node Id":"TableReader","Plan Rows":41704.22474226803,"Actual Rows":37775,"Task":"root","Total Time":10628020,"Max Time":10628020,"Access Object":"","Operation Info":"data:Selection_39","Execution Info":"time:10.6ms, loops:42, cop_task: {num: 2, max: 16.1ms, min: 8.32ms, avg: 12.2ms, p95: 16.1ms, rpc_num: 2, rpc_time: 24.4ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":1261370,"Plans":[{"Node Id":"Selection","Plan Rows":41704.22474226803,"Actual Rows":37775,"Task":"cop[tikv]","Total Time":934000000,"Max Time":559000000,"Access Object":"","Operation Info":"ge(new0107.orders.o_orderdate, 1995-01-01 00:00:00.000000), lt(new0107.orders.o_orderdate, 1995-04-01 00:00:00.000000)","Execution Info":"tikv_task:{proc max:559ms, min:375ms, p80:559ms, p95:559ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":871000000,"Max Time":519000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:519ms, min:352ms, p80:519ms, p95:519ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"IndexLookUp","Plan Rows":4.054354859583279,"Actual Rows":95181,"Task":"root","Total Time":7066937225,"Max Time":1912291452,"Access Object":"","Operation Info":"","Execution Info":"time:7.07s, loops:110, index_task: {total_time: 1.97s, fetch_handle: 1.97s, build: 56.1µs, wait: 72.3µs}, table_task: {total_time: 16.4s, num: 33, concurrency: 50}","Disk":0,"Memory":211848,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":5.067943574479099,"Actual Rows":150845,"Task":"cop[tikv]","Total Time":1485000000,"Max Time":506000000,"Access Object":"","Operation Info":"table:lineitem, index:PRIMARY(L_ORDERKEY, L_LINENUMBER), range: decided by [eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)], keep order:false","Execution Info":"time:1.96s, loops:174, cop_task: {num: 13, max: 610.9ms, min: 1.82ms, avg: 183.5ms, p95: 610.9ms, max_proc_keys: 36503, p95_proc_keys: 36503, tot_proc: 1.78s, tot_wait: 52ms, rpc_num: 25, rpc_time: 4.77s, copr_cache_hit_ratio: 0.15}, tikv_task:{proc max:506ms, min:3ms, p80:180ms, p95:506ms, iters:206, tasks:13}, scan_detail: {total_process_keys: 149042, total_process_keys_size: 7899226, total_keys: 186361, rocksdb: {delete_skipped_count: 0, key_skipped_count: 149042, block: {cache_hit_count: 149407, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]},{"Node Id":"Selection","Plan Rows":4.054354859583279,"Actual Rows":95181,"Task":"cop[tikv]","Total Time":1685000000,"Max Time":171000000,"Access Object":"","Operation Info":"lt(new0107.lineitem.l_commitdate, new0107.lineitem.l_receiptdate)","Execution Info":"time:16.2s, loops:148, cop_task: {num: 43, max: 1.42s, min: 2.96ms, avg: 445.5ms, p95: 1.25s, max_proc_keys: 17842, p95_proc_keys: 12133, tot_proc: 12.5s, tot_wait: 1.72s, rpc_num: 85, rpc_time: 38.3s, copr_cache_hit_ratio: 0.42}, tikv_task:{proc max:171ms, min:0s, p80:69ms, p95:128ms, iters:341, tasks:43}, scan_detail: {total_process_keys: 122100, total_process_keys_size: 23988769, total_keys: 147578, rocksdb: {delete_skipped_count: 0, key_skipped_count: 118083, block: {cache_hit_count: 100265, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRowIDScan","Plan Rows":5.067943574479099,"Actual Rows":150845,"Task":"cop[tikv]","Total Time":1667000000,"Max Time":169000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:169ms, min:0s, p80:69ms, p95:126ms, iters:341, tasks:43}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  o_orderpriority,  count(*) as order_count from  orders where  o_orderdate >= '1995-01-01'  and o_orderdate < date_add('1995-01-01', interval '3' month)  and exists (   select    *   from    lineitem   where    l_orderkey = o_orderkey    and l_commitdate < l_receiptdate  ) group by  o_orderpriority order by  o_orderpriority;

{"Node Id":"Sort","Plan Rows":307.48077797816654,"Actual Rows":1,"Task":"root","Total Time":249553516,"Max Time":249553516,"Access Object":"","Operation Info":"new0107.supplier.s_suppkey","Execution Info":"time:249.6ms, loops:2","Disk":0,"Memory":3684,"Plans":[{"Node Id":"IndexJoin","Plan Rows":307.48077797816654,"Actual Rows":1,"Task":"root","Total Time":248726445,"Max Time":248726445,"Access Object":"","Operation Info":"inner join, inner:TableReader_62, outer key:new0107.lineitem.l_suppkey, inner key:new0107.supplier.s_suppkey, equal cond:eq(new0107.lineitem.l_suppkey, new0107.supplier.s_suppkey)","Execution Info":"time:248.7ms, loops:2, inner:{total:73.5ms, concurrency:5, task:1, construct:2.98ms, fetch:70.5ms, build:15.6µs}, probe:5.43µs","Disk":0,"Memory":108177,"Plans":[{"Node Id":"TableReader","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":68050482,"Max Time":68050482,"Access Object":"","Operation Info":"data:TableRangeScan_61","Execution Info":"time:68.1ms, loops:2, cop_task: {num: 1, max: 27.9ms, proc_keys: 1, rpc_num: 1, rpc_time: 27.9ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":1,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:supplier, range: decided by [new0107.lineitem.l_suppkey], keep order:false","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 1, total_process_keys_size: 129, total_keys: 1, rocksdb: {delete_skipped_count: 0, key_skipped_count: 0, block: {cache_hit_count: 3, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]},{"Node Id":"Selection","Plan Rows":307.48077797816654,"Actual Rows":1,"Task":"root","Total Time":174230261,"Max Time":174230261,"Access Object":"","Operation Info":"eq(Column#25, 1479126.6609)","Execution Info":"time:174.2ms, loops:3","Disk":0,"Memory":50944,"Plans":[{"Node Id":"HashAgg","Plan Rows":384.3509724727081,"Actual Rows":10000,"Task":"root","Total Time":166877231,"Max Time":166877231,"Access Object":"","Operation Info":"group by:new0107.lineitem.l_suppkey, funcs:sum(Column#46)-\u003eColumn#25, funcs:firstrow(new0107.lineitem.l_suppkey)-\u003enew0107.lineitem.l_suppkey","Execution Info":"time:166.9ms, loops:13, partial_worker:{wall_time:123.951742ms, concurrency:5, task_num:9, tot_wait:351.224959ms, tot_exec:101.629882ms, tot_time:457.301982ms, max:109.957286ms, p95:109.957286ms}, final_worker:{wall_time:174.063248ms, concurrency:5, task_num:25, tot_wait:508.560864ms, tot_exec:161.765365ms, tot_time:670.345722ms, max:159.266813ms, p95:159.266813ms}","Disk":0,"Memory":10634879,"Plans":[{"Node Id":"TableReader","Plan Rows":384.3509724727081,"Actual Rows":72907,"Task":"root","Total Time":71293869,"Max Time":71293869,"Access Object":"","Operation Info":"data:HashAgg_73","Execution Info":"time:71.3ms, loops:10, cop_task: {num: 9, max: 64.1ms, min: 14.7ms, avg: 51.1ms, p95: 64.1ms, rpc_num: 9, rpc_time: 459.5ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":2407809,"Plans":[{"Node Id":"HashAgg","Plan Rows":384.3509724727081,"Actual Rows":72907,"Task":"cop[tikv]","Total Time":4716000000,"Max Time":640000000,"Access Object":"","Operation Info":"group by:new0107.lineitem.l_suppkey, funcs:sum(mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount)))-\u003eColumn#46","Execution Info":"tikv_task:{proc max:640ms, min:266ms, p80:587ms, p95:640ms, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"Selection","Plan Rows":154124.125,"Actual Rows":154277,"Task":"cop[tikv]","Total Time":4328000000,"Max Time":595000000,"Access Object":"","Operation Info":"ge(new0107.lineitem.l_shipdate, 1997-07-01 00:00:00.000000), lt(new0107.lineitem.l_shipdate, 1997-10-01 00:00:00.000000)","Execution Info":"tikv_task:{proc max:595ms, min:238ms, p80:528ms, p95:595ms, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4093000000,"Max Time":572000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:572ms, min:216ms, p80:504ms, p95:572ms, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
 /*PLACEHOLDER*/ select  s_suppkey,  s_name,  s_address,  s_phone,  total_revenue from  supplier,  revenue0 where  s_suppkey = supplier_no  and total_revenue = (   select    max(total_revenue)   from    revenue0  ) order by  s_suppkey;

{"Node Id":"Projection","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":3065097303,"Max Time":3065097303,"Access Object":"","Operation Info":"div(Column#46, 7.0)-\u003eColumn#47","Execution Info":"time:3.07s, loops:2, Concurrency:OFF","Disk":0,"Memory":1428,"Plans":[{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":3064065482,"Max Time":3064065482,"Access Object":"","Operation Info":"funcs:sum(new0107.lineitem.l_extendedprice)-\u003eColumn#46","Execution Info":"time:3.06s, loops:2, partial_worker:{wall_time:3.058785561s, concurrency:5, task_num:5, tot_wait:15.276547791s, tot_exec:338.243µs, tot_time:15.276921569s, max:3.055413364s, p95:3.055413364s}, final_worker:{wall_time:0s, concurrency:5, task_num:5, tot_wait:15.308101023s, tot_exec:80.915µs, tot_time:15.308189307s, max:3.062721301s, p95:3.062721301s}","Disk":0,"Memory":36064,"Plans":[{"Node Id":"HashJoin","Plan Rows":1210.4745245946383,"Actual Rows":421,"Task":"root","Total Time":3052524771,"Max Time":3052524771,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.part.p_partkey, new0107.lineitem.l_partkey)], other cond:lt(new0107.lineitem.l_quantity, mul(0.2, Column#44))","Execution Info":"time:3.05s, loops:6, build_hash_table:{total:2.45s, fetch:2.45s, build:1ms}, probe:{concurrency:5, total:15.2s, max:3.05s, probe:37.9ms, fetch:15.2s}","Disk":0,"Memory":637296,"Plans":[{"Node Id":"HashJoin","Plan Rows":1210.4745245946383,"Actual Rows":4588,"Task":"root","Total Time":2448960807,"Max Time":2448960807,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.part.p_partkey, new0107.lineitem.l_partkey)]","Execution Info":"time:2.45s, loops:8, build_hash_table:{total:239.9ms, fetch:239.8ms, build:104.1µs}, probe:{concurrency:5, total:12.2s, max:2.45s, probe:1.55s, fetch:10.7s}","Disk":0,"Memory":41680,"Plans":[{"Node Id":"TableReader","Plan Rows":59.45536499999999,"Actual Rows":233,"Task":"root","Total Time":239783080,"Max Time":239783080,"Access Object":"","Operation Info":"data:Selection_39","Execution Info":"time:239.8ms, loops:2, cop_task: {num: 1, max: 165.5ms, proc_keys: 0, rpc_num: 1, rpc_time: 165.5ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":16068,"Plans":[{"Node Id":"Selection","Plan Rows":59.45536499999999,"Actual Rows":233,"Task":"cop[tikv]","Total Time":230000000,"Max Time":230000000,"Access Object":"","Operation Info":"eq(new0107.part.p_brand, \"Brand#44\"), eq(new0107.part.p_container, \"WRAP PKG\")","Execution Info":"tikv_task:{time:230ms, loops:200}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":200000,"Actual Rows":200000,"Task":"cop[tikv]","Total Time":194000000,"Max Time":194000000,"Access Object":"","Operation Info":"table:part, keep order:false","Execution Info":"tikv_task:{time:194ms, loops:200}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":4009984,"Actual Rows":4009984,"Task":"root","Total Time":1740997046,"Max Time":1740997046,"Access Object":"","Operation Info":"data:TableFullScan_36","Execution Info":"time:1.74s, loops:3924, cop_task: {num: 9, max: 2.24s, min: 1.18s, avg: 1.81s, p95: 2.24s, max_proc_keys: 512775, p95_proc_keys: 512775, tot_proc: 12.3s, tot_wait: 264ms, rpc_num: 9, rpc_time: 16.3s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":85891396,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":5240000000,"Max Time":775000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:775ms, min:348ms, p80:690ms, p95:775ms, iters:3959, tasks:9}, scan_detail: {total_process_keys: 4009984, total_process_keys_size: 787655655, total_keys: 4009993, rocksdb: {delete_skipped_count: 0, key_skipped_count: 4009984, block: {cache_hit_count: 12898, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"HashAgg","Plan Rows":196960,"Actual Rows":200000,"Task":"root","Total Time":3040893241,"Max Time":3040893241,"Access Object":"","Operation Info":"group by:new0107.lineitem.l_partkey, funcs:avg(Column#50, Column#51)-\u003eColumn#44, funcs:firstrow(new0107.lineitem.l_partkey)-\u003enew0107.lineitem.l_partkey","Execution Info":"time:3.04s, loops:200, partial_worker:{wall_time:2.213167323s, concurrency:5, task_num:9, tot_wait:865.373586ms, tot_exec:9.098130982s, tot_time:10.528261798s, max:2.20610393s, p95:2.20610393s}, final_worker:{wall_time:3.041425478s, concurrency:5, task_num:25, tot_wait:9.56501689s, tot_exec:4.84908547s, tot_time:14.414130079s, max:3.019260707s, p95:3.019260707s}","Disk":0,"Memory":248979891,"Plans":[{"Node Id":"TableReader","Plan Rows":196960,"Actual Rows":1590811,"Task":"root","Total Time":237381701,"Max Time":237381701,"Access Object":"","Operation Info":"data:HashAgg_41","Execution Info":"time:237.4ms, loops:10, cop_task: {num: 9, max: 202.9ms, min: 92.1ms, avg: 148.3ms, p95: 202.9ms, rpc_num: 9, rpc_time: 1.33s, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":70904636,"Plans":[{"Node Id":"HashAgg","Plan Rows":196960,"Actual Rows":1590811,"Task":"cop[tikv]","Total Time":8618000000,"Max Time":1120000000,"Access Object":"","Operation Info":"group by:new0107.lineitem.l_partkey, funcs:count(new0107.lineitem.l_quantity)-\u003eColumn#50, funcs:sum(new0107.lineitem.l_quantity)-\u003eColumn#51","Execution Info":"tikv_task:{proc max:1.12s, min:574ms, p80:1.09s, p95:1.12s, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4380000000,"Max Time":570000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:570ms, min:362ms, p80:563ms, p95:570ms, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  sum(l_extendedprice) / 7.0 as avg_yearly from  lineitem,  part where  p_partkey = l_partkey  and p_brand = 'Brand#44'  and p_container = 'WRAP PKG'  and l_quantity < (   select    0.2 * avg(l_quantity)   from    lineitem   where    l_partkey = p_partkey  );

{"Node Id":"Sort","Plan Rows":42035.97683311305,"Actual Rows":4,"Task":"root","Total Time":1093078554,"Max Time":1093078554,"Access Object":"","Operation Info":"Column#31","Execution Info":"time:1.09s, loops:2","Disk":0,"Memory":9712,"Plans":[{"Node Id":"Projection","Plan Rows":42035.97683311305,"Actual Rows":4,"Task":"root","Total Time":1092811611,"Max Time":1092811611,"Access Object":"","Operation Info":"Column#31, Column#32, Column#33","Execution Info":"time:1.09s, loops:5, Concurrency:5","Disk":0,"Memory":24280,"Plans":[{"Node Id":"HashAgg","Plan Rows":42035.97683311305,"Actual Rows":4,"Task":"root","Total Time":1091370888,"Max Time":1091370888,"Access Object":"","Operation Info":"group by:Column#37, funcs:count(1)-\u003eColumn#32, funcs:sum(Column#35)-\u003eColumn#33, funcs:firstrow(Column#36)-\u003eColumn#31","Execution Info":"time:1.09s, loops:5, partial_worker:{wall_time:1.090612371s, concurrency:5, task_num:6, tot_wait:5.4476225s, tot_exec:1.387101ms, tot_time:5.4490327s, max:1.089817526s, p95:1.089817526s}, final_worker:{wall_time:1.090801191s, concurrency:5, task_num:20, tot_wait:5.449427886s, tot_exec:81.136µs, tot_time:5.449515509s, max:1.089920813s, p95:1.089920813s}","Disk":0,"Memory":405647,"Plans":[{"Node Id":"Projection","Plan Rows":43584.08347826087,"Actual Rows":3679,"Task":"root","Total Time":1090114507,"Max Time":1090114507,"Access Object":"","Operation Info":"new0107.customer.c_acctbal, substring(new0107.customer.c_phone, 1, 2)-\u003eColumn#36, substring(new0107.customer.c_phone, 1, 2)-\u003eColumn#37","Execution Info":"time:1.09s, loops:7, Concurrency:5","Disk":0,"Memory":367428,"Plans":[{"Node Id":"HashJoin","Plan Rows":43584.08347826087,"Actual Rows":3679,"Task":"root","Total Time":1074266857,"Max Time":1074266857,"Access Object":"","Operation Info":"anti semi join, equal:[eq(new0107.customer.c_custkey, new0107.orders.o_custkey)]","Execution Info":"time:1.07s, loops:7, build_hash_table:{total:1.02s, fetch:103.7ms, build:919.2ms}, probe:{concurrency:5, total:5.34s, max:1.08s, probe:87.6ms, fetch:5.25s}","Disk":0,"Memory":8253696,"Plans":[{"Node Id":"TableReader","Plan Rows":54480.10434782609,"Actual Rows":10834,"Task":"root","Total Time":75379902,"Max Time":75379902,"Access Object":"","Operation Info":"data:Selection_43","Execution Info":"time:75.4ms, loops:12, cop_task: {num: 1, max: 59.3ms, proc_keys: 0, rpc_num: 1, rpc_time: 59.3ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":775145,"Plans":[{"Node Id":"Selection","Plan Rows":54480.10434782609,"Actual Rows":10834,"Task":"cop[tikv]","Total Time":245000000,"Max Time":245000000,"Access Object":"","Operation Info":"gt(new0107.customer.c_acctbal, 5001.433377), in(substring(new0107.customer.c_phone, 1, 2), \"20\", \"40\", \"22\", \"30\", \"39\", \"42\", \"21\")","Execution Info":"tikv_task:{time:245ms, loops:151}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":150000,"Actual Rows":150000,"Task":"cop[tikv]","Total Time":202000000,"Max Time":202000000,"Access Object":"","Operation Info":"table:customer, keep order:false","Execution Info":"tikv_task:{time:202ms, loops:151}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":1094656,"Actual Rows":1001472,"Task":"root","Total Time":67397445,"Max Time":67397445,"Access Object":"","Operation Info":"data:TableFullScan_45","Execution Info":"time:67.4ms, loops:980, cop_task: {num: 2, max: 78.6ms, min: 65.2ms, avg: 71.9ms, p95: 78.6ms, rpc_num: 2, rpc_time: 143.7ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":8025811,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":1079000000,"Max Time":572000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:572ms, min:507ms, p80:572ms, p95:572ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  cntrycode,  count(*) as numcust,  sum(c_acctbal) as totacctbal from  (   select    substring(c_phone from 1 for 2) as cntrycode,    c_acctbal   from    customer   where    substring(c_phone from 1 for 2) in     ('20', '40', '22', '30', '39', '42', '21')    and c_acctbal > (     select      avg(c_acctbal)     from      customer     where      c_acctbal > 0.00      and substring(c_phone from 1 for 2) in       ('20', '40', '22', '30', '39', '42', '21')    )    and not exists (     select      *     from      orders     where      o_custkey = c_custkey    )  ) as custsale group by  cntrycode order by  cntrycode;

{"Node Id":"Sort","Plan Rows":2.937928795775128,"Actual Rows":4,"Task":"root","Total Time":117896516,"Max Time":117896516,"Access Object":"","Operation Info":"new0107.lineitem.l_returnflag, new0107.lineitem.l_linestatus","Execution Info":"time:117.9ms, loops:2","Disk":0,"Memory":34872,"Plans":[{"Node Id":"Projection","Plan Rows":2.937928795775128,"Actual Rows":4,"Task":"root","Total Time":117804642,"Max Time":117804642,"Access Object":"","Operation Info":"new0107.lineitem.l_returnflag, new0107.lineitem.l_linestatus, Column#18, Column#19, Column#20, Column#21, Column#22, Column#23, Column#24, Column#25","Execution Info":"time:117.8ms, loops:4, Concurrency:OFF","Disk":0,"Memory":11624,"Plans":[{"Node Id":"HashAgg","Plan Rows":2.937928795775128,"Actual Rows":4,"Task":"root","Total Time":117777596,"Max Time":117777596,"Access Object":"","Operation Info":"group by:new0107.lineitem.l_linestatus, new0107.lineitem.l_returnflag, funcs:sum(Column#26)-\u003eColumn#18, funcs:sum(Column#27)-\u003eColumn#19, funcs:sum(Column#28)-\u003eColumn#20, funcs:sum(Column#29)-\u003eColumn#21, funcs:avg(Column#30, Column#31)-\u003eColumn#22, funcs:avg(Column#32, Column#33)-\u003eColumn#23, funcs:avg(Column#34, Column#35)-\u003eColumn#24, funcs:count(Column#36)-\u003eColumn#25, funcs:firstrow(new0107.lineitem.l_returnflag)-\u003enew0107.lineitem.l_returnflag, funcs:firstrow(new0107.lineitem.l_linestatus)-\u003enew0107.lineitem.l_linestatus","Execution Info":"time:117.8ms, loops:4, partial_worker:{wall_time:117.664405ms, concurrency:5, task_num:1, tot_wait:586.396771ms, tot_exec:179.743µs, tot_time:586.590174ms, max:117.332687ms, p95:117.332687ms}, final_worker:{wall_time:0s, concurrency:5, task_num:3, tot_wait:587.444309ms, tot_exec:187.514µs, tot_time:587.635941ms, max:117.588591ms, p95:117.588591ms}","Disk":0,"Memory":136884,"Plans":[{"Node Id":"TableReader","Plan Rows":2.937928795775128,"Actual Rows":36,"Task":"root","Total Time":117083288,"Max Time":117083288,"Access Object":"","Operation Info":"data:HashAgg_9","Execution Info":"time:117.1ms, loops:2, cop_task: {num: 9, max: 110.2ms, min: 71.1ms, avg: 80.6ms, p95: 110.2ms, rpc_num: 9, rpc_time: 725.2ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":3162,"Plans":[{"Node Id":"HashAgg","Plan Rows":2.937928795775128,"Actual Rows":36,"Task":"cop[tikv]","Total Time":10706000000,"Max Time":1409000000,"Access Object":"","Operation Info":"group by:new0107.lineitem.l_linestatus, new0107.lineitem.l_returnflag, funcs:sum(new0107.lineitem.l_quantity)-\u003eColumn#26, funcs:sum(new0107.lineitem.l_extendedprice)-\u003eColumn#27, funcs:sum(mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount)))-\u003eColumn#28, funcs:sum(mul(mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount)), plus(1, new0107.lineitem.l_tax)))-\u003eColumn#29, funcs:count(new0107.lineitem.l_quantity)-\u003eColumn#30, funcs:sum(new0107.lineitem.l_quantity)-\u003eColumn#31, funcs:count(new0107.lineitem.l_extendedprice)-\u003eColumn#32, funcs:sum(new0107.lineitem.l_extendedprice)-\u003eColumn#33, funcs:count(new0107.lineitem.l_discount)-\u003eColumn#34, funcs:sum(new0107.lineitem.l_discount)-\u003eColumn#35, funcs:count(1)-\u003eColumn#36","Execution Info":"tikv_task:{proc max:1.41s, min:649ms, p80:1.33s, p95:1.41s, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"Selection","Plan Rows":3927015.821399177,"Actual Rows":3928532,"Task":"cop[tikv]","Total Time":4744000000,"Max Time":663000000,"Access Object":"","Operation Info":"le(new0107.lineitem.l_shipdate, 1998-08-15 00:00:00.000000)","Execution Info":"tikv_task:{proc max:663ms, min:265ms, p80:603ms, p95:663ms, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4545000000,"Max Time":642000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:642ms, min:256ms, p80:578ms, p95:642ms, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  l_returnflag,  l_linestatus,  sum(l_quantity) as sum_qty,  sum(l_extendedprice) as sum_base_price,  sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,  sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,  avg(l_quantity) as avg_qty,  avg(l_extendedprice) as avg_price,  avg(l_discount) as avg_disc,  count(*) as count_order from  lineitem where  l_shipdate <= date_sub('1998-12-01', interval 108 day) group by  l_returnflag,  l_linestatus order by  l_returnflag,  l_linestatus;

{"Node Id":"Projection","Plan Rows":100,"Actual Rows":100,"Task":"root","Total Time":2208682318,"Max Time":2208682318,"Access Object":"","Operation Info":"new0107.supplier.s_acctbal, new0107.supplier.s_name, new0107.nation.n_name, new0107.part.p_partkey, new0107.part.p_mfgr, new0107.supplier.s_address, new0107.supplier.s_phone, new0107.supplier.s_comment","Execution Info":"time:2.21s, loops:2, Concurrency:OFF","Disk":0,"Memory":29808,"Plans":[{"Node Id":"TopN","Plan Rows":100,"Actual Rows":100,"Task":"root","Total Time":2208657944,"Max Time":2208657944,"Access Object":"","Operation Info":"new0107.supplier.s_acctbal:desc, new0107.nation.n_name, new0107.supplier.s_name, new0107.part.p_partkey, offset:0, count:100","Execution Info":"time:2.21s, loops:2","Disk":0,"Memory":143768,"Plans":[{"Node Id":"Projection","Plan Rows":160,"Actual Rows":485,"Task":"root","Total Time":2204442567,"Max Time":2204442567,"Access Object":"","Operation Info":"new0107.part.p_partkey, new0107.part.p_mfgr, new0107.supplier.s_name, new0107.supplier.s_address, new0107.supplier.s_phone, new0107.supplier.s_acctbal, new0107.supplier.s_comment, new0107.nation.n_name","Execution Info":"time:2.2s, loops:2, Concurrency:OFF","Disk":0,"Memory":139888,"Plans":[{"Node Id":"HashJoin","Plan Rows":160,"Actual Rows":485,"Task":"root","Total Time":2204425934,"Max Time":2204425934,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.part.p_partkey, new0107.partsupp.ps_partkey) eq(new0107.partsupp.ps_supplycost, Column#50)]","Execution Info":"time:2.2s, loops:2, build_hash_table:{total:2.15s, fetch:1.79s, build:365.3ms}, probe:{concurrency:5, total:11s, max:2.21s, probe:3.95ms, fetch:11s}","Disk":0,"Memory":5761024,"Plans":[{"Node Id":"IndexJoin","Plan Rows":203.08692120227457,"Actual Rows":649,"Task":"root","Total Time":2199765940,"Max Time":2199765940,"Access Object":"","Operation Info":"inner join, inner:TableReader_53, outer key:new0107.partsupp.ps_partkey, inner key:new0107.part.p_partkey, equal cond:eq(new0107.partsupp.ps_partkey, new0107.part.p_partkey)","Execution Info":"time:2.2s, loops:2, inner:{total:4.7s, concurrency:5, task:14, construct:813.2ms, fetch:3.89s, build:1.02ms}, probe:124.3ms","Disk":0,"Memory":59543512,"Plans":[{"Node Id":"HashJoin","Plan Rows":200,"Actual Rows":160240,"Task":"root","Total Time":1042128640,"Max Time":1042128640,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.supplier.s_suppkey, new0107.partsupp.ps_suppkey)]","Execution Info":"time:1.04s, loops:160, build_hash_table:{total:365.5ms, fetch:364.7ms, build:842.3µs}, probe:{concurrency:5, total:6.17s, max:1.26s, probe:2.66s, fetch:3.51s}","Disk":0,"Memory":598488,"Plans":[{"Node Id":"HashJoin","Plan Rows":2.5,"Actual Rows":2003,"Task":"root","Total Time":364485901,"Max Time":364485901,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.supplier.s_nationkey)]","Execution Info":"time:364.5ms, loops:7, build_hash_table:{total:282ms, fetch:281.9ms, build:25.9µs}, probe:{concurrency:5, total:1.65s, max:331.5ms, probe:52.2ms, fetch:1.6s}","Disk":0,"Memory":1000,"Plans":[{"Node Id":"HashJoin","Plan Rows":0.00625,"Actual Rows":5,"Task":"root","Total Time":281834905,"Max Time":281834905,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.region.r_regionkey, new0107.nation.n_regionkey)]","Execution Info":"time:281.8ms, loops:2, build_hash_table:{total:52.6ms, fetch:52.5ms, build:8.2µs}, probe:{concurrency:5, total:1.37s, max:281.5ms, probe:31.8µs, fetch:1.37s}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":0.005,"Actual Rows":1,"Task":"root","Total Time":52498957,"Max Time":52498957,"Access Object":"","Operation Info":"data:Selection_84","Execution Info":"time:52.5ms, loops:2, cop_task: {num: 1, max: 75.3ms, proc_keys: 5, rpc_num: 1, rpc_time: 75.3ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":242,"Plans":[{"Node Id":"Selection","Plan Rows":0.005,"Actual Rows":1,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"eq(new0107.region.r_name, \"ASIA\")","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 5, total_process_keys_size: 559, total_keys: 6, rocksdb: {delete_skipped_count: 0, key_skipped_count: 5, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":5,"Actual Rows":5,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:region, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":25,"Actual Rows":25,"Task":"root","Total Time":241411567,"Max Time":241411567,"Access Object":"","Operation Info":"data:TableFullScan_81","Execution Info":"time:241.4ms, loops:2, cop_task: {num: 1, max: 92.7ms, proc_keys: 25, rpc_num: 1, rpc_time: 92.7ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":1002,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:nation, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":10000,"Actual Rows":10000,"Task":"root","Total Time":75478500,"Max Time":75478500,"Access Object":"","Operation Info":"data:TableFullScan_86","Execution Info":"time:75.5ms, loops:11, cop_task: {num: 1, max: 72.4ms, proc_keys: 0, rpc_num: 1, rpc_time: 72.4ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":2086982,"Plans":[{"Node Id":"TableFullScan","Plan Rows":10000,"Actual Rows":10000,"Task":"cop[tikv]","Total Time":20000000,"Max Time":20000000,"Access Object":"","Operation Info":"table:supplier, keep order:false","Execution Info":"tikv_task:{time:20ms, loops:14}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":800000,"Actual Rows":800000,"Task":"root","Total Time":612472212,"Max Time":612472212,"Access Object":"","Operation Info":"data:TableFullScan_88","Execution Info":"time:612.5ms, loops:783, cop_task: {num: 2, max: 965.9ms, min: 533.1ms, avg: 749.5ms, p95: 965.9ms, max_proc_keys: 529029, p95_proc_keys: 529029, tot_proc: 991ms, tot_wait: 10ms, rpc_num: 2, rpc_time: 1.5s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":44825523,"Plans":[{"Node Id":"TableFullScan","Plan Rows":800000,"Actual Rows":800000,"Task":"cop[tikv]","Total Time":775000000,"Max Time":504000000,"Access Object":"","Operation Info":"table:partsupp, keep order:false","Execution Info":"tikv_task:{proc max:504ms, min:271ms, p80:504ms, p95:504ms, iters:790, tasks:2}, scan_detail: {total_process_keys: 800000, total_process_keys_size: 150608990, total_keys: 800002, rocksdb: {delete_skipped_count: 0, key_skipped_count: 800000, block: {cache_hit_count: 2473, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":0.008704000000000002,"Actual Rows":485,"Task":"root","Total Time":3567453667,"Max Time":643142810,"Access Object":"","Operation Info":"data:Selection_52","Execution Info":"time:3.57s, loops:27, cop_task: {num: 14, max: 581.1ms, min: 46.9ms, avg: 177ms, p95: 581.1ms, max_proc_keys: 18955, p95_proc_keys: 18955, tot_proc: 1.04s, tot_wait: 19ms, rpc_num: 27, rpc_time: 4.91s, copr_cache_hit_ratio: 0.29}","Disk":0,"Memory":0,"Plans":[{"Node Id":"Selection","Plan Rows":0.008704000000000002,"Actual Rows":485,"Task":"cop[tikv]","Total Time":1072000000,"Max Time":204000000,"Access Object":"","Operation Info":"eq(new0107.part.p_size, 30), like(new0107.part.p_type, \"%STEEL\", 92)","Execution Info":"tikv_task:{proc max:204ms, min:5ms, p80:157ms, p95:204ms, iters:176, tasks:14}, scan_detail: {total_process_keys: 114279, total_process_keys_size: 18677790, total_keys: 142269, rocksdb: {delete_skipped_count: 0, key_skipped_count: 95214, block: {cache_hit_count: 132311, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":118078,"Task":"cop[tikv]","Total Time":1056000000,"Max Time":201000000,"Access Object":"","Operation Info":"table:part, range: decided by [new0107.partsupp.ps_partkey], keep order:false","Execution Info":"tikv_task:{proc max:201ms, min:5ms, p80:156ms, p95:201ms, iters:176, tasks:14}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"Selection","Plan Rows":160,"Actual Rows":118067,"Task":"root","Total Time":1685353403,"Max Time":1685353403,"Access Object":"","Operation Info":"not(isnull(Column#50))","Execution Info":"time:1.69s, loops:117","Disk":0,"Memory":50944,"Plans":[{"Node Id":"HashAgg","Plan Rows":200,"Actual Rows":118067,"Task":"root","Total Time":1602921021,"Max Time":1602921021,"Access Object":"","Operation Info":"group by:new0107.partsupp.ps_partkey, funcs:min(new0107.partsupp.ps_supplycost)-\u003eColumn#50, funcs:firstrow(new0107.partsupp.ps_partkey)-\u003enew0107.partsupp.ps_partkey","Execution Info":"time:1.6s, loops:120, partial_worker:{wall_time:1.535670335s, concurrency:5, task_num:160, tot_wait:6.857337347s, tot_exec:273.642184ms, tot_time:7.143681389s, max:1.445931235s, p95:1.445931235s}, final_worker:{wall_time:2.154560613s, concurrency:5, task_num:25, tot_wait:7.344770831s, tot_exec:2.913741069s, tot_time:10.258541883s, max:2.133511151s, p95:2.133511151s}","Disk":0,"Memory":38201497,"Plans":[{"Node Id":"HashJoin","Plan Rows":200,"Actual Rows":160240,"Task":"root","Total Time":1406680659,"Max Time":1406680659,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.supplier.s_suppkey, new0107.partsupp.ps_suppkey)]","Execution Info":"time:1.41s, loops:161, build_hash_table:{total:344.9ms, fetch:344ms, build:875.6µs}, probe:{concurrency:5, total:6.8s, max:1.39s, probe:2.38s, fetch:4.42s}","Disk":0,"Memory":26400,"Plans":[{"Node Id":"HashJoin","Plan Rows":2.5,"Actual Rows":2003,"Task":"root","Total Time":344661117,"Max Time":344661117,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.supplier.s_nationkey)]","Execution Info":"time:344.7ms, loops:7, build_hash_table:{total:285ms, fetch:285ms, build:8.11µs}, probe:{concurrency:5, total:1.66s, max:333.7ms, probe:50.4ms, fetch:1.61s}","Disk":0,"Memory":372,"Plans":[{"Node Id":"HashJoin","Plan Rows":0.00625,"Actual Rows":5,"Task":"root","Total Time":285005717,"Max Time":285005717,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.region.r_regionkey, new0107.nation.n_regionkey)]","Execution Info":"time:285ms, loops:2, build_hash_table:{total:241.3ms, fetch:241.3ms, build:6.52µs}, probe:{concurrency:5, total:1.38s, max:284.8ms, probe:22.5µs, fetch:1.38s}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":0.005,"Actual Rows":1,"Task":"root","Total Time":241197902,"Max Time":241197902,"Access Object":"","Operation Info":"data:Selection_117","Execution Info":"time:241.2ms, loops:2, cop_task: {num: 1, max: 91.1ms, proc_keys: 5, rpc_num: 1, rpc_time: 91.1ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":246,"Plans":[{"Node Id":"Selection","Plan Rows":0.005,"Actual Rows":1,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"eq(new0107.region.r_name, \"ASIA\")","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 5, total_process_keys_size: 559, total_keys: 6, rocksdb: {delete_skipped_count: 0, key_skipped_count: 5, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":5,"Actual Rows":5,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:region, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":25,"Actual Rows":25,"Task":"root","Total Time":74869454,"Max Time":74869454,"Access Object":"","Operation Info":"data:TableFullScan_114","Execution Info":"time:74.9ms, loops:2, cop_task: {num: 1, max: 71.9ms, proc_keys: 25, rpc_num: 1, rpc_time: 71.9ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":609,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:nation, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":10000,"Actual Rows":10000,"Task":"root","Total Time":36677637,"Max Time":36677637,"Access Object":"","Operation Info":"data:TableFullScan_119","Execution Info":"time:36.7ms, loops:11, cop_task: {num: 1, max: 36.3ms, proc_keys: 0, rpc_num: 1, rpc_time: 36.2ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":160500,"Plans":[{"Node Id":"TableFullScan","Plan Rows":10000,"Actual Rows":10000,"Task":"cop[tikv]","Total Time":7000000,"Max Time":7000000,"Access Object":"","Operation Info":"table:supplier, keep order:false","Execution Info":"tikv_task:{time:7ms, loops:14}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":800000,"Actual Rows":800000,"Task":"root","Total Time":796947685,"Max Time":796947685,"Access Object":"","Operation Info":"data:TableFullScan_121","Execution Info":"time:796.9ms, loops:783, cop_task: {num: 2, max: 1.03s, min: 523.8ms, avg: 777.8ms, p95: 1.03s, max_proc_keys: 529029, p95_proc_keys: 529029, tot_proc: 1.07s, tot_wait: 9ms, rpc_num: 2, rpc_time: 1.56s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":44825522,"Plans":[{"Node Id":"TableFullScan","Plan Rows":800000,"Actual Rows":800000,"Task":"cop[tikv]","Total Time":901000000,"Max Time":644000000,"Access Object":"","Operation Info":"table:partsupp, keep order:false","Execution Info":"tikv_task:{proc max:644ms, min:257ms, p80:644ms, p95:644ms, iters:790, tasks:2}, scan_detail: {total_process_keys: 800000, total_process_keys_size: 150608990, total_keys: 800002, rocksdb: {delete_skipped_count: 0, key_skipped_count: 800000, block: {cache_hit_count: 2473, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  s_acctbal,  s_name,  n_name,  p_partkey,  p_mfgr,  s_address,  s_phone,  s_comment from  part,  supplier,  partsupp,  nation,  region where  p_partkey = ps_partkey  and s_suppkey = ps_suppkey  and p_size = 30  and p_type like '%STEEL'  and s_nationkey = n_nationkey  and n_regionkey = r_regionkey  and r_name = 'ASIA'  and ps_supplycost = (   select    min(ps_supplycost)   from    partsupp,    supplier,    nation,    region   where    p_partkey = ps_partkey    and s_suppkey = ps_suppkey    and s_nationkey = n_nationkey    and n_regionkey = r_regionkey    and r_name = 'ASIA'  ) order by  s_acctbal desc,  n_name,  s_name,  p_partkey limit 100;
 drop view revenue0;

{"Node Id":"Projection","Plan Rows":10,"Actual Rows":10,"Task":"root","Total Time":2791330757,"Max Time":2791330757,"Access Object":"","Operation Info":"new0107.lineitem.l_orderkey, Column#35, new0107.orders.o_orderdate, new0107.orders.o_shippriority","Execution Info":"time:2.79s, loops:2, Concurrency:OFF","Disk":0,"Memory":2544,"Plans":[{"Node Id":"TopN","Plan Rows":10,"Actual Rows":10,"Task":"root","Total Time":2791320401,"Max Time":2791320401,"Access Object":"","Operation Info":"Column#35:desc, new0107.orders.o_orderdate, offset:0, count:10","Execution Info":"time:2.79s, loops:2","Disk":0,"Memory":78560,"Plans":[{"Node Id":"HashAgg","Plan Rows":535774.7154925766,"Actual Rows":7662,"Task":"root","Total Time":2789078753,"Max Time":2789078753,"Access Object":"","Operation Info":"group by:Column#48, Column#49, Column#50, funcs:sum(Column#44)-\u003eColumn#35, funcs:firstrow(Column#45)-\u003enew0107.orders.o_orderdate, funcs:firstrow(Column#46)-\u003enew0107.orders.o_shippriority, funcs:firstrow(Column#47)-\u003enew0107.lineitem.l_orderkey","Execution Info":"time:2.79s, loops:11, partial_worker:{wall_time:2.779601833s, concurrency:5, task_num:21, tot_wait:13.775238602s, tot_exec:15.413834ms, tot_time:13.792089348s, max:2.760167991s, p95:2.760167991s}, final_worker:{wall_time:2.791469713s, concurrency:5, task_num:25, tot_wait:13.885761671s, tot_exec:29.567051ms, tot_time:13.915348432s, max:2.787042591s, p95:2.787042591s}","Disk":0,"Memory":3603128,"Plans":[{"Node Id":"Projection","Plan Rows":795926.0114565928,"Actual Rows":20167,"Task":"root","Total Time":2755860948,"Max Time":2755860948,"Access Object":"","Operation Info":"mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount))-\u003eColumn#44, new0107.orders.o_orderdate, new0107.orders.o_shippriority, new0107.lineitem.l_orderkey, new0107.lineitem.l_orderkey, new0107.orders.o_orderdate, new0107.orders.o_shippriority","Execution Info":"time:2.76s, loops:22, Concurrency:5","Disk":0,"Memory":730980,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":795926.0114565928,"Actual Rows":20167,"Task":"root","Total Time":2721331599,"Max Time":2721331599,"Access Object":"","Operation Info":"inner join, inner:IndexLookUp_27, outer key:new0107.orders.o_orderkey, inner key:new0107.lineitem.l_orderkey, equal cond:eq(new0107.orders.o_orderkey, new0107.lineitem.l_orderkey)","Execution Info":"time:2.72s, loops:22, inner:{total:9.65s, concurrency:5, task:12, construct:135ms, fetch:9.09s, build:40.3ms, join:427.3ms}","Disk":0,"Memory":22286270,"Plans":[{"Node Id":"HashJoin","Plan Rows":196313.84992738423,"Actual Rows":96277,"Task":"root","Total Time":455096597,"Max Time":455096597,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.customer.c_custkey, new0107.orders.o_custkey)]","Execution Info":"time:455.1ms, loops:100, build_hash_table:{total:245.6ms, fetch:237.2ms, build:8.42ms}, probe:{concurrency:5, total:3.16s, max:633.5ms, probe:1.52s, fetch:1.63s}","Disk":0,"Memory":977192,"Plans":[{"Node Id":"TableReader","Plan Rows":21774,"Actual Rows":29752,"Task":"root","Total Time":200472030,"Max Time":200472030,"Access Object":"","Operation Info":"data:Selection_75","Execution Info":"time:200.5ms, loops:30, cop_task: {num: 1, max: 76.7ms, proc_keys: 0, rpc_num: 1, rpc_time: 76.6ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":778276,"Plans":[{"Node Id":"Selection","Plan Rows":21774,"Actual Rows":29752,"Task":"cop[tikv]","Total Time":164000000,"Max Time":164000000,"Access Object":"","Operation Info":"eq(new0107.customer.c_mktsegment, \"AUTOMOBILE\")","Execution Info":"tikv_task:{time:164ms, loops:151}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":150000,"Actual Rows":150000,"Task":"cop[tikv]","Total Time":138000000,"Max Time":138000000,"Access Object":"","Operation Info":"table:customer, keep order:false","Execution Info":"tikv_task:{time:138ms, loops:151}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":730104.3924398626,"Actual Rows":484673,"Task":"root","Total Time":142057934,"Max Time":142057934,"Access Object":"","Operation Info":"data:Selection_72","Execution Info":"time:142.1ms, loops:473, cop_task: {num: 2, max: 67.1ms, min: 38.8ms, avg: 52.9ms, p95: 67.1ms, rpc_num: 2, rpc_time: 105.8ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":15547594,"Plans":[{"Node Id":"Selection","Plan Rows":730104.3924398626,"Actual Rows":484673,"Task":"cop[tikv]","Total Time":937000000,"Max Time":541000000,"Access Object":"","Operation Info":"lt(new0107.orders.o_orderdate, 1995-03-13 00:00:00.000000)","Execution Info":"tikv_task:{proc max:541ms, min:396ms, p80:541ms, p95:541ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":885000000,"Max Time":510000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:510ms, min:375ms, p80:510ms, p95:510ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"IndexLookUp","Plan Rows":4.054354859583279,"Actual Rows":20167,"Task":"root","Total Time":8639191874,"Max Time":1814852270,"Access Object":"","Operation Info":"","Execution Info":"time:8.64s, loops:39, index_task: {total_time: 4.87s, fetch_handle: 4.57s, build: 104.1µs, wait: 302.9ms}, table_task: {total_time: 10.8s, num: 57, concurrency: 60}","Disk":0,"Memory":161728,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":7.484459202807528,"Actual Rows":384652,"Task":"cop[tikv]","Total Time":3543000000,"Max Time":1049000000,"Access Object":"","Operation Info":"table:lineitem, index:PRIMARY(L_ORDERKEY, L_LINENUMBER), range: decided by [eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)], keep order:false","Execution Info":"time:4.54s, loops:411, cop_task: {num: 23, max: 1.21s, min: 49.3ms, avg: 216.1ms, p95: 760.2ms, max_proc_keys: 88162, p95_proc_keys: 86659, tot_proc: 3.67s, tot_wait: 36ms, rpc_num: 45, rpc_time: 9.89s, copr_cache_hit_ratio: 0.00}, tikv_task:{proc max:1.05s, min:4ms, p80:286ms, p95:691ms, iters:480, tasks:23}, scan_detail: {total_process_keys: 384652, total_process_keys_size: 20386556, total_keys: 480929, rocksdb: {delete_skipped_count: 0, key_skipped_count: 384652, block: {cache_hit_count: 385413, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]},{"Node Id":"Selection","Plan Rows":4.054354859583279,"Actual Rows":20167,"Task":"cop[tikv]","Total Time":3858000000,"Max Time":259000000,"Access Object":"","Operation Info":"gt(new0107.lineitem.l_shipdate, 1995-03-13 00:00:00.000000)","Execution Info":"time:10.5s, loops:118, cop_task: {num: 76, max: 308.8ms, min: 13.6ms, avg: 119.3ms, p95: 293.5ms, max_proc_keys: 20480, p95_proc_keys: 20377, tot_proc: 4.74s, tot_wait: 701ms, rpc_num: 151, rpc_time: 18.1s, copr_cache_hit_ratio: 0.20}, tikv_task:{proc max:259ms, min:0s, p80:97ms, p95:188ms, iters:714, tasks:76}, scan_detail: {total_process_keys: 356201, total_process_keys_size: 69976279, total_keys: 426280, rocksdb: {delete_skipped_count: 0, key_skipped_count: 345747, block: {cache_hit_count: 271925, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRowIDScan","Plan Rows":7.484459202807528,"Actual Rows":384652,"Task":"cop[tikv]","Total Time":3809000000,"Max Time":258000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:258ms, min:0s, p80:97ms, p95:187ms, iters:714, tasks:76}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  l_orderkey,  sum(l_extendedprice * (1 - l_discount)) as revenue,  o_orderdate,  o_shippriority from  customer,  orders,  lineitem where  c_mktsegment = 'AUTOMOBILE'  and c_custkey = o_custkey  and l_orderkey = o_orderkey  and o_orderdate < '1995-03-13'  and l_shipdate > '1995-03-13' group by  l_orderkey,  o_orderdate,  o_shippriority order by  revenue desc,  o_orderdate limit 10;

{"Node Id":"Projection","Plan Rows":100,"Actual Rows":6,"Task":"root","Total Time":6882395145,"Max Time":6882395145,"Access Object":"","Operation Info":"new0107.customer.c_name, new0107.customer.c_custkey, new0107.orders.o_orderkey, new0107.orders.o_orderdate, new0107.orders.o_totalprice, Column#54","Execution Info":"time:6.88s, loops:2, Concurrency:OFF","Disk":0,"Memory":4600,"Plans":[{"Node Id":"TopN","Plan Rows":100,"Actual Rows":6,"Task":"root","Total Time":6882378552,"Max Time":6882378552,"Access Object":"","Operation Info":"new0107.orders.o_totalprice:desc, new0107.orders.o_orderdate, offset:0, count:100","Execution Info":"time:6.88s, loops:2","Disk":0,"Memory":9248,"Plans":[{"Node Id":"HashAgg","Plan Rows":807403.0718960115,"Actual Rows":6,"Task":"root","Total Time":6879933299,"Max Time":6879933299,"Access Object":"","Operation Info":"group by:new0107.customer.c_custkey, new0107.customer.c_name, new0107.orders.o_orderdate, new0107.orders.o_orderkey, new0107.orders.o_totalprice, funcs:sum(new0107.lineitem.l_quantity)-\u003eColumn#54, funcs:firstrow(new0107.customer.c_custkey)-\u003enew0107.customer.c_custkey, funcs:firstrow(new0107.customer.c_name)-\u003enew0107.customer.c_name, funcs:firstrow(new0107.orders.o_orderkey)-\u003enew0107.orders.o_orderkey, funcs:firstrow(new0107.orders.o_totalprice)-\u003enew0107.orders.o_totalprice, funcs:firstrow(new0107.orders.o_orderdate)-\u003enew0107.orders.o_orderdate","Execution Info":"time:6.88s, loops:4, partial_worker:{wall_time:6.879875373s, concurrency:5, task_num:3, tot_wait:34.357979301s, tot_exec:39.226274ms, tot_time:34.397241637s, max:6.879471952s, p95:6.879471952s}, final_worker:{wall_time:0s, concurrency:5, task_num:4, tot_wait:34.397504084s, tot_exec:87.331µs, tot_time:34.397594838s, max:6.879536754s, p95:6.879536754s}","Disk":0,"Memory":54302,"Plans":[{"Node Id":"HashJoin","Plan Rows":3273498.568184062,"Actual Rows":42,"Task":"root","Total Time":6879457352,"Max Time":6879457352,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.orders.o_orderkey, new0107.lineitem.l_orderkey)]","Execution Info":"time:6.88s, loops:4, build_hash_table:{total:6.44s, fetch:6.44s, build:38.1µs}, probe:{concurrency:5, total:34s, max:6.83s, probe:627.1ms, fetch:33.4s}","Disk":0,"Memory":6344,"Plans":[{"Node Id":"HashJoin","Plan Rows":807403.0718960115,"Actual Rows":6,"Task":"root","Total Time":6443640822,"Max Time":6443640822,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.orders.o_orderkey, new0107.lineitem.l_orderkey)]","Execution Info":"time:6.44s, loops:3, build_hash_table:{total:4.4s, fetch:4.4s, build:14.3µs}, probe:{concurrency:5, total:32.2s, max:6.44s, probe:127.3ms, fetch:32.1s}","Disk":0,"Memory":49664,"Plans":[{"Node Id":"HashJoin","Plan Rows":1097817.7150192554,"Actual Rows":1001472,"Task":"root","Total Time":3210261231,"Max Time":3210261231,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.customer.c_custkey, new0107.orders.o_custkey)]","Execution Info":"time:3.21s, loops:980, build_hash_table:{total:257.7ms, fetch:57.8ms, build:199.9ms}, probe:{concurrency:5, total:32.1s, max:6.43s, probe:25.8s, fetch:6.32s}","Disk":0,"Memory":5182368,"Plans":[{"Node Id":"TableReader","Plan Rows":150000,"Actual Rows":150000,"Task":"root","Total Time":757275,"Max Time":757275,"Access Object":"","Operation Info":"data:TableFullScan_88","Execution Info":"time:757.3µs, loops:148, cop_task: {num: 1, max: 37.5ms, proc_keys: 0, rpc_num: 1, rpc_time: 37.4ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":5105005,"Plans":[{"Node Id":"TableFullScan","Plan Rows":150000,"Actual Rows":150000,"Task":"cop[tikv]","Total Time":169000000,"Max Time":169000000,"Access Object":"","Operation Info":"table:customer, keep order:false","Execution Info":"tikv_task:{time:169ms, loops:151}","Disk":0,"Memory":0,"Plans":[]}]},{"Node Id":"TableReader","Plan Rows":1094656,"Actual Rows":1001472,"Task":"root","Total Time":1173440997,"Max Time":1173440997,"Access Object":"","Operation Info":"data:TableFullScan_86","Execution Info":"time:1.17s, loops:980, cop_task: {num: 2, max: 1.83s, min: 1.21s, avg: 1.52s, p95: 1.83s, max_proc_keys: 583494, p95_proc_keys: 583494, tot_proc: 2.21s, tot_wait: 1ms, rpc_num: 2, rpc_time: 3.05s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":64133920,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":1562000000,"Max Time":894000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:894ms, min:668ms, p80:894ms, p95:894ms, iters:987, tasks:2}, scan_detail: {total_process_keys: 1001472, total_process_keys_size: 151717700, total_keys: 1001474, rocksdb: {delete_skipped_count: 0, key_skipped_count: 1001472, block: {cache_hit_count: 2529, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"Selection","Plan Rows":791244.8,"Actual Rows":6,"Task":"root","Total Time":4396777386,"Max Time":4396777386,"Access Object":"","Operation Info":"gt(Column#52, 314)","Execution Info":"time:4.4s, loops:2","Disk":0,"Memory":50944,"Plans":[{"Node Id":"HashAgg","Plan Rows":989056,"Actual Rows":1002367,"Task":"root","Total Time":4101768238,"Max Time":4101768238,"Access Object":"","Operation Info":"group by:new0107.lineitem.l_orderkey, funcs:sum(Column#66)-\u003eColumn#52, funcs:firstrow(new0107.lineitem.l_orderkey)-\u003enew0107.lineitem.l_orderkey","Execution Info":"time:4.1s, loops:983, partial_worker:{wall_time:1.822711011s, concurrency:5, task_num:9, tot_wait:239.420457ms, tot_exec:6.940818715s, tot_time:7.897409836s, max:1.808817933s, p95:1.808817933s}, final_worker:{wall_time:4.397040531s, concurrency:5, task_num:25, tot_wait:6.445193749s, tot_exec:14.779104704s, tot_time:21.224533421s, max:4.39614487s, p95:4.39614487s}","Disk":0,"Memory":350265341,"Plans":[{"Node Id":"TableReader","Plan Rows":989056,"Actual Rows":1002374,"Task":"root","Total Time":349121255,"Max Time":349121255,"Access Object":"","Operation Info":"data:HashAgg_91","Execution Info":"time:349.1ms, loops:10, cop_task: {num: 9, max: 308.9ms, min: 18.4ms, avg: 133.1ms, p95: 308.9ms, rpc_num: 9, rpc_time: 1.2s, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":11705194,"Plans":[{"Node Id":"HashAgg","Plan Rows":989056,"Actual Rows":1002374,"Task":"cop[tikv]","Total Time":5051000000,"Max Time":713000000,"Access Object":"","Operation Info":"group by:new0107.lineitem.l_orderkey, funcs:sum(new0107.lineitem.l_quantity)-\u003eColumn#66","Execution Info":"tikv_task:{proc max:713ms, min:301ms, p80:675ms, p95:713ms, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":3708000000,"Max Time":535000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:535ms, min:241ms, p80:502ms, p95:535ms, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]},{"Node Id":"TableReader","Plan Rows":4009984,"Actual Rows":4009984,"Task":"root","Total Time":580032559,"Max Time":580032559,"Access Object":"","Operation Info":"data:TableFullScan_101","Execution Info":"time:580ms, loops:3924, cop_task: {num: 9, max: 1.58s, min: 566.8ms, avg: 1.28s, p95: 1.58s, max_proc_keys: 512775, p95_proc_keys: 512775, tot_proc: 9.2s, tot_wait: 58ms, rpc_num: 9, rpc_time: 11.5s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":192576064,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4866000000,"Max Time":775000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:775ms, min:264ms, p80:601ms, p95:775ms, iters:3959, tasks:9}, scan_detail: {total_process_keys: 4009984, total_process_keys_size: 787655655, total_keys: 4009993, rocksdb: {delete_skipped_count: 0, key_skipped_count: 4009984, block: {cache_hit_count: 12898, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}
/*PLACEHOLDER*/ select  c_name,  c_custkey,  o_orderkey,  o_orderdate,  o_totalprice,  sum(l_quantity) from  customer,  orders,  lineitem where  o_orderkey in (   select    l_orderkey   from    lineitem   group by    l_orderkey having     sum(l_quantity) > 314  )  and c_custkey = o_custkey  and o_orderkey = l_orderkey group by  c_name,  c_custkey,  o_orderkey,  o_orderdate,  o_totalprice order by  o_totalprice desc,  o_orderdate limit 100;

{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":2410249335,"Max Time":2410249335,"Access Object":"","Operation Info":"funcs:sum(Column#28)-\u003eColumn#27","Execution Info":"time:2.41s, loops:2, partial_worker:{wall_time:2.410180069s, concurrency:5, task_num:5, tot_wait:11.869807347s, tot_exec:86.304µs, tot_time:11.869905034s, max:2.373993799s, p95:2.373993799s}, final_worker:{wall_time:2.410346317s, concurrency:5, task_num:5, tot_wait:11.870383567s, tot_exec:41.79µs, tot_time:11.870429649s, max:2.374121807s, p95:2.374121807s}","Disk":0,"Memory":19344,"Plans":[{"Node Id":"Projection","Plan Rows":2810.7054154138987,"Actual Rows":72,"Task":"root","Total Time":2373961014,"Max Time":2373961014,"Access Object":"","Operation Info":"mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount))-\u003eColumn#28","Execution Info":"time:2.37s, loops:6, Concurrency:5","Disk":0,"Memory":21420,"Plans":[{"Node Id":"HashJoin","Plan Rows":2810.7054154138987,"Actual Rows":72,"Task":"root","Total Time":2373380976,"Max Time":2373380976,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.part.p_partkey, new0107.lineitem.l_partkey)], other cond:or(and(and(eq(new0107.part.p_brand, \"Brand#52\"), in(new0107.part.p_container, \"SM CASE\", \"SM BOX\", \"SM PACK\", \"SM PKG\")), and(ge(new0107.lineitem.l_quantity, 4), and(le(new0107.lineitem.l_quantity, 14), le(new0107.part.p_size, 5)))), or(and(and(eq(new0107.part.p_brand, \"Brand#11\"), in(new0107.part.p_container, \"MED BAG\", \"MED BOX\", \"MED PKG\", \"MED PACK\")), and(ge(new0107.lineitem.l_quantity, 18), and(le(new0107.lineitem.l_quantity, 28), le(new0107.part.p_size, 10)))), and(and(eq(new0107.part.p_brand, \"Brand#51\"), in(new0107.part.p_container, \"LG CASE\", \"LG BOX\", \"LG PACK\", \"LG PKG\")), and(ge(new0107.lineitem.l_quantity, 29), and(le(new0107.lineitem.l_quantity, 39), le(new0107.part.p_size, 15))))))","Execution Info":"time:2.37s, loops:6, build_hash_table:{total:106.8ms, fetch:106.7ms, build:148.2µs}, probe:{concurrency:5, total:11.9s, max:2.37s, probe:646.8ms, fetch:11.2s}","Disk":0,"Memory":50112,"Plans":[{"Node Id":"TableReader","Plan Rows":138.05455049694,"Actual Rows":453,"Task":"root","Total Time":106616181,"Max Time":106616181,"Access Object":"","Operation Info":"data:Selection_30","Execution Info":"time:106.6ms, loops:2, cop_task: {num: 1, max: 53.3ms, proc_keys: 0, rpc_num: 1, rpc_time: 53.2ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":30663,"Plans":[{"Node Id":"Selection","Plan Rows":138.05455049694,"Actual Rows":453,"Task":"cop[tikv]","Total Time":281000000,"Max Time":281000000,"Access Object":"","Operation Info":"ge(new0107.part.p_size, 1), or(and(eq(new0107.part.p_brand, \"Brand#52\"), and(in(new0107.part.p_container, \"SM CASE\", \"SM BOX\", \"SM PACK\", \"SM PKG\"), le(new0107.part.p_size, 5))), or(and(eq(new0107.part.p_brand, \"Brand#11\"), and(in(new0107.part.p_container, \"MED BAG\", \"MED BOX\", \"MED PKG\", \"MED PACK\"), le(new0107.part.p_size, 10))), and(eq(new0107.part.p_brand, \"Brand#51\"), and(in(new0107.part.p_container, \"LG CASE\", \"LG BOX\", \"LG PACK\", \"LG PKG\"), le(new0107.part.p_size, 15)))))","Execution Info":"tikv_task:{time:281ms, loops:200}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":200000,"Actual Rows":200000,"Task":"cop[tikv]","Total Time":168000000,"Max Time":168000000,"Access Object":"","Operation Info":"table:part, keep order:false","Execution Info":"tikv_task:{time:168ms, loops:200}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":182075.37432781045,"Actual Rows":94250,"Task":"root","Total Time":2136130558,"Max Time":2136130558,"Access Object":"","Operation Info":"data:Selection_27","Execution Info":"time:2.14s, loops:93, cop_task: {num: 9, max: 2.36s, min: 921.2ms, avg: 1.54s, p95: 2.36s, max_proc_keys: 512775, p95_proc_keys: 512775, tot_proc: 13.4s, tot_wait: 141ms, rpc_num: 9, rpc_time: 13.9s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":3839883,"Plans":[{"Node Id":"Selection","Plan Rows":182075.37432781045,"Actual Rows":94250,"Task":"cop[tikv]","Total Time":8816000000,"Max Time":1142000000,"Access Object":"","Operation Info":"eq(new0107.lineitem.l_shipinstruct, \"DELIVER IN PERSON\"), in(new0107.lineitem.l_shipmode, \"AIR\", \"AIR REG\"), or(and(ge(new0107.lineitem.l_quantity, 4), le(new0107.lineitem.l_quantity, 14)), or(and(ge(new0107.lineitem.l_quantity, 18), le(new0107.lineitem.l_quantity, 28)), and(ge(new0107.lineitem.l_quantity, 29), le(new0107.lineitem.l_quantity, 39))))","Execution Info":"tikv_task:{proc max:1.14s, min:714ms, p80:1.1s, p95:1.14s, iters:3959, tasks:9}, scan_detail: {total_process_keys: 4009984, total_process_keys_size: 787655655, total_keys: 4009993, rocksdb: {delete_skipped_count: 0, key_skipped_count: 4009984, block: {cache_hit_count: 12898, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":5885000000,"Max Time":738000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:738ms, min:537ms, p80:692ms, p95:738ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}
/*PLACEHOLDER*/ select  sum(l_extendedprice* (1 - l_discount)) as revenue from  lineitem,  part where  (   p_partkey = l_partkey   and p_brand = 'Brand#52'   and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')   and l_quantity >= 4 and l_quantity <= 4 + 10   and p_size between 1 and 5   and l_shipmode in ('AIR', 'AIR REG')   and l_shipinstruct = 'DELIVER IN PERSON'  )  or  (   p_partkey = l_partkey   and p_brand = 'Brand#11'   and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')   and l_quantity >= 18 and l_quantity <= 18 + 10   and p_size between 1 and 10   and l_shipmode in ('AIR', 'AIR REG')   and l_shipinstruct = 'DELIVER IN PERSON'  )  or  (   p_partkey = l_partkey   and p_brand = 'Brand#51'   and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')   and l_quantity >= 29 and l_quantity <= 29 + 10   and p_size between 1 and 15   and l_shipmode in ('AIR', 'AIR REG')   and l_shipinstruct = 'DELIVER IN PERSON'  );

{"Node Id":"Sort","Plan Rows":1,"Actual Rows":5,"Task":"root","Total Time":2565541547,"Max Time":2565541547,"Access Object":"","Operation Info":"new0107.orders.o_orderpriority","Execution Info":"time:2.57s, loops:2","Disk":0,"Memory":4000,"Plans":[{"Node Id":"Projection","Plan Rows":1,"Actual Rows":5,"Task":"root","Total Time":2565468373,"Max Time":2565468373,"Access Object":"","Operation Info":"new0107.orders.o_orderpriority, Column#27","Execution Info":"time:2.57s, loops:5, Concurrency:OFF","Disk":0,"Memory":1000,"Plans":[{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":5,"Task":"root","Total Time":2565436854,"Max Time":2565436854,"Access Object":"","Operation Info":"group by:new0107.orders.o_orderpriority, funcs:count(1)-\u003eColumn#27, funcs:firstrow(new0107.orders.o_orderpriority)-\u003enew0107.orders.o_orderpriority","Execution Info":"time:2.57s, loops:5, partial_worker:{wall_time:2.546675648s, concurrency:5, task_num:34, tot_wait:12.211236197s, tot_exec:347.592559ms, tot_time:12.628980544s, max:2.532457951s, p95:2.532457951s}, final_worker:{wall_time:2.565458094s, concurrency:5, task_num:20, tot_wait:12.735706865s, tot_exec:759.445µs, tot_time:12.736474469s, max:2.547537678s, p95:2.547537678s}","Disk":0,"Memory":382040,"Plans":[{"Node Id":"IndexJoin","Plan Rows":33363.37979381443,"Actual Rows":34630,"Task":"root","Total Time":2452817161,"Max Time":2452817161,"Access Object":"","Operation Info":"semi join, inner:IndexLookUp_18, outer key:new0107.orders.o_orderkey, inner key:new0107.lineitem.l_orderkey, equal cond:eq(new0107.orders.o_orderkey, new0107.lineitem.l_orderkey)","Execution Info":"time:2.45s, loops:35, inner:{total:9.65s, concurrency:5, task:10, construct:56.7ms, fetch:9.48s, build:121.1ms}, probe:56.2ms","Disk":0,"Memory":10481523,"Plans":[{"Node Id":"TableReader","Plan Rows":41704.22474226803,"Actual Rows":37775,"Task":"root","Total Time":22703610,"Max Time":22703610,"Access Object":"","Operation Info":"data:Selection_39","Execution Info":"time:22.7ms, loops:42, cop_task: {num: 2, max: 56.3ms, min: 20.5ms, avg: 38.4ms, p95: 56.3ms, rpc_num: 2, rpc_time: 76.8ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":1261374,"Plans":[{"Node Id":"Selection","Plan Rows":41704.22474226803,"Actual Rows":37775,"Task":"cop[tikv]","Total Time":934000000,"Max Time":559000000,"Access Object":"","Operation Info":"ge(new0107.orders.o_orderdate, 1995-01-01 00:00:00.000000), lt(new0107.orders.o_orderdate, 1995-04-01 00:00:00.000000)","Execution Info":"tikv_task:{proc max:559ms, min:375ms, p80:559ms, p95:559ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":871000000,"Max Time":519000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:519ms, min:352ms, p80:519ms, p95:519ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"IndexLookUp","Plan Rows":4.054354859583279,"Actual Rows":95181,"Task":"root","Total Time":9317113752,"Max Time":1979738328,"Access Object":"","Operation Info":"","Execution Info":"time:9.32s, loops:110, index_task: {total_time: 6.16s, fetch_handle: 6.16s, build: 41.9µs, wait: 81.5µs}, table_task: {total_time: 7.53s, num: 33, concurrency: 50}","Disk":0,"Memory":211848,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":5.067943574479099,"Actual Rows":150845,"Task":"cop[tikv]","Total Time":1569000000,"Max Time":447000000,"Access Object":"","Operation Info":"table:lineitem, index:PRIMARY(L_ORDERKEY, L_LINENUMBER), range: decided by [eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)], keep order:false","Execution Info":"time:6.14s, loops:174, cop_task: {num: 13, max: 1.65s, min: 25.9ms, avg: 692.5ms, p95: 1.65s, max_proc_keys: 36503, p95_proc_keys: 36503, tot_proc: 7.65s, tot_wait: 997ms, rpc_num: 25, rpc_time: 18s, copr_cache_hit_ratio: 0.15}, tikv_task:{proc max:447ms, min:3ms, p80:230ms, p95:447ms, iters:206, tasks:13}, scan_detail: {total_process_keys: 149042, total_process_keys_size: 7899226, total_keys: 186361, rocksdb: {delete_skipped_count: 0, key_skipped_count: 149042, block: {cache_hit_count: 149407, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]},{"Node Id":"Selection","Plan Rows":4.054354859583279,"Actual Rows":95181,"Task":"cop[tikv]","Total Time":1708000000,"Max Time":208000000,"Access Object":"","Operation Info":"lt(new0107.lineitem.l_commitdate, new0107.lineitem.l_receiptdate)","Execution Info":"time:7.35s, loops:148, cop_task: {num: 43, max: 833.4ms, min: 24.6ms, avg: 192.9ms, p95: 438.7ms, max_proc_keys: 17842, p95_proc_keys: 12133, tot_proc: 3.34s, tot_wait: 3.16s, rpc_num: 85, rpc_time: 16.5s, copr_cache_hit_ratio: 0.42}, tikv_task:{proc max:208ms, min:0s, p80:58ms, p95:131ms, iters:341, tasks:43}, scan_detail: {total_process_keys: 122100, total_process_keys_size: 23988769, total_keys: 147578, rocksdb: {delete_skipped_count: 0, key_skipped_count: 118083, block: {cache_hit_count: 100265, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRowIDScan","Plan Rows":5.067943574479099,"Actual Rows":150845,"Task":"cop[tikv]","Total Time":1681000000,"Max Time":200000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:200ms, min:0s, p80:56ms, p95:127ms, iters:341, tasks:43}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  o_orderpriority,  count(*) as order_count from  orders where  o_orderdate >= '1995-01-01'  and o_orderdate < date_add('1995-01-01', interval '3' month)  and exists (   select    *   from    lineitem   where    l_orderkey = o_orderkey    and l_commitdate < l_receiptdate  ) group by  o_orderpriority order by  o_orderpriority;

{"Node Id":"Sort","Plan Rows":8.43216,"Actual Rows":18333,"Task":"root","Total Time":2803123738,"Max Time":2803123738,"Access Object":"","Operation Info":"Column#23:desc, new0107.part.p_brand, new0107.part.p_type, new0107.part.p_size","Execution Info":"time:2.8s, loops:19","Disk":0,"Memory":1362656,"Plans":[{"Node Id":"Projection","Plan Rows":8.43216,"Actual Rows":18333,"Task":"root","Total Time":2671749791,"Max Time":2671749791,"Access Object":"","Operation Info":"new0107.part.p_brand, new0107.part.p_type, new0107.part.p_size, Column#23","Execution Info":"time:2.67s, loops:19, Concurrency:OFF","Disk":0,"Memory":1328656,"Plans":[{"Node Id":"HashAgg","Plan Rows":8.43216,"Actual Rows":18333,"Task":"root","Total Time":2671655252,"Max Time":2671655252,"Access Object":"","Operation Info":"group by:new0107.part.p_brand, new0107.part.p_size, new0107.part.p_type, funcs:count(distinct new0107.partsupp.ps_suppkey)-\u003eColumn#23, funcs:firstrow(new0107.part.p_brand)-\u003enew0107.part.p_brand, funcs:firstrow(new0107.part.p_type)-\u003enew0107.part.p_type, funcs:firstrow(new0107.part.p_size)-\u003enew0107.part.p_size","Execution Info":"time:2.67s, loops:19","Disk":0,"Memory":8761243,"Plans":[{"Node Id":"HashJoin","Plan Rows":45665.63769293257,"Actual Rows":119078,"Task":"root","Total Time":1879751713,"Max Time":1879751713,"Access Object":"","Operation Info":"anti semi join, equal:[eq(new0107.partsupp.ps_suppkey, new0107.supplier.s_suppkey)]","Execution Info":"time:1.88s, loops:119, build_hash_table:{total:37.8ms, fetch:37.8ms, build:16.8µs}, probe:{concurrency:5, total:12.6s, max:2.52s, probe:2.86s, fetch:9.74s}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"Projection","Plan Rows":57082.04711616571,"Actual Rows":119136,"Task":"root","Total Time":2016536261,"Max Time":2016536261,"Access Object":"","Operation Info":"new0107.partsupp.ps_suppkey, new0107.part.p_brand, new0107.part.p_type, new0107.part.p_size","Execution Info":"time:2.02s, loops:120, Concurrency:5","Disk":0,"Memory":760800,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":57082.04711616571,"Actual Rows":119136,"Task":"root","Total Time":2127473135,"Max Time":2127473135,"Access Object":"","Operation Info":"inner join, inner:IndexReader_33, outer key:new0107.part.p_partkey, inner key:new0107.partsupp.ps_partkey, equal cond:eq(new0107.part.p_partkey, new0107.partsupp.ps_partkey)","Execution Info":"time:2.13s, loops:120, inner:{total:4.08s, concurrency:5, task:9, construct:80.7ms, fetch:2.87s, build:11.8ms, join:1.13s}","Disk":0,"Memory":9513539,"Plans":[{"Node Id":"TableReader","Plan Rows":14053.599999999999,"Actual Rows":29784,"Task":"root","Total Time":41244787,"Max Time":41244787,"Access Object":"","Operation Info":"data:Selection_60","Execution Info":"time:41.2ms, loops:35, cop_task: {num: 1, max: 38.2ms, proc_keys: 0, rpc_num: 1, rpc_time: 38.2ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":1817788,"Plans":[{"Node Id":"Selection","Plan Rows":14053.599999999999,"Actual Rows":29784,"Task":"cop[tikv]","Total Time":324000000,"Max Time":324000000,"Access Object":"","Operation Info":"in(new0107.part.p_size, 48, 19, 12, 4, 41, 7, 21, 39), ne(new0107.part.p_brand, \"Brand#34\"), not(like(new0107.part.p_type, \"LARGE BRUSHED%\", 92))","Execution Info":"tikv_task:{time:324ms, loops:200}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":200000,"Actual Rows":200000,"Task":"cop[tikv]","Total Time":261000000,"Max Time":261000000,"Access Object":"","Operation Info":"table:part, keep order:false","Execution Info":"tikv_task:{time:261ms, loops:200}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"IndexReader","Plan Rows":4.061738424045491,"Actual Rows":119136,"Task":"root","Total Time":2765166581,"Max Time":1841327606,"Access Object":"","Operation Info":"index:IndexRangeScan_32","Execution Info":"time:2.77s, loops:133, cop_task: {num: 9, max: 1.82s, min: 10.2ms, avg: 286.8ms, p95: 1.82s, max_proc_keys: 53228, p95_proc_keys: 53228, tot_proc: 2.08s, tot_wait: 186ms, rpc_num: 17, rpc_time: 5.15s, copr_cache_hit_ratio: 0.22}","Disk":0,"Memory":68398,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":4.061738424045491,"Actual Rows":119136,"Task":"cop[tikv]","Total Time":987000000,"Max Time":463000000,"Access Object":"","Operation Info":"table:partsupp, index:PRIMARY(PS_PARTKEY, PS_SUPPKEY), range: decided by [eq(new0107.partsupp.ps_partkey, new0107.part.p_partkey)], keep order:false","Execution Info":"tikv_task:{proc max:463ms, min:6ms, p80:210ms, p95:463ms, iters:159, tasks:9}, scan_detail: {total_process_keys: 116920, total_process_keys_size: 6196760, total_keys: 146150, rocksdb: {delete_skipped_count: 0, key_skipped_count: 116920, block: {cache_hit_count: 117007, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"TableReader","Plan Rows":8000,"Actual Rows":4,"Task":"root","Total Time":37655433,"Max Time":37655433,"Access Object":"","Operation Info":"data:Selection_67","Execution Info":"time:37.7ms, loops:2, cop_task: {num: 1, max: 37.7ms, proc_keys: 0, rpc_num: 1, rpc_time: 37.7ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":568,"Plans":[{"Node Id":"Selection","Plan Rows":8000,"Actual Rows":4,"Task":"cop[tikv]","Total Time":16000000,"Max Time":16000000,"Access Object":"","Operation Info":"like(new0107.supplier.s_comment, \"%Customer%Complaints%\", 92)","Execution Info":"tikv_task:{time:16ms, loops:14}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":10000,"Actual Rows":10000,"Task":"cop[tikv]","Total Time":9000000,"Max Time":9000000,"Access Object":"","Operation Info":"table:supplier, keep order:false","Execution Info":"tikv_task:{time:9ms, loops:14}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  p_brand,  p_type,  p_size,  count(distinct ps_suppkey) as supplier_cnt from  partsupp,  part where  p_partkey = ps_partkey  and p_brand <> 'Brand#34'  and p_type not like 'LARGE BRUSHED%'  and p_size in (48, 19, 12, 4, 41, 7, 21, 39)  and ps_suppkey not in (   select    s_suppkey   from    supplier   where    s_comment like '%Customer%Complaints%'  ) group by  p_brand,  p_type,  p_size order by  supplier_cnt desc,  p_brand,  p_type,  p_size;

{"Node Id":"Sort","Plan Rows":10,"Actual Rows":152,"Task":"root","Total Time":4906570632,"Max Time":4906570632,"Access Object":"","Operation Info":"new0107.supplier.s_name","Execution Info":"time:4.91s, loops:2","Disk":0,"Memory":13568,"Plans":[{"Node Id":"HashJoin","Plan Rows":10,"Actual Rows":152,"Task":"root","Total Time":4905690103,"Max Time":4905690103,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.supplier.s_suppkey, new0107.partsupp.ps_suppkey)]","Execution Info":"time:4.91s, loops:6, build_hash_table:{total:579.3ms, fetch:578.8ms, build:406.2µs}, probe:{concurrency:5, total:24.5s, max:4.9s, probe:858.1µs, fetch:24.5s}","Disk":0,"Memory":36940,"Plans":[{"Node Id":"HashJoin","Plan Rows":10,"Actual Rows":420,"Task":"root","Total Time":579040943,"Max Time":579040943,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.supplier.s_nationkey)]","Execution Info":"time:579ms, loops:6, build_hash_table:{total:124.1ms, fetch:124.1ms, build:9.41µs}, probe:{concurrency:5, total:2.72s, max:577.8ms, probe:347.8ms, fetch:2.37s}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":0.025,"Actual Rows":1,"Task":"root","Total Time":124026144,"Max Time":124026144,"Access Object":"","Operation Info":"data:Selection_52","Execution Info":"time:124ms, loops:2, cop_task: {num: 1, max: 90.1ms, proc_keys: 25, rpc_num: 1, rpc_time: 90.1ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":245,"Plans":[{"Node Id":"Selection","Plan Rows":0.025,"Actual Rows":1,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"eq(new0107.nation.n_name, \"ALGERIA\")","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:nation, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":10000,"Actual Rows":10000,"Task":"root","Total Time":410829414,"Max Time":410829414,"Access Object":"","Operation Info":"data:TableFullScan_49","Execution Info":"time:410.8ms, loops:11, cop_task: {num: 1, max: 275.5ms, proc_keys: 0, rpc_num: 1, rpc_time: 275.4ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":750729,"Plans":[{"Node Id":"TableFullScan","Plan Rows":10000,"Actual Rows":10000,"Task":"cop[tikv]","Total Time":13000000,"Max Time":13000000,"Access Object":"","Operation Info":"table:supplier, keep order:false","Execution Info":"tikv_task:{time:13ms, loops:14}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"HashAgg","Plan Rows":2547.961871329696,"Actual Rows":3734,"Task":"root","Total Time":4904063789,"Max Time":4904063789,"Access Object":"","Operation Info":"group by:new0107.partsupp.ps_suppkey, funcs:firstrow(new0107.partsupp.ps_suppkey)-\u003enew0107.partsupp.ps_suppkey","Execution Info":"time:4.9s, loops:6, partial_worker:{wall_time:4.90244449s, concurrency:5, task_num:5, tot_wait:24.413209479s, tot_exec:2.672359ms, tot_time:24.416283222s, max:4.896811571s, p95:4.896811571s}, final_worker:{wall_time:4.904293693s, concurrency:5, task_num:25, tot_wait:24.416444687s, tot_exec:4.523418ms, tot_time:24.420978091s, max:4.884834136s, p95:4.884834136s}","Disk":0,"Memory":1073103,"Plans":[{"Node Id":"Selection","Plan Rows":2547.961871329696,"Actual Rows":4608,"Task":"root","Total Time":4897342262,"Max Time":4897342262,"Access Object":"","Operation Info":"gt(cast(new0107.partsupp.ps_availqty, decimal(20,0) BINARY), mul(0.5, Column#44))","Execution Info":"time:4.9s, loops:6","Disk":0,"Memory":60656,"Plans":[{"Node Id":"HashAgg","Plan Rows":3184.9523391621196,"Actual Rows":8576,"Task":"root","Total Time":4886866216,"Max Time":4886866216,"Access Object":"","Operation Info":"group by:new0107.partsupp.ps_partkey, new0107.partsupp.ps_suppkey, funcs:firstrow(new0107.partsupp.ps_suppkey)-\u003enew0107.partsupp.ps_suppkey, funcs:firstrow(new0107.partsupp.ps_availqty)-\u003enew0107.partsupp.ps_availqty, funcs:sum(new0107.lineitem.l_quantity)-\u003eColumn#44","Execution Info":"time:4.89s, loops:12, partial_worker:{wall_time:4.875672775s, concurrency:5, task_num:14, tot_wait:24.015994504s, tot_exec:120.079635ms, tot_time:24.13807787s, max:4.829292802s, p95:4.829292802s}, final_worker:{wall_time:4.896248041s, concurrency:5, task_num:25, tot_wait:24.326146294s, tot_exec:39.116641ms, tot_time:24.365278124s, max:4.877902758s, p95:4.877902758s}","Disk":0,"Memory":4189649,"Plans":[{"Node Id":"HashJoin","Plan Rows":64843.663285959956,"Actual Rows":10496,"Task":"root","Total Time":4823177419,"Max Time":4823177419,"Access Object":"","Operation Info":"left outer join, equal:[eq(new0107.partsupp.ps_partkey, new0107.lineitem.l_partkey) eq(new0107.partsupp.ps_suppkey, new0107.lineitem.l_suppkey)]","Execution Info":"time:4.82s, loops:15, build_hash_table:{total:4.61s, fetch:4.61s, build:3.57ms}, probe:{concurrency:5, total:23.8s, max:4.76s, probe:469.3ms, fetch:23.3s}","Disk":0,"Memory":290232,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":3184.9523391621196,"Actual Rows":8576,"Task":"root","Total Time":4609115762,"Max Time":4609115762,"Access Object":"","Operation Info":"inner join, inner:IndexLookUp_64, outer key:new0107.part.p_partkey, inner key:new0107.partsupp.ps_partkey, equal cond:eq(new0107.part.p_partkey, new0107.partsupp.ps_partkey)","Execution Info":"time:4.61s, loops:13, inner:{total:17.2s, concurrency:5, task:6, construct:20.4ms, fetch:17.1s, build:5.88ms, join:54.4ms}","Disk":0,"Memory":792221,"Plans":[{"Node Id":"TableReader","Plan Rows":784.1352659017139,"Actual Rows":2144,"Task":"root","Total Time":126505449,"Max Time":126505449,"Access Object":"","Operation Info":"data:Selection_95","Execution Info":"time:126.5ms, loops:8, cop_task: {num: 1, max: 92.7ms, proc_keys: 0, rpc_num: 1, rpc_time: 92.7ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":109114,"Plans":[{"Node Id":"Selection","Plan Rows":784.1352659017139,"Actual Rows":2144,"Task":"cop[tikv]","Total Time":234000000,"Max Time":234000000,"Access Object":"","Operation Info":"like(new0107.part.p_name, \"green%\", 92)","Execution Info":"tikv_task:{time:234ms, loops:200}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":200000,"Actual Rows":200000,"Task":"cop[tikv]","Total Time":206000000,"Max Time":206000000,"Access Object":"","Operation Info":"table:part, keep order:false","Execution Info":"tikv_task:{time:206ms, loops:200}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"IndexLookUp","Plan Rows":4.061738424045491,"Actual Rows":8576,"Task":"root","Total Time":17025639821,"Max Time":4481452394,"Access Object":"","Operation Info":"","Execution Info":"time:17s, loops:19, index_task: {total_time: 8.58s, fetch_handle: 8.58s, build: 339.5µs, wait: 309.4µs}, table_task: {total_time: 9.53s, num: 10, concurrency: 30}","Disk":0,"Memory":239428,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":4.061738424045491,"Actual Rows":8576,"Task":"cop[tikv]","Total Time":81000000,"Max Time":35000000,"Access Object":"","Operation Info":"table:partsupp, index:PRIMARY(PS_PARTKEY, PS_SUPPKEY), range: decided by [eq(new0107.partsupp.ps_partkey, new0107.part.p_partkey)], keep order:false","Execution Info":"time:8.57s, loops:25, cop_task: {num: 6, max: 3.66s, min: 241.9ms, avg: 1.4s, p95: 3.66s, max_proc_keys: 4100, p95_proc_keys: 4100, tot_proc: 1.14s, tot_wait: 632ms, rpc_num: 11, rpc_time: 16.6s, copr_cache_hit_ratio: 0.17}, tikv_task:{proc max:35ms, min:1ms, p80:27ms, p95:35ms, iters:36, tasks:6}, scan_detail: {total_process_keys: 6992, total_process_keys_size: 370576, total_keys: 8740, rocksdb: {delete_skipped_count: 0, key_skipped_count: 6992, block: {cache_hit_count: 6999, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]},{"Node Id":"TableRowIDScan","Plan Rows":4.061738424045491,"Actual Rows":8576,"Task":"cop[tikv]","Total Time":65000000,"Max Time":18000000,"Access Object":"","Operation Info":"table:partsupp, keep order:false","Execution Info":"time:9.35s, loops:24, cop_task: {num: 11, max: 1.87s, min: 65.9ms, avg: 463.8ms, p95: 1.87s, max_proc_keys: 2048, p95_proc_keys: 2048, tot_proc: 87ms, tot_wait: 1.08s, rpc_num: 21, rpc_time: 9.7s, copr_cache_hit_ratio: 0.27}, tikv_task:{proc max:18ms, min:0s, p80:7ms, p95:18ms, iters:50, tasks:11}, scan_detail: {total_process_keys: 4984, total_process_keys_size: 936122, total_keys: 6222, rocksdb: {delete_skipped_count: 0, key_skipped_count: 4984, block: {cache_hit_count: 4966, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":599374.3333333333,"Actual Rows":606222,"Task":"root","Total Time":91174756,"Max Time":91174756,"Access Object":"","Operation Info":"data:Selection_100","Execution Info":"time:91.2ms, loops:591, cop_task: {num: 9, max: 368.2ms, min: 80.6ms, avg: 175.5ms, p95: 368.2ms, rpc_num: 9, rpc_time: 1.58s, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":38950283,"Plans":[{"Node Id":"Selection","Plan Rows":599374.3333333333,"Actual Rows":606222,"Task":"cop[tikv]","Total Time":4423000000,"Max Time":656000000,"Access Object":"","Operation Info":"ge(new0107.lineitem.l_shipdate, 1993-01-01 00:00:00.000000), lt(new0107.lineitem.l_shipdate, 1994-01-01 00:00:00.000000)","Execution Info":"tikv_task:{proc max:656ms, min:273ms, p80:546ms, p95:656ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4155000000,"Max Time":600000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:600ms, min:257ms, p80:522ms, p95:600ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  s_name,  s_address from  supplier,  nation where  s_suppkey in (   select    ps_suppkey   from    partsupp   where    ps_partkey in (     select      p_partkey     from      part     where      p_name like 'green%'    )    and ps_availqty > (     select      0.5 * sum(l_quantity)     from      lineitem     where      l_partkey = ps_partkey      and l_suppkey = ps_suppkey      and l_shipdate >= '1993-01-01'      and l_shipdate < date_add('1993-01-01', interval '1' year)    )  )  and s_nationkey = n_nationkey  and n_name = 'ALGERIA' order by  s_name;

{"Node Id":"Projection","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":6017072558,"Max Time":6017072558,"Access Object":"","Operation Info":"div(Column#46, 7.0)-\u003eColumn#47","Execution Info":"time:6.02s, loops:2, Concurrency:OFF","Disk":0,"Memory":1428,"Plans":[{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":6015650629,"Max Time":6015650629,"Access Object":"","Operation Info":"funcs:sum(new0107.lineitem.l_extendedprice)-\u003eColumn#46","Execution Info":"time:6.02s, loops:2, partial_worker:{wall_time:6.015607355s, concurrency:5, task_num:5, tot_wait:30.075130317s, tot_exec:167.812µs, tot_time:30.075315252s, max:6.015096599s, p95:6.015096599s}, final_worker:{wall_time:0s, concurrency:5, task_num:5, tot_wait:30.079527051s, tot_exec:29.136µs, tot_time:30.079562208s, max:6.016509014s, p95:6.016509014s}","Disk":0,"Memory":37608,"Plans":[{"Node Id":"HashJoin","Plan Rows":1210.4745245946383,"Actual Rows":421,"Task":"root","Total Time":6015196750,"Max Time":6015196750,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.part.p_partkey, new0107.lineitem.l_partkey)], other cond:lt(new0107.lineitem.l_quantity, mul(0.2, Column#44))","Execution Info":"time:6.02s, loops:6, build_hash_table:{total:4.9s, fetch:4.9s, build:797.7µs}, probe:{concurrency:5, total:30.1s, max:6.01s, probe:49.3ms, fetch:30s}","Disk":0,"Memory":514912,"Plans":[{"Node Id":"HashJoin","Plan Rows":1210.4745245946383,"Actual Rows":4588,"Task":"root","Total Time":4896637534,"Max Time":4896637534,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.part.p_partkey, new0107.lineitem.l_partkey)]","Execution Info":"time:4.9s, loops:7, build_hash_table:{total:376.4ms, fetch:376.1ms, build:314.1µs}, probe:{concurrency:5, total:24.5s, max:4.9s, probe:1.81s, fetch:22.7s}","Disk":0,"Memory":41680,"Plans":[{"Node Id":"TableReader","Plan Rows":59.45536499999999,"Actual Rows":233,"Task":"root","Total Time":376035906,"Max Time":376035906,"Access Object":"","Operation Info":"data:Selection_39","Execution Info":"time:376ms, loops:2, cop_task: {num: 1, max: 285.4ms, proc_keys: 0, rpc_num: 1, rpc_time: 285.4ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":16068,"Plans":[{"Node Id":"Selection","Plan Rows":59.45536499999999,"Actual Rows":233,"Task":"cop[tikv]","Total Time":230000000,"Max Time":230000000,"Access Object":"","Operation Info":"eq(new0107.part.p_brand, \"Brand#44\"), eq(new0107.part.p_container, \"WRAP PKG\")","Execution Info":"tikv_task:{time:230ms, loops:200}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":200000,"Actual Rows":200000,"Task":"cop[tikv]","Total Time":194000000,"Max Time":194000000,"Access Object":"","Operation Info":"table:part, keep order:false","Execution Info":"tikv_task:{time:194ms, loops:200}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":4009984,"Actual Rows":4009984,"Task":"root","Total Time":4217187043,"Max Time":4217187043,"Access Object":"","Operation Info":"data:TableFullScan_36","Execution Info":"time:4.22s, loops:3924, cop_task: {num: 9, max: 4.58s, min: 2.3s, avg: 4.13s, p95: 4.58s, max_proc_keys: 512775, p95_proc_keys: 512775, tot_proc: 21.4s, tot_wait: 17ms, rpc_num: 9, rpc_time: 37.2s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":167406724,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":8369000000,"Max Time":1880000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:1.88s, min:253ms, p80:1.43s, p95:1.88s, iters:3959, tasks:9}, scan_detail: {total_process_keys: 4009984, total_process_keys_size: 787655655, total_keys: 4009993, rocksdb: {delete_skipped_count: 0, key_skipped_count: 4009984, block: {cache_hit_count: 12898, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"HashAgg","Plan Rows":196960,"Actual Rows":200000,"Task":"root","Total Time":6013158706,"Max Time":6013158706,"Access Object":"","Operation Info":"group by:new0107.lineitem.l_partkey, funcs:avg(Column#50, Column#51)-\u003eColumn#44, funcs:firstrow(new0107.lineitem.l_partkey)-\u003enew0107.lineitem.l_partkey","Execution Info":"time:6.01s, loops:200, partial_worker:{wall_time:5.358261469s, concurrency:5, task_num:9, tot_wait:1.386538218s, tot_exec:23.744858477s, tot_time:25.763024704s, max:5.357353195s, p95:5.357353195s}, final_worker:{wall_time:6.013575706s, concurrency:5, task_num:25, tot_wait:25.28630478s, tot_exec:4.25092865s, tot_time:29.537260701s, max:6.012539471s, p95:6.012539471s}","Disk":0,"Memory":231651178,"Plans":[{"Node Id":"TableReader","Plan Rows":196960,"Actual Rows":1590811,"Task":"root","Total Time":711051445,"Max Time":711051445,"Access Object":"","Operation Info":"data:HashAgg_41","Execution Info":"time:711.1ms, loops:10, cop_task: {num: 9, max: 365.4ms, min: 31.6ms, avg: 219.9ms, p95: 365.4ms, rpc_num: 9, rpc_time: 1.98s, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":30279476,"Plans":[{"Node Id":"HashAgg","Plan Rows":196960,"Actual Rows":1590811,"Task":"cop[tikv]","Total Time":8618000000,"Max Time":1120000000,"Access Object":"","Operation Info":"group by:new0107.lineitem.l_partkey, funcs:count(new0107.lineitem.l_quantity)-\u003eColumn#50, funcs:sum(new0107.lineitem.l_quantity)-\u003eColumn#51","Execution Info":"tikv_task:{proc max:1.12s, min:574ms, p80:1.09s, p95:1.12s, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4380000000,"Max Time":570000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:570ms, min:362ms, p80:563ms, p95:570ms, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  sum(l_extendedprice) / 7.0 as avg_yearly from  lineitem,  part where  p_partkey = l_partkey  and p_brand = 'Brand#44'  and p_container = 'WRAP PKG'  and l_quantity < (   select    0.2 * avg(l_quantity)   from    lineitem   where    l_partkey = p_partkey  );

{"Node Id":"Projection","Plan Rows":100,"Actual Rows":6,"Task":"root","Total Time":6224170615,"Max Time":6224170615,"Access Object":"","Operation Info":"new0107.customer.c_name, new0107.customer.c_custkey, new0107.orders.o_orderkey, new0107.orders.o_orderdate, new0107.orders.o_totalprice, Column#54","Execution Info":"time:6.22s, loops:2, Concurrency:OFF","Disk":0,"Memory":4600,"Plans":[{"Node Id":"TopN","Plan Rows":100,"Actual Rows":6,"Task":"root","Total Time":6223919659,"Max Time":6223919659,"Access Object":"","Operation Info":"new0107.orders.o_totalprice:desc, new0107.orders.o_orderdate, offset:0, count:100","Execution Info":"time:6.22s, loops:2","Disk":0,"Memory":9248,"Plans":[{"Node Id":"HashAgg","Plan Rows":807403.0718960115,"Actual Rows":6,"Task":"root","Total Time":6221137605,"Max Time":6221137605,"Access Object":"","Operation Info":"group by:new0107.customer.c_custkey, new0107.customer.c_name, new0107.orders.o_orderdate, new0107.orders.o_orderkey, new0107.orders.o_totalprice, funcs:sum(new0107.lineitem.l_quantity)-\u003eColumn#54, funcs:firstrow(new0107.customer.c_custkey)-\u003enew0107.customer.c_custkey, funcs:firstrow(new0107.customer.c_name)-\u003enew0107.customer.c_name, funcs:firstrow(new0107.orders.o_orderkey)-\u003enew0107.orders.o_orderkey, funcs:firstrow(new0107.orders.o_totalprice)-\u003enew0107.orders.o_totalprice, funcs:firstrow(new0107.orders.o_orderdate)-\u003enew0107.orders.o_orderdate","Execution Info":"time:6.22s, loops:4, partial_worker:{wall_time:6.201128525s, concurrency:5, task_num:3, tot_wait:30.686879996s, tot_exec:202.459063ms, tot_time:30.89223793s, max:6.191029044s, p95:6.191029044s}, final_worker:{wall_time:6.241470324s, concurrency:5, task_num:4, tot_wait:31.040246046s, tot_exec:9.293011ms, tot_time:31.049546013s, max:6.211288913s, p95:6.211288913s}","Disk":0,"Memory":50456,"Plans":[{"Node Id":"HashJoin","Plan Rows":3273498.568184062,"Actual Rows":42,"Task":"root","Total Time":6171430917,"Max Time":6171430917,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.orders.o_orderkey, new0107.lineitem.l_orderkey)]","Execution Info":"time:6.17s, loops:4, build_hash_table:{total:5.55s, fetch:5.55s, build:16.5µs}, probe:{concurrency:5, total:30.5s, max:6.15s, probe:819.2ms, fetch:29.6s}","Disk":0,"Memory":9516,"Plans":[{"Node Id":"HashJoin","Plan Rows":807403.0718960115,"Actual Rows":6,"Task":"root","Total Time":5531112113,"Max Time":5531112113,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.orders.o_orderkey, new0107.lineitem.l_orderkey)]","Execution Info":"time:5.53s, loops:4, build_hash_table:{total:2.81s, fetch:2.81s, build:636.5µs}, probe:{concurrency:5, total:27.7s, max:5.53s, probe:167.4ms, fetch:27.5s}","Disk":0,"Memory":49664,"Plans":[{"Node Id":"HashJoin","Plan Rows":1097817.7150192554,"Actual Rows":1001472,"Task":"root","Total Time":5526793527,"Max Time":5526793527,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.customer.c_custkey, new0107.orders.o_custkey)]","Execution Info":"time:5.53s, loops:981, build_hash_table:{total:262.2ms, fetch:129.9ms, build:132.4ms}, probe:{concurrency:5, total:27.6s, max:5.51s, probe:10.8s, fetch:16.7s}","Disk":0,"Memory":5182368,"Plans":[{"Node Id":"TableReader","Plan Rows":150000,"Actual Rows":150000,"Task":"root","Total Time":127108874,"Max Time":127108874,"Access Object":"","Operation Info":"data:TableFullScan_88","Execution Info":"time:127.1ms, loops:148, cop_task: {num: 1, max: 168.2ms, proc_keys: 0, rpc_num: 1, rpc_time: 168.1ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":5105011,"Plans":[{"Node Id":"TableFullScan","Plan Rows":150000,"Actual Rows":150000,"Task":"cop[tikv]","Total Time":169000000,"Max Time":169000000,"Access Object":"","Operation Info":"table:customer, keep order:false","Execution Info":"tikv_task:{time:169ms, loops:151}","Disk":0,"Memory":0,"Plans":[]}]},{"Node Id":"TableReader","Plan Rows":1094656,"Actual Rows":1001472,"Task":"root","Total Time":3152810950,"Max Time":3152810950,"Access Object":"","Operation Info":"data:TableFullScan_86","Execution Info":"time:3.15s, loops:980, cop_task: {num: 2, max: 4.29s, min: 3.12s, avg: 3.7s, p95: 4.29s, max_proc_keys: 583494, p95_proc_keys: 583494, tot_proc: 6.08s, tot_wait: 415ms, rpc_num: 2, rpc_time: 7.41s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":64133926,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":3276000000,"Max Time":2817000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:2.82s, min:459ms, p80:2.82s, p95:2.82s, iters:987, tasks:2}, scan_detail: {total_process_keys: 1001472, total_process_keys_size: 151717700, total_keys: 1001474, rocksdb: {delete_skipped_count: 0, key_skipped_count: 1001472, block: {cache_hit_count: 2529, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"Selection","Plan Rows":791244.8,"Actual Rows":6,"Task":"root","Total Time":2812938123,"Max Time":2812938123,"Access Object":"","Operation Info":"gt(Column#52, 314)","Execution Info":"time:2.81s, loops:2","Disk":0,"Memory":50944,"Plans":[{"Node Id":"HashAgg","Plan Rows":989056,"Actual Rows":1002367,"Task":"root","Total Time":2523356102,"Max Time":2523356102,"Access Object":"","Operation Info":"group by:new0107.lineitem.l_orderkey, funcs:sum(Column#66)-\u003eColumn#52, funcs:firstrow(new0107.lineitem.l_orderkey)-\u003enew0107.lineitem.l_orderkey","Execution Info":"time:2.52s, loops:983, partial_worker:{wall_time:1.287019847s, concurrency:5, task_num:9, tot_wait:970.018338ms, tot_exec:3.281237918s, tot_time:4.860776104s, max:1.285410803s, p95:1.285410803s}, final_worker:{wall_time:2.814320088s, concurrency:5, task_num:25, tot_wait:3.62828066s, tot_exec:9.363184782s, tot_time:12.99152703s, max:2.796974039s, p95:2.796974039s}","Disk":0,"Memory":350268292,"Plans":[{"Node Id":"TableReader","Plan Rows":989056,"Actual Rows":1002374,"Task":"root","Total Time":297763434,"Max Time":297763434,"Access Object":"","Operation Info":"data:HashAgg_91","Execution Info":"time:297.8ms, loops:10, cop_task: {num: 9, max: 263.9ms, min: 179ms, avg: 231.9ms, p95: 263.9ms, rpc_num: 9, rpc_time: 2.09s, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":11712876,"Plans":[{"Node Id":"HashAgg","Plan Rows":989056,"Actual Rows":1002374,"Task":"cop[tikv]","Total Time":5051000000,"Max Time":713000000,"Access Object":"","Operation Info":"group by:new0107.lineitem.l_orderkey, funcs:sum(new0107.lineitem.l_quantity)-\u003eColumn#66","Execution Info":"tikv_task:{proc max:713ms, min:301ms, p80:675ms, p95:713ms, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":3708000000,"Max Time":535000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:535ms, min:241ms, p80:502ms, p95:535ms, iters:3923, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]},{"Node Id":"TableReader","Plan Rows":4009984,"Actual Rows":4009984,"Task":"root","Total Time":1194232413,"Max Time":1194232413,"Access Object":"","Operation Info":"data:TableFullScan_101","Execution Info":"time:1.19s, loops:3924, cop_task: {num: 9, max: 4.4s, min: 1.13s, avg: 3.5s, p95: 4.4s, max_proc_keys: 512775, p95_proc_keys: 512775, tot_proc: 26.3s, tot_wait: 1.51s, rpc_num: 9, rpc_time: 31.5s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":192576075,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4216000000,"Max Time":565000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:565ms, min:349ms, p80:545ms, p95:565ms, iters:3959, tasks:9}, scan_detail: {total_process_keys: 4009984, total_process_keys_size: 787655655, total_keys: 4009993, rocksdb: {delete_skipped_count: 0, key_skipped_count: 4009984, block: {cache_hit_count: 12898, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}
/*PLACEHOLDER*/ select  c_name,  c_custkey,  o_orderkey,  o_orderdate,  o_totalprice,  sum(l_quantity) from  customer,  orders,  lineitem where  o_orderkey in (   select    l_orderkey   from    lineitem   group by    l_orderkey having     sum(l_quantity) > 314  )  and c_custkey = o_custkey  and o_orderkey = l_orderkey group by  c_name,  c_custkey,  o_orderkey,  o_orderdate,  o_totalprice order by  o_totalprice desc,  o_orderdate limit 100;

{"Node Id":"HashAgg","Plan Rows":1,"Actual Rows":1,"Task":"root","Total Time":336121633,"Max Time":336121633,"Access Object":"","Operation Info":"funcs:sum(Column#28)-\u003eColumn#27","Execution Info":"time:336.1ms, loops:2, partial_worker:{wall_time:243.013634ms, concurrency:5, task_num:5, tot_wait:996.618398ms, tot_exec:351.467µs, tot_time:996.987749ms, max:199.442873ms, p95:199.442873ms}, final_worker:{wall_time:299.249909ms, concurrency:5, task_num:5, tot_wait:1.116642823s, tot_exec:228.984µs, tot_time:1.12192865s, max:240.670981ms, p95:240.670981ms}","Disk":0,"Memory":19056,"Plans":[{"Node Id":"Projection","Plan Rows":2810.7054154138987,"Actual Rows":72,"Task":"root","Total Time":212395134,"Max Time":212395134,"Access Object":"","Operation Info":"mul(new0107.lineitem.l_extendedprice, minus(1, new0107.lineitem.l_discount))-\u003eColumn#28","Execution Info":"time:212.4ms, loops:6, Concurrency:5","Disk":0,"Memory":21420,"Plans":[{"Node Id":"HashJoin","Plan Rows":2810.7054154138987,"Actual Rows":72,"Task":"root","Total Time":183934486,"Max Time":183934486,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.part.p_partkey, new0107.lineitem.l_partkey)], other cond:or(and(and(eq(new0107.part.p_brand, \"Brand#52\"), in(new0107.part.p_container, \"SM CASE\", \"SM BOX\", \"SM PACK\", \"SM PKG\")), and(ge(new0107.lineitem.l_quantity, 4), and(le(new0107.lineitem.l_quantity, 14), le(new0107.part.p_size, 5)))), or(and(and(eq(new0107.part.p_brand, \"Brand#11\"), in(new0107.part.p_container, \"MED BAG\", \"MED BOX\", \"MED PKG\", \"MED PACK\")), and(ge(new0107.lineitem.l_quantity, 18), and(le(new0107.lineitem.l_quantity, 28), le(new0107.part.p_size, 10)))), and(and(eq(new0107.part.p_brand, \"Brand#51\"), in(new0107.part.p_container, \"LG CASE\", \"LG BOX\", \"LG PACK\", \"LG PKG\")), and(ge(new0107.lineitem.l_quantity, 29), and(le(new0107.lineitem.l_quantity, 39), le(new0107.part.p_size, 15))))))","Execution Info":"time:183.9ms, loops:6, build_hash_table:{total:8.94ms, fetch:8.76ms, build:188.2µs}, probe:{concurrency:5, total:695.1ms, max:145.5ms, probe:525.4ms, fetch:169.7ms}","Disk":0,"Memory":50112,"Plans":[{"Node Id":"TableReader","Plan Rows":138.05455049694,"Actual Rows":453,"Task":"root","Total Time":438189,"Max Time":438189,"Access Object":"","Operation Info":"data:Selection_30","Execution Info":"time:438.2µs, loops:2, cop_task: {num: 1, max: 101.1ms, proc_keys: 0, rpc_num: 1, rpc_time: 101.1ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":30667,"Plans":[{"Node Id":"Selection","Plan Rows":138.05455049694,"Actual Rows":453,"Task":"cop[tikv]","Total Time":281000000,"Max Time":281000000,"Access Object":"","Operation Info":"ge(new0107.part.p_size, 1), or(and(eq(new0107.part.p_brand, \"Brand#52\"), and(in(new0107.part.p_container, \"SM CASE\", \"SM BOX\", \"SM PACK\", \"SM PKG\"), le(new0107.part.p_size, 5))), or(and(eq(new0107.part.p_brand, \"Brand#11\"), and(in(new0107.part.p_container, \"MED BAG\", \"MED BOX\", \"MED PKG\", \"MED PACK\"), le(new0107.part.p_size, 10))), and(eq(new0107.part.p_brand, \"Brand#51\"), and(in(new0107.part.p_container, \"LG CASE\", \"LG BOX\", \"LG PACK\", \"LG PKG\"), le(new0107.part.p_size, 15)))))","Execution Info":"tikv_task:{time:281ms, loops:200}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":200000,"Actual Rows":200000,"Task":"cop[tikv]","Total Time":168000000,"Max Time":168000000,"Access Object":"","Operation Info":"table:part, keep order:false","Execution Info":"tikv_task:{time:168ms, loops:200}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":182075.37432781045,"Actual Rows":94250,"Task":"root","Total Time":55950372,"Max Time":55950372,"Access Object":"","Operation Info":"data:Selection_27","Execution Info":"time:56ms, loops:93, cop_task: {num: 9, max: 86.2ms, min: 40.7ms, avg: 72ms, p95: 86.2ms, rpc_num: 9, rpc_time: 647.8ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":15735068,"Plans":[{"Node Id":"Selection","Plan Rows":182075.37432781045,"Actual Rows":94250,"Task":"cop[tikv]","Total Time":8816000000,"Max Time":1142000000,"Access Object":"","Operation Info":"eq(new0107.lineitem.l_shipinstruct, \"DELIVER IN PERSON\"), in(new0107.lineitem.l_shipmode, \"AIR\", \"AIR REG\"), or(and(ge(new0107.lineitem.l_quantity, 4), le(new0107.lineitem.l_quantity, 14)), or(and(ge(new0107.lineitem.l_quantity, 18), le(new0107.lineitem.l_quantity, 28)), and(ge(new0107.lineitem.l_quantity, 29), le(new0107.lineitem.l_quantity, 39))))","Execution Info":"tikv_task:{proc max:1.14s, min:714ms, p80:1.1s, p95:1.14s, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":5885000000,"Max Time":738000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:738ms, min:537ms, p80:692ms, p95:738ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}
/*PLACEHOLDER*/ select  sum(l_extendedprice* (1 - l_discount)) as revenue from  lineitem,  part where  (   p_partkey = l_partkey   and p_brand = 'Brand#52'   and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')   and l_quantity >= 4 and l_quantity <= 4 + 10   and p_size between 1 and 5   and l_shipmode in ('AIR', 'AIR REG')   and l_shipinstruct = 'DELIVER IN PERSON'  )  or  (   p_partkey = l_partkey   and p_brand = 'Brand#11'   and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')   and l_quantity >= 18 and l_quantity <= 18 + 10   and p_size between 1 and 10   and l_shipmode in ('AIR', 'AIR REG')   and l_shipinstruct = 'DELIVER IN PERSON'  )  or  (   p_partkey = l_partkey   and p_brand = 'Brand#51'   and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')   and l_quantity >= 29 and l_quantity <= 29 + 10   and p_size between 1 and 15   and l_shipmode in ('AIR', 'AIR REG')   and l_shipinstruct = 'DELIVER IN PERSON'  );

{"Node Id":"Projection","Plan Rows":6.4,"Actual Rows":100,"Task":"root","Total Time":9954472176,"Max Time":9954472176,"Access Object":"","Operation Info":"new0107.supplier.s_name, Column#72","Execution Info":"time:9.95s, loops:2, Concurrency:OFF","Disk":0,"Memory":4728,"Plans":[{"Node Id":"TopN","Plan Rows":6.4,"Actual Rows":100,"Task":"root","Total Time":9954448965,"Max Time":9954448965,"Access Object":"","Operation Info":"Column#72:desc, new0107.supplier.s_name, offset:0, count:100","Execution Info":"time:9.95s, loops:2","Disk":0,"Memory":12344,"Plans":[{"Node Id":"HashAgg","Plan Rows":6.4,"Actual Rows":414,"Task":"root","Total Time":9953598079,"Max Time":9953598079,"Access Object":"","Operation Info":"group by:new0107.supplier.s_name, funcs:count(1)-\u003eColumn#72, funcs:firstrow(new0107.supplier.s_name)-\u003enew0107.supplier.s_name","Execution Info":"time:9.95s, loops:6, partial_worker:{wall_time:9.944019034s, concurrency:5, task_num:3, tot_wait:49.573559936s, tot_exec:55.106141ms, tot_time:49.629250259s, max:9.929301366s, p95:9.929301366s}, final_worker:{wall_time:9.985443158s, concurrency:5, task_num:15, tot_wait:49.668184402s, tot_exec:1.620013ms, tot_time:49.669825385s, max:9.935789139s, p95:9.935789139s}","Disk":0,"Memory":348828,"Plans":[{"Node Id":"IndexJoin","Plan Rows":2611.2567138461536,"Actual Rows":2750,"Task":"root","Total Time":9926368594,"Max Time":9926368594,"Access Object":"","Operation Info":"anti semi join, inner:IndexLookUp_39, outer key:new0107.lineitem.l_orderkey, inner key:new0107.lineitem.l_orderkey, equal cond:eq(new0107.lineitem.l_orderkey, new0107.lineitem.l_orderkey), other cond:ne(new0107.lineitem.l_suppkey, new0107.lineitem.l_suppkey)","Execution Info":"time:9.93s, loops:4, inner:{total:9.01s, concurrency:5, task:10, construct:345.1ms, fetch:8.56s, build:101.7ms}, probe:219.3ms","Disk":0,"Memory":16984503,"Plans":[{"Node Id":"IndexJoin","Plan Rows":3264.070892307692,"Actual Rows":49059,"Task":"root","Total Time":8964182585,"Max Time":8964182585,"Access Object":"","Operation Info":"semi join, inner:IndexLookUp_80, outer key:new0107.lineitem.l_orderkey, inner key:new0107.lineitem.l_orderkey, equal cond:eq(new0107.lineitem.l_orderkey, new0107.lineitem.l_orderkey), other cond:ne(new0107.lineitem.l_suppkey, new0107.lineitem.l_suppkey), ne(new0107.lineitem.l_suppkey, new0107.supplier.s_suppkey)","Execution Info":"time:8.96s, loops:53, inner:{total:24.4s, concurrency:5, task:10, construct:410.8ms, fetch:23.8s, build:167ms}, probe:211ms","Disk":0,"Memory":15306973,"Plans":[{"Node Id":"IndexJoin","Plan Rows":4080.0886153846145,"Actual Rows":50936,"Task":"root","Total Time":5286743441,"Max Time":5286743441,"Access Object":"","Operation Info":"inner join, inner:TableReader_95, outer key:new0107.lineitem.l_orderkey, inner key:new0107.orders.o_orderkey, equal cond:eq(new0107.lineitem.l_orderkey, new0107.orders.o_orderkey)","Execution Info":"time:5.29s, loops:55, inner:{total:15.3s, concurrency:5, task:12, construct:305.9ms, fetch:14.9s, build:150.2ms}, probe:277.3ms","Disk":0,"Memory":16229245,"Plans":[{"Node Id":"HashJoin","Plan Rows":4009.984,"Actual Rows":105617,"Task":"root","Total Time":800690862,"Max Time":800690862,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.supplier.s_suppkey, new0107.lineitem.l_suppkey)]","Execution Info":"time:800.7ms, loops:108, build_hash_table:{total:201.9ms, fetch:201.7ms, build:206.2µs}, probe:{concurrency:5, total:4.78s, max:990.7ms, probe:2.35s, fetch:2.43s}","Disk":0,"Memory":19640,"Plans":[{"Node Id":"HashJoin","Plan Rows":10,"Actual Rows":415,"Task":"root","Total Time":199168018,"Max Time":199168018,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.supplier.s_nationkey)]","Execution Info":"time:199.2ms, loops:6, build_hash_table:{total:156.2ms, fetch:156.2ms, build:8.27µs}, probe:{concurrency:5, total:908.1ms, max:188.4ms, probe:1.33ms, fetch:906.8ms}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":0.025,"Actual Rows":1,"Task":"root","Total Time":155990965,"Max Time":155990965,"Access Object":"","Operation Info":"data:Selection_124","Execution Info":"time:156ms, loops:2, cop_task: {num: 1, max: 138.8ms, proc_keys: 25, rpc_num: 1, rpc_time: 138.8ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":243,"Plans":[{"Node Id":"Selection","Plan Rows":0.025,"Actual Rows":1,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"eq(new0107.nation.n_name, \"EGYPT\")","Execution Info":"tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":0,"Max Time":0,"Access Object":"","Operation Info":"table:nation, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:0s, loops:1}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":10000,"Actual Rows":10000,"Task":"root","Total Time":130901030,"Max Time":130901030,"Access Object":"","Operation Info":"data:TableFullScan_121","Execution Info":"time:130.9ms, loops:11, cop_task: {num: 1, max: 94.7ms, proc_keys: 0, rpc_num: 1, rpc_time: 94.6ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":420728,"Plans":[{"Node Id":"TableFullScan","Plan Rows":10000,"Actual Rows":10000,"Task":"cop[tikv]","Total Time":8000000,"Max Time":8000000,"Access Object":"","Operation Info":"table:supplier, keep order:false","Execution Info":"tikv_task:{time:8ms, loops:14}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":3207987.2,"Actual Rows":2534187,"Task":"root","Total Time":137064266,"Max Time":137064266,"Access Object":"","Operation Info":"data:Selection_127","Execution Info":"time:137.1ms, loops:2468, cop_task: {num: 9, max: 121.8ms, min: 26.9ms, avg: 71.5ms, p95: 121.8ms, rpc_num: 9, rpc_time: 643.6ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":81253914,"Plans":[{"Node Id":"Selection","Plan Rows":3207987.2,"Actual Rows":2534187,"Task":"cop[tikv]","Total Time":5546000000,"Max Time":794000000,"Access Object":"","Operation Info":"gt(new0107.lineitem.l_receiptdate, new0107.lineitem.l_commitdate)","Execution Info":"tikv_task:{proc max:794ms, min:404ms, p80:692ms, p95:794ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4975000000,"Max Time":755000000,"Access Object":"","Operation Info":"table:l1, keep order:false","Execution Info":"tikv_task:{proc max:755ms, min:308ms, p80:628ms, p95:755ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"TableReader","Plan Rows":0.45678627040378006,"Actual Rows":48357,"Task":"root","Total Time":14689936313,"Max Time":4009890170,"Access Object":"","Operation Info":"data:Selection_94","Execution Info":"time:14.7s, loops:65, cop_task: {num: 17, max: 3.86s, min: 101.2ms, avg: 1.21s, p95: 3.86s, max_proc_keys: 24063, p95_proc_keys: 24063, tot_proc: 17.6s, tot_wait: 1.36s, rpc_num: 33, rpc_time: 41s, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":0,"Plans":[{"Node Id":"Selection","Plan Rows":0.45678627040378006,"Actual Rows":48357,"Task":"cop[tikv]","Total Time":10437000000,"Max Time":2708000000,"Access Object":"","Operation Info":"eq(new0107.orders.o_orderstatus, \"F\")","Execution Info":"tikv_task:{proc max:2.71s, min:11ms, p80:1.5s, p95:2.71s, iters:169, tasks:17}, scan_detail: {total_process_keys: 100128, total_process_keys_size: 15170695, total_keys: 108162, rocksdb: {delete_skipped_count: 0, key_skipped_count: 16674, block: {cache_hit_count: 131493, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRangeScan","Plan Rows":1,"Actual Rows":100128,"Task":"cop[tikv]","Total Time":10255000000,"Max Time":2707000000,"Access Object":"","Operation Info":"table:orders, range: decided by [new0107.lineitem.l_orderkey], keep order:false","Execution Info":"tikv_task:{proc max:2.71s, min:11ms, p80:1.5s, p95:2.71s, iters:169, tasks:17}","Disk":0,"Memory":0,"Plans":[]}]}]}]},{"Node Id":"IndexLookUp","Plan Rows":4.054354859583279,"Actual Rows":239373,"Task":"root","Total Time":22992612578,"Max Time":5088691253,"Access Object":"","Operation Info":"","Execution Info":"time:23s, loops:249, index_task: {total_time: 19.4s, fetch_handle: 19.4s, build: 95.6µs, wait: 135µs}, table_task: {total_time: 14.6s, num: 40, concurrency: 50}","Disk":0,"Memory":202856,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":4.054354859583279,"Actual Rows":239373,"Task":"cop[tikv]","Total Time":16027000000,"Max Time":2738000000,"Access Object":"","Operation Info":"table:l2, index:PRIMARY(L_ORDERKEY, L_LINENUMBER), range: decided by [eq(new0107.lineitem.l_orderkey, new0107.lineitem.l_orderkey)], keep order:false","Execution Info":"time:19.4s, loops:263, cop_task: {num: 19, max: 4.63s, min: 63.6ms, avg: 1.66s, p95: 4.63s, max_proc_keys: 43475, p95_proc_keys: 43475, tot_proc: 27.3s, tot_wait: 1.98s, rpc_num: 37, rpc_time: 1m3.1s, copr_cache_hit_ratio: 0.11}, tikv_task:{proc max:2.74s, min:7ms, p80:1.9s, p95:2.74s, iters:317, tasks:19}, scan_detail: {total_process_keys: 235767, total_process_keys_size: 12495651, total_keys: 283391, rocksdb: {delete_skipped_count: 0, key_skipped_count: 235767, block: {cache_hit_count: 190667, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]},{"Node Id":"TableRowIDScan","Plan Rows":4.054354859583279,"Actual Rows":239373,"Task":"cop[tikv]","Total Time":1679000000,"Max Time":179000000,"Access Object":"","Operation Info":"table:l2, keep order:false","Execution Info":"time:14.2s, loops:299, cop_task: {num: 55, max: 1.98s, min: 16.4ms, avg: 270.6ms, p95: 1.06s, max_proc_keys: 19234, p95_proc_keys: 16384, tot_proc: 7.94s, tot_wait: 2.75s, rpc_num: 109, rpc_time: 29.5s, copr_cache_hit_ratio: 0.05}, tikv_task:{proc max:179ms, min:0s, p80:54ms, p95:109ms, iters:481, tasks:55}, scan_detail: {total_process_keys: 234317, total_process_keys_size: 46019027, total_keys: 277655, rocksdb: {delete_skipped_count: 0, key_skipped_count: 232649, block: {cache_hit_count: 162018, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"IndexLookUp","Plan Rows":4.05435485958328,"Actual Rows":165987,"Task":"root","Total Time":8303684829,"Max Time":2023585912,"Access Object":"","Operation Info":"","Execution Info":"time:8.3s, loops:177, index_task: {total_time: 5.13s, fetch_handle: 5.13s, build: 84.6µs, wait: 131.3µs}, table_task: {total_time: 9.79s, num: 40, concurrency: 50}","Disk":0,"Memory":75696,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":5.0679435744790995,"Actual Rows":237493,"Task":"cop[tikv]","Total Time":1506000000,"Max Time":296000000,"Access Object":"","Operation Info":"table:l3, index:PRIMARY(L_ORDERKEY, L_LINENUMBER), range: decided by [eq(new0107.lineitem.l_orderkey, new0107.lineitem.l_orderkey)], keep order:false","Execution Info":"time:5.07s, loops:263, cop_task: {num: 19, max: 1.55s, min: 39.9ms, avg: 347.9ms, p95: 1.55s, max_proc_keys: 43144, p95_proc_keys: 43144, tot_proc: 4.39s, tot_wait: 961ms, rpc_num: 37, rpc_time: 13.2s, copr_cache_hit_ratio: 0.11}, tikv_task:{proc max:296ms, min:1ms, p80:132ms, p95:296ms, iters:317, tasks:19}, scan_detail: {total_process_keys: 233138, total_process_keys_size: 12356314, total_keys: 278763, rocksdb: {delete_skipped_count: 0, key_skipped_count: 233138, block: {cache_hit_count: 182668, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]},{"Node Id":"Selection","Plan Rows":4.05435485958328,"Actual Rows":165987,"Task":"cop[tikv]","Total Time":1709000000,"Max Time":138000000,"Access Object":"","Operation Info":"gt(new0107.lineitem.l_receiptdate, new0107.lineitem.l_commitdate)","Execution Info":"time:9.65s, loops:221, cop_task: {num: 55, max: 781.7ms, min: 27.9ms, avg: 171.1ms, p95: 752.4ms, max_proc_keys: 18400, p95_proc_keys: 16384, tot_proc: 2.36s, tot_wait: 4.71s, rpc_num: 109, rpc_time: 18.2s, copr_cache_hit_ratio: 0.15}, tikv_task:{proc max:138ms, min:0s, p80:53ms, p95:137ms, iters:479, tasks:55}, scan_detail: {total_process_keys: 225947, total_process_keys_size: 44376229, total_keys: 268093, rocksdb: {delete_skipped_count: 0, key_skipped_count: 225932, block: {cache_hit_count: 154183, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableRowIDScan","Plan Rows":5.0679435744790995,"Actual Rows":237493,"Task":"cop[tikv]","Total Time":1659000000,"Max Time":137000000,"Access Object":"","Operation Info":"table:l3, keep order:false","Execution Info":"tikv_task:{proc max:137ms, min:0s, p80:53ms, p95:119ms, iters:479, tasks:55}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  s_name,  count(*) as numwait from  supplier,  lineitem l1,  orders,  nation where  s_suppkey = l1.l_suppkey  and o_orderkey = l1.l_orderkey  and o_orderstatus = 'F'  and l1.l_receiptdate > l1.l_commitdate  and exists (   select    *   from    lineitem l2   where    l2.l_orderkey = l1.l_orderkey    and l2.l_suppkey <> l1.l_suppkey  )  and not exists (   select    *   from    lineitem l3   where    l3.l_orderkey = l1.l_orderkey    and l3.l_suppkey <> l1.l_suppkey    and l3.l_receiptdate > l3.l_commitdate  )  and s_nationkey = n_nationkey  and n_name = 'EGYPT' group by  s_name order by  numwait desc,  s_name limit 100;

{"Node Id":"Sort","Plan Rows":10,"Actual Rows":152,"Task":"root","Total Time":753927460,"Max Time":753927460,"Access Object":"","Operation Info":"new0107.supplier.s_name","Execution Info":"time:753.9ms, loops:2","Disk":0,"Memory":13568,"Plans":[{"Node Id":"HashJoin","Plan Rows":10,"Actual Rows":152,"Task":"root","Total Time":752834355,"Max Time":752834355,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.supplier.s_suppkey, new0107.partsupp.ps_suppkey)]","Execution Info":"time:752.8ms, loops:6, build_hash_table:{total:42.9ms, fetch:42.7ms, build:286.1µs}, probe:{concurrency:5, total:3.64s, max:727.9ms, probe:781.6µs, fetch:3.64s}","Disk":0,"Memory":35428,"Plans":[{"Node Id":"HashJoin","Plan Rows":10,"Actual Rows":420,"Task":"root","Total Time":42306255,"Max Time":42306255,"Access Object":"","Operation Info":"inner join, equal:[eq(new0107.nation.n_nationkey, new0107.supplier.s_nationkey)]","Execution Info":"time:42.3ms, loops:6, build_hash_table:{total:6.37ms, fetch:6.36ms, build:10.2µs}, probe:{concurrency:5, total:109.2ms, max:26ms, probe:2.54ms, fetch:106.6ms}","Disk":0,"Memory":25056,"Plans":[{"Node Id":"TableReader","Plan Rows":0.025,"Actual Rows":1,"Task":"root","Total Time":6299443,"Max Time":6299443,"Access Object":"","Operation Info":"data:Selection_52","Execution Info":"time:6.3ms, loops:2, cop_task: {num: 1, max: 31.7ms, proc_keys: 25, tot_proc: 1ms, tot_wait: 2ms, rpc_num: 1, rpc_time: 31.7ms, copr_cache_hit_ratio: 0.00}","Disk":0,"Memory":261,"Plans":[{"Node Id":"Selection","Plan Rows":0.025,"Actual Rows":1,"Task":"cop[tikv]","Total Time":1000000,"Max Time":1000000,"Access Object":"","Operation Info":"eq(new0107.nation.n_name, \"ALGERIA\")","Execution Info":"tikv_task:{time:1ms, loops:1}, scan_detail: {total_process_keys: 25, total_process_keys_size: 3109, total_keys: 26, rocksdb: {delete_skipped_count: 0, key_skipped_count: 25, block: {cache_hit_count: 4, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":25,"Actual Rows":25,"Task":"cop[tikv]","Total Time":1000000,"Max Time":1000000,"Access Object":"","Operation Info":"table:nation, keep order:false, stats:pseudo","Execution Info":"tikv_task:{time:1ms, loops:1}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":10000,"Actual Rows":10000,"Task":"root","Total Time":6653867,"Max Time":6653867,"Access Object":"","Operation Info":"data:TableFullScan_49","Execution Info":"time:6.65ms, loops:11, cop_task: {num: 1, max: 31.8ms, proc_keys: 0, rpc_num: 1, rpc_time: 31.7ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":750729,"Plans":[{"Node Id":"TableFullScan","Plan Rows":10000,"Actual Rows":10000,"Task":"cop[tikv]","Total Time":13000000,"Max Time":13000000,"Access Object":"","Operation Info":"table:supplier, keep order:false","Execution Info":"tikv_task:{time:13ms, loops:14}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"HashAgg","Plan Rows":2547.961871329696,"Actual Rows":3734,"Task":"root","Total Time":727050895,"Max Time":727050895,"Access Object":"","Operation Info":"group by:new0107.partsupp.ps_suppkey, funcs:firstrow(new0107.partsupp.ps_suppkey)-\u003enew0107.partsupp.ps_suppkey","Execution Info":"time:727.1ms, loops:6, partial_worker:{wall_time:725.371926ms, concurrency:5, task_num:5, tot_wait:3.592148533s, tot_exec:3.141733ms, tot_time:3.597175748s, max:720.391379ms, p95:720.391379ms}, final_worker:{wall_time:727.718414ms, concurrency:5, task_num:25, tot_wait:3.619237193s, tot_exec:5.215011ms, tot_time:3.62446696s, max:725.57285ms, p95:725.57285ms}","Disk":0,"Memory":1072919,"Plans":[{"Node Id":"Selection","Plan Rows":2547.961871329696,"Actual Rows":4608,"Task":"root","Total Time":718023902,"Max Time":718023902,"Access Object":"","Operation Info":"gt(cast(new0107.partsupp.ps_availqty, decimal(20,0) BINARY), mul(0.5, Column#44))","Execution Info":"time:718ms, loops:6","Disk":0,"Memory":60656,"Plans":[{"Node Id":"HashAgg","Plan Rows":3184.9523391621196,"Actual Rows":8576,"Task":"root","Total Time":710467287,"Max Time":710467287,"Access Object":"","Operation Info":"group by:new0107.partsupp.ps_partkey, new0107.partsupp.ps_suppkey, funcs:firstrow(new0107.partsupp.ps_suppkey)-\u003enew0107.partsupp.ps_suppkey, funcs:firstrow(new0107.partsupp.ps_availqty)-\u003enew0107.partsupp.ps_availqty, funcs:sum(new0107.lineitem.l_quantity)-\u003eColumn#44","Execution Info":"time:710.5ms, loops:12, partial_worker:{wall_time:700.909407ms, concurrency:5, task_num:15, tot_wait:3.356649762s, tot_exec:71.503571ms, tot_time:3.43002474s, max:687.63105ms, p95:687.63105ms}, final_worker:{wall_time:717.327967ms, concurrency:5, task_num:25, tot_wait:3.509318491s, tot_exec:35.939084ms, tot_time:3.545272767s, max:716.806504ms, p95:716.806504ms}","Disk":0,"Memory":4358056,"Plans":[{"Node Id":"HashJoin","Plan Rows":64843.663285959956,"Actual Rows":10496,"Task":"root","Total Time":680977975,"Max Time":680977975,"Access Object":"","Operation Info":"left outer join, equal:[eq(new0107.partsupp.ps_partkey, new0107.lineitem.l_partkey) eq(new0107.partsupp.ps_suppkey, new0107.lineitem.l_suppkey)]","Execution Info":"time:681ms, loops:16, build_hash_table:{total:401.3ms, fetch:395.5ms, build:5.8ms}, probe:{concurrency:5, total:3.09s, max:624.5ms, probe:461.2ms, fetch:2.63s}","Disk":0,"Memory":303864,"Plans":[{"Node Id":"IndexHashJoin","Plan Rows":3184.9523391621196,"Actual Rows":8576,"Task":"root","Total Time":398906411,"Max Time":398906411,"Access Object":"","Operation Info":"inner join, inner:IndexLookUp_64, outer key:new0107.part.p_partkey, inner key:new0107.partsupp.ps_partkey, equal cond:eq(new0107.part.p_partkey, new0107.partsupp.ps_partkey)","Execution Info":"time:398.9ms, loops:13, inner:{total:1.21s, concurrency:5, task:6, construct:8.29ms, fetch:1.13s, build:480.2µs, join:78.2ms}","Disk":0,"Memory":792221,"Plans":[{"Node Id":"TableReader","Plan Rows":784.1352659017139,"Actual Rows":2144,"Task":"root","Total Time":52372635,"Max Time":52372635,"Access Object":"","Operation Info":"data:Selection_95","Execution Info":"time:52.4ms, loops:8, cop_task: {num: 1, max: 34.2ms, proc_keys: 0, rpc_num: 1, rpc_time: 34.2ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":109118,"Plans":[{"Node Id":"Selection","Plan Rows":784.1352659017139,"Actual Rows":2144,"Task":"cop[tikv]","Total Time":234000000,"Max Time":234000000,"Access Object":"","Operation Info":"like(new0107.part.p_name, \"green%\", 92)","Execution Info":"tikv_task:{time:234ms, loops:200}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":200000,"Actual Rows":200000,"Task":"cop[tikv]","Total Time":206000000,"Max Time":206000000,"Access Object":"","Operation Info":"table:part, keep order:false","Execution Info":"tikv_task:{time:206ms, loops:200}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"IndexLookUp","Plan Rows":4.061738424045491,"Actual Rows":8576,"Task":"root","Total Time":1124033833,"Max Time":333292894,"Access Object":"","Operation Info":"","Execution Info":"time:1.12s, loops:19, index_task: {total_time: 529.2ms, fetch_handle: 529.1ms, build: 17.7µs, wait: 45.3µs}, table_task: {total_time: 793.7ms, num: 10, concurrency: 30}","Disk":0,"Memory":239428,"Plans":[{"Node Id":"IndexRangeScan","Plan Rows":4.061738424045491,"Actual Rows":8576,"Task":"cop[tikv]","Total Time":181000000,"Max Time":138000000,"Access Object":"","Operation Info":"table:partsupp, index:PRIMARY(PS_PARTKEY, PS_SUPPKEY), range: decided by [eq(new0107.partsupp.ps_partkey, new0107.part.p_partkey)], keep order:false","Execution Info":"time:527.9ms, loops:25, cop_task: {num: 6, max: 160.5ms, min: 8.24ms, avg: 55.6ms, p95: 160.5ms, max_proc_keys: 4100, p95_proc_keys: 4100, tot_proc: 163ms, tot_wait: 6ms, rpc_num: 11, rpc_time: 659.2ms, copr_cache_hit_ratio: 0.50}, tikv_task:{proc max:138ms, min:2ms, p80:23ms, p95:138ms, iters:36, tasks:6}, scan_detail: {total_process_keys: 6452, total_process_keys_size: 341956, total_keys: 8065, rocksdb: {delete_skipped_count: 0, key_skipped_count: 6452, block: {cache_hit_count: 6459, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]},{"Node Id":"TableRowIDScan","Plan Rows":4.061738424045491,"Actual Rows":8576,"Task":"cop[tikv]","Total Time":75000000,"Max Time":29000000,"Access Object":"","Operation Info":"table:partsupp, keep order:false","Execution Info":"time:739.9ms, loops:24, cop_task: {num: 11, max: 91.1ms, min: 14ms, avg: 47.2ms, p95: 91.1ms, max_proc_keys: 2048, p95_proc_keys: 2048, tot_proc: 44ms, tot_wait: 9ms, rpc_num: 20, rpc_time: 966.5ms, copr_cache_hit_ratio: 0.36}, tikv_task:{proc max:29ms, min:0s, p80:7ms, p95:29ms, iters:50, tasks:11}, scan_detail: {total_process_keys: 4168, total_process_keys_size: 784651, total_keys: 5203, rocksdb: {delete_skipped_count: 0, key_skipped_count: 4168, block: {cache_hit_count: 4151, read_count: 0, read_byte: 0 Bytes}}}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":599374.3333333333,"Actual Rows":606222,"Task":"root","Total Time":69547714,"Max Time":69547714,"Access Object":"","Operation Info":"data:Selection_100","Execution Info":"time:69.5ms, loops:592, cop_task: {num: 9, max: 100.1ms, min: 55ms, avg: 66ms, p95: 100.1ms, rpc_num: 9, rpc_time: 593.4ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":38950297,"Plans":[{"Node Id":"Selection","Plan Rows":599374.3333333333,"Actual Rows":606222,"Task":"cop[tikv]","Total Time":4423000000,"Max Time":656000000,"Access Object":"","Operation Info":"ge(new0107.lineitem.l_shipdate, 1993-01-01 00:00:00.000000), lt(new0107.lineitem.l_shipdate, 1994-01-01 00:00:00.000000)","Execution Info":"tikv_task:{proc max:656ms, min:273ms, p80:546ms, p95:656ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":4009984,"Actual Rows":4009984,"Task":"cop[tikv]","Total Time":4155000000,"Max Time":600000000,"Access Object":"","Operation Info":"table:lineitem, keep order:false","Execution Info":"tikv_task:{proc max:600ms, min:257ms, p80:522ms, p95:600ms, iters:3959, tasks:9}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  s_name,  s_address from  supplier,  nation where  s_suppkey in (   select    ps_suppkey   from    partsupp   where    ps_partkey in (     select      p_partkey     from      part     where      p_name like 'green%'    )    and ps_availqty > (     select      0.5 * sum(l_quantity)     from      lineitem     where      l_partkey = ps_partkey      and l_suppkey = ps_suppkey      and l_shipdate >= '1993-01-01'      and l_shipdate < date_add('1993-01-01', interval '1' year)    )  )  and s_nationkey = n_nationkey  and n_name = 'ALGERIA' order by  s_name;

{"Node Id":"Sort","Plan Rows":42035.97683311305,"Actual Rows":4,"Task":"root","Total Time":1025833349,"Max Time":1025833349,"Access Object":"","Operation Info":"Column#31","Execution Info":"time:1.03s, loops:2","Disk":0,"Memory":9712,"Plans":[{"Node Id":"Projection","Plan Rows":42035.97683311305,"Actual Rows":4,"Task":"root","Total Time":1025772841,"Max Time":1025772841,"Access Object":"","Operation Info":"Column#31, Column#32, Column#33","Execution Info":"time:1.03s, loops:5, Concurrency:5","Disk":0,"Memory":24280,"Plans":[{"Node Id":"HashAgg","Plan Rows":42035.97683311305,"Actual Rows":4,"Task":"root","Total Time":1025545228,"Max Time":1025545228,"Access Object":"","Operation Info":"group by:Column#37, funcs:count(1)-\u003eColumn#32, funcs:sum(Column#35)-\u003eColumn#33, funcs:firstrow(Column#36)-\u003eColumn#31","Execution Info":"time:1.03s, loops:5, partial_worker:{wall_time:1.024842675s, concurrency:5, task_num:7, tot_wait:5.109969535s, tot_exec:3.186114ms, tot_time:5.113189382s, max:1.024649506s, p95:1.024649506s}, final_worker:{wall_time:1.029821715s, concurrency:5, task_num:20, tot_wait:5.125473133s, tot_exec:343.635µs, tot_time:5.125824522s, max:1.025316613s, p95:1.025316613s}","Disk":0,"Memory":331557,"Plans":[{"Node Id":"Projection","Plan Rows":43584.08347826087,"Actual Rows":3679,"Task":"root","Total Time":1019612734,"Max Time":1019612734,"Access Object":"","Operation Info":"new0107.customer.c_acctbal, substring(new0107.customer.c_phone, 1, 2)-\u003eColumn#36, substring(new0107.customer.c_phone, 1, 2)-\u003eColumn#37","Execution Info":"time:1.02s, loops:8, Concurrency:5","Disk":0,"Memory":316586,"Plans":[{"Node Id":"HashJoin","Plan Rows":43584.08347826087,"Actual Rows":3679,"Task":"root","Total Time":1012899884,"Max Time":1012899884,"Access Object":"","Operation Info":"anti semi join, equal:[eq(new0107.customer.c_custkey, new0107.orders.o_custkey)]","Execution Info":"time:1.01s, loops:8, build_hash_table:{total:968.7ms, fetch:61.4ms, build:907.3ms}, probe:{concurrency:5, total:5.07s, max:1.02s, probe:92.9ms, fetch:4.97s}","Disk":0,"Memory":8253696,"Plans":[{"Node Id":"TableReader","Plan Rows":54480.10434782609,"Actual Rows":10834,"Task":"root","Total Time":6848479,"Max Time":6848479,"Access Object":"","Operation Info":"data:Selection_43","Execution Info":"time:6.85ms, loops:12, cop_task: {num: 1, max: 4.72ms, proc_keys: 0, rpc_num: 1, rpc_time: 4.67ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":775145,"Plans":[{"Node Id":"Selection","Plan Rows":54480.10434782609,"Actual Rows":10834,"Task":"cop[tikv]","Total Time":245000000,"Max Time":245000000,"Access Object":"","Operation Info":"gt(new0107.customer.c_acctbal, 5001.433377), in(substring(new0107.customer.c_phone, 1, 2), \"20\", \"40\", \"22\", \"30\", \"39\", \"42\", \"21\")","Execution Info":"tikv_task:{time:245ms, loops:151}","Disk":0,"Memory":0,"Plans":[{"Node Id":"TableFullScan","Plan Rows":150000,"Actual Rows":150000,"Task":"cop[tikv]","Total Time":202000000,"Max Time":202000000,"Access Object":"","Operation Info":"table:customer, keep order:false","Execution Info":"tikv_task:{time:202ms, loops:151}","Disk":0,"Memory":0,"Plans":[]}]}]},{"Node Id":"TableReader","Plan Rows":1094656,"Actual Rows":1001472,"Task":"root","Total Time":41029364,"Max Time":41029364,"Access Object":"","Operation Info":"data:TableFullScan_45","Execution Info":"time:41ms, loops:980, cop_task: {num: 2, max: 51.8ms, min: 34.7ms, avg: 43.3ms, p95: 51.8ms, rpc_num: 2, rpc_time: 86.5ms, copr_cache_hit_ratio: 1.00}","Disk":0,"Memory":8025811,"Plans":[{"Node Id":"TableFullScan","Plan Rows":1094656,"Actual Rows":1001472,"Task":"cop[tikv]","Total Time":1079000000,"Max Time":572000000,"Access Object":"","Operation Info":"table:orders, keep order:false","Execution Info":"tikv_task:{proc max:572ms, min:507ms, p80:572ms, p95:572ms, iters:987, tasks:2}","Disk":0,"Memory":0,"Plans":[]}]}]}]}]}]}]}
/*PLACEHOLDER*/ select  cntrycode,  count(*) as numcust,  sum(c_acctbal) as totacctbal from  (   select    substring(c_phone from 1 for 2) as cntrycode,    c_acctbal   from    customer   where    substring(c_phone from 1 for 2) in     ('20', '40', '22', '30', '39', '42', '21')    and c_acctbal > (     select      avg(c_acctbal)     from      customer     where      c_acctbal > 0.00      and substring(c_phone from 1 for 2) in       ('20', '40', '22', '30', '39', '42', '21')    )    and not exists (     select      *     from      orders     where      o_custkey = c_custkey    )  ) as custsale group by  cntrycode order by  cntrycode;
